Stack (330 cards, 1 backgrounds)

  on showPillar theID
  global  MY_Pillars
  if MY_Pillars is empty then put "off,off,off,off,off,off,off,off" into MY_Pillars
  if item theID of MY_Pillars is off then put 2010 into base
  else put 2000 into base
  get the loc of the target
  xCIcon3 it,theID + base
  play stop
  play "TN Crtyd Pilars"
  end showPillar
  
  on hidePillar
  hide the target
  show the target
  end hidePillar
  
  on PillarClick theID
  global  MY_Pillars,MY_boat
  play stop
  play "SW Pushbutton Out"
  if MY_Pillars is empty then put "off,off,off,off,off,off,off,off" into MY_Pillars
  get item theID of MY_Pillars
  if it is "on" then put "off" into item theID of MY_Pillars
  else put "on" into item theID of MY_Pillars
  showPillar theID
  if MY_Pillars is "off,on,off,off,on,on,off,off" then
  put "up" into MY_boat
  play stop
  hc
  play "BR ShipUp"
  repeat until the sound is done
  soundIdle
  end repeat
  else
  if MY_boat is "up" then
  put "down" into MY_boat
  play stop
  hc
  play "BR ShipUp"
  repeat until the sound is done
  soundIdle
  end repeat
  end if
  end if
  ww
  end PillarClick
  
  on closeCard
  global startTime
  hc
  put the ticks into startTime
  HTLock "true"
  end closeCard
  
  on openCard
  global pictAdd,startTime,HCSounds,MY_Water
  soundIdle
  HTChangePict bg fld "pict name","srccopy"
  get the result
  soundIdle
  if it is not empty then
  soundstop
  xmemory(1)
  HTChangePict bg fld "pict name","srccopy"
  soundIdle
  end if
  if pictAdd is not empty then
  set itemdelimiter to "|"
  repeat with x = 1 to the number of lines in pictAdd
  if line x of pictAdd is not empty then
  put item 1 of line x of pictAdd into thePict
  put item 2 of line x of pictAdd into theLoc
  put item 3 of line x of pictAdd into theClip
  if theClip is empty then HTAddPict thePict,theLoc,"srccopy"
  else HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
  end if
  soundIdle
  end repeat
  set itemdelimiter to ","
  put empty into pictAdd
  end if
  soundIdle
  
  if there is a window "WaterMoov" then
  hide window "WaterMoov"
  set the rate of window "WaterMoov" to "0"
  end if
  if MY_Water is not empty then
  if there is a window "WaterMoov" then
  set the windowRect of window "WaterMoov" to the rect of card button "moovmarker"
  set the movie of window "WaterMoov" to MY_Water
  soundIdle
  WaterIdle
  end if
  end if
  
  if HCSounds is not empty then
  play stop
  repeat with x = 1 to the number of lines in HCSounds
  do ("Play " & quote & line x of HCSounds & quote)
  end repeat
  put empty into HCSounds
  end if
  HTLock "forceFalse"
  
  if MY_Water is not empty then
  if there is a window "WaterMoov" then
  if MY_Water is "Vault Water.MooV" then
  set the currTime of window WaterMooV to 1932
  set the startTime of window WaterMooV to 1932
  set the endTime of window WaterMooV to 4300
  end if
  set the rate of window "WaterMoov" to "1"
  show window "WaterMoov"
  set the loop of window "WaterMoov" to true
  end if
  put empty into MY_Water
  end if
  
  soundIdle
  hide msg
  wait while the mouseclick
  pass openCard
  end openCard
  
  on waterIdle
  if there is a window "WaterMooV" then send movieIdle to window "WaterMooV"
  end waterIdle
  
  on openStack
  global ALL_CurrStack,S_SCREENPOS,documents,MY_Butter1
  -- The documents paths are for MooVs - always on the CD
  --
  put "Myst:Myst Graphics:Myst:" into documents
  --
  SetScreen
  bt --sets blind typing to true, remove after development
  BlackFrame
  xMemory(1)
  HTuDefPal 9001
  --HyperTint "later","delay","maxDepth8","iRes5","NoTEOpt"
  HyperTint "later","delay","iRes5","NoTEOpt"
  if the result is not empty then put the result
  htlock novbl
  htlock nobw
  htlock nocolormap
  start using stack "MYres1"
  start using stack "MYres2"
  start using stack "MYres3"
  DeCurse "install"
  deCurse "override","hand","color","nodelay"
  put "Myst" into All_CurrStack
  put true into MY_butter1
  end openStack
  
  on closeStack
  -- closing the stack, get rid of the HyperTint stuff
  DeCurse "remove"
  htlock true
  closemoovs
  HTRemove
  stop using stack "MYres1"
  stop using stack "MYres2"
  stop using stack "MYres3"
  end closeStack
  
  on closemoovs
  if there is a window "PlanetariumStarFieldLight" then close window "PlanetariumStarFieldLight"
  if there is a window "PlanetariumStarField" then close window "PlanetariumStarField"
  repeat with x = (the number of lines in the windows) down to 1
  if line x of the windows contains "moov" then close window (line x of the windows)
  else if line x of the windows contains "mov" then close window (line x of the windows)
  end repeat
  end closemoovs
  
  function FurnaceTime theParam
  return ((theParam - 12) / 13) * 1.2
  end FurnaceTime
  
  on idle
  global MY_TreeGate, MY_CabinValve, MY_Match, MY_Pilot
  set itemDelimiter to ","
  soundIdle
  if MY_TreeGate is empty then put "0,0" into MY_TreeGate
  if MY_Pilot is not "lit" then put 0 into CabinValve
  else put MY_CabinValve into CabinValve
  --put MY_CabinValve && MY_TreeGate
  if CabinValve ≠ 12 then
  if (item 1 of MY_TreeGate < 13 and CabinValve > 12) or ¬
  (item 1 of MY_TreeGate > 1 and CabinValve < 12) then
  put the seconds into now
  get abs(1/FurnaceTime(CabinValve) * 2.5)
  if now - item 2 of MY_TreeGate > it then
  put furnaceTime(CabinValve) into theRate
  if there is a window "CabinGauge.MooV" then set the rate of window "CabinGauge.MooV" to theRate
  if CabinValve > 12 then add 1 to item 1 of MY_TreeGate
  else subtract 1 from item 1 of MY_TreeGate
  put now into item 2 of MY_TreeGate
  if field "pict name" contains "TreeGate3-E" or ¬
  field "pict name" contains "TreeGate2-E" or ¬
  field "pict name" contains "TreeGate1-E" or ¬
  field "pict name" contains "TreeRoom2-S" or ¬
  field "pict name" contains "TreeRoom3-S" or ¬
  field "pict name" contains "TreeGateIn" or ¬
  field "pict name" contains "TreeGateLookDown" then
  HTLock "true"
  TreeUpdate
  end if
  play stop
  if CabinValve > 12 then
  play "PD TreeGate up"
  else
  play stop
  play "PD TreeGate down"
  end if
  end if
  end if
  if MY_Match is a number then
  if the ticks > MY_Match then
  put "out" into my_match
  repeat with x = 1 to 5
  deCurse "override",4000,"color","nodelay"
  wait 3
  deCurse "override",4001,"color","nodelay"
  wait 3
  end repeat
  deCurse "override",4002,"color","nodelay"
  wait 30
  end if
  end if
  end if
  pass idle
  end idle
  
  \0
  end if
  end if
  pass idle
  end idle
  
  \0
  \0lay"
  wait 30
  end if
  end if
  end if
  pass idle
  end idle
  
  \0t 30
  end if
  end if
  end if
  pass idle
  end idle
  
  \0"nodelay"
  wait 30
  end if
  end if
  end if
  pass idle
  end id

  * Card 21776 "" (3 parts)
    * Part 21776:1 ""
      on mouseUp
      go to card id 22764
      end mouseUp
    * Part 21776:2 "left"
      on mouseUp
      go to card id 21716
      end mouseUp
    * Part 21776:4 "right"
      on mouseUp
      go to card id 22034
      end mouseUp
  * Card 22034 "" (3 parts)
    * Part 22034:1 "right"
      on mouseUp
      go to card id 21716
      end mouseUp
    * Part 22034:2 ""
      on mouseUp
      go to card id 20863
      end mouseUp
    * Part 22034:3 "left"
      on mouseUp
      go to card id 21776
      end mouseUp
  * Card 21716 "qclo" (9 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute,MY_Gears
    put empty into pictAdd
    if MY_Gears is "up" then
    put field "pict name" & " (gears-up)" into WhichPict
    put WhichPict & "|" & the rect of card button GeaMarker & return into pictAdd
    show card button ClockPath
    show card button ClockPath2
    show card button qclo2
    else
    hide card button ClockPath
    hide card button ClockPath2
    hide card button qclo2
    end if
    put  "ClockControlsUp" & (MY_ClockHour mod 3) + ((MY_ClockMinute/5 mod 3) * 3) into WhichPict
    put WhichPict & "|" & the rect of card button marker & return after pictAdd
    
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 66 into item 1 of it
    put 65 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 64 into item 4 of it
    put  field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    playQT "AR Howling&Birds Mov",,loop,100
    pass openCard
    end openCard

    * Part 21716:1 "right"
      on mouseUp
      if there is a window "Gears.Moov" then close window "Gears.Moov"
      go to card id 21776
      end mouseUp
    * Part 21716:2 "left"
      on mouseUp
      if there is a window "Gears.Moov" then close window "Gears.Moov"
      go to card id 22034
      end mouseUp
    * Part 21716:5 "GeaMarker"
    * Part 21716:6 "ClockPath"
      on mouseUp
      if there is a window "Gears.Moov" then close window "Gears.Moov"
      go to card id 57311
      end mouseUp
    * Part 21716:7 "ClockPath2"
      on mouseUp
      if there is a window "Gears.Moov" then close window "Gears.Moov"
      go to card id 57311
      end mouseUp
    * Part 21716:8 "clock"
    * Part 21716:3 "marker"
      on mouseUp
      htlock true
      vd "up"
      go to card id 22299
      set cursor to none
      xMemory(1)
      end mouseUp
      
      on mouseWithin
      deCurse "override","down","color","nodelay"
      end mouseWithin
    * Part 21716:11 ""
      on mouseUp
      vd "up"
      go to card id 22299
      end mouseUp
      
      
      on mouseWithin
      deCurse "override","down","color","nodelay"
      end mouseWithin
    * Part 21716:12 "qclo2"
      on mouseUp
      if there is a window "Gears.Moov" then close window "Gears.Moov"
      go to card id 57311
      end mouseUp
  * Card 57311 "" (5 parts)

    on openCard
    global pictAdd,MY_CloMarker,MY_ClockMinute,MY_ClockHour
    if MY_CloMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CloMarker & return into pictAdd
    end if
    if MY_ClockHour > 9 or MY_ClockHour < 4 then put 12 into temphour
    else put MY_ClockHour into temphour
    
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 91 into item 1 of it
    put 90 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 44 into item 4 of it
    put  field "pict name" & " (Clock) " & temphour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    
    pass openCard
    end openCard

    * Part 57311:4 "CloMarker"
    * Part 57311:1 ""
      on mouseUp
      go to card id 60085
      end mouseUp
    * Part 57311:2 "right"
      on mouseUp
      go to card id 60452
      end mouseUp
    * Part 57311:3 "left"
      on mouseUp
      go to card id 60452
      end mouseUp
    * Part 57311:5 "clock"
  * Card 60085 "qclo2" (7 parts)

    on openCard
    global pictAdd,MY_CloMarker,MY_CloDoor
    hide card button enterclock
    hide card button closedoor
    show card button opendoor
    if MY_CloMarker is "on" then
    put  field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CloMarker into pictAdd
    end if
    put "closed" into MY_CloDoor
    playQT "AR Howling&Birds Mov",,loop,100
    pass openCard
    end openCard

    * Part 60085:6 "doormarker"
    * Part 60085:1 "right"
      on mouseUp
      global MY_CloDoor
      go to card id 60372
      if MY_CloDoor = "open" then
      play "DR Creak Open" tempo 150 c
      play "DR Door Close"
      end if
      
      end mouseUp
    * Part 60085:2 "left"
      on mouseUp
      global MY_CloDoor
      go to card id 60372
      if MY_CloDoor = "open" then
      play "DR Creak Open" tempo 150 c
      play "DR Door Close"
      end if
      
      end mouseUp
    * Part 60085:4 "CloMarker"
      on mouseDown
      global MY_CloMarker
      htlock true
      if MY_CloMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button clomarker, "Srccopy"
      put "off" into MY_CloMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button clomarker, "Srccopy"
      put "on" into MY_CloMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 60085:5 "opendoor"
      on mouseUp
      global MY_CloDoor,MY_GearGate
      put "open" into MY_CloDoor
      if MY_GearGate is "open" then
      put field "Pict Name" & " (Door/Gear)" into WhichPict
      else  put field "pict name" & " (DoorOpen)" into WhichPict
      hide card button opendoor
      show card button closedoor
      show card button enterclock
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,2,32
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "DR Creak 2"
      htlock forcefalse
      play stop
      end mouseUp
    * Part 60085:7 "enterclock"
      on mouseUp
      soundstop
      xmemory(1)
      go to card id 70105
      end mouseUp
    * Part 60085:8 "closedoor"
      on mouseUp
      global MY_CloDoor
      hc
      htlock true
      HTvisual "wipe left",,the rect of card button doormarker,2,32
      show card button opendoor
      hide card button closedoor
      hide card button enterclock
      dplay"DR Creak Open"
      opencard
      play stop
      play "DR Door Close"
      put "closed" into MY_CloDoor
      end mouseUp
  * Card 72845 "" (5 parts)

    on openCard
    global pictAdd,MY_CloMarker
    if MY_CloMarker is "on" then
    put field "pict name" into WhichPict
    delete last word of whichPict
    put WhichPict & " (Switch-on)|" & the rect ¬
    of card button CloMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 72845:5 "none"
      on mouseUp
      htvisual "wipe left",,,0
      go to card id 60085
      play "DR Creak Open"
      htvisual "scroll left",,,0
      go to card id 60372
      end mouseUp
      
      on mouseWithin
      deCurse "override","right","color","nodelay"
      end mouseWithin
    * Part 72845:4 "none"
      on mouseUp
      htvisual "wipe right",,,0
      go to card id 60085
      play "DR Creak Open"
      htvisual "scroll right",,,0
      go to card id 60372
      end mouseUp
      
      on mouseWithin
      deCurse "override","left","color","nodelay"
      end mouseWithin
    * Part 72845:1 ""
      on mouseUp
      go to card id 70105
      end mouseUp
    * Part 72845:2 ""
      on mouseUp
      HTVisual "wipe left",,,1
      go to card id 60085
      play "DR Creak Open"
      end mouseUp
    * Part 72845:3 "CloMarker"
      on mouseDown
      global MY_CloMarker
      if MY_CloMarker is "on" then
      xCIcon3 the loc of card button CloMarker, 9019
      play stop
      play "SW Marker"
      put "off" into MY_CloMarker
      else
      xCIcon3 the loc of card button CloMarker, 9020
      play stop
      play "SW Marker"
      put "on" into MY_CloMarker
      end if
      end mouseDown
  * Card 70105 "" (16 parts)

    on openCard
    global MY_GearGate,GearSetup
    put false into GearSetup
    set cursor to none
    if MY_GearGate is "open" then
    gearmusic
    if the last word of field "pict name" is not "(GateOpen)" then put " (GateOpen)" after field "pict name"
    wait 0
    else
    if the last word of field "pict name" is "(GateOpen)" then delete the last word of field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global GearSetup,MY_GearGate
    if GearSetup is not true then
    set cursor to none
    if MY_GearGate is "open" then
    PreGear 1,2
    soundidle
    PreGear 2,2
    soundidle
    PreGear 3,1
    else
    PreGear 1,3
    soundidle
    PreGear 2,3
    soundidle
    PreGear 3,3
    end if
    soundidle
    PreWeight
    put true into GearSetup
    end if
    end idle
    
    on checkNum
    global MY_GearGate
    get "Clock1-W Gear1.MooV"
    if there is a window it then put the currTime of window it into G1
    get "Clock1-W Gear2.MooV"
    if there is a window it then put the currTime of window it into G2
    get "Clock1-W Gear3.MooV"
    if there is a window it then put the currTime of window it into G3
    if G1 is 600 and G2 is 600 and G3 is 300 then
    if MY_GearGate is not "open" then
    set cursor to none
    WeightDown
    OpenGate
    end if
    else
    if MY_GearGate is not "closed" then
    set cursor to none
    CloseGate
    end if
    end if
    end checkNum
    
    on PreWeight
    global MY_GearGate
    put "Clock1-W LeftChain.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button weightMarker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the timeFormat of window TheMovieName to "MovieTime"
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    if MY_GearGate is "open" then set the currTime of window theMovieName to the endTime of window theMovieName
    else set the startTime of window TheMovieName to 0
    set the passMovieClick of window theMovieName to false
    show window TheMovieName
    end if
    end PreWeight
    
    on PreGate
    global MY_GearGate
    put "Clock1-W GearGate.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button gateMarker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    if MY_GearGate is "open" then set the currTime of window TheMovieName to the endTime of window TheMovieName
    end if
    end PreGate
    
    on OpenGate
    global MY_GearGate
    put "Clock1-W GearGate.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    PreGate
    end if
    set the startTime of window TheMovieName to "0"
    play "CN Chain Run"
    wait 4 seconds
    play "GR GearGate Huge Faint Mx 22"
    show window TheMovieName
    set the rate of window TheMovieName to "1.0"
    put "open" into MY_GearGate
    repeat until the rate of window TheMovieName = 0
    send movieIdle to window TheMovieName
    end repeat
    htlock true
    opencard
    hide window theMovieName -- Added 1.0b8
    end OpenGate
    
    on CloseGate
    global theMovieName, MY_GearGate
    put "Clock1-W GearGate.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    PreGate
    end if
    play "CN Chain Run"
    wait 4 seconds
    play "GR GearGate Huge Faint Mx 22"
    show window TheMovieName
    send reverse to window TheMovieName
    put "closed" into MY_GearGate
    repeat until the rate of window TheMovieName = 0
    send movieIdle to window TheMovieName
    end repeat
    htlock true
    opencard
    hide window theMovieName -- Added 1.0b8
    end CloseGate
    
    on mouseDownInMovie theMovie
    click at the mouseLoc
    end mouseDownInMovie
    
    on closeCard
    global GearSetup
    put false into GearSetup
    get "Clock1-W LeftChain.MooV"
    if there is a window it then close window it
    get "Clock1-W GearGate.MooV"
    if there is a window it then close window it
    get "Clock1-W Gear1.MooV"
    if there is a window it then close window it
    get "Clock1-W Gear2.MooV"
    if there is a window it then close window it
    get "Clock1-W Gear3.MooV"
    if there is a window it then close window it
    xmemory (1)
    pass closeCard
    end closeCard
    
    on PreGear Which,Pos
    put "Clock1-W Gear" & which & ".MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    get the topleft of card button ("gear" & which)
    Movie TheMovieName,"borderless",it,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the timeFormat of window TheMovieName to "MovieTime"
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    get 0
    if Pos is not 3 then get Pos * 300
    set the currTime of window TheMovieName to it
    set the rate of window TheMovieName to "0.0"
    show window TheMovieName
    end if
    end PreGear
    
    on Gear Which
    put "Clock1-W Gear" & which & ".MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    get the currTime of window TheMovieName
    set the startTime of window TheMovieName to it
    if it ≥ 730 then get 0
    add 300 to it
    set the endTime of window TheMovieName to it
    set the rate of window TheMovieName to "1.0"
    end if
    end Gear
    
    on WeightDown
    put "Clock1-W LeftChain.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    get the currTime of window TheMovieName
    set the startTime of window TheMovieName to it
    set the endTime of window TheMovieName to 1800
    set the rate of window TheMovieName to "1.0"
    play "CN Puzzle Solve Mid" -- added (1.0b8)
    play "CN Puzzle Solve Mid" -- added (1.0b8)
    repeat until the rate of window TheMovieName = 0 -- added (1.0b8)
    send movieIdle to window TheMovieName -- added (1.0b8)
    end repeat  -- added (1.0b8)
    play stop
    end if
    end WeightDown
    
    on gearmusic
    set cursor to none
    playQT "FlyGearGate/Music.MooV",,loop,30
    end gearmusic

    * Part 70105:16 "rightlever"
    * Part 70105:15 "rightswitch"
    * Part 70105:19 "ratchetmarker"
    * Part 70105:20 "ratchetSwitch"
    * Part 70105:18 "leftlever"
    * Part 70105:17 "leftswitch"
    * Part 70105:5 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      Lever
      end mouseDown
      
      on lever
      global Do_it
      put true into do_it
      --htlock nobw
      put 0 into it
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      put "Clock1-W RatchetSwitch" into thePict
      put the rect of card button "RatchetMarker" into theLoc
      put "0,0,45,188" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button "ratchetswitch" then exit repeat
      get (the mouseV - theStart) div 8
      if it < 0 then get 0
      if it > 4 then get 4
      put it * 45 into item 1 of theClip
      put it * 45 + 45 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it = 4 then
      deCurse "override",2003,"color","nodelay"
      lever2
      exit repeat
      end if
      end repeat
      if do_it is true then
      deCurse "override",2003,"color","nodelay"
      repeat with x = it down to 0
      put x * 45 into item 1 of theClip
      put x * 45 + 45 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      end if
      --htlock bw
      end lever
      
      on Lever2
      global MY_GearGate, do_it
      set the cursor to none
      soundstop
      if there is a window "Clock1-W LeftChain.MooV" then
      if the currTime of window "Clock1-W LeftChain.MooV" is not 0 then
      weight
      Resetgear 1
      repeat until the currTime of window "Clock1-W Gear1.MooV" is 900
      send movieIdle to window "Clock1-W Gear1.MooV"
      send movieIdle to window "Clock1-W LeftChain.MooV"
      end repeat
      send movieIdle to window "Clock1-W Gear1.MooV"
      Resetgear 2
      repeat until the currTime of window "Clock1-W Gear2.MooV" is 900
      send movieIdle to window "Clock1-W Gear2.MooV"
      send movieIdle to window "Clock1-W LeftChain.MooV"
      end repeat
      send movieIdle to window "Clock1-W Gear2.MooV"
      Resetgear 3
      repeat until the currTime of window "Clock1-W Gear3.MooV" is 900
      send movieIdle to window "Clock1-W Gear3.MooV"
      send movieIdle to window "Clock1-W LeftChain.MooV"
      end repeat
      send movieIdle to window "Clock1-W Gear3.MooV"
      repeat until the rate of window "Clock1-W LeftChain.MooV" is 0
      send movieIdle to window "Clock1-W LeftChain.MooV"
      end repeat
      play stop
      play "CN Puzzle Solve End"
      PreGear 1,3
      PreGear 2,3
      PreGear 3,3
      put "Clock1-W RatchetSwitch" into thePict
      put the rect of card button "RatchetMarker" into theLoc
      put "0,0,45,188" into theClip
      repeat with x = 4 down to 0
      put x * 45 into item 1 of theClip
      put x * 45 + 45 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      put false into do_it
      if MY_GearGate is "open" then CloseGate
      wait 0
      end if
      end if
      end Lever2
      
      on Weight
      put "Clock1-W LeftChain.MooV" into TheMovieName --∆
      play "CN Puzzle Solve Strt"
      play "CN Puzzle Solve Mid"
      play "CN Puzzle Solve Mid"
      play "CN Puzzle Solve Mid"
      play "CN Puzzle Solve Mid"
      play "CN Puzzle Solve Mid"
      --play "CN Puzzle Solve End"
      
      if there is a window TheMovieName then
      get the currTime of window TheMovieName
      set the startTime of window TheMovieName to it
      set the endTime of window TheMovieName to 0
      set the rate of window TheMovieName to "-1.0"
      end if
      end Weight
      
      on ResetGear Which
      put "Clock1-W Gear" & which & ".MooV" into TheMovieName --∆
      if there is a window TheMovieName then
      get the currTime of window TheMovieName
      set the startTime of window TheMovieName to it
      if it ≠ 900 then
      set the endTime of window TheMovieName to 900
      set the rate of window TheMovieName to "2.0"
      show window TheMovieName
      else
      set the currTime of window TheMovieName to 900
      end if
      end if
      end ResetGear
    * Part 70105:1 "right"
      on mouseUp
      htlock true
      go to card id 71232
      end mouseUp
    * Part 70105:3 "left"
      on mouseUp
      htlock true
      go to card id 71232
      end mouseUp
    * Part 70105:4 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      Lever
      end mouseDown
      
      on lever
      --htlock nobw
      put 0 into it
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      put "Clock1-W LeftSwitch" into thePict
      put the rect of card button "LeftSwitch" into theLoc
      put "0,0,60,108" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button "leftlever" then exit repeat
      get (the mouseV - theStart) div 10
      if it < 0 then get 0
      if it > 5 then get 5
      put it * 60 into item 1 of theClip
      put it * 60 + 60 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it = 5 then lever2
      end repeat
      deCurse "override",2003,"color","nodelay"
      repeat with x = it down to 0
      put x * 60 into item 1 of theClip
      put x * 60 + 60 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      checknum  -- moved from lever2 handler (1.0b8)
      --htlock bw
      end lever
      
      on Lever2
      get 0
      if there is a window "Clock1-W LeftChain.MooV" then get the currTime of window "Clock1-W LeftChain.MooV"
      if it < 1750 then
      play "CN Puzzle Solve Strt"
      Weight
      Chain
      gear 2
      gear 3
      repeat until the rate of window "Clock1-W Gear3.MooV" is 0
      send movieIdle to window "Clock1-W LeftChain.MooV"
      send movieIdle to window "Clock1-W Gear2.MooV"
      send movieIdle to window "Clock1-W Gear3.MooV"
      end repeat
      if the mouse is down and the mouseloc is within the rect of card button "leftlever" then
      repeat until the mouse is up
      play "CN Puzzle Solve Strt"
      get 0
      if there is a window "Clock1-W LeftChain.MooV" then get the currTime of window "Clock1-W LeftChain.MooV"
      if it < 1750 then
      Weight
      Chain
      gear 2
      repeat until the rate of window "Clock1-W Gear2.MooV" is 0
      send movieIdle to window "Clock1-W LeftChain.MooV"
      send movieIdle to window "Clock1-W Gear2.MooV"
      end repeat
      end if
      if the mouseloc is not within the rect of card button "leftlever" then exit repeat
      end repeat
      play stop
      play "CN Chain Stop"
      end if
      -- checknum  -- moved up to lever handler (1.0b8)
      end if
      end Lever2
      
      on Chain
      -- Rattle Ratchet Routine...
      -- It's no longer with us, but it may be back!!!
      end Chain
      
      on Weight
      put "Clock1-W LeftChain.MooV" into TheMovieName --∆
      if there is a window TheMovieName then
      get the currTime of window TheMovieName
      set the startTime of window TheMovieName to it
      add 200 to item 1 of it
      set the endTime of window TheMovieName to it
      set the rate of window TheMovieName to "1.0"
      end if
      end Weight
    * Part 70105:6 "GateMarker"
    * Part 70105:9 "weightMarker"
    * Part 70105:11 "gear1"
    * Part 70105:12 "gear2"
    * Part 70105:13 "gear3"
    * Part 70105:14 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      Lever
      end mouseDown
      
      on lever
      --htlock nobw
      put 0 into it
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      put "Clock1-W RightSwitch" into thePict
      put the rect of card button "RightSwitch" into theLoc
      put "0,0,56,105" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button "rightlever" then exit repeat
      get (the mouseV - theStart) div 10
      if it < 0 then get 0
      if it > 5 then get 5
      put it * 56 into item 1 of theClip
      put it * 56 + 56 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it = 5 then lever2
      end repeat
      deCurse "override",2003,"color","nodelay"
      repeat with x = it down to 0
      put x * 56 into item 1 of theClip
      put x * 56 + 56 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      checkNum
      --htlock bw
      end lever
      
      on Lever2
      get 0
      if there is a window "Clock1-W LeftChain.MooV" then get the currTime of window "Clock1-W LeftChain.MooV"
      if it < 1750 then
      play "CN Puzzle Solve Strt"
      Weight
      Chain
      gear 1
      gear 2
      repeat until the rate of window "Clock1-W Gear2.MooV" is 0
      send movieIdle to window "Clock1-W LeftChain.MooV"
      send movieIdle to window "Clock1-W Gear1.MooV"
      send movieIdle to window "Clock1-W Gear2.MooV"
      end repeat
      if the mouse is down and the mouseloc is within the rect of card button "rightlever" then
      repeat until the mouse is up
      play "CN Puzzle Solve Strt"
      get 0
      if there is a window "Clock1-W LeftChain.MooV" then get the currTime of window "Clock1-W LeftChain.MooV"
      if it < 1750 then
      Weight
      Chain
      gear 2
      repeat until the rate of window "Clock1-W Gear2.MooV" is 0
      send movieIdle to window "Clock1-W LeftChain.MooV"
      send movieIdle to window "Clock1-W Gear2.MooV"
      end repeat
      --else
      --exit repeat
      end if
      if the mouseloc is not within the rect of card button "rightlever" then exit repeat
      end repeat
      play stop
      play "CN Chain Stop"
      end if
      --if the sound ≠ "CN Chain Stop" then play "CN Chain Stop"
      end if
      --
      end Lever2
      
      on Chain
      -- Rattle Ratchet Routine...
      -- It's no longer with us, but it may be back!!!
      end Chain
      
      on Weight
      put "Clock1-W LeftChain.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      Movie TheMovieName,"borderless",the topleft of card button weightMarker,"invisible","Floating"
      set the startTime of window TheMovieName to 0
      end if
      if there is a window TheMovieName then
      set the timeFormat of window TheMovieName to "MovieTime"
      set the audioLevel of window TheMovieName to "0"
      set the mute of window TheMovieName to true
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      show window TheMovieName
      get the currTime of window TheMovieName
      set the startTime of window TheMovieName to it
      add 200 to item 1 of it
      set the endTime of window TheMovieName to it
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "1.0"
      end if
      end Weight
  * Card 71232 "" (3 parts)
    * Part 71232:1 "right"
      on mouseUp
      go to card id 70105
      end mouseUp
    * Part 71232:2 "left"
      on mouseUp
      go to card id 70105
      end mouseUp
    * Part 71232:3 ""
      on mouseUp
      go to card id 60372
      if there is a window "FlyGearGate/Music.MooV" then close window "FlyGearGate/Music.MooV"
      playQT "AR Lite Wind MoV",,loop,200
      play "DR Creak Open" tempo 150 c
      play "DR Door Close"
      end mouseUp
  * Card 60372 "" (5 parts)
    * Part 60372:1 ""
      on mouseUp
      go to card id 60452
      end mouseUp
    * Part 60372:2 "right"
      on mouseUp
      go to card id 60085
      end mouseUp
    * Part 60372:3 "left"
      on mouseUp
      go to card id 60085
      end mouseUp
    * Part 60372:4 "qfor2"
      on mouseUp
      go to card id 60452
      end mouseUp
    * Part 60372:5 "qcab right"
      on mouseUp
      go to card id 60085
      end mouseUp
  * Card 60452 "" (4 parts)
    * Part 60452:1 ""
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,50
      go to card id 60828
      end mouseUp
    * Part 60452:2 "right"
      on mouseUp
      go to card id 57311
      end mouseUp
    * Part 60452:3 "left"
      on mouseUp
      go to card id 57311
      end mouseUp
    * Part 60452:4 "qfor2"
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,50
      go to card id 60828
      end mouseUp
  * Card 60828 "" (6 parts)
    * Part 60828:3 "right"
      on mouseUp
      go to card id 56703
      end mouseUp
    * Part 60828:1 ""
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 22764
      end mouseUp
    * Part 60828:2 ""
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 21716
      end mouseUp
    * Part 60828:4 "left"
      on mouseUp
      go to card id 56703
      end mouseUp
    * Part 60828:5 ""
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 22034
      end mouseUp
    * Part 60828:6 "qfor2"
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 22764
      end mouseUp
  * Card 56703 "" (6 parts)

    on openCard
    global pictAdd,MY_CloMarker,MY_ClockMinute,MY_ClockHour
    if MY_CloMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CloMarker & return into pictAdd
    end if
    
    get the rect of card button clock
    --subtract (MY_ClockMinute div 5) * 70 from item 1 of it
    put (MY_ClockMinute div 5) * 70 into item 1 of it
    put 69 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 64 into item 4 of it
    put field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    
    pass openCard
    end openCard

    * Part 56703:4 "cloMarker"
    * Part 56703:1 "right"
      on mouseUp
      go to card id 60828
      end mouseUp
    * Part 56703:2 "left"
      on mouseUp
      go to card id 60828
      end mouseUp
    * Part 56703:3 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,80
      go to card id 57311
      end mouseUp
    * Part 56703:5 "clock"
    * Part 56703:6 "qclo2"
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,80
      go to card id 57311
      end mouseUp
  * Card 22299 "" (7 parts)

    on mouseDownInMovie
    click at the mouseloc
    end mouseDownInMovie
    
    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute,MY_Gears
    if MY_Gears is "up" then
    put field "pict name" & " (gears-up)" into WhichPict
    put WhichPict & "|" & the rect of card button GeaMarker2 & return into pictAdd
    end if
    put "ClockControls" & (MY_ClockHour mod 3) + ((MY_ClockMinute/5 mod 3) * 3) into WhichPict
    put WhichPict & "|" & the rect of card button marker after pictAdd
    pass openCard
    end openCard
    
    on idle
    if there is not a window "Gears.MooV" then GearsPre
    end idle
    
    
    on GearsPre
    put "Gears.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    soundIdle
    Movie TheMovieName,"borderless",the topleft of card button GeaMarker,"invisible","Floating"
    soundIdle
    end if
    if there is a window TheMovieName then
    set the timeFormat of window theMovieName to Movietime
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    set the fastIdle of window TheMovieName to true
    end if
    end GearsPre
    
    on GearsUp
    put "Gears.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then GearsPre
    if there is a window TheMovieName then
    set the startTime of window TheMovieName to "0"
    set the currTime of window TheMovieName to "0"
    set the endTime of window TheMovieName to "650"
    show window TheMovieName
    set the rate of window TheMovieName to ".5"
    end if
    end GearsUp
    
    on GearsDown
    put "Gears.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then GearsPre
    if there is a window TheMovieName then
    set the startTime of window TheMovieName to "700"
    set the currTime of window TheMovieName to "700"
    set the endTime of window theMovieName to the duration of window theMovieName
    show window TheMovieName
    set the rate of window TheMovieName to ".5"
    end if
    end GearsDown

    * Part 22299:9 "GeaMarker2"
      on mouseUp
      
      end mouseUp
    * Part 22299:1 ""
      on mouseUp
      htvisual "scroll down",,,0
      go to card id 21716
      end mouseUp
    * Part 22299:8 "GeaMarker"
    * Part 22299:2 "marker"
    * Part 22299:4 "none"
      on mouseDown
      global MY_ClockMinute,MY_ClockHour,MY_ClickCheck
      put "ClockControls" into WhichPict
      put ((MY_ClockHour) mod 3) into theStart
      repeat until the mouse is up
      if the sound is "done" then play "SQ WheelLarge"
      add 5 to MY_ClockMinute
      if MY_ClockMinute > 59 then put 0 into MY_ClockMinute
      get theStart + ((MY_ClockMinute/5 mod 3) * 3)
      HTAddPict WhichPict & it, the rect of card button marker, "Srccopy"
      wait 2
      soundIdle
      end repeat
      put "true" into MY_ClickCheck
      end mouseDown
    * Part 22299:5 ""
      on mouseDown
      global MY_ClockHour,MY_ClockMinute,MY_Clickcheck
      put "true" into my_clickcheck
      put "ClockControls" into WhichPict
      put (MY_ClockMinute/5 mod 3) * 3 into theStart
      repeat until the mouse is up
      if the sound is "done" then play "SQ WheelSmall"
      add 1 to MY_ClockHour
      if MY_ClockHour > 12 then put 1 into MY_ClockHour
      get (MY_ClockHour mod 3) + theStart
      HTAddPict WhichPict & it, the rect of card button marker, "Srccopy"
      wait 2
      soundIdle
      end repeat
      end mouseDown
    * Part 22299:6 ""
      on mouseDown
      global MY_ClockHour,MY_ClockMinute,MY_Gears
      global theMovieName
      set cursor to none
      put the loc of me into origLoc
      xCIcon3 the loc of the target, 9110
      play "SW PushButton In"
      wait until the mouse is up
      play "SW PushButton Out"
      set loc of me to 0,0
      set the loc of me to origLoc
      put empty into gearchange
      put "Gears.Moov" into theMovieName
      if MY_Gears is not "up" then
      if MY_ClockMinute is 40 and MY_ClockHour is 2 then
      soundPause
      play "MR GearPath Up"
      wait 30
      gearsUp
      send movieIdle to window theMovieName
      put "up" into MY_Gears
      put 1 into gearchange
      end if
      else
      if MY_ClockMinute is not 40 or MY_ClockHour is not 2 then
      soundPause
      play "MR GearPath Up"
      wait 30
      gearsDown
      send movieIdle to window theMovieName
      put "down" into MY_Gears
      put 1 into gearchange
      end if
      end if
      if there is a window theMovieName then
      repeat until the rate of window theMovieName = 0
      send movieIdle to window theMovieName
      end repeat
      end if
      if gearchange = 1 then
      htlock "true"
      openCard
      set cursor to none
      end if
      hide window theMovieName
      wait until the sound is "done"
      soundStart
      end mouseDown
  * Card 36854 "" (7 parts)

    on openCard
    global pictAdd,MY_CabinValve,MY_Pilot,showMoov
    if MY_Pilot is empty then put "out" into MY_Pilot
    put "CabinValveFar" & (MY_CabinValve mod 6) + 1 into WhichPict
    put WhichPict & "|" & the rect of card button marker & return into pictAdd
    playFire
    if MY_Pilot is "lit" then
    put "CabinPilotFar (on)" into WhichPict
    put WhichPict & "|" & the rect of card button markerPilot & return after pictAdd
    if MY_CabinValve > 0 then
    put "CabinFireFar (on)" into WhichPict
    put WhichPict & "|" & the rect of card button markerFire & return after pictAdd
    set the rate of window "CabinFire.MooV" to 1
    end if
    else
    if MY_CabinValve > 0 then playQT "AR Gas MoV",,"loop",MY_CabinValve * 2,,,,,true
    end if
    playGauge
    put empty into showMooV
    pass openCard
    end openCard
    
    on idle
    global showMoov,MY_CabinValve,MY_Pilot
    if showMoov is empty then
    if there is a window "CabinGauge.MooV" then
    setGauge
    show window "CabinGauge.MooV"
    end if
    if MY_Pilot is "lit" and MY_CabinValve > 0 then
    if there is a window "CabinFire.moov" then show window "CabinFire.moov"
    end if
    put true into showMoov
    end if
    pass idle
    end idle
    
    on closeCard
    if there is a window "CabinGauge.MooV" then hide window "CabinGauge.MooV"
    if there is a window "CabinFire.moov" then hide window "CabinFire.moov"
    pass closeCard
    end closeCard
    
    on playGauge
    global MY_CabinValve, MY_pilot
    set cursor to none
    put "CabinGauge.MooV" into TheMovieName
    if there is a window TheMovieName then
    set the movie of window theMovieName to "CabinGaugeFar.MooV"
    set the windowRect of window themovieName to the rect of card button markerGauge
    else
    Movie "CabinGaugeFar.MooV","borderless",the topleft of card button markerGauge,"invisible","Floating"
    if there is a window "CabinGaugeFar.MooV" then
    set the windowName of window "CabinGaugeFar.MooV" to "CabinGauge.MooV"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the controllerVisible of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the passMovieClick of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    end if
    end if
    end playGauge
    
    on setGauge
    global MY_CabinValve, MY_pilot
    put "CabinGauge.MooV" into TheMovieName
    if there is a window TheMovieName then
    set the startTime of window TheMovieName to "0"
    if MY_CabinValve ≤ 12 or MY_Pilot = "out" then set the currTime of window TheMovieName to "0,1"
    else set the currTime of window TheMovieName to "2,3"
    if MY_Pilot is "lit" then put (MY_CabinValve - 12) / 20 into theRate
    else put (-.6) into theRate
    set the rate of window TheMovieName to theRate
    end if
    end setGauge
    
    on playFire
    global MY_Pilot,MY_CabinValve
    set cursor to none
    put "CabinFire.MooV" into TheMovieName
    if there is a window TheMovieName then
    if MY_Pilot is "lit" and MY_CabinValve > 0 then
    set the movie of window theMovieName to "CabinFireFar.MooV"
    set the windowRect of window themovieName to the rect of card button markerFire
    set the audioLevel of window "CabinFire.moov" to "100"
    end if
    else
    Movie "CabinFireFar.MooV","borderless",the topleft of card button markerFire,"invisible","Floating"
    if there is a window "CabinFireFar.MooV" then
    set the windowName of window "CabinFireFar.MooV" to "CabinFire.MooV"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "100"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    set the currTime of window TheMovieName to "0"
    set the passMovieClick of window TheMovieName to false
    end if
    end if
    end playFire
    
    on MouseDownInMovie
    click at the clickloc
    end MouseDownInMovie

    * Part 36854:5 "markerGauge"
    * Part 36854:6 "markerFire"
    * Part 36854:7 "markerPilot"
    * Part 36854:4 "marker"
    * Part 36854:1 ""
      on mouseUp
      htlock true
      go to card id 36943
      end mouseUp
    * Part 36854:2 "right"
      on mouseUp
      htlock true
      go to card id 37341
      end mouseUp
    * Part 36854:3 "left"
      on mouseUp
      htlock true
      go to card id 37341
      end mouseUp
  * Card 36943 "" (11 parts)

    on openCard
    global pictAdd,MY_CabinValve,MY_Pilot,showMoov
    if MY_Pilot is empty then put "out" into MY_Pilot
    put "CabinValve" & (MY_CabinValve mod 6) + 1 into WhichPict
    put WhichPict & "|" & the rect of card button marker & return into pictAdd
    if MY_Pilot is "lit" then
    put "CabinPilot (on)" into WhichPict
    put WhichPict & "|" & the rect of card button markerPilot & return after pictAdd
    if MY_CabinValve > 0 then
    put "CabinFire (on)" into WhichPict
    put WhichPict & "|" & the rect of card button markerFire & return after pictAdd
    end if
    else
    if MY_CabinValve > 0 then playQT "AR Gas MoV",,"loop",MY_CabinValve * 4,,,,,true
    end if
    playFire
    playGauge
    put empty into showMooV
    pass openCard
    end openCard
    
    on idle
    global showMoov,MY_CabinValve,MY_Pilot
    if showMoov is empty then
    if there is a window "CabinGauge.MooV" then
    setGauge
    show window "CabinGauge.MooV"
    end if
    if MY_Pilot is "lit" and MY_CabinValve > 0 then
    if there is a window "CabinFire.moov" then
    show window "CabinFire.moov"
    set the audioLevel of window "CabinFire.moov" to "200"
    end if
    end if
    put true into showMoov
    end if
    if there is a window "CabinGauge.MooV" then send movieidle to window "CabinGauge.MooV"
    if there is a window "CabinFire.moov" then send movieidle to window "CabinFire.moov"
    pass idle
    end idle
    
    on closeCard
    if there is a window "CabinGauge.MooV" then hide window "CabinGauge.MooV"
    if there is a window "CabinFire.moov" then hide window "CabinFire.moov"
    pass closeCard
    end closeCard
    
    on setGauge
    global MY_CabinValve, MY_pilot
    put "CabinGauge.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    set the startTime of window TheMovieName to "0"
    if MY_CabinValve ≤ 12 or MY_Pilot = "out" then set the currTime of window TheMovieName to "0,1"
    else set the currTime of window TheMovieName to "2,3"
    if MY_Pilot is "lit" then put (MY_CabinValve - 12) / 20 into theRate
    else put (-.6) into theRate
    set the rate of window TheMovieName to theRate
    end if
    end setGauge
    
    on playFire
    put "CabinFire.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    set the movie of window theMovieName to "CabinFire.MooV"
    set the windowRect of window themovieName to the rect of card button markerFire
    end if
    end playFire
    
    on playGauge
    put "CabinGauge.MooV" into TheMovieName --∆
    set the movie of window theMovieName to "CabinGauge.MooV"
    set the windowRect of window themovieName to the rect of card button markerGauge
    end playGauge

    * Part 36943:12 ""
    * Part 36943:8 "left"
      on mouseUp
      global MY_CabinValve,MY_Pilot
      htlock true
      if MY_Pilot is not "lit" and MY_Cabinvalve > 0 then
      playQT "AR Gas MoV",,"loop",MY_CabinValve * 2,,,,,true
      end if
      go to card id 37341
      end mouseUp
    * Part 36943:6 "marker"
    * Part 36943:1 "right"
      on mouseUp
      global MY_CabinValve,MY_Pilot
      htlock true
      if MY_Pilot is not "lit" and MY_Cabinvalve > 0 then
      playQT "AR Gas MoV",,"loop",MY_CabinValve * 2,,,,,true
      end if
      go to card id 37341
      end mouseUp
    * Part 36943:3 ""
      on mousewithin
      deCurse "override",8000,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global MY_CabinValve,MY_TreeGate,MY_Pilot
      repeat until the mouse is up
      if MY_CabinValve > 24 then exit repeat
      if MY_CabinValve = 0 and MY_Pilot is "lit" then
      HTAddPict "CabinFire (on)",the rect of card button markerFire,"srccopy"
      if there is a window "CabinFire.moov" then
      set the rate of window "Cabinfire.moov" to 1
      show window "Cabinfire.moov"
      end if
      end if
      add 1 to MY_CabinValve
      get (MY_CabinValve mod 6) + 1
      HTAddPict "CabinValve" & it, the rect of card button marker, "Srccopy"
      if the sound is "done" then play "SQ WheelLarge"
      if there is a window "CabinGauge.MooV" then send movieIdle to window "CabinGauge.MooV"
      if there is a window "CabinFire.moov" then send movieIdle to window "CabinFire.moov"
      if MY_Pilot is not "lit" then playQT "AR Gas MoV",,"loop",MY_CabinValve * 4,,,,,true
      end repeat
      put the seconds into item 2 of MY_TreeGate
      if MY_Pilot is "lit" and there is a window "CabinGauge.MooV" then
      put furnaceTime(MY_CabinValve) into theRate
      if theRate ≥ 0 and cTime ≠ eTime then
      set the rate of window "CabinGauge.MooV" to theRate
      end if
      end if
      end mouseDown
    * Part 36943:5 "markerFire"
    * Part 36943:7 "none"
      on mousewithin
      deCurse "override",8001,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global MY_CabinValve,MY_TreeGate,MY_Pilot
      if MY_CabinValve > 0 then
      repeat until the mouse is up
      subtract 1 from MY_CabinValve
      get (MY_CabinValve mod 6) + 1
      HTAddPict "CabinValve" & it, the rect of card button marker, "Srccopy"
      if the sound is "done" then play "SQ WheelLarge"
      if MY_CabinValve < 1 then
      soundstop
      if MY_Pilot is "lit" then
      htlock true
      HTChangePict bg fld "pict name","srccopy"
      HTAddPict "CabinPilot (on)",the rect of card button markerPilot,"srccopy"
      HTAddPict "CabinValve" & (MY_CabinValve mod 6) + 1,the rect of card button marker,"srccopy"
      htlock forceFalse
      end if
      play stop
      if there is a window "Cabinfire.moov" then
      hide window "Cabinfire.mooV"
      set the rate of window "CabinFire.MooV" to 0
      end if
      exit repeat
      end if
      if there is a window "CabinGauge.MooV" then send movieIdle to window "CabinGauge.MooV"
      if there is a window "Cabinfire.moov" then send movieIdle to window "Cabinfire.moov"
      if MY_Pilot is not "lit" then playQT "AR Gas MoV",,"loop",MY_CabinValve * 4,,,,,true
      end repeat
      put the seconds into item 2 of MY_TreeGate
      if there is a window "CabinGauge.MooV" then
      put furnaceTime(MY_CabinValve) into theRate
      if MY_Pilot is "lit" then -- added (1.0b8)
      if theRate ≤ 0 and cTime ≠ 0 then
      set the rate of window "CabinGauge.MooV" to theRate
      end if
      end if -- added (1.0b8)
      end if
      end if
      end mouseDown
    * Part 36943:9 "MarkerPilot"
      on mouseWithin
      global MY_Match, MY_Pilot,MY_CabinValve,theRate
      if MY_Match is a number then
      put 0 into MY_Match
      put "CabinPilot (on)" into WhichPict
      HTAddPict WhichPict,the rect of card button markerPilot,"srccopy"
      put "lit" into MY_Pilot
      if MY_CabinValve > 0 then
      --if there is not a window "CabinFire.moov" then playFire
      if there is a window "CabinFire.moov" then show window "CabinFire.moov"
      put "CabinFire (on)" into WhichPict
      HTAddPict WhichPict,the rect of card button markerFire,"srccopy"
      if there is a window "CabinFire.moov" then
      set the rate of window "Cabinfire.moov" to 1
      soundstop
      show window "Cabinfire.moov"
      end if
      soundstop
      end if
      end if
      end mouseWithin
    * Part 36943:11 ""
    * Part 36943:10 "markerGauge"
    * Part 36943:13 ""
  * Card 37341 "" (4 parts)

    on openCard
    playFire
    pass openCard
    end openCard
    
    on playFire
    global MY_Pilot,MY_CabinValve
    set cursor to none
    put "CabinFire.MooV" into TheMovieName
    if there is a window TheMovieName then
    if MY_Pilot is "lit" and MY_CabinValve > 0 then
    set the movie of window theMovieName to "CabinFireFar.MooV"
    --set the windowRect of window themovieName to the rect of card button markerFire
    set the audioLevel of window "CabinFire.moov" to "100"
    end if
    end if
    end playFire

    * Part 37341:1 "right"
      on mouseUp
      go to card id 36854
      end mouseUp
    * Part 37341:2 "left"
      on mouseUp
      go to card id 36854
      end mouseUp
    * Part 37341:3 ""
      on mouseUp
      global MY_CabinValve
      playQT "",,"loop",MY_CabinValve,,,,,true
      go to card id 37618
      end mouseUp
    * Part 37341:4 ""
      on mouseUp
      global MY_Match,my_cabindoor
      put empty into my_cabindoor
      if MY_Match is "New" then put "out" into my_match
      if MY_Match is a number then put 0 into MY_Match
      if there is a window "CabinFire.MooV" then send movieIdle to window "CabinFire.MooV"
      go to card id 21170
      if there is a window "CabinFire.MooV" then send movieIdle to window "CabinFire.MooV"
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      soundstop
      if there is a window "CabinFire.moov" then close window "CabinFire.moov"
      if there is a window "CabinGauge.MooV" then close window "CabinGauge.MooV"
      playQT "AR Howling&Birds Mov",,loop,100
      xmemory(1)
      end mouseUp
  * Card 37618 "" (11 parts)

    on opencard
    setSafe
    pass opencard
    end opencard
    
    on Roll which
    global MY_Safe
    put "CabinVaultDigits" into thePict
    soundIdle
    put the rect of card button (which) into theLoc
    put char 2 of which into digit
    put "0,0,12,14" into theClip
    play "SW PushButton In"
    get char digit of MY_Safe
    add 1 to it
    if it > 9 then get 0
    put it into char digit of MY_Safe
    put ((digit - 1) * 12) into item 1 of theClip
    put (it * 14) into item 2 of theClip
    put (11 + item 1 of theClip) into item 3 of theClip
    put (13 + item 2 of theClip) into item 4 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    if the mouseClick then
    click at the clickLoc
    else
    play stop
    play "SW PushButton Out"
    end if
    end Roll
    
    on setSafe
    global MY_Safe,pictAdd
    put "CabinVaultDigits" into thePict
    soundIdle
    repeat with digit = 1 to 3
    put the rect of card button ("d" & digit) into theLoc
    get char digit of MY_Safe
    put ((digit - 1) * 12) into item 1 of theClip
    put (it * 14) into item 2 of theClip
    put (11 + item 1 of theClip) into item 3 of theClip
    put (13 + item 2 of theClip) into item 4 of theClip
    put thePict & "|" & theLoc & "|" & theClip & return after PictAdd
    end repeat
    end setSafe

    * Part 37618:1 ""
      on mouseUp
      global MY_CabinValve
      playQT "",,"loop",MY_CabinValve * 2,,,,,true
      go to card id 37341
      end mouseUp
    * Part 37618:2 ""
    * Part 37618:14 "marker"
    * Part 37618:3 "handle"
    * Part 37618:5 "D1"
    * Part 37618:8 "safe1"
      on mouseDown
      Roll D1
      end mouseDown
    * Part 37618:9 "D2"
    * Part 37618:10 "D3"
    * Part 37618:11 "safe2"
      on mouseDown
      Roll D2
      end mouseDown
    * Part 37618:12 "safe3"
      on mouseDown
      Roll D3
      end mouseDown
    * Part 37618:15 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global MY_Safe
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      put "Cabin3-W SafeHandle" into thePict
      put the rect of card button handle into theLoc
      put "0,0,112,108" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button handle then exit repeat
      get (the mouseV - theStart) div 6
      if it < 0 then get 0
      if it > 5 then get 5
      put it * 112 into item 1 of theClip
      put it * 112 + 112 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it = 5 then
      if itsDown is not true then
      if the sound is "done" then play "MR FrplRotate Start"
      if MY_Safe is "724" then
      htvisual "wipe right",,,1,32
      dplay "DR steel open"
      go to card id 37940
      play stop
      hide card button match
      exit mouseDown
      end if
      put true into itsDown
      end if
      else
      put empty into itsDown
      end if
      soundidle
      if there is a window "CabinFire.MooV" then send movieIdle to window "CabinFire.MooV"
      end repeat
      deCurse "override",2003,"color","nodelay"
      put "0,0,112,108" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end mouseDown
      
      on Handle
      put "Cabin3-W SafeHandle.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      PreHandle
      end if
      set the rate of window TheMovieName to "3.0"
      show window TheMovieName
      send play to window theMovieName
      repeat until the rate of window theMovieName is 0
      send MovieIdle to window theMovieName
      end repeat
      play "DR SafeLatch"
      end Handle
  * Card 37752 "" (4 parts)
    * Part 37752:1 ""
    * Part 37752:2 "D1"
    * Part 37752:3 "D2"
    * Part 37752:4 "D3"
  * Card 37940 "" (9 parts)

    on opencard
    global MY_Match
    if MY_Match = "new" then show card button matchstrip
    else hide card button matchstrip
    hide card button match
    show card button "matchbox"
    pass opencard
    end opencard

    * Part 37940:5 "marker"
    * Part 37940:2 ""
      on mouseUp
      global MY_CabinValve
      htvisual "wipe left",,,1,32
      dplay "DR SafeClose"
      play "DR steel open"
      go to card id 37752
      dplay "DR SafeLatch"
      htvisual "wipe up",,,1,32
      go to card id 37618
      playQT "",,"loop",MY_CabinValve * 2,,,,,true
      vd
      go to card id 37341
      end mouseUp
    * Part 37940:3 ""
    * Part 37940:4 "matchbox"
      on mouseDown
      put "Cabin-MatchboxOpen" into WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      show card button match
      show card button matchstrip
      hide card button matchbox
      end mouseDown
    * Part 37940:6 "Match"
      on mouseUp
      global MY_Match
      if my_match is a number then opencard
      else
      
      put "new" into MY_Match
      end if
      end mouseUp
    * Part 37940:1 "none"
      on mouseUp
      htvisual "wipe left",,,1,32
      dplay "DR SafeClose"
      play "DR steel open"
      go to card id 37752
      dplay "DR SafeLatch"
      htvisual "wipe up",,,1,32
      go to card id 37618
      end mouseUp
    * Part 37940:8 "matchstrip"
      on mouseEnter
      global MY_Match
      if MY_Match = "new" then
      put (the Ticks + 3600) into MY_Match
      play stop
      play "FR MatchStrike"
      end if
      
      end mouseEnter
    * Part 37940:9 "left"
      on mouseUp
      global My_CabinValve
      go to card id 36854
      play "DR steel open"
      wait 30
      play stop
      play "DR SafeClose"
      play "DR SafeLatch"
      playQT "",,"loop",MY_CabinValve * 2,,,,,true
      end mouseUp
    * Part 37940:11 "right"
      on mouseUp
      global My_CabinValve
      go to card id 36854
      play "DR steel open"
      wait 30
      play stop
      play "DR SafeClose"
      play "DR SafeLatch"
      playQT "",,"loop",MY_CabinValve * 2,,,,,true
      end mouseUp
  * Card 35918 "" (18 parts)

    on GenUp
    global MY_GenVolts
    -- Gen Up
    if MY_GenVolts = 0 then
    if there is not a window "EL GenAll MoV" then playQT "EL GenAll MoV",,loop,150,"5,05","0","0","9,30",true
    else
    playQT "EL GenAll MoV",,Loop,150,,,,,true
    soundTime "5,05","0","0","9,30"
    end if
    else soundTime "14,41","9,30","9,30","23,40"
    -- Gen Run Up
    end GenUp
    
    on GenDown
    global MY_GenVolts,soundMooV
    -- Gen Up
    if MY_GenVolts = 0 then
    playQT "EL GenAll MoV",,noLoop,150,,,,,true
    set the closeOnFinish of window soundMooV to false
    soundTime ,"34,0","34,0","end"
    else soundTime "28,20","23,41","23,42","34,0"
    -- Gen Run Down
    end GenDown
    
    on setVoltage theVolts
    setVDigits theVolts
    setVMeter theVolts
    end setVoltage
    
    on setVDigits theVolts
    if theVolts ≥ 10 then
    put char 1 of theVolts into theV2
    put char 2 of theVolts into theV1
    else
    put 0 into theV2
    put theVolts into theV1
    end if
    
    put "GenDigit2" into thePict
    put "0,0,15,17" into theClip
    if there is a card button v2 then
    put the rect of card button v2 into theLoc
    put (theV2 * 15) into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    if there is a card button v1 then
    put the rect of card button v1 into theLoc
    put (theV1 * 15) into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    end SetVDigits
    
    on setVMeter theVolts
    get the loc of card button m1
    xCIcon3 it, (theVolts div 4) + 7000
    end setVMeter
    
    on setShipVolt theVolts
    setSDigits theVolts
    setSMeter theVolts
    end setShipVolt
    
    on setSDigits theVolts
    if theVolts ≥ 10 then
    put char 1 of theVolts into theV2
    put char 2 of theVolts into theV1
    else
    put 0 into theV2
    put theVolts into theV1
    end if
    put "GenDigit1" into thePict
    put "0,0,13,17" into theClip
    if there is a card button s2 then
    put the rect of card button s2 into theLoc
    put (theV2 * 13) into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    if there is a card button s1 then
    put the rect of card button s1 into theLoc
    put (theV1 * 13) into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    end setSDigits
    
    on setSMeter theVolts
    if there is a card button m2 then
    get the loc of card button m2
    xCIcon3 it, (theVolts div 4) + 8000
    end if
    end setSMeter
    
    on AddVolts theSwitch
    global MY_GenVolts
    put "10,7,8,16,5,1,2,22,19,9" into VoltList
    if theSwitch > 0 then add item theSwitch of VoltList to MY_GenVolts
    else subtract item (-theSwitch) of VoltList from MY_GenVolts
    end AddVolts
    
    on openCard
    global pictAdd,MY_GenVolts,MY_Generators,MY_GenBreaker
    HTChangePict bg fld "pict name","srccopy"
    soundIdle
    put 0 into MY_GenVolts
    repeat with x = 1 to 10
    if item x of MY_Generators is "1" then
    put "GenSwitch" & x into WhichPict
    put the rect of card button id (x + 2) into theLoc
    HTAddPict WhichPict,theLoc,"srccopy"
    soundIdle
    AddVolts x
    end if
    end repeat
    setVDigits MY_GenVolts
    if MY_GenBreaker ≠ 0 then setSDigits 0
    else setSDigits MY_GenVolts
    soundIdle
    htlock forcefalse
    setVMeter MY_GenVolts
    if MY_GenBreaker ≠ 0 then setSMeter 0
    else setSMeter MY_GenVolts
    end openCard
    
    on switch
    global  MY_GenVolts,MY_Generators,MY_recur
    if MY_recur < 10 then
    Add 1 to MY_recur
    put MY_GenVolts into oldVolts
    put the id of the target into myID
    if item (myId - 2) of MY_Generators is "1" then
    put "GenSwitchOff" & (myId - 2) into WhichPict
    HTAddPict WhichPict, the rect of the target, "Srccopy"
    put "0" into item (myId - 2) of MY_Generators
    play stop
    play "SW PushButton In"
    addVolts -(myId - 2)
    GenDown
    else
    put "GenSwitch" & (myId - 2) into WhichPict
    HTAddPict WhichPict, the rect of the target, "Srccopy"
    put "1" into item (myId - 2) of MY_Generators
    play stop
    play "SW PushButton In"
    GenUp
    addVolts (myId - 2)
    end if
    changePower oldVolts, MY_GenVolts
    subtract 1 from MY_recur
    --if MY_recur ≠ 0 then put 0 into MY_recur
    wait 0
    else
    set cursor to none
    setVoltage MY_GenVolts -- added (1.0b8)
    end if
    end switch
    
    on changePower oldVolts, newVolts
    global MY_GenBreaker,MY_GenVolts
    repeat while oldVolts ≠ newVolts
    soundIdle
    if oldVolts > newVolts then subtract 1 from oldVolts
    else add 1 to oldVolts
    setVoltage oldVolts
    if the mouseclick then
    if MY_GenVolts > 59 then put Random(2) into MY_GenBreaker
    if MY_GenBreaker ≠ 0 then setShipVolt 0
    else setShipVolt MY_GenVolts
    click at the clickLoc
    exit repeat
    end if
    end repeat
    if MY_GenVolts > 59 then put Random(2) into MY_GenBreaker
    if MY_GenBreaker ≠ 0 then setShipVolt 0
    else setShipVolt MY_GenVolts
    end changePower

    * Part 35918:1 "right"
      on mouseUp
      htlock true
      go to card id 36329
      end mouseUp
    * Part 35918:2 "left"
      on mouseUp
      htlock true
      go to card id 36329
      end mouseUp
    * Part 35918:3 "5001,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:4 "5002,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:5 "5003,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:6 "5004,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:7 "5005,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:11 "5009,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:12 "5010,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:13 "v2"
    * Part 35918:14 "v1"
    * Part 35918:15 "s2"
    * Part 35918:16 "s1"
    * Part 35918:18 "m1"
    * Part 35918:19 "m2"
    * Part 35918:8 "5006,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:9 "5007,off"
      on mouseDown
      switch
      end mouseDown
    * Part 35918:10 "5008,off"
      on mouseDown
      switch
      end mouseDown
  * Card 36329 "" (4 parts)

    on idle
    global MY_GenVolts
    if the sound is "done" and MY_GenVolts > 0 then play "El GenRun"
    end idle

    * Part 36329:1 ""
      on mouseUp
      global playsounds
      go to card id 34888
      play stop
      if playsounds is "false" then soundstop
      playQT "MU Generator Stairs MoV",,loop,75
      play "DR GenRoom Down"
      end mouseUp
    * Part 36329:2 "right"
      on mouseUp
      go to card id 35918
      end mouseUp
    * Part 36329:3 "left"
      on mouseUp
      go to card id 35918
      end mouseUp
    * Part 36329:4 ""
      on mouseUp
      go to card id 43331
      end mouseUp
  * Card 43331 "" (1 parts)

    on idle
    global MY_GenVolts
    if the sound is "done" and MY_GenVolts > 0 then play "El GenRun"
    end idle

    * Part 43331:1 ""
      on mouseUp
      go to card id 36329
      end mouseUp
  * Card 8336 "dock" (11 parts)

    on openCard
    global pictAdd,MY_DocMarker,MY_Boat,MY_GearGate,BirdStartTime
    playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
    put the ticks + 80 into BirdStartTime
    if MY_Boat is "up" then
    show card button boat
    else
    hide card button boat
    end if
    if the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    if MY_DocMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button DocMarker & return after pictAdd
    end if
    if MY_GearGate is "open" then
    put field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker & return after pictAdd
    end if
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up" and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard
    
    on idle
    global MY_Boat,BirdStartTime
    if MY_Boat is "down" then
    if the ticks > BirdStartTime then
    put random(4) into which
    if which < 4 then
    if there is a window "BirdsMoov" then
    hide window "BirdsMoov"
    htlock forcefalse
    end if
    soundidle
    birds which
    soundidle
    if there is a window "BirdsMoov" then
    show window "BirdsMoov"
    set the rate of window "BirdsMoov" to "1.0"
    end if
    end if
    put the ticks + (random(1000) + 800) into BirdStartTime
    end if
    end if
    pass idle
    end idle
    
    on closecard
    htlock true
    if there is a window "BirdsMoov" then close window "birdsMoov"
    pass closecard
    end closecard
    
    on Birds x
    do ( "put " & quote & "Birds" & x & ".MooV" & quote & " into theMovieName")
    if there is not a window "BirdsMoov" then
    Movie theMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    if there is a window theMovieName then
    set the TimeFormat of window theMovieName to "MovieTime"
    set the dontErase of window theMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window theMovieName to "256"
    set the mute of window theMovieName to true
    set the badge of window theMovieName to false
    set the controllerVisible of window theMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window theMovieName to false
    set the loop of window theMovieName to false
    set the seeAllFrames of window theMovieName to false
    set the startTime of window theMovieName to "0"
    --set the endTime of window theMovieName to "2,240"
    --set the callBackMsg of window MtheMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the windowName of window theMovieName to "BirdsMooV"
    end if
    else
    set the movie of window "BirdsMoov" to theMovieName
    end if
    end Birds

    * Part 8336:4 "boatMarker"
    * Part 8336:6 "gearMarker"
    * Part 8336:3 "DocMarker"
      --on mouseDown
      global MY_DocMarker
      put field "pict name" into WhichPict
      if MY_DocMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_DocMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_DocMarker
      end if
      go this card
      end mouseDown
    * Part 8336:1 ""
      on mouseUp
      go to card id 2737
      end mouseUp
    * Part 8336:2 "right"
      on mouseUp
      go to card id 2838
      end mouseUp
    * Part 8336:5 "boat"
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      go to card id 59122
      end mouseUp
    * Part 8336:7 "left"
      on mouseUp
      go to card id 77365
      end mouseUp
    * Part 8336:8 "tester"
      on mouseUp
      put 0 into chksum
      repeat with x = 1 to 300
      put numtochar(random(125)) after TheList
      end repeat
      put the ticks into starttime
      repeat with x = 1 to the length of theList
      add (chartonum(char x of theList)) to chksum
      end repeat
      put the ticks - starttime
      wait 5
      put chksum
      end mouseUp
    * Part 8336:9 "qpla2"
      on mouseUp
      go to card id 2737
      end mouseUp
    * Part 8336:10 "qgea"
      on mouseUp
      go card
      end mouseUp
    * Part 8336:14 "moovMarker"
  * Card 2838 "qdoc2" (6 parts)

    on openCard
    global MY_Boat,BirdStartTime
    put the ticks + 320 into BirdStartTime
    if MY_Boat is "up" then
    show card button boat
    show card button boat2
    set the loc of card button "moovmarker" to 482,24
    else
    hide card button boat
    hide card button boat2
    end if
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    playQT "BR Seagulls/Water Slosh Mx MoV",,"loop","180"
    pass openCard
    end openCard
    
    on idle
    global MY_Boat,BirdStartTime
    if the ticks > BirdStartTime then
    put random(4) into which
    if which < 4 then
    if there is a window "BirdsMoov" then
    hide window "BirdsMoov"
    if MY_Boat is "up" then
    set the loc of card button "moovmarker" to 482,24
    set the windowRect of window "BirdsMoov" to the rect of card button "moovmarker"
    else
    put (random(288) + 194) into x
    set the loc of card button "moovmarker" to x,24
    set the windowRect of window "BirdsMoov" to the rect of card button "moovmarker"
    end if
    htlock forcefalse
    end if
    soundidle
    birds which
    soundidle
    if there is a window "BirdsMoov" then
    set the rate of window "BirdsMoov" to "1.0"
    show window "BirdsMoov"
    end if
    end if
    put the ticks + (random(1000) + 900) into BirdStartTime
    end if
    pass idle
    end idle
    
    on closecard
    htlock true
    if there is a window "BirdsMoov" then close window "birdsMoov"
    pass closecard
    end closecard
    
    on Birds x
    do ( "put " & quote & "Birds" & x & ".MooV" & quote & " into theMovieName")
    if there is not a window "BirdsMoov" then
    Movie theMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    if there is a window theMovieName then
    set the TimeFormat of window theMovieName to "MovieTime"
    set the dontErase of window theMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window theMovieName to "256"
    set the mute of window theMovieName to true
    set the badge of window theMovieName to false
    set the controllerVisible of window theMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window theMovieName to false
    set the loop of window theMovieName to false
    set the seeAllFrames of window theMovieName to false
    set the startTime of window theMovieName to "0"
    --set the endTime of window theMovieName to "2,240"
    --set the callBackMsg of window MtheMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the windowName of window theMovieName to "BirdsMooV"
    end if
    else
    set the movie of window "BirdsMoov" to theMovieName
    end if
    end Birds

    * Part 2838:3 "boatMarker"
    * Part 2838:1 "left"
      on mouseUp
      htlock true
      go to card id 8336
      end mouseUp
    * Part 2838:2 "right"
      on mouseUp
      htlock true
      go to card id 4734
      end mouseUp
    * Part 2838:4 "boat"
      on mouseUp
      go to card id 57582
      end mouseUp
    * Part 2838:5 "boat2"
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      go to card id 59122
      end mouseUp
    * Part 2838:6 "moovMarker"
  * Card 4734 "" (2 parts)
    * Part 4734:1 "left"
      on mouseUp
      go to card id 2838
      end mouseUp
    * Part 4734:2 "right"
      on mouseUp
      go to card id 77365
      end mouseUp
  * Card 77365 "" (6 parts)

    on openCard
    global dockDoor
    put empty into dockDoor
    pass openCard
    end openCard

    * Part 77365:7 "door"
      on mouseUp
      
      end mouseUp
    * Part 77365:3 "left"
      on mouseUp
      global dockDoor
      if dockDoor is "open" then
      htlock true
      htvisual "scroll left",,the rect of card button doorMarker,1,4
      htchangePict "dock1-n","srccopy"
      play "DR grayroom down"
      htlock forcefalse
      put empty into DockDoor
      end if
      go to card id 4734
      end mouseUp
    * Part 77365:4 "right"
      on mouseUp
      global dockDoor
      if dockDoor is "open" then
      htlock true
      htvisual "scroll left",,the rect of card button doorMarker,1,4
      htchangePict "dock1-n","srccopy"
      play "DR grayroom down"
      htlock forcefalse
      put empty into DockDoor
      end if
      go to card id 8336
      end mouseUp
    * Part 77365:5 "qste"
      on mouseUp
      go card
      end mouseUp
    * Part 77365:8 "doorMarker"
    * Part 77365:6 ""
      on mouseUp
      global dockDoor,MY_VaultDI,MY_VaultMooV,MY_VaultNum,MY_VaultErase
      if MY_VaultNum is 40 then get "Mountain"
      else if MY_VaultNum is 47 then get "MarkerSwitch"
      else if MY_VaultNum is 67 then get "Water"
      else if MY_VaultNum is 08 then get "Atrus"
      else get "Blank"
      if MY_VaultNum is in MY_VaultErase then get "Blank"
      put it into MY_VaultMooV
      if dockDoor is not "open" then
      htlock true
      htvisual "scroll away right",,the rect of card button doorMarker,1,4
      htaddpict "dock1-n open",the rect of card button door,"srccopy"
      play "DR grayroom down"
      htlock forcefalse
      put "open" into DockDoor
      else
      go to card id 5234
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,60
      end if
      end mouseUp
  * Card 5234 "" (5 parts)

    on mouseDownInMovie
    click at the clickLoc
    end mouseDownInMovie
    
    on openCard
    global MY_VaultMooV,MY_VaultDI,MY_Water
    put "Vault 1-In" into field "pict name"
    Water
    if MY_VaultDI is "on" then put " " & MY_VaultMooV after field "pict name"
    if MY_VaultMooV is "water" then
    if MY_VaultDI is "on" then put "Vault 1 Water.MooV" into MY_Water
    end if
    pass openCard
    end opencard
    
    on Water
    put "Vault Water.MooV" into theMovieName
    if there is not a window "WaterMooV" then
    Movie TheMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    if there is a window TheMovieName then
    set the TimeFormat of window theMovieName to "MovieTime"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "256"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1.0"
    set the windowName of window TheMovieName to "WaterMooV"
    end if
    end if
    end Water

    * Part 5234:4 "mooVMarker"
    * Part 5234:1 ""
      on mouseUp
      go to card id 25094
      playQT "MU VaultSound Mov",,loop,40
      end mouseUp
    * Part 5234:2 "right"
      on mouseUp
      go to card id 89364
      end mouseUp
    * Part 5234:3 "left"
      on mouseUp
      go to card id 89364
      end mouseUp
    * Part 5234:6 "qvau"
      on mouseUp
      go to card id 25094
      playQT "MU VaultSound Mov",,loop,40
      end mouseUp
  * Card 25094 "" (5 parts)

    on mouseDownInMovie
    click at the clickLoc
    end mouseDownInMovie
    
    on openCard
    global MY_VaultMooV,MY_VaultDI,MY_Water
    put "Vault 2-In" into field "pict name"
    if MY_VaultDI is "on" then put " " & MY_VaultMooV after field "pict name"
    if MY_VaultMooV is "water" and MY_VaultDI is "on" then put "Vault 2 Water.MooV" into MY_Water
    pass openCard
    end opencard

    * Part 25094:4 "mooVMarker"
    * Part 25094:1 ""
      on mouseUp
      go to card id 79408
      playQT "MU VaultSound Mov",,loop,70
      end mouseUp
    * Part 25094:2 "right"
      on mouseUp
      go to card id 89294
      end mouseUp
    * Part 25094:3 "left"
      on mouseUp
      go to card id 89294
      end mouseUp
    * Part 25094:5 "qvau"
      on mouseUp
      go to card id 79408
      playQT "MU VaultSound Mov",,loop,70
      end mouseUp
  * Card 79408 "" (5 parts)

    on mouseDownInMovie
    click at the clickLoc
    end mouseDownInMovie
    
    on openCard
    global MY_VaultMooV,MY_VaultDI,MY_Water
    put "Vault 3-In" into field "pict name"
    if MY_VaultDI is "on" then put " " & MY_VaultMooV after field "pict name"
    if MY_VaultMooV is "water" and MY_VaultDI is "on" then put "Vault 3 Water.MooV" into MY_Water
    pass openCard
    end opencard

    * Part 79408:4 "moovMarker"
    * Part 79408:1 ""
      on mouseUp
      go to card id 86000
      playQT "MU VaultSound Mov",,loop,110
      end mouseUp
    * Part 79408:2 "right"
      on mouseUp
      go to card id 88832
      end mouseUp
    * Part 79408:3 "left"
      on mouseUp
      go to card id 88832
      end mouseUp
    * Part 79408:5 "qvau"
      on mouseUp
      go to card id 86000
      playQT "MU VaultSound Mov",,loop,110
      end mouseUp
  * Card 86000 "" (5 parts)

    on mouseDownInMovie
    click at the clickLoc
    end mouseDownInMovie
    
    on openCard
    global MY_VaultMooV,MY_VaultDI,MY_Water
    put "Vault 4-In" into field "pict name"
    if MY_VaultDI is "on" then put " " & MY_VaultMooV after field "pict name"
    if MY_VaultMooV is "water" and MY_VaultDI is "on" then put "Vault 4 Water.MooV" into MY_Water
    pass openCard
    end opencard

    * Part 86000:4 "moovMarker"
    * Part 86000:1 ""
      on mouseUp
      go to card id 86355
      playQT "MU VaultSound Mov",,loop,150
      end mouseUp
    * Part 86000:2 "right"
      on mouseUp
      go to card id 88671
      end mouseUp
    * Part 86000:3 "left"
      on mouseUp
      go to card id 88671
      end mouseUp
    * Part 86000:5 "qvau"
      on mouseUp
      go to card id 86355
      playQT "MU VaultSound Mov",,loop,150
      end mouseUp
  * Card 86355 "" (4 parts)

    on mouseDownInMovie
    click at the clickLoc
    end mouseDownInMovie
    
    on openCard
    global MY_VaultMooV,MY_VaultDI,MY_Water
    put "Vault 5-In" into field "pict name"
    if MY_VaultDI is "on" then put " " & MY_VaultMooV after field "pict name"
    if MY_VaultMooV is "water" and MY_VaultDI is "on" then put "Vault 5 Water.MooV" into MY_Water
    pass openCard
    end opencard

    * Part 86355:5 "moovMarker"
    * Part 86355:1 ""
      on mouseUp
      hc
      fadeout pause
      go to card id 86826
      end mouseUp
    * Part 86355:2 "right"
      on mouseUp
      go to card id 89742
      end mouseUp
    * Part 86355:3 "left"
      on mouseUp
      go to card id 90296
      end mouseUp
  * Card 89742 "" (5 parts)
    * Part 89742:1 "right"
      on mouseUp
      go to card id 88832
      end mouseUp
    * Part 89742:2 "right"
      on mouseUp
      go to card id 88832
      end mouseUp
    * Part 89742:3 "left"
      on mouseUp
      go to card id 86355
      end mouseUp
    * Part 89742:4 "right"
      on mouseUp
      go to card id 88345
      end mouseUp
    * Part 89742:5 ""
      on mouseUp
      go to card id 90595
      end mouseUp
  * Card 90101 "" (3 parts)
    * Part 90101:1 ""
      on mouseUp
      go to card id 90595
      end mouseUp
    * Part 90101:2 ""
    * Part 90101:3 "none"
      on mouseUp
      vd
      go to card id 90595
      htlock true
      HTVisual "tdfBlend2",,the rect of card button marker,2
      htaddpict "vault controlpanel (sunk)",the rect of card button marker,"srccopy"
      play "sw spaceship lever"
      htlock forcefalse
      htvisual "scroll away up",,the rect of card button panel,1,4
      go to card id 90877
      play stop
      end mouseUp
  * Card 90595 "" (6 parts)
    * Part 90595:5 "marker"
    * Part 90595:1 ""
      on mouseUp
      go to card id 88671
      end mouseUp
    * Part 90595:2 "left"
      on mouseUp
      go to card id 89742
      end mouseUp
    * Part 90595:3 "panel"
      on mouseUp
      go to card id 90101
      end mouseUp
    * Part 90595:4 "none"
      on mouseUp
      htlock true
      HTVisual "tdfBlend2",,the rect of card button marker,2
      htaddpict "vault controlpanel (sunk)",the rect of card button marker,"srccopy"
      play "sw spaceship lever"
      htlock forcefalse
      htvisual "scroll away up",,the rect of card button panel,1,4
      go to card id 90877
      play stop
      end mouseUp
    * Part 90595:6 "right"
      on mouseUp
      go to card id 90296
      end mouseUp
  * Card 90877 "" (13 parts)

    on openCard
    global MY_VaultNum
    HTChangePict bg fld "pict name","srccopy"
    repeat with which = 1 to 2
    put "VaultDigit" & which into thePict
    put the rect of card button ("digit" & which) into theLoc
    put "0,0,23,35" into theClip
    get char which of MY_VaultNum
    put ((it + 9) mod 10) * 23 into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end repeat
    play stop
    play "MR Mech Bsmt Stairs"
    htlock forcefalse
    end openCard
    
    on closeCard
    global MY_VaultMooV,MY_VaultDI,MY_VaultNum,MY_VaultErase
    if MY_VaultNum is 40 then get "Mountain"
    else if MY_VaultNum is 47 then get "MarkerSwitch"
    else if MY_VaultNum is 67 then get "Water"
    else if MY_VaultNum is 08 then get "Atrus"
    else get "Blank"
    if MY_VaultNum is in MY_VaultErase then get "Blank"
    if MY_VaultMooV ≠ it then
    put it into MY_VaultMooV
    put "off" into MY_VaultDI
    end if
    end closeCard
    
    on Button Which, what
    global MY_VaultNum
    put "Vault controlpanel (down)" into thePict
    put the topleft of card button down into theDown
    get the rect of the target
    subtract item 1 of theDown from item 1 of it
    subtract item 2 of theDown from item 2 of it
    subtract item 1 of theDown from item 3 of it
    subtract item 2 of theDown from item 4 of it
    HTSavePict the rect of the target,"clipboard","srccopy","backdrop"
    HTAddPict thePict,the rect of the target,"srccopy","srcRect",it
    
    soundIdle
    put "VaultDigit" & which into thePict
    put the rect of card button ("digit" & which) into theLoc
    put "0,0,23,35" into theClip
    play "SW PushButton In"
    get char which of MY_VaultNum
    get min(9,max(0,what + char which of MY_VaultNum))
    put it into char which of MY_VaultNum
    put round(((it + 9) mod 10) * 23) into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    get the ticks
    repeat until the ticks > it + 10
    if the mouse is up then exit repeat
    soundIdle
    end repeat
    repeat while the mouse is down and the mouseloc is within the rect of the target
    get char which of MY_VaultNum
    get min(9,max(0,what + char which of MY_VaultNum))
    if it ≠ char which of MY_VaultNum then
    play "SW PushButton In"
    put it into char which of MY_VaultNum
    put round(((it + 9) mod 10) * 23) into item 1 of theClip
    end if
    soundIdle
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end repeat
    HTAddPict "",the rect of the target,"srccopy","clipboard"
    play "SW PushButton Out"
    end Button

    * Part 90877:18 "Down"
    * Part 90877:5 "marker"
    * Part 90877:1 "none"
      on mouseUp
      htlock true
      go to card id 90877
      htlock forcefalse
      htlock true
      htvisual "scroll down",,the rect of card button panel,1,4
      htaddpict "vault controlpanel (sunk)",the rect of card button marker,"srccopy"
      play "MR Mech Bsmt Stairs" e4
      htlock forcefalse
      play stop
      dplay "sw spaceship lever"
      HTVisual "tdfBlend2",,the rect of card button marker,3
      go to card id 90595
      vs right
      go to card id 89742
      end mouseUp
      
      on mouseWithin
      global ALL_Cursor
      if ALL_Cursor is not "left" then deCurse "override","left","color","nodelay"
      end mouseWithin
    * Part 90877:3 "none"
      on mouseUp
      htlock true
      go to card id 90877
      htlock forcefalse
      htlock true
      htvisual "scroll down",,the rect of card button panel,1,4
      htaddpict "vault controlpanel (sunk)",the rect of card button marker,"srccopy"
      play "MR Mech Bsmt Stairs" e4
      htlock forcefalse
      play stop
      dplay "sw spaceship lever"
      HTVisual "tdfBlend2",,the rect of card button marker,3
      go to card id 90595
      vd
      go to card id 88671
      end mouseUp
    * Part 90877:4 "panel"
      on mouseUp
      
      end mouseUp
    * Part 90877:11 ""
      on mousedown
      button 2,1
      end mousedown
    * Part 90877:12 ""
      on mousedown
      button 2,-1
      end mousedown
    * Part 90877:13 ""
      on mousedown
      button 1,1
      end mousedown
    * Part 90877:14 ""
      on mousedown
      button 1,-1
      end mousedown
    * Part 90877:16 "digit2"
    * Part 90877:17 "digit1"
    * Part 90877:15 "none"
    * Part 90877:19 ""
      on mouseDown
      global MY_VaultNum,MY_VaultErase
      put "Vault controlpanel (down)" into thePict
      put the topleft of card button down into theDown
      get "58,50,75,65"
      HTSavePict the rect of the target,"clipboard","srccopy","backdrop"
      play "SW PushButton In"
      HTAddPict thePict,the rect of the target,"srccopy","srcRect",it
      repeat while the mouse is down
      soundidle
      end repeat
      repeat with x = 1 to 10
      if the mouse is down then
      if the mouseLoc is within the rect of me then
      if x > 6 then
      play "BP ShortElec" c3t d3t f#3t b2t c#3t
      repeat until the sound is "done"
      soundidle
      end repeat
      HTAddPict "",the rect of the target,"srccopy","clipboard"
      play "SW PushButton Out"
      if (space & MY_VaultNum & space) is in " 40 47 67 08 " then
      if MY_VaultNum is not in MY_VaultErase then
      put " " & MY_VaultNum after MY_VaultErase
      end if
      end if
      exit mouseDown
      else
      play "SW Buzzer" e3
      HTAddPict "",the rect of the target,"srccopy","clipboard"
      ww
      exit mouseDown
      end if
      else
      HTAddPict "",the rect of the target,"srccopy","clipboard"
      play "SW PushButton Out"
      click at the clickLoc
      exit mouseDown
      end if
      end if
      soundIdle
      HTAddPict "",the rect of the target,"srccopy","clipboard"
      play stop
      if x ≤ 6 then play "BP ShortElec" tempo 300 c3
      else play "BP ShortElec" tempo 500 c4
      HTAddPict thePict,the rect of the target,"srccopy","srcRect",it
      wait 1
      end repeat
      play "SW Buzzer" e3
      HTAddPict "",the rect of the target,"srccopy","clipboard"
      closeDoor
      ww
      end mouseDown
      
      on closeDoor
      htlock true
      go to card id 90877
      htlock forcefalse
      htlock true
      htvisual "scroll down",,the rect of card button panel,1,4
      htaddpict "vault controlpanel (sunk)",the rect of card button marker,"srccopy"
      play "MR Mech Bsmt Stairs" e4
      htlock forcefalse
      play stop
      play "EL Servo Motor End"
      dplay "sw spaceship lever"
      HTVisual "tdfBlend2",,the rect of card button marker,3
      go to card id 90595
      --play stop
      end closeDoor
  * Card 86826 "qvau" (7 parts)

    on openCard
    global MY_VaultMooV,MY_VaultDI,MY_Water
    put "Vault 6-In" into field "pict name"
    if MY_VaultDI is "on" then put " " & MY_VaultMooV after field "pict name"
    if MY_VaultMooV is "water" and MY_VaultDI is "on" then
    put "Vault Water.MooV" into MY_Water
    else
    if MY_VaultMooV is "markerSwitch" then put the rect of card button "MarkerMarkerSwitch" into theRect
    else if MY_VaultMooV is "mountain" then put the rect of card button "MarkerMountain" into theRect
    else put the rect of card button MoovMarker into theRect
    put "Vault " & MY_VaultMooV & ".MooV" into TheMovieName
    switchMooV theMovieName,theRect
    end if
    if there is a window "MU VaultSound Mov" then
    fadeout pause
    else
    fadeout
    end if
    
    pass openCard
    end opencard
    
    on switchMooV theMooV,theRect
    if there is a window "WaterMoov" then
    set the windowRect of window "WaterMoov" to theRect
    set the movie of window "WaterMoov" to theMooV
    end if
    end switchMooV
    
    on loadmoov
    global MY_VaultMooV
    put "Vault " & MY_VaultMooV & ".MooV" into TheMovieName
    if there is not a window TheMovieName then
    soundidle
    set cursor to none
    get topleft of card button ("marker" & MY_VaultMooV)
    Movie TheMovieName,"borderless",it,"invisible","Floating"
    soundidle
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the timeFormat of window theMovieName to movieTime
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    set the passMovieClick of window theMovieName to false
    set the rate of window theMovieName to "0.0"
    end if
    end loadmoov

    * Part 86826:10 "mooVMarker"
    * Part 86826:1 "right"
      on mouseUp
      htlock true
      go to card id 87276
      if there is a window "MU VaultSound Mov" then
      set the rate of window "MU VaultSound Mov" to 1
      fadein "MU VaultSound Mov",150
      else
      playQT "MU VaultSound Mov",fadein,loop,150
      end if
      end mouseUp
    * Part 86826:2 "left"
      on mouseUp
      htlock true
      go to card id 87971
      if there is a window "MU VaultSound Mov" then
      set the rate of window "MU VaultSound Mov" to 1
      fadein "MU VaultSound Mov",150
      else
      playQT "MU VaultSound Mov",fadein,loop,150
      end if
      end mouseUp
    * Part 86826:3 "marker1"
    * Part 86826:4 "none"
      on mousedown
      global MY_VaultMooV,MY_VaultDI
      put "Vault " & MY_VaultMooV & ".MooV" into TheMovieName
      if MY_VaultMooV is "Mountain" then get 11180
      else if MY_VaultMooV is "Water" then get 4350
      else if MY_VaultMooV is "Atrus" then get 39080
      else if MY_VaultMooV is "MarkerSwitch" then get 9500
      else if MY_VaultMooV is "Blank" then get 2644
      htlock true
      WaterIdle
      htaddpict "Vault 6-In (ButtonIn)",the rect of card button marker1,"srccopy"
      WaterIdle
      play "SW Pushbutton in"
      htlock forcefalse
      WaterIdle
      set the loop of window "WaterMooV" to false
      if MY_VaultDI is "off" then
      play "EL CRT On"
      WaterIdle
      if there is a window "WaterMooV" then
      if MY_VaultMooV is "Atrus" then set the mute of window "WaterMooV" to false
      else set the mute of window "WaterMooV" to true
      set the startTime of window "WaterMooV" to 0
      set the currTime of window "WaterMooV" to 0
      set the endTime of window "WaterMooV" to it
      show window "WaterMooV"
      send play to window "WaterMooV"
      if MY_VaultMooV is "Water" then
      set the loop of window "WaterMooV" to true
      repeat until the currTime of window "WaterMooV" ≥ 1932
      WaterIdle
      end repeat
      set the startTime of window WaterMooV to 1932
      set the endTime of window WaterMooV to 4300
      end if
      WaterIdle
      end if
      if MY_VaultMooV is "Atrus" or MY_VaultMooV is "Blank" or MY_VaultMooV is "MarkerSwitch" then put "off" into MY_VaultDI
      else put "on" into MY_VaultDI
      else
      if there is a window "WaterMooV" then
      if MY_VaultMooV is "Water" then
      set the endTime of window "WaterMooV" to the duration of window "WaterMooV"
      set the loop of window "WaterMooV" to false
      else
      set the endTime of window "WaterMooV" to the duration of window "WaterMooV"
      set the startTime of window "WaterMooV" to it
      set the currTime of window "WaterMooV" to it
      show window "WaterMooV"
      send play to window "WaterMooV"
      WaterIdle
      end if
      end if
      put "off" into MY_VaultDI
      play "EL CRT Off"
      WaterIdle
      end if
      get "Vault 6-In"
      if MY_VaultDI is "on" then get it & " " & MY_VaultMooV
      WaterIdle
      HTChangePict it,"srccopy"
      end mousedown
    * Part 86826:5 "markerMountain"
    * Part 86826:6 "markerMarkerSwitch"
  * Card 87971 "" (2 parts)
    * Part 87971:1 "right"
      on mouseUp
      go to card id 86826
      end mouseUp
    * Part 87971:2 "left"
      on mouseUp
      go to card id 88101
      end mouseUp
  * Card 87276 "" (2 parts)
    * Part 87276:1 "left"
      on mouseUp
      go to card id 86826
      end mouseUp
    * Part 87276:2 "right"
      on mouseUp
      go to card id 88101
      end mouseUp
  * Card 88101 "" (5 parts)
    * Part 88101:1 "left"
      on mouseUp
      go to card id 87276
      end mouseUp
    * Part 88101:2 ""
      on mouseUp
      go to card id 88345
      playQT "MU VaultSound Mov",,loop,150
      end mouseUp
    * Part 88101:3 ""
      on mouseUp
      go to card id 90595
      playQT "MU VaultSound Mov",,loop,150
      end mouseUp
    * Part 88101:4 "right"
      on mouseUp
      go to card id 87971
      end mouseUp
    * Part 88101:5 "qdoc2"
      on mouseUp
      global All_cursor
      if All_cursor is 1002 then
      dplay "DR grayroom down"
      end if
      go to card id 88345
      end mouseUp
  * Card 88345 "" (5 parts)
    * Part 88345:1 ""
      on mouseUp
      go to card id 88671
      playQT "MU VaultSound Mov",,loop,110
      end mouseUp
    * Part 88345:2 "left"
      on mouseUp
      go to card id 89742
      end mouseUp
    * Part 88345:3 "right"
      on mouseUp
      go to card id 90296
      end mouseUp
    * Part 88345:4 ""
      on mouseUp
      go to card id 90595
      end mouseUp
    * Part 88345:5 "qdoc2"
      on mouseUp
      global All_Cursor
      if All_Cursor is 1002 then
      dplay "DR grayroom down"
      end if
      go to card id 88671
      playQT "MU VaultSound Mov",,loop,110
      end mouseUp
  * Card 90296 "" (2 parts)
    * Part 90296:1 "left"
      on mouseUp
      go to card id 88345
      end mouseUp
    * Part 90296:2 "right"
      on mouseUp
      go to card id 86355
      end mouseUp
  * Card 88671 "" (4 parts)
    * Part 88671:1 ""
      on mouseUp
      go to card id 88832
      playQT "MU VaultSound Mov",,loop,70
      end mouseUp
    * Part 88671:2 "right"
      on mouseUp
      go to card id 86000
      end mouseUp
    * Part 88671:3 "left"
      on mouseUp
      go to card id 86000
      end mouseUp
    * Part 88671:4 "qdoc2"
      on mouseUp
      global All_Cursor
      if All_Cursor is 1002 then
      dplay "DR grayroom down"
      end if
      go to card id 88832
      playQT "MU VaultSound Mov",,loop,70
      end mouseUp
  * Card 88832 "" (4 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" then put "Vault 3-Out boatUp" into field "pict name"
    else put "Vault 3-Out" into field "pict name"
    pass openCard
    end opencard

    * Part 88832:1 ""
      on mouseUp
      go to card id 89294
      playQT "MU VaultSound Mov",,loop,40
      end mouseUp
    * Part 88832:2 "right"
      on mouseUp
      go to card id 79408
      end mouseUp
    * Part 88832:3 "left"
      on mouseUp
      go to card id 79408
      end mouseUp
    * Part 88832:4 "qdoc2"
      on mouseUp
      global All_Cursor
      if All_Cursor is 1002 then
      dplay "DR grayroom down"
      end if
      go to card id 89294
      playQT "MU VaultSound Mov",,loop,40
      end mouseUp
  * Card 89294 "" (4 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" then put "Vault 2-Out boatUp" into field "pict name"
    else put "Vault 2-Out" into field "pict name"
    pass openCard
    end opencard

    * Part 89294:1 ""
      on mouseUp
      go to card id 89364
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,50
      end mouseUp
    * Part 89294:2 "left"
      on mouseUp
      go to card id 25094
      end mouseUp
    * Part 89294:3 "right"
      on mouseUp
      go to card id 25094
      end mouseUp
    * Part 89294:4 "qdoc2"
      on mouseUp
      global All_Cursor
      if All_Cursor is 1002 then
      dplay "DR grayroom down"
      end if
      go to card id 89364
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,50
      end mouseUp
  * Card 89364 "" (3 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" then put "Vault 1-Out boatUp" into field "pict name"
    else put "Vault 1-Out" into field "pict name"
    pass openCard
    end opencard

    * Part 89364:1 "right"
      on mouseUp
      go to card id 5234
      end mouseUp
    * Part 89364:2 "left"
      on mouseUp
      go to card id 5234
      end mouseUp
    * Part 89364:3 ""
      on mouseUp
      go to card id 2838
      play "DR grayroom down"
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      if there is a window "waterMoov" then close window "watermoov"
      end mouseUp
  * Card 2737 "qdoc3" (8 parts)

    on openCard
    global pictAdd,MY_DocMarker,MY_GearGate,vault,ALL_Page,DU_End
    if vault is empty then put "closed" into vault
    if vault is "open" then
    if DU_End is "win" or ALL_Page is "Atrus" then
    put field "pict name" & " Ped/Open/Empty|" & the rect ¬
    of card button Marker2 & return into pictAdd
    else
    put field "pict name" & " Ped/Open|" & the rect ¬
    of card button Marker2 & return into pictAdd
    end if
    else
    hide card button page
    end if
    if MY_DocMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button DocMarker & return after pictAdd
    end if
    if MY_GearGate is "open" then
    put field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker after pictAdd
    end if
    playqt "BR Seagulls/Water Slosh Mx MoV",,"loop","180"
    pass openCard
    end openCard

    * Part 2737:1 "right"
      on mouseUp
      global vault
      if vault is open then
      send mousedown to card button "docmarker"
      end if
      go to card id 4495
      end mouseUp
    * Part 2737:2 ""
      on mouseUp
      global vault
      if vault is open then
      send mousedown to card button "docmarker"
      end if
      go to card id 5026
      end mouseUp
    * Part 2737:3 "DocMarker"
      on mouseDown
      global vault
      global MY_GearGate
      global MY_PlaMarker,MY_ShiMarker,MY_CloMarker,MY_GarMarker
      global MY_GeaMarker,MY_DocMarker,MY_MinMarker,MY_CabMarker
      global ALL_Page,DU_end
      --if the optionkey is down then
      --  put "on" into MY_PlaMarker
      --  put "on" into MY_ShiMarker
      --  put "on" into MY_CloMarker
      --  put "on" into MY_GarMarker
      --  put "on" into MY_GeaMarker
      --  put "on" into MY_DocMarker
      --  put "on" into MY_MinMarker
      --  put "on" into MY_CabMarker
      --end if
      if vault is empty then
      put closed into vault
      hide card button page
      end if
      if MY_DocMarker is "on" then
      htlock true
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button docmarker, "Srccopy"
      play stop
      play "SW Marker"
      htlock forcefalse
      put "off" into MY_DocMarker
      
      if MY_PlaMarker = "on" and MY_ShiMarker = "on" and MY_CloMarker = "on" and MY_GarMarker = "on" and ¬
      MY_GeaMarker = "on" and MY_DocMarker = "off" and MY_MinMarker = "on" and MY_CabMarker = "on" then
      htlock true
      if ALL_Page is "Atrus" or DU_End = "win" then
      put "open" into vault
      put field "pict name" into WhichPict
      put WhichPict & " Ped/Open/Empty" into WhichPict
      htvisual "wipe right",,the rect of card button marker2,1,16
      HTAddPict WhichPict, the rect of card button "marker2", "Srccopy"
      show card button page
      else
      put "open" into vault
      put field "pict name" into WhichPict
      put WhichPict & " Ped/Open" into WhichPict
      htvisual "wipe right",,the rect of card button marker2,1,16
      HTAddPict WhichPict, the rect of card button marker2, "Srccopy"
      show card button page
      end if
      play stop
      play "DR SafeLatch"
      htlock forcefalse
      end if
      else
      htlock true
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button docmarker, "Srccopy"
      play stop
      play "SW Marker"
      htlock forcefalse
      put "on" into MY_DocMarker
      if MY_PlaMarker = "on" and MY_ShiMarker = "on" and MY_CloMarker = "on" and MY_GarMarker = "on" and ¬
      MY_GeaMarker = "on" and MY_DocMarker = "on" and MY_MinMarker = "on" and MY_CabMarker = "on" then
      if vault is "open" then
      put closed into vault
      htlock true
      htvisual "wipe left",,the rect of card button marker2,1,16
      opencard
      hide card button page
      htlock forcefalse
      play stop
      play "DR SafeLatch"
      end if
      end if
      wait while the mouseclick
      end if
      end mouseDown
    * Part 2737:4 "gearMarker"
    * Part 2737:5 "marker2"
      on mouseDown
      global MY_PlaMarker,MY_ShiMarker,MY_CloMarker,MY_GarMarker
      global MY_GeaMarker,MY_DocMarker,MY_MinMarker,MY_CabMarker
      global ALL_Page
      if MY_PlaMarker = "on" and MY_ShiMarker = "on" and MY_CloMarker = "on" and MY_GarMarker = "on" and ¬
      MY_GeaMarker = "on" and MY_DocMarker = "off" and MY_MinMarker = "on" and MY_CabMarker = "on" then
      htlock true
      if ALL_Page is not "Atrus" then
      put field "pict name" into WhichPict
      put WhichPict & " Ped/Open" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      show card button page
      else
      put field "pict name" into WhichPict
      put WhichPict & " Ped/Open/Empty" into WhichPict
      HTAddPict WhichPict, the rect of card button "open", "Srccopy"
      show card button page
      end if
      
      
      play stop
      play "DR SafeLatch"
      show card button close
      hide me
      --go card
      htlock forcefalse
      end if
      end mouseDown
    * Part 2737:7 "page"
      on mouseDown
      global ALL_Page,DU_End
      if DU_End ≠ "win" then
      if ALL_Page is "Atrus" then
      put empty into ALL_Page
      put field "pict name" into WhichPict
      put WhichPict & " Ped/Open" into WhichPict
      HTAddPict WhichPict, the rect of card button "marker2", "Srccopy"
      else
      if ALL_Page is not empty then dropPage
      htlock true
      put field "pict name" into WhichPict
      put WhichPict & " Ped/Open/Empty" into WhichPict
      HTAddPict WhichPict, the rect of card button "marker2", "Srccopy"
      htlock forcefalse
      put "Atrus" into ALL_Page
      UpdateCursor
      end if
      dropState
      end if
      end mouseDown
    * Part 2737:8 "left"
      on mouseUp
      global vault
      if vault is open then
      send mousedown to card button "docmarker"
      end if
      go to card id 4495
      end mouseUp
    * Part 2737:9 "qgea"
      on mouseUp
      global MY_Qlist, quick, vault
      if quick is true then
      if MY_Qlist contains "qgea" then
      if vault is open then
      send mousedown to card button "docmarker"
      end if
      end if
      end if
      go card
      end mouseUp
  * Card 4495 "qdoc" (6 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" then
    show card button boat
    show card button qboa
    else
    hide card button boat
    hide card button qboa
    end if
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    playQT "BR Seagulls/Water Slosh Mx MoV",,"loop","180"
    pass openCard
    end openCard

    * Part 4495:1 ""
      on mouseUp
      go to card id 4734
      end mouseUp
    * Part 4495:2 "left"
      on mouseUp
      go to card id 2737
      end mouseUp
    * Part 4495:3 "right"
      on mouseUp
      go to card id 2737
      end mouseUp
    * Part 4495:6 "boat"
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      go to card id 48097
      end mouseUp
    * Part 4495:7 "qboa"
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      go to card id 48097
      end mouseUp
    * Part 4495:8 "qste right"
      on mouseUp
      go to card id 2737
      end mouseUp
  * Card 48097 "" (3 parts)
    * Part 48097:1 ""
      on mouseUp
      go to card id 57582
      end mouseUp
    * Part 48097:2 "right"
      on mouseUp
      go to card id 59355
      end mouseUp
    * Part 48097:3 "left"
      on mouseUp
      go to card id 59355
      end mouseUp
  * Card 57582 "" (3 parts)
    * Part 57582:1 ""
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,30
      go to card id 57822
      show card button openDoor
      end mouseUp
    * Part 57582:2 "right"
      on mouseUp
      go to card id 59122
      end mouseUp
    * Part 57582:3 "left"
      on mouseUp
      go to card id 59122
      end mouseUp
  * Card 57822 "qboa" (6 parts)
    * Part 57822:7 "theDoor"
    * Part 57822:5 "closeDoor"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      htvisual "wipe left",,the rect of card button "theDoor",2,32
      HTChangePict WhichPict,"Srccopy"
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,30
      play "DR Creak Open"
      htlock forcefalse
      play stop
      play "DR Door Close"
      show card button openDoor
      end mouseUp
    * Part 57822:6 "EnterBoat"
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,60,,,,,true
      go to card id 58250
      end mouseUp
    * Part 57822:1 "openDoor"
      on mouseUp
      put field "pict name" & " (Door Open)" into WhichPict
      htlock true
      htvisual "wipe right",,the rect of card button "theDoor",2,32
      HTAddPict WhichPict, the rect of me, "Srccopy"
      play "DR Creak Open"
      htlock forcefalse
      hide me
      play stop
      playQT "FlyStoneship/Music.MooV",,loop,40,,,,,true
      end mouseUp
    * Part 57822:2 "right"
      on mouseUp
      if the visible of card button OpenDoor is false then
      go to card id 59122
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      else
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      go to card id 59122
      end if
      end mouseUp
    * Part 57822:3 "left"
      on mouseUp
      if the visible of card button OpenDoor is false then
      go to card id 59122
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,100
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      else
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      go to card id 59122
      end if
      end mouseUp
  * Card 58250 "" (1 parts)
    * Part 58250:1 ""
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,100,,,,,true
      go to card id 58602
      end mouseUp
  * Card 58602 "" (3 parts)
    * Part 58602:1 "right"
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,60,,,,,true
      go to card id 58803
      end mouseUp
    * Part 58602:2 "left"
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,60,,,,,true
      go to card id 58803
      end mouseUp
    * Part 58602:3 ""
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,150,,,,,true
      go to card id 73177
      end mouseUp
  * Card 73177 "" (2 parts)
    * Part 73177:1 ""
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,100,,,,,true
      go to card id 58602
      end mouseUp
    * Part 73177:2 ""
      on mouseUp
      go to card id 77008
      end mouseUp
  * Card 77008 "" (2 parts)

    on mouseDownInMovie
    deCurse "override",2003,"color","nodelay"
    if there is a window "FlyStoneShip/Music.MooV" then
    hide window "FlyStoneShip/Music.MooV"
    close window "FlyStoneShip/Music.MooV"
    end if
    -- soundIdle
    play "transport"
    fadeout
    go to card "black"
    htlock true
    go to card "Black" of stack "StoneShip Age"
    vd
    wait until the sound is "done"
    play "transport"
    go to card "Restart" of stack "StoneShip Age"
    end mouseDownInMovie
    
    on idle
    global MY_FlyBoat
    if MY_FlyBoat is empty then
    flyby
    put true into MY_FlyBoat
    end if
    end idle
    
    on FlyBy
    put "FlyStoneShip/Music.MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the windowLoc of window theMovieName to the topleft of card button marker
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the badge of window theMovieName to false
    set the audioLevel of window TheMovieName to "250"
    set the controllerVisible of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    soundidle
    deCurse "override","hand","color","nodelay"
    show window TheMovieName
    set the rate of window theMovieName to "1.0"
    set the fastidle of window TheMovieName to true
    end if
    end FlyBy

    * Part 77008:1 ""
      on mouseUp
      global MY_FlyBoat
      htlock true
      put empty into MY_FlyBoat
      if there is a window "FlyStoneShip/Music.MooV" then
      hide window "FlyStoneShip/Music.MooV"
      end if
      playQT "FlyStoneShip/Music.MooV",,loop,100,,,,,true
      set the fastidle of window "FlyStoneShip/Music.MooV" to false
      go to card id 58602
      end mouseUp
    * Part 77008:7 "marker"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseUp
      deCurse "override",2003,"color","nodelay"
      if there is a window "FlyStoneShip/Music.MooV" then
      hide window "FlyStoneShip/Music.MooV"
      close window "FlyStoneShip/Music.MooV"
      end if
      -- soundIdle
      play "transport"
      fadeout
      go to card "black"
      htlock true
      go to card "Black" of stack "StoneShip Age"
      vd
      wait until the sound is "done"
      play "transport"
      go to card "Restart" of stack "StoneShip Age"
      end mouseUp
  * Card 58803 "" (3 parts)
    * Part 58803:1 ""
      on mouseUp
      go to card id 59122
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,30
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      end mouseUp
    * Part 58803:2 "left"
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,100,,,,,true
      go to card id 58602
      end mouseUp
    * Part 58803:3 "right"
      on mouseUp
      playQT "FlyStoneship/Music.MooV",,loop,100,,,,,true
      go to card id 58602
      end mouseUp
  * Card 59122 "" (5 parts)

    on openCard
    global pictAdd,MY_GearGate
    if MY_GearGate is "open" then
    put field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 59122:1 ""
      on mouseUp
      go to card id 59355
      end mouseUp
    * Part 59122:3 "left"
      on mouseUp
      go to card id 57582
      end mouseUp
    * Part 59122:4 "right"
      on mouseUp
      go to card id 57582
      end mouseUp
    * Part 59122:5 "gearMarker"
    * Part 59122:6 "qpla2"
      on mouseUp
      go to card id 59355
      end mouseUp
  * Card 59355 "" (8 parts)

    on openCard
    global pictAdd,MY_GearGate
    if MY_GearGate is "open" then
    put field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 59355:1 ""
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      go to card id 2737
      end mouseUp
    * Part 59355:2 "left"
      on mouseUp
      go to card id 48097
      end mouseUp
    * Part 59355:3 ""
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      go to card id 8336
      end mouseUp
    * Part 59355:4 "right"
      on mouseUp
      go to card id 48097
      end mouseUp
    * Part 59355:5 ""
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      go to card id 77365
      end mouseUp
    * Part 59355:6 "gearMarker"
    * Part 59355:7 "qgea"
      on mouseUp
      go card
      end mouseUp
    * Part 59355:8 "qpla2"
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      go to card id 2737
      end mouseUp
  * Card 5026 "qpla2" (4 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 5026:4 "boatmarker"
    * Part 5026:2 ""
      on mouseUp
      go to card id 6798
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
      end mouseUp
    * Part 5026:1 "right"
      on mouseUp
      go to card id 5726
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,80
      end mouseUp
    * Part 5026:3 "left"
      on mouseUp
      go to card id 4495
      end mouseUp
  * Card 19240 "" (6 parts)

    on openCard
    global pictAdd,MY_GarMarker,MY_Boat
    if MY_GarMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker & return into pictAdd
    end if
    if MY_Boat is "up" then
    put field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 19240:4 "GarMarker"
    * Part 19240:6 "boatMarker"
    * Part 19240:1 ""
      on mouseUp
      go to card id 16774
      playQT "AR Lite Wind Mov",,loop,50
      end mouseUp
    * Part 19240:2 "right"
      on mouseUp
      go to card id 17084
      end mouseUp
    * Part 19240:3 "left"
      on mouseUp
      go to card id 17571
      end mouseUp
    * Part 19240:7 "qlib"
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,50
      go to card id 16774
      end mouseUp
  * Card 18993 "qfor" (6 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 28 into item 1 of it
    put 27 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 26 into item 4 of it
    put field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    playQT "AR Howling&Birds Mov","","loop","100"
    pass openCard
    end openCard

    * Part 18993:5 "clock"
    * Part 18993:1 ""
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 18993:4 ""
      on mouseUp
      go to card id 17084
      end mouseUp
    * Part 18993:2 "right"
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 17571
      end mouseUp
    * Part 18993:3 "left"
      on mouseUp
      go to card id 19240
      end mouseUp
    * Part 18993:7 "qclo"
      on mouseUp
      go to card id 17319
      end mouseUp
  * Card 18304 "qfor2" (7 parts)

    on openCard
    global pictAdd,MY_MinMarker
    if MY_MinMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button MinMarker into pictAdd
    end if
    playQT "AR Howling&Birds Mov","","loop","100"
    pass openCard
    end openCard

    * Part 18304:5 "MinMarker"
    * Part 18304:1 ""
      on mouseUp
      go to card id 17571
      end mouseUp
    * Part 18304:2 ""
      on mouseUp
      go to card id 19240
      end mouseUp
    * Part 18304:3 "right"
      on mouseUp
      go to card id 17825
      end mouseUp
    * Part 18304:4 "left"
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 18304:6 "qlib"
      on mouseUp
      go to card id 19240
      end mouseUp
    * Part 18304:7 "qfou"
      on mouseUp
      go to card id 19240
      end mouseUp
  * Card 17084 "" (6 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 37 into item 1 of it
    put 36 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 34 into item 4 of it
    put field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    
    pass openCard
    end openCard

    * Part 17084:5 "clock"
    * Part 17084:1 ""
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 17084:2 "right"
      on mouseUp
      go to card id 17571
      end mouseUp
    * Part 17084:3 ""
      on mouseUp
      go to card id 17825
      end mouseUp
    * Part 17084:4 "left"
      on mouseUp
      go to card id 19240
      end mouseUp
    * Part 17084:6 "qclo"
      on mouseUp
      go to card id 17319
      end mouseUp
  * Card 17571 "qmin" (6 parts)

    on openCard
    global pictAdd,MY_MinMarker
    if MY_MinMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button MinMarker into pictAdd
    end if
    playQT "AR Howling&Birds Mov","","loop","100"
    pass openCard
    end openCard

    * Part 17571:1 "right"
      on mouseUp
      go to card id 19240
      end mouseUp
    * Part 17571:2 "left"
      on mouseUp
      go to card id 17084
      end mouseUp
    * Part 17571:3 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,200
      go to card id 27316
      end mouseUp
    * Part 17571:4 ""
      on mouseUp
      playQT "MU Generator Stairs MoV",,loop,75
      go to card id 44417
      end mouseUp
    * Part 17571:5 "MinMarker"
      on mouseDown
      global MY_MinMarker
      htlock true
      if MY_MinMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button minmarker, "Srccopy"
      put "off" into MY_MinMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button minmarker, "Srccopy"
      put "on" into MY_MinMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 17571:6 "qgen"
      on mouseUp
      playQT "MU Generator Stairs MoV",,loop,75
      go to card id 44417
      end mouseUp
  * Card 44417 "" (4 parts)
    * Part 44417:1 ""
      on mouseUp
      go to card id 28930
      playQT "MU Generator Stairs MoV",,loop,125
      end mouseUp
    * Part 44417:2 "right"
      on mouseUp
      go to card id 40799
      end mouseUp
    * Part 44417:3 "left"
      on mouseUp
      go to card id 40799
      end mouseUp
    * Part 44417:4 "qgen"
      on mouseUp
      go to card id 28930
      playQT "MU Generator Stairs MoV",,loop,125
      end mouseUp
  * Card 18697 "" (4 parts)
    * Part 18697:4 "right"
      on mouseUp
      go to card id 17571
      end mouseUp
    * Part 18697:1 ""
      on mouseUp
      go to card id 17084
      end mouseUp
    * Part 18697:2 ""
      on mouseUp
      go to card id 19240
      playQT "AR Howling&Birds Mov",,loop,50
      end mouseUp
    * Part 18697:3 "left"
      on mouseUp
      go to card id 17571
      end mouseUp
  * Card 17948 "" (4 parts)
    * Part 17948:4 "left"
      on mouseUp
      go to card id 17825
      end mouseUp
    * Part 17948:1 ""
      on mouseUp
      go to card id 18304
      end mouseUp
    * Part 17948:2 ""
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 17948:3 "right"
      on mouseUp
      go to card id 17825
      end mouseUp
  * Card 17825 "" (4 parts)

    on openCard
    global pictAdd,MY_CabMarker
    if MY_CabMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 17825:6 "CabMarker"
      --on mouseUp
      global MY_CabMarker
      put field "pict name" into WhichPict
      if MY_CabMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_CabMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_CabMarker
      end if
      go this card
      end mouseUp
    * Part 17825:1 "right"
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 17825:2 "left"
      on mouseUp
      go to card id 18304
      end mouseUp
    * Part 17825:3 ""
      on mouseUp
      go to card id 21343
      end mouseUp
  * Card 19652 "qcab" (7 parts)

    on openCard
    global pictAdd,MY_CabMarker
    hide card button entercabin
    show card button opendoor
    if MY_CabMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    playQT "AR Howling&Birds Mov",,loop,100
    pass openCard
    end openCard

    * Part 19652:13 "doormarker"
    * Part 19652:1 "left"
      on mouseUp
      global my_cabindoor
      go to card id 19909
      if my_cabindoor is "open" then
      play "DR Door Close"
      put empty into my_cabindoor
      end if
      end mouseUp
    * Part 19652:2 "right"
      on mouseUp
      global my_cabindoor
      go to card id 21170
      if my_cabindoor is "open" then
      play "DR Door Close"
      put empty into my_cabindoor
      end if
      end mouseUp
    * Part 19652:3 "qtre"
      on mouseUp
      global my_cabindoor
      go to card id 31619
      if my_cabindoor is "open" then
      play "DR Door Close"
      put empty into my_cabindoor
      end if
      end mouseUp
    * Part 19652:4 "opendoor"
      on mouseUp
      global my_cabindoor
      put "open"  into my_cabindoor
      htlock true
      put field "pict name" & " (Door Open)" into WhichPict
      HTVisual "wipe right",,,2
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play stop
      play "DR Creak 2"
      htlock forcefalse
      hide card button opendoor
      show card button entercabin
      wait 15
      play stop
      end mouseUp
    * Part 19652:6 "CabMarker"
      on mouseDown
      global MY_CabMarker
      htlock true
      if MY_CabMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button cabmarker, "Srccopy"
      put "off" into MY_CabMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button cabmarker, "Srccopy"
      put "on" into MY_CabMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 19652:12 "entercabin"
      on mouseUp
      soundstop
      xmemory(1)
      go to card id 36854
      
      end mouseUp
  * Card 38306 "" (5 parts)

    on openCard
    global pictAdd,MY_CabMarker
    if MY_CabMarker is "on" then
    get field "pict name"
    delete last word of it
    delete last word of it
    put it & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 38306:4 "right"
      on mouseUp
      go to card id 21170
      play "DR Creak Open"
      end mouseUp
    * Part 38306:1 ""
      on mouseUp
      go to card id 36854
      end mouseUp
    * Part 38306:2 "left"
      on mouseUp
      go to card id 19909
      play "DR Creak Open"
      end mouseUp
    * Part 38306:3 ""
      on mouseUp
      go to card id 31619
      play "DR Creak Open"
      end mouseUp
    * Part 38306:5 "CabMarker"
      on mouseDown
      global MY_CabMarker
      if MY_CabMarker is "on" then
      xCIcon3 the loc of card button CabMarker, 9017
      play stop
      play "SW Marker"
      put "off" into MY_CabMarker
      else
      xCIcon3 the loc of card button CabMarker, 9018
      play stop
      play "SW Marker"
      put "on" into MY_CabMarker
      end if
      end mouseDown
  * Card 19909 "" (3 parts)
    * Part 19909:1 ""
      on mouseUp
      go to card id 17948
      end mouseUp
    * Part 19909:2 "right"
      on mouseUp
      go to card id 21343
      end mouseUp
    * Part 19909:3 "left"
      on mouseUp
      go to card id 21170
      end mouseUp
  * Card 21343 "" (8 parts)

    on openCard
    global pictAdd,MY_CabMarker
    if MY_CabMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    hide card button entercabin
    show card button opendoor
    pass openCard
    end openCard

    * Part 21343:7 "doormarker"
    * Part 21343:1 "right"
      on mouseUp
      global my_cabindoor
      go to card id 21170
      if my_cabindoor is "open" then
      play "DR Door Close"
      put empty into my_cabindoor
      end if
      end mouseUp
    * Part 21343:2 "left"
      on mouseUp
      global my_cabindoor
      go to card id 19909
      if my_cabindoor is "open" then
      play "DR Door Close"
      put empty into my_cabindoor
      end if
      end mouseUp
    * Part 21343:3 "opendoor"
      on mouseUp
      global MY_CabinDoor
      put "open" into MY_CabinDoor
      htlock true
      put field "pict name" & " (Door Open)" into WhichPict
      HTVisual "wipe right",,,2
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "DR Creak 2"
      htlock forceFalse
      hide card button opendoor
      show card button entercabin
      wait 15
      play stop
      end mouseUp
    * Part 21343:5 ""
      on mouseUp
      global my_cabindoor
      go to card id 31619
      if MY_CabinDoor is "open" then
      play "DR Door Close"
      put empty into my_cabindoor
      end if
      end mouseUp
    * Part 21343:4 "CabMarker"
      on mouseDown
      global MY_CabMarker
      htlock true
      if MY_CabMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button cabmarker, "Srccopy"
      put "off" into MY_CabMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button cabmarker, "Srccopy"
      put "on" into MY_CabMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 21343:6 ""
    * Part 21343:8 "entercabin"
      on mouseUp
      soundstop
      xmemory(1)
      go to card id 36854
      
      end mouseUp
  * Card 36553 "" (6 parts)

    on openCard
    global pictAdd,MY_CabMarker
    if MY_CabMarker is "on" then
    get field "pict name"
    delete last word of it
    delete last word of it
    put it & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 36553:5 ""
      on mouseUp
      go to card id 31619
      play "DR Creak Open"
      end mouseUp
    * Part 36553:1 "right"
      on mouseUp
      go to card id 21170
      play "DR Creak Open"
      end mouseUp
    * Part 36553:2 "left"
      on mouseUp
      go to card id 19909
      play "DR Creak Open"
      end mouseUp
    * Part 36553:3 ""
      on mouseUp
      go to card id 36854
      end mouseUp
    * Part 36553:4 "CabMarker"
      on mouseDown
      global MY_CabMarker
      if MY_CabMarker is "on" then
      xCIcon3 the loc of card button CabMarker, 9015
      play stop
      play "SW Marker"
      put "off" into MY_CabMarker
      else
      xCIcon3 the loc of card button CabMarker, 9016
      play stop
      play "SW Marker"
      put "on" into MY_CabMarker
      end if
      end mouseDown
    * Part 36553:6 ""
  * Card 21170 "" (5 parts)
    * Part 21170:1 ""
      on mouseUp
      go to card id 20099
      end mouseUp
    * Part 21170:2 ""
      on mouseUp
      go to card id 19652
      end mouseUp
    * Part 21170:3 "left"
      on mouseUp
      go to card id 19652
      end mouseUp
    * Part 21170:4 "right"
      on mouseUp
      go to card id 19909
      end mouseUp
    * Part 21170:5 "qclo"
      on mouseUp
      go to card id 20099
      end mouseUp
  * Card 18553 "" (5 parts)
    * Part 18553:1 ""
      on mouseUp
      go to card id 18304
      end mouseUp
    * Part 18553:2 ""
      on mouseUp
      go to card id 17825
      end mouseUp
    * Part 18553:3 "left"
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 18553:4 "right"
      on mouseUp
      go to card id 17319
      end mouseUp
    * Part 18553:5 "qfou"
      on mouseUp
      go to card id 18304
      end mouseUp
  * Card 17319 "" (6 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute,MY_Gears
    hide card button qclo2
    if MY_Gears is "up" then
    show card button qclo2
    put field "pict name" & " (gears-up)" into WhichPict
    put WhichPict & "|" & the rect of card button GeaMarker & return into pictAdd
    end if
    
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 40 into item 1 of it
    put 39 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 40 into item 4 of it
    put field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    
    pass openCard
    end openCard

    * Part 17319:4 "GeaMarker"
    * Part 17319:5 "clock"
    * Part 17319:3 ""
      on mouseUp
      go to card id 22896
      end mouseUp
    * Part 17319:1 "right"
      on mouseUp
      go to card id 18304
      end mouseUp
    * Part 17319:2 "left"
      on mouseUp
      go to card id 17825
      end mouseUp
    * Part 17319:6 "qclo2"
      on mouseUp
      go to card id 22896
      end mouseUp
  * Card 22764 "" (4 parts)
    * Part 22764:1 ""
      on mouseUp
      go to card id 18553
      end mouseUp
    * Part 22764:2 "right"
      on mouseUp
      go to card id 22896
      end mouseUp
    * Part 22764:3 "left"
      on mouseUp
      go to card id 22896
      end mouseUp
    * Part 22764:4 "qfor2"
      on mouseUp
      go to card id 18553
      end mouseUp
  * Card 22896 "" (7 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute,MY_Gears
    hide card button qclo2
    if MY_Gears is "up" then
    show card button qclo2
    put field "pict name" & " (gears-up)" into WhichPict
    put WhichPict & "|" & the rect of card button GeaMarker & return into pictAdd
    show card button clockPath
    else
    hide card button clockPath
    end if
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 54 into item 1 of it
    put 53 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 51 into item 4 of it
    put field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    
    pass openCard
    end openCard

    * Part 22896:4 "GeaMarker"
    * Part 22896:6 "clock"
    * Part 22896:1 "left"
      on mouseUp
      go to card id 22764
      end mouseUp
    * Part 22896:2 "right"
      on mouseUp
      go to card id 22764
      end mouseUp
    * Part 22896:3 ""
      on mouseUp
      go to card id 21716
      end mouseUp
    * Part 22896:5 "ClockPath"
      on mouseUp
      go to card id 56703
      end mouseUp
    * Part 22896:7 "qclo2"
      on mouseUp
      go to card id 56703
      end mouseUp
  * Card 20226 "" (6 parts)

    on openCard
    global pictAdd,MY_CabMarker
    if MY_CabMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 20226:5 "CabMarker"
    * Part 20226:2 "right"
      on mouseUp
      go to card id 20099
      end mouseUp
    * Part 20226:3 "left"
      on mouseUp
      go to card id 20099
      end mouseUp
    * Part 20226:4 ""
      on mouseUp
      go to card id 31619
      end mouseUp
    * Part 20226:1 ""
      on mouseUp
      go to card id 19652
      end mouseUp
    * Part 20226:6 "qtre"
      on mouseUp
      go to card id 31619
      end mouseUp
  * Card 20099 "" (5 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute,MY_Gears
    if MY_Gears is "up" then
    put field "pict name" & " (gears-up)" into WhichPict
    put WhichPict & "|" & the rect of card button GeaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 20099:4 "GeaMarker"
    * Part 20099:1 "right"
      on mouseUp
      go to card id 20226
      end mouseUp
    * Part 20099:2 "left"
      on mouseUp
      go to card id 20226
      end mouseUp
    * Part 20099:3 ""
      on mouseUp
      go to card id 20615
      end mouseUp
    * Part 20099:5 "qclo"
      on mouseUp
      go to card id 20615
      end mouseUp
  * Card 20863 "" (5 parts)

    on openCard
    global pictAdd,MY_CabMarker
    if MY_CabMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button CabMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 20863:4 "CabMarker"
    * Part 20863:1 ""
      on mouseUp
      go to card id 20226
      end mouseUp
    * Part 20863:2 "right"
      on mouseUp
      go to card id 20615
      end mouseUp
    * Part 20863:3 "left"
      on mouseUp
      go to card id 20615
      end mouseUp
    * Part 20863:5 "qcab"
      on mouseUp
      go to card id 20226
      end mouseUp
  * Card 20615 "" (5 parts)

    on openCard
    global pictAdd,MY_ClockHour,MY_ClockMinute,MY_Gears
    if MY_Gears is "up" then
    put field "pict name" & " (gears-up)" into WhichPict
    put WhichPict & "|" & the rect of card button GeaMarker & return into pictAdd
    end if
    
    get the rect of card button clock
    put (MY_ClockMinute div 5) * 43 into item 1 of it
    put 42 + item 1 of it into item 3 of it
    put 0 into item 2 of it
    put 43 into item 4 of it
    put field "pict name" & " (Clock) " & MY_ClockHour into WhichPict
    put WhichPict & "|" & the rect of card button clock & "|" & it after pictAdd
    pass openCard
    end openCard

    * Part 20615:3 "GeaMarker"
    * Part 20615:2 ""
      on mouseUp
      go to card id 21716
      end mouseUp
    * Part 20615:1 "right"
      on mouseUp
      go to card id 20863
      end mouseUp
    * Part 20615:4 "clock"
    * Part 20615:5 "qclo2"
      on mouseUp
      go card
      end mouseUp
  * Card 26663 "" (7 parts)
    * Part 26663:4 ""
      on mouseUp
      go to card id 12527
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
    * Part 26663:2 "right"
      on mouseUp
      go to card id 27005
      end mouseUp
    * Part 26663:3 "left"
      on mouseUp
      go to card id 27005
      end mouseUp
    * Part 26663:5 ""
      on mouseUp
      go to card id 24061
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 26663:6 ""
      on mouseUp
      go to card id 12527
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
    * Part 26663:7 "qbre2"
      on mouseUp
      go to card id 24061
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 26663:8 "qshi"
      on mouseUp
      go to card id 12527
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
  * Card 27005 "qpat" (6 parts)

    on openCard
    global pictAdd,MY_Boat
    if MY_Boat is "up" then
    put field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker after pictAdd
    end if
    playQT "AR Lite Wind MoV",,loop,200
    pass openCard
    end openCard

    * Part 27005:4 "boatMarker"
    * Part 27005:1 ""
      on mouseUp
      go to card id 12224
      playQT "AR Lite Wind MoV",,loop,200
      end mouseUp
    * Part 27005:2 ""
      on mouseUp
      go to card id 11357
      end mouseUp
    * Part 27005:3 ""
      on mouseUp
      go to card id 11521
      end mouseUp
    * Part 27005:5 "right"
      on mouseUp
      go to card id 26663
      end mouseUp
    * Part 27005:6 "left"
      on mouseUp
      go to card id 26663
      end mouseUp
  * Card 11521 "qlib" (4 parts)

    on opencard
    playQT "AR Lite Wind MoV",,loop,200
    pass opencard
    end opencard

    * Part 11521:1 "right"
      on mouseUp
      go to card id 12224
      end mouseUp
    * Part 11521:2 "left"
      on mouseUp
      go to card id 11943
      end mouseUp
    * Part 11521:3 ""
      on mouseUp
      xMemory(1)
      go to card id 46094
      playQT "AR Lite Wind MoV",,loop,30
      end mouseUp
    * Part 11521:5 "qshi left"
      on mouseUp
      go to card id 11943
      end mouseUp
  * Card 11943 "qpat2" (4 parts)

    on opencard
    playQT "AR Lite Wind MoV",,loop,200
    pass opencard
    end opencard

    * Part 11943:1 "right"
      on mouseUp
      go to card id 11521
      end mouseUp
    * Part 11943:2 "left"
      on mouseUp
      go to card id 11357
      end mouseUp
    * Part 11943:3 ""
      on mouseUp
      go to card id 26663
      playQT "AR Lite Wind MoV",,loop,200
      end mouseUp
    * Part 11943:4 "qbre2"
      on mouseUp
      go to card id 26663
      playQT "AR Lite Wind MoV",,loop,200
      end mouseUp
  * Card 12224 "" (6 parts)

    on openCard
    global pictAdd,MY_PlaMarker,MY_Boat
    if the last word of bg field 1 = "Boatup" then
    delete the last word of bg field 1
    end if
    if MY_PlaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    if MY_Boat is "up" then put " BoatUp" after bg field 1
    pass openCard
    end openCard

    * Part 12224:2 "right"
      on mouseUp
      go to card id 11357
      end mouseUp
    * Part 12224:4 "PlaMarker"
    * Part 12224:3 "left"
      on mouseUp
      go to card id 11521
      end mouseUp
    * Part 12224:1 ""
      on mouseUp
      go to card id 10238
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
    * Part 12224:6 "qpla"
      on mouseUp
      go to card id 10238
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
    * Part 12224:7 "qpat1"
      on mouseUp
      go to card id 10238
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
  * Card 11357 "" (9 parts)

    on openCard
    global pictAdd,MY_Boat
    if MY_Boat is "up" then
    put field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker after pictAdd
    end if
    pass openCard
    end openCard

    * Part 11357:9 "boatMarker"
    * Part 11357:1 "left"
      on mouseUp
      go to card id 12224
      end mouseUp
    * Part 11357:2 "right"
      on mouseUp
      go to card id 11943
      end mouseUp
    * Part 11357:4 ""
      on mouseUp
      go to card id 39621
      end mouseUp
    * Part 11357:6 ""
      on mouseUp
      go to card id 39131
      end mouseUp
    * Part 11357:7 ""
      on mouseUp
      go to card id 39194
      end mouseUp
    * Part 11357:8 ""
      on mouseUp
      go to card id 39902
      end mouseUp
    * Part 11357:3 ""
      on mouseUp
      go to card id 14569
      playQT "AR Lite Wind MoV",,loop,150
      end mouseUp
    * Part 11357:12 "qfor"
      on mouseUp
      go to card id 14569
      playQT "AR Lite Wind MoV",,loop,150
      end mouseUp
  * Card 14817 "" (9 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 14817:1 "right"
      on mouseUp
      go to card id 80753
      end mouseUp
    * Part 14817:5 ""
      on mouseUp
      go to card id 12224
      end mouseUp
    * Part 14817:10 "PlaMarker"
    * Part 14817:2 "left"
      on mouseUp
      go to card id 80989
      end mouseUp
    * Part 14817:3 ""
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,200
      go to card id 11521
      end mouseUp
    * Part 14817:4 ""
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,200
      go to card id 11943
      end mouseUp
    * Part 14817:7 ""
      on mouseUp
      go to card id 39621
      end mouseUp
    * Part 14817:9 ""
      on mouseUp
      go to card id 39902
      end mouseUp
    * Part 14817:12 "qshi"
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,200
      go to card id 11943
      end mouseUp
  * Card 14569 "" (9 parts)

    on openCard
    global pictAdd,MY_GarMarker,MY_Boat
    if last word of bg field 1 = "BoatUp" then delete the last word of bg field 1
    if MY_GarMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker into pictAdd
    end if
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    pass openCard
    end openCard

    * Part 14569:8 "GarMarker"
    * Part 14569:7 "boatMarker"
    * Part 14569:3 "none"
      on mouseUp
      HTVisual "scroll up",,,1
      go to card id 15013
      end mouseUp
      
      on mousewithin
      deCurse "override","down","color","nodelay"
      end mousewithin
    * Part 14569:4 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,100
      go to card id 15359
      end mouseUp
    * Part 14569:1 "right"
      on mouseUp
      go to card id 80989
      end mouseUp
    * Part 14569:2 "left"
      on mouseUp
      go to card id 80753
      end mouseUp
    * Part 14569:5 ""
      on mouseUp
      go to card id 33253
      end mouseUp
    * Part 14569:6 ""
      on mouseUp
      go to card id 33326
      end mouseUp
    * Part 14569:10 "qfor"
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,100
      go to card id 15359
      end mouseUp
  * Card 80989 "" (5 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 80989:1 "left"
      on mouseUp
      go to card id 14569
      end mouseUp
    * Part 80989:2 "right"
      on mouseUp
      go to card id 14817
      end mouseUp
    * Part 80989:4 ""
      on mouseUp
      go to card id 39131
      end mouseUp
    * Part 80989:5 ""
      on mouseUp
      go to card id 33253
      end mouseUp
    * Part 80989:6 ""
      on mouseUp
      go to card id 39621
      end mouseUp
  * Card 80753 "" (5 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 80753:1 "left"
      on mouseUp
      go to card id 14817
      end mouseUp
    * Part 80753:2 "right"
      on mouseUp
      go to card id 14569
      end mouseUp
    * Part 80753:3 ""
      on mouseUp
      go to card id 39194
      end mouseUp
    * Part 80753:4 ""
      on mouseUp
      go to card id 39902
      end mouseUp
    * Part 80753:5 ""
      on mouseUp
      go to card id 33326
      end mouseUp
  * Card 78996 "" (5 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 78996:1 "left"
      on mouseUp
      go to card id 15359
      end mouseUp
    * Part 78996:3 "right"
      on mouseUp
      go to card id 15587
      end mouseUp
    * Part 78996:4 ""
      on mouseUp
      go to card id 40072
      end mouseUp
    * Part 78996:5 ""
      on mouseUp
      go to card id 33253
      end mouseUp
    * Part 78996:6 ""
      on mouseUp
      go to card id 39131
      end mouseUp
  * Card 15013 "" (3 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 15013:4 "boatMarker"
    * Part 15013:2 "none"
      on mouseUp
      HTVisual "scroll down",,,1
      go to card id 14569
      end mouseUp
    * Part 15013:3 ""
      on mouseUp
      
      end mouseUp
  * Card 15587 "qfou" (8 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    playQT "AR Lite Wind Mov",,loop,150
    pass openCard
    end openCard

    * Part 15587:9 "boatMarker"
    * Part 15587:4 "none"
      on mouseUp
      HTVisual "scroll up",,,1
      go to card id 15854
      end mouseUp
      
      on mousewithin
      deCurse "override","down","color","nodelay"
      end mousewithin
    * Part 15587:3 ""
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,180
      go to card id 14817
      end mouseUp
    * Part 15587:1 "right"
      on mouseUp
      go to card id 81200
      end mouseUp
    * Part 15587:2 "left"
      on mouseUp
      go to card id 78996
      end mouseUp
    * Part 15587:5 ""
      on mouseUp
      go to card id 39131
      end mouseUp
    * Part 15587:6 ""
      on mouseUp
      go to card id 39194
      end mouseUp
    * Part 15587:10 "qlib"
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,180
      go to card id 14817
      end mouseUp
  * Card 15854 "" (3 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 15854:2 "none"
      on mouseUp
      HTVisual "scroll down",,,1
      go to card id 15587
      end mouseUp
    * Part 15854:4 "boatMarker"
    * Part 15854:3 ""
  * Card 15359 "" (8 parts)

    on openCard
    global pictAdd,MY_GarMarker
    if MY_GarMarker is "on" then
    put  field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 15359:1 "right"
      on mouseUp
      go to card id 78996
      end mouseUp
    * Part 15359:2 "left"
      on mouseUp
      go to card id 81200
      end mouseUp
    * Part 15359:3 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,50
      go to card id 15974
      end mouseUp
    * Part 15359:6 ""
      on mouseUp
      go to card id 40072
      end mouseUp
    * Part 15359:8 ""
      on mouseUp
      go to card id 40436
      end mouseUp
    * Part 15359:9 "GarMarker"
      on mouseDown
      global MY_GarMarker
      htlock true
      if MY_GarMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      put "off" into MY_GarMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      put "on" into MY_GarMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 15359:11 "qfor"
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,50
      go to card id 15974
      end mouseUp
    * Part 15359:12 "qmin"
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,50
      go to card id 15974
      end mouseUp
  * Card 81200 "" (6 parts)

    on openCard
    global MY_Boat,MY_GarMarker,pictAdd
    put "Garden 3-S" into field "pict name"
    if MY_GarMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker into pictAdd
    end if
    if MY_Boat is "up" then put " BoatUp" after bg field 1
    pass openCard
    end openCard

    * Part 81200:1 "left"
      on mouseUp
      go to card id 15587
      end mouseUp
    * Part 81200:2 "right"
      on mouseUp
      go to card id 15359
      end mouseUp
    * Part 81200:3 "garmarker"
      on mouseDown
      global MY_GarMarker
      if MY_GarMarker is "on" then
      put "Garden 3-S" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      play stop
      play "SW Marker"
      put "off" into MY_GarMarker
      else
      put "Garden 3-S" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      play stop
      play "SW Marker"
      put "on" into MY_GarMarker
      end if
      end mouseDown
    * Part 81200:4 ""
      on mouseUp
      go to card id 39194
      end mouseUp
    * Part 81200:5 ""
      on mouseUp
      go to card id 40436
      end mouseUp
    * Part 81200:6 ""
      on mouseUp
      go to card id 33326
      end mouseUp
  * Card 16155 "" (11 parts)

    on openCard
    global pictAdd,MY_GarMarker,MY_Boat
    if MY_GarMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker & return into pictAdd
    end if
    
    if MY_Boat is "up" then
    put field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker after pictAdd
    end if
    pass openCard
    end openCard

    * Part 16155:11 "BoatMarker"
    * Part 16155:1 ""
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,150
      go to card id 15587
      end mouseUp
    * Part 16155:2 "right"
      on mouseUp
      go to card id 26459
      end mouseUp
    * Part 16155:3 "left"
      on mouseUp
      go to card id 82458
      end mouseUp
    * Part 16155:5 ""
      on mouseUp
      go to card id 33326
      end mouseUp
    * Part 16155:6 ""
      on mouseUp
      go to card id 39131
      end mouseUp
    * Part 16155:7 ""
      on mouseUp
      go to card id 39194
      end mouseUp
    * Part 16155:8 ""
    * Part 16155:9 "GarMarker"
      on mouseDown
      global MY_GarMarker
      htlock true
      if MY_GarMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      play stop
      play "SW Marker"
      put "off" into MY_GarMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      put "on" into MY_GarMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 16155:10 ""
      on mouseUp
      go to card id 33253
      end mouseUp
    * Part 16155:12 "qlib"
      on mouseUp
      playQT "AR Lite Wind Mov",,loop,150
      go to card id 15587
      end mouseUp
  * Card 15974 "" (5 parts)
    * Part 15974:2 "right"
      on mouseUp
      go to card id 82458
      end mouseUp
    * Part 15974:1 ""
      on mouseUp
      go to card id 17571
      playQT "AR Howling&Birds Mov",,loop,50
      end mouseUp
    * Part 15974:3 "left"
      on mouseUp
      go to card id 26459
      end mouseUp
    * Part 15974:4 ""
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,50
      go to card id 16440
      end mouseUp
    * Part 15974:6 "qfor"
      on mouseUp
      go to card id 16440
      playQT "AR Howling&Birds Mov",,loop,50
      end mouseUp
  * Card 26459 "" (4 parts)

    on openCard
    global pictAdd,MY_GarMarker,MY_Boat
    if MY_GarMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 26459:1 "left"
      on mouseUp
      go to card id 16155
      end mouseUp
    * Part 26459:3 "right"
      on mouseUp
      go to card id 15974
      end mouseUp
    * Part 26459:4 "garMarker"
      on mouseDown
      global MY_GarMarker
      htlock true
      if MY_GarMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      put "off" into MY_GarMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button garmarker, "Srccopy"
      put "on" into MY_GarMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 26459:5 ""
      on mouseUp
      go to card id 40436
      end mouseUp
  * Card 82458 "" (4 parts)
    * Part 82458:1 "right"
      on mouseUp
      go to card id 16155
      end mouseUp
    * Part 82458:2 "left"
      on mouseUp
      go to card id 15974
      end mouseUp
    * Part 82458:3 ""
      on mouseUp
      go to card id 40072
      end mouseUp
    * Part 82458:4 ""
      on mouseUp
      go to card id 33253
      end mouseUp
  * Card 16774 "" (8 parts)

    on openCard
    global pictAdd,MY_GarMarker,MY_Boat
    if MY_GarMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GarMarker & return into pictAdd
    end if
    if MY_Boat is "up" then
    put field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker after pictAdd
    end if
    pass openCard
    end openCard

    * Part 16774:6 "GarMarker"
      --on mouseUp
      global MY_GarMarker
      put field "pict name" into WhichPict
      if MY_GarMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_GarMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_GarMarker
      end if
      go this card
      end mouseUp
    * Part 16774:7 "boatMarker"
    * Part 16774:3 ""
      on mouseUp
      go to card id 16155
      playQT "AR Lite Wind Mov",,loop,100
      end mouseUp
    * Part 16774:1 "right"
      on mouseUp
      go to card id 82706
      end mouseUp
    * Part 16774:2 "left"
      on mouseUp
      go to card id 83270
      end mouseUp
    * Part 16774:4 ""
      on mouseUp
      go to card id 33253
      end mouseUp
    * Part 16774:5 ""
      on mouseUp
      go to card id 33326
      end mouseUp
    * Part 16774:9 "qlib"
      on mouseUp
      go to card id 16155
      playQT "AR Lite Wind Mov",,loop,100
      end mouseUp
  * Card 16440 "" (6 parts)

    on idle
    global MY_Butter1
    if MY_Butter1 is true then
    hc
    Butterfly
    put false into MY_Butter1
    ww
    end if
    pass idle
    end idle
    
    on closecard
    htlock true
    if there is a window "Garden 4-W (BF2).Moov" then
    hide window "Garden 4-W (BF2).Moov"
    close window "Garden 4-W (BF2).Moov"
    end if
    pass closecard
    end closecard
    
    on Butterfly
    put "Garden 4-W (BF2).Moov" into theMovieName
    if there is not a window theMovieName then
    Movie theMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    if there is a window theMovieName then
    set the TimeFormat of window theMovieName to "MovieTime"
    set the dontErase of window theMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window theMovieName to "256"
    set the mute of window theMovieName to true
    set the badge of window theMovieName to false
    set the controllerVisible of window theMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window theMovieName to true
    set the loop of window theMovieName to false
    set the seeAllFrames of window theMovieName to false
    set the startTime of window theMovieName to "0"
    --set the endTime of window theMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    show window theMovieName
    set the rate of window theMovieName to 1.0
    end if
    end if
    end Butterfly
    
    on MouseDownInMovie
    click at the clickloc
    end MouseDownInMovie

    * Part 16440:6 "moovmarker"
    * Part 16440:1 "right"
      on mouseUp
      go to card id 83270
      end mouseUp
    * Part 16440:2 "left"
      on mouseUp
      go to card id 82706
      end mouseUp
    * Part 16440:3 ""
      on mouseUp
      htlock true
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 18993
      end mouseUp
    * Part 16440:4 ""
    * Part 16440:5 "qclo"
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 18993
      end mouseUp
  * Card 83270 "" (4 parts)
    * Part 83270:1 "right"
      on mouseUp
      go to card id 16774
      end mouseUp
    * Part 83270:2 "left"
      on mouseUp
      go to card id 16440
      end mouseUp
    * Part 83270:3 ""
      on mouseUp
      go to card id 27316
      end mouseUp
    * Part 83270:4 ""
      on mouseUp
      go to card id 40072
      end mouseUp
  * Card 82706 "" (3 parts)
    * Part 82706:1 "left"
      on mouseUp
      go to card id 16774
      end mouseUp
    * Part 82706:2 "right"
      on mouseUp
      go to card id 16440
      end mouseUp
    * Part 82706:4 ""
      on mouseUp
      go to card id 40436
      end mouseUp
  * Card 40072 "" (3 parts)
    * Part 40072:1 ""
      on mouseUp
      go to card id 82458
      end mouseUp
    * Part 40072:2 ""
    * Part 40072:3 "7"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
  * Card 33253 "" (3 parts)
    * Part 33253:1 ""
      on mouseUp
      go to card id 78996
      end mouseUp
    * Part 33253:2 ""
    * Part 33253:4 "6"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
  * Card 39131 "" (3 parts)
    * Part 39131:1 ""
      on mouseUp
      go to card id 80989
      end mouseUp
    * Part 39131:2 ""
    * Part 39131:4 "5"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
  * Card 39621 "" (4 parts)
    * Part 39621:1 "right"
      on mouseUp
      go to card id 11521
      end mouseUp
    * Part 39621:2 ""
    * Part 39621:3 "4"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
    * Part 39621:4 "left"
      on mouseUp
      go to card id 14569
      end mouseUp
  * Card 40436 "" (3 parts)
    * Part 40436:1 ""
      on mouseUp
      go to card id 26459
      end mouseUp
    * Part 40436:2 ""
    * Part 40436:3 "3"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
  * Card 33326 "" (3 parts)
    * Part 33326:1 ""
      on mouseUp
      go to card id 81200
      end mouseUp
    * Part 33326:2 ""
    * Part 33326:5 "2"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
  * Card 39194 "" (3 parts)
    * Part 39194:1 ""
      on mouseUp
      go to card id 80753
      end mouseUp
    * Part 39194:2 ""
    * Part 39194:3 "1"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
  * Card 39902 "" (5 parts)
    * Part 39902:1 "left"
      on mouseUp
      go to card id 11521
      end mouseUp
    * Part 39902:2 ""
    * Part 39902:3 "8"
      on mouseEnter
      showPillar the short name of me
      end mouseEnter
      
      on mouseLeave
      hidePillar
      end mouseLeave
      
      on mouseUp
      pillarClick the short name of me
      end mouseUp
    * Part 39902:4 "boatMarker"
    * Part 39902:6 "right"
      on mouseUp
      go to card id 14569
      end mouseUp
  * Card 10575 "" (5 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 10575:3 "boatMarker"
    * Part 10575:1 ""
      on mouseUp
      go to card id 11197
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,40
      end mouseUp
    * Part 10575:2 "left"
      on mouseUp
      go to card id 10973
      end mouseUp
    * Part 10575:4 "right"
      on mouseUp
      go to card id 78797
      end mouseUp
    * Part 10575:6 "qdoc"
      on mouseUp
      go to card id 11197
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,40
      end mouseUp
  * Card 10973 "qgea" (5 parts)

    on openCard
    global pictAdd,MY_GeaMarker,MY_GearGate
    if MY_GeaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GeaMarker & return into pictAdd
    end if
    if MY_GearGate is "open" then
    put field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker after pictAdd
    playQT "FlyGearGate/Music.MooV",,loop,50,,,,,true
    show card button GearButton
    else
    playQT "FlyGearGate/Music.MooV",,loop,30,,,,,true
    hide card button GearButton
    end if
    pass openCard
    end openCard

    * Part 10973:5 "gearMarker"
    * Part 10973:1 "right"
      on mouseUp
      go to card id 10575
      end mouseUp
    * Part 10973:2 "left"
      on mouseUp
      go to card id 78797
      end mouseUp
    * Part 10973:3 "geaMarker"
      on mouseDown
      global MY_GeaMarker
      htlock true
      if MY_GeaMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button geamarker, "Srccopy"
      put "off" into MY_GeaMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button geamarker, "Srccopy"
      put "on" into MY_GeaMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 10973:4 "GearButton"
      on mouseUp
      playQT "FlyGearGate/Music.MooV",,loop,100,,,,,true
      go to card id 59796
      end mouseUp
  * Card 78797 "" (3 parts)
    * Part 78797:1 "right"
      on mouseUp
      go to card id 10973
      end mouseUp
    * Part 78797:2 "left"
      on mouseUp
      go to card id 10575
      end mouseUp
    * Part 78797:3 "none"
      on mouseUp
      go to card id 82170
      end mouseUp
  * Card 82170 "" (1 parts)
    * Part 82170:1 "none"
      on mouseUp
      go to card id 78797
      end mouseUp
      
      on mouseWithin
      deCurse "override","down","color","nodelay"
      end mouseWithin
  * Card 59796 "" (3 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 59796:1 ""
      on mouseUp
      playQT "FlyGearGate/Music.MooV",,loop,150,,,,,true
      go to card id 64050
      end mouseUp
    * Part 59796:2 ""
      on mouseUp
      playQT "FlyGearGate/Music.MooV",,loop,60,,,,,true
      go to card id 10575
      end mouseUp
    * Part 59796:3 "marker"
  * Card 64050 "" (3 parts)
    * Part 64050:1 ""
      on mouseUp
      playQT "FlyGearGate/Music.MooV",,loop,100,,,,,true
      go to card id 59796
      end mouseUp
    * Part 64050:2 ""
    * Part 64050:3 ""
      on mouseUp
      playQT "FlyGearGate/Music.MooV",,loop,190,,,,,true
      go to card id 43221
      end mouseUp
  * Card 43221 "" (2 parts)
    * Part 43221:1 ""
      on mouseUp
      playQT "FlyGearGate/Music.MooV",,loop,150,,,,,true
      go to card id 64050
      end mouseUp
    * Part 43221:2 ""
      on mouseUp
      htlock nobw
      go to card id 72560
      end mouseUp
  * Card 72560 "" (3 parts)

    on mouseDownInMovie
    deCurse "override",2003,"color","nodelay"
    if there is a window "FlyGearGate/Music.MooV" then
    hide window "FlyGearGate/Music.MooV"
    close window "FlyGearGate/Music.MooV"
    end if
    play "transport"
    fadeout
    go to card black
    htlock true
    go to card "Black" of stack "Mechanical Age"
    vd
    wait until the sound is "done"
    play "transport"
    go to card "Restart" of stack "Mechanical Age"
    end mouseDownInMovie
    
    on idle
    global MY_FlyGear
    if MY_FlyGear is empty then
    flyby
    put true into MY_FlyGear
    end if
    end idle
    
    on FlyBy
    put "FlyGearGate/Music.MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the windowLoc of window theMovieName to the topleft of card button marker
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "250"
    set the controllerVisible of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    --set the rate of window TheMovieName to "0.0"
    --set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    deCurse "override","hand","color","nodelay"
    set the fastidle of window TheMovieName to true
    end if
    end FlyBy

    * Part 72560:1 ""
      on mouseUp
      global MY_FlyGear
      htlock true
      put "FlyGearGate/Music.MooV" into TheMovieName
      soundidle
      put empty into MY_FlyGear
      if there is a window TheMovieName then hide window TheMovieName
      playQT "FlyGearGate/Music.MooV",,loop,150,,,,,true
      soundidle
      set the fastidle of window "FlyGearGate/Music.MooV" to false
      go to card id 64050
      end mouseUp
    * Part 72560:2 ""
      on mouseUp
      
      end mouseUp
    * Part 72560:4 "marker"
      on mouseUp
      deCurse "override",2003,"color","nodelay"
      if there is a window "FlyGearGate/Music.MooV" then
      hide window "FlyGearGate/Music.MooV"
      close window "FlyGearGate/Music.MooV"
      end if
      play "transport"
      fadeout
      go to card black
      htlock true
      go to card "Black" of stack "Mechanical Age"
      vd
      wait until the sound is "done"
      play "transport"
      go to card "Restart" of stack "Mechanical Age"
      end mouseUp
  * Card 46094 "" (5 parts)
    * Part 46094:1 ""
      on mouseUp
      go to card id 46439
      end mouseUp
    * Part 46094:5 "right"
      on mouseUp
      go to card id 49958
      end mouseUp
    * Part 46094:2 ""
      on mouseUp
      go to card id 47833
      end mouseUp
    * Part 46094:6 "left"
      on mouseUp
      go to card id 49958
      end mouseUp
    * Part 46094:3 ""
      on mouseUp
      go to card id 46739
      end mouseUp
  * Card 46439 "" (6 parts)

    on openCard
    htlock "nobw"
    global MY_LibStairs
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "StairsDown" then
    put " StairsDown" after field "pict name"
    end if
    else
    if last word of field "pict name" is "StairsDown" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 46439:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 46439:1 "left"
      on mouseUp
      go to card id 48298
      end mouseUp
    * Part 46439:2 "right"
      on mouseUp
      go to card id 47448
      end mouseUp
    * Part 46439:3 ""
      on mouseUp
      go to card id 48883
      end mouseUp
    * Part 46439:5 ""
      on mouseUp
      go to card id 49308
      loadmoov
      end mouseUp
    * Part 46439:6 ""
      on mouseUp
      go to card id 48589
      loadmoov
      end mouseUp
  * Card 44018 "restart" (1 parts)

    on opencard
    global MY_LibStairs,MY_CabinValve,MY_TreeGate
    if MY_LibStairs is up then playQT "AR Lite Wind MoV",,loop,30
    else playQT "MR Elev Room Loud MoV",,loop,30
    if MY_CabinValve > 12 then put 13 into item 1 of MY_TreeGate
    if MY_CabinValve < 12 then put 1 into item 1 of MY_TreeGate
    pass opencard
    end opencard

    * Part 44018:1 "down"
      on mouseUp
      htlock "nobw"
      htlock true
      vs up
      pop card
      end mouseUp
  * Card 48883 "" (4 parts)

    on openCard
    global MY_LibStairs
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "StairsDown" then
    put " StairsDown" after field "pict name"
    show card button LibPath
    show card button qele
    end if
    else
    if last word of field "pict name" is "StairsDown" then
    delete last word of field "pict name"
    hide card button LibPath
    hide card button qele
    end if
    end if
    pass openCard
    end openCard

    * Part 48883:1 ""
      on mouseUp
      go to card id 46439
      end mouseUp
    * Part 48883:2 ""
      on mouseUp
      start using stack MYRes4
      go to card id 48938
      end mouseUp
    * Part 48883:3 "LibPath"
      on mouseUp
      playQT "MR Elev Room Loud MoV",,loop,40
      go to card id 50829
      end mouseUp
    * Part 48883:4 "qele"
      on mouseUp
      playQT "MR Elev Room Loud MoV",,loop,40
      go to card id 50829
      end mouseUp
  * Card 50829 "" (3 parts)
    * Part 50829:1 "qele"
      on mouseUp
      go to card id 51152
      playQT "MR Elev Room Loud MoV",,loop,50
      end mouseUp
    * Part 50829:2 "right"
      on mouseUp
      go to card id 54814
      end mouseUp
    * Part 50829:3 "left"
      on mouseUp
      go to card id 54814
      end mouseUp
  * Card 51152 "" (3 parts)
    * Part 51152:1 ""
      on mouseUp
      go to card id 51409
      playQT "MR Elev Room Loud MoV",,loop,60
      end mouseUp
    * Part 51152:2 "right"
      on mouseUp
      go to card id 54569
      end mouseUp
    * Part 51152:3 "left"
      on mouseUp
      go to card id 54569
      end mouseUp
  * Card 51409 "" (3 parts)
    * Part 51409:1 ""
      on mouseUp
      go to card id 51672
      playQT "MR Elev Room Loud MoV",,loop,70
      end mouseUp
    * Part 51409:2 "right"
      on mouseUp
      go to card id 54324
      end mouseUp
    * Part 51409:3 "left"
      on mouseUp
      go to card id 54324
      end mouseUp
  * Card 51672 "" (3 parts)
    * Part 51672:1 ""
      on mouseUp
      go to card id 51830
      playQT "MR Elev Room Loud MoV",,loop,80
      end mouseUp
    * Part 51672:2 "right"
      on mouseUp
      go to card id 54046
      end mouseUp
    * Part 51672:3 "left"
      on mouseUp
      go to card id 54046
      end mouseUp
  * Card 51830 "" (3 parts)
    * Part 51830:1 ""
      on mouseUp
      go to card id 52000
      playQT "MR Elev Room Loud MoV",,loop,90
      end mouseUp
    * Part 51830:2 "right"
      on mouseUp
      go to card id 53974
      end mouseUp
    * Part 51830:3 "left"
      on mouseUp
      go to card id 53974
      end mouseUp
  * Card 52000 "" (3 parts)
    * Part 52000:1 ""
      on mouseUp
      go to card id 52235
      playQT "MR Elev Room Loud MoV",,loop,100
      end mouseUp
    * Part 52000:2 "right"
      on mouseUp
      go to card id 53543
      end mouseUp
    * Part 52000:3 "left"
      on mouseUp
      go to card id 53543
      end mouseUp
  * Card 52235 "" (3 parts)

    on opencard
    playQT "MR Elev Room Loud MoV",,loop,100
    pass opencard
    end opencard

    * Part 52235:1 "none"
      on mouseUp
      play stop
      HTVisual "scrollaway right",,the rect of card button none,2,16
      dplay "DR Elev Open"
      go to card id 52656
      end mouseUp
    * Part 52235:2 "right"
      on mouseUp
      go to card id 53495
      end mouseUp
    * Part 52235:3 "left"
      on mouseUp
      go to card id 53495
      end mouseUp
  * Card 52656 "qele" (5 parts)
    * Part 52656:5 "door"
    * Part 52656:1 "none"
      on mouseUp
      play stop
      HTVisual "scroll left",,the rect of card button door,2,16
      dplay "DR Elev Close"
      go to card id 52235
      end mouseUp
    * Part 52656:2 "none"
      on mouseUp
      vd
      go to card id 85634
      htlock forcefalse
      playQT "MR Elev Room Loud MoV",,loop,50
      vs left
      go to card id 52926
      ww
      end mouseUp
    * Part 52656:3 "left"
      on mouseUp
      go to card id 53495
      play "DR Elev Close"
      end mouseUp
    * Part 52656:4 "right"
      on mouseUp
      go to card id 53495
      play "DR Elev Close"
      end mouseUp
  * Card 85634 "" (0 parts)
  * Card 52926 "" (5 parts)
    * Part 52926:4 "door"
    * Part 52926:1 "none"
      on mouseDown
      xcIcon3 the loc of card button "none",503
      play "SW PushButton In"
      play "SW Buzzer"
      wait 15
      wait until the mouse is up
      play stop
      play "SW PushButton Out"
      hide card button none
      show card button none
      end mouseDown
    * Part 52926:2 "none"
      on mouseDown
      play stop
      HTVisual "scroll right",,the rect of card button door,2
      dplay "DR Elev Close"
      go to card id 53170
      playQT "MR Elev Room Loud MoV",,loop,25
      end mousedown
    * Part 52926:3 ""
      on mouseUp
      playQT "MR Elev Room Loud MoV",,loop,100
      go to card id 53495
      play "DR Elev Close"
      end mouseUp
    * Part 52926:5 "qcen"
      on mouseUp
      playQT "MR Elev Room Loud MoV",,loop,100
      go to card id 53495
      play "DR Elev Close"
      end mouseUp
  * Card 53495 "" (3 parts)
    * Part 53495:1 "qcen"
      on mouseUp
      go to card id 53543
      playQT "MR Elev Room Loud MoV",,loop,90
      end mouseUp
    * Part 53495:2 "right"
      on mouseUp
      go to card id 52235
      end mouseUp
    * Part 53495:3 "left"
      on mouseUp
      go to card id 52235
      end mouseUp
  * Card 53543 "" (3 parts)
    * Part 53543:1 ""
      on mouseUp
      go to card id 53974
      playQT "MR Elev Room Loud MoV",,loop,80
      end mouseUp
    * Part 53543:2 "right"
      on mouseUp
      go to card id 52000
      end mouseUp
    * Part 53543:3 "left"
      on mouseUp
      go to card id 52000
      end mouseUp
  * Card 53974 "" (3 parts)
    * Part 53974:1 ""
      on mouseUp
      go to card id 54046
      playQT "MR Elev Room Loud MoV",,loop,70
      end mouseUp
    * Part 53974:2 "left"
      on mouseUp
      go to card id 51830
      end mouseUp
    * Part 53974:3 "right"
      on mouseUp
      go to card id 51830
      end mouseUp
  * Card 54046 "" (3 parts)
    * Part 54046:1 ""
      on mouseUp
      go to card id 54324
      playQT "MR Elev Room Loud MoV",,loop,60
      end mouseUp
    * Part 54046:2 "right"
      on mouseUp
      go to card id 51672
      end mouseUp
    * Part 54046:3 "left"
      on mouseUp
      go to card id 51672
      end mouseUp
  * Card 54324 "" (3 parts)
    * Part 54324:1 ""
      on mouseUp
      go to card id 54569
      playQT "MR Elev Room Loud MoV",,loop,50
      end mouseUp
    * Part 54324:2 "right"
      on mouseUp
      go to card id 51409
      end mouseUp
    * Part 54324:3 "left"
      on mouseUp
      go to card id 51409
      end mouseUp
  * Card 54569 "" (3 parts)
    * Part 54569:1 ""
      on mouseUp
      go to card id 54814
      playQT "MR Elev Room Loud MoV",,loop,40
      end mouseUp
    * Part 54569:2 "right"
      on mouseUp
      go to card id 51152
      end mouseUp
    * Part 54569:3 "left"
      on mouseUp
      go to card id 51152
      end mouseUp
  * Card 54814 "" (3 parts)
    * Part 54814:1 ""
      on mouseUp
      go to card id 46851
      playQT "MR Elev Room Loud MoV",,loop,30
      end mouseUp
    * Part 54814:2 "right"
      on mouseUp
      go to card id 50829
      end mouseUp
    * Part 54814:3 "left"
      on mouseUp
      go to card id 50829
      end mouseUp
  * Card 53170 "" (5 parts)
    * Part 53170:5 "marker"
    * Part 53170:1 "none"
      on mousedown
      htlock "nobw"
      play stop
      HTvisual "scrollaway left",,the rect of card button none,2
      dplay "DR Elev Open"
      go to card id 52926
      playQT "MR Elev Room Loud MoV",,loop,50
      end mousedown
    * Part 53170:2 ""
      on mouseUp
      go to card id 61001
      end mouseUp
    * Part 53170:3 ""
    * Part 53170:4 "marker2"
      On mouseWithin
      global ALL_Cursor,Quick
      get the short name of the target
      if Quick is true then
      get 1002
      if it ≠ ALL_Cursor then
      deCurse "override",1002,"color","nodelay"
      put it into ALL_Cursor
      end if
      end if
      end mouseWithin
      
      on mouseDown
      play "SW PushButton In"
      xcIcon3 the loc of card button "marker2",503
      end mouseDown
      
      on mouseUp
      global pictAdd, MY_ObserveAngle,Quick
      play stop
      play "SW PushButton Out"
      if Quick is not "true" then
      hide card button marker2
      show card button marker2
      put field "pict name" into WhichPict
      put "(closed,dark)" into last word of WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      put "(closed2)" into last word of WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      put "(closed,dark)" into last word of WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      put "(closed2)" into last word of WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      go to card id 63481
      soundstop
      play "MR FrplRotate Start"
      play "MR Elev Start"
      play "MR Elev Mid"
      elevatorUp
      play "MR Elev Start"
      play "MR Elev Mid"
      play "MR Elev Mid"
      play "MR Elev Mid"
      repeat while there is a window "LibElevator.MooV"
      if there is a window "LibElevator.MooV" then
      get the rate of window "LibElevator.MooV"
      if it = 0 then exit repeat
      end if
      send movieIdle to window "LibElevator.MooV"
      end repeat
      play stop
      play "MR Elev End"
      htlock "bw"
      go to card id 65111
      if there is a window "LibElevator.MooV" then close window "LibElevator.MooV"
      wait 90
      put "LibraryElevator (closed,dark)" into WhichPict
      put whichPict & "|" & the rect of card button marker into pictAdd
      else
      play "MR Elev Start"
      play "MR Elev End"
      end if
      go to card id 61001
      htlock "nobw"
      play "EL SharpHum"
      if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
      MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
      playQT "MU Obser/Elecmot Mix MoV",,loop,70,"47,0","0,0","0,0","end"
      else
      playQT "MR Elev Room Loud MoV",,loop,70
      end if
      openCard
      go card
      end mouseUp
  * Card 63481 "" (1 parts)

    on elevatorUp
    global ST_book, theMovieName
    put "LibElevator.MooV" into TheMovieName --∆
    if TheMovieName is in the windows then
    close window TheMovieName
    else
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    put the result into TheResult
    if "Error" is in TheResult then -- Something went wrong
    answer TheResult
    exit elevatorUp
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    show window TheMovieName
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1"
    end if
    end if
    end elevatorUp
    
    on Done
    global pictAdd
    go to card id 65111
    if there is a window "LibElevator.MooV" then close window "LibElevator.MooV"
    send idle
    wait 120
    put "LibraryElevator (closed,dark)" into WhichPict
    put whichPict & "|" & the rect of card button marker into pictAdd
    go to card id 61001
    wait 120
    openCard
    go card
    end Done

    * Part 63481:1 "marker"
  * Card 65111 "" (1 parts)

    on elevatorDown
    global ST_book, theMovieName
    put "LibElevator.MooV" into TheMovieName --∆
    if TheMovieName is in the windows then
    close window TheMovieName
    else
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    put the result into TheResult
    if "Error" is in TheResult then -- Something went wrong
    answer TheResult
    exit elevatorDown
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    --set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    send reverse to window theMovieName
    show window TheMovieName
    --set the rate of window TheMovieName to "1"
    end if
    end if
    end elevatorDown

    * Part 65111:3 "marker"
  * Card 61001 "" (3 parts)

    --on idle
    put the currTime of window "MU Obser/Elecmot Mix MoV"
    pass idle
    end idle

    * Part 61001:5 "marker"
    * Part 61001:3 "none"
      on mousedown
      global SoundMooV
      htlock "nobw"
      HTvisual "scrollaway left",,the rect of card button none,2
      playQT SoundMooV,,loop,100
      play stop
      dplay "DR Elev Open"
      go to card id 64906
      end mousedown
    * Part 61001:4 "marker2"
      On mouseWithin
      global ALL_Cursor,Quick
      get the short name of the target
      if Quick is true then
      get 1002
      if it ≠ ALL_Cursor then
      deCurse "override",1002,"color","nodelay"
      put it into ALL_Cursor
      end if
      end if
      end mouseWithin
      
      on mouseDown
      play "SW PushButton In"
      xcIcon3 the loc of card button "marker2",503
      end mouseDown
      
      on mouseUp
      global  pictAdd,Quick
      play stop
      play "SW PushButton Out"
      if Quick is not "true" then
      hide card button marker2
      show card button marker2
      htlock "bw"
      put "LibraryElevator (closed,dark)" into WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      put "LibraryElevator (closed,dark)" into WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      go to card id 65111
      htlock "nobw"
      soundstop
      play "MR FrplRotate Start"
      play "MR Elev Start"
      play "MR Elev Mid"
      ElevatorDown
      play "MR Elev Start"
      play "MR Elev Mid"
      play "MR Elev Mid"
      play "MR Elev Mid"
      repeat while there is a window "LibElevator.MooV"
      if there is a window "LibElevator.MooV" then
      get the rate of window "LibElevator.MooV"
      if it = 0 then exit repeat
      end if
      send movieIdle to window "LibElevator.MooV"
      end repeat
      play stop
      play "MR Elev End"
      go to card id 63481
      if there is a window "LibElevator.MooV" then close window "LibElevator.MooV"
      wait 90
      put "(closed2)" into last word of WhichPict
      put whichPict & "|" & the rect of card button marker into pictAdd
      else
      play "MR Elev Start"
      play "MR Elev End"
      end if
      go to card id 53170
      play "EL SharpHum"
      playQT "MR Elev Room Loud MoV",,loop,25
      put empty into pictAdd
      put "(closed,dark)" into last word of WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      openCard
      end mouseUp
  * Card 64906 "" (5 parts)

    on openCard
    global pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    get  bg field "pict name"
    put "(slot)|" into last word of it
    put it & the rect of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 64906:4 "door"
    * Part 64906:1 ""
      on mouseUp
      global SoundMooV
      playQT SoundMooV,,loop,180
      go to card id 61232
      end mouseUp
    * Part 64906:2 "none"
      on mousedown
      global SoundMooV
      HTVisual "scroll right",,the rect of card button door,2
      playQT SoundMooV,,loop,70
      play stop
      dplay "DR Elev Close"
      go to card id 61001
      end mousedown
    * Part 64906:3 "marker"
    * Part 64906:5 "marker2"
      on mouseDown
      play "SW PushButton In"
      xcIcon3 the loc of card button "marker2",503
      play "SW Buzzer"
      wait 15
      wait until the mouse is up
      hide card button marker2
      show card button marker2
      play stop
      play "SW PushButton Out"
      end mouseDown
  * Card 61232 "" (3 parts)
    * Part 61232:1 "up"
      on mouseUp
      go to card id 61932
      end mouseUp
    * Part 61232:2 "right"
      on mouseUp
      go to card id 64325
      end mouseUp
    * Part 61232:3 "left"
      on mouseUp
      go to card id 66387
      end mouseUp
  * Card 62129 "" (3 parts)
    * Part 62129:3 ""
      on mouseUp
      global SoundMooV
      go to card id 85634
      playQT SoundMooV,,loop,100
      vs left
      go to card id 64906
      ww
      end mouseUp
    * Part 62129:4 "left"
      on mouseUp
      go to card id 64325
      end mouseUp
    * Part 62129:5 "right"
      on mouseUp
      go to card id 66387
      end mouseUp
  * Card 66387 "" (3 parts)
    * Part 66387:1 "left"
      on mouseUp
      go to card id 62129
      end mouseUp
    * Part 66387:2 "right"
      on mouseUp
      go to card id 61232
      end mouseUp
    * Part 66387:3 ""
      on mouseUp
      go to card id 66650
      end mouseUp
  * Card 66650 "" (5 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put bg field "pict name" & " (code)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 66650:1 ""
      on mouseUp
      go to card id 67498
      end mouseUp
    * Part 66650:2 ""
      on mouseup
      go to card id 68068
      end mouseUp
    * Part 66650:3 "right"
      on mouseUp
      go to card id 68717
      end mouseUp
    * Part 66650:4 "left"
      on mouseUp
      go to card id 68717
      end mouseUp
    * Part 66650:5 "marker"
  * Card 64325 "" (3 parts)
    * Part 64325:1 "left"
      on mouseUp
      go to card id 61232
      end mouseUp
    * Part 64325:2 "right"
      on mouseUp
      go to card id 62129
      end mouseUp
    * Part 64325:3 ""
      on mouseUp
      go to card id 66941
      end mouseUp
  * Card 66941 "" (5 parts)

    on openCard
    global pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put  bg field "pict name" & " (code)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 66941:1 ""
      on mouseUp
      go to card id 67498
      end mouseUp
    * Part 66941:2 ""
      on mouseUp
      go to card id 67709
      end mouseUp
    * Part 66941:3 "left"
      on mouseUp
      go to card id 68606
      end mouseUp
    * Part 66941:4 "right"
      on mouseUp
      go to card id 68606
      end mouseUp
    * Part 66941:5 "marker"
  * Card 67498 "" (3 parts)
    * Part 67498:1 "up"
      on mouseUp
      go to card id 67304
      end mouseUp
    * Part 67498:2 "right"
      on mouseUp
      go to card id 67709
      end mouseUp
    * Part 67498:3 "left"
      on mouseUp
      go to card id 68068
      end mouseUp
  * Card 68068 "" (3 parts)
    * Part 68068:1 "right"
      on mouseUp
      go to card id 67498
      end mouseUp
    * Part 68068:2 "left"
      on mouseUp
      go to card id 68289
      end mouseUp
    * Part 68068:3 ""
      on mouseUp
      go to card id 68606
      end mouseUp
  * Card 68606 "" (5 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put bg field "pict name" & " (slot)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 68606:1 ""
      on mouseUp
      go to card id 61232
      end mouseUp
    * Part 68606:2 ""
      on mouseUp
      go to card id 66387
      end mouseUp
    * Part 68606:3 "right"
      on mouseUp
      go to card id 66941
      end mouseUp
    * Part 68606:4 "left"
      on mouseUp
      go to card id 66941
      end mouseUp
    * Part 68606:5 "marker"
  * Card 67709 "" (3 parts)
    * Part 67709:1 "left"
      on mouseUp
      go to card id 67498
      end mouseUp
    * Part 67709:2 "right"
      on mouseUp
      go to card id 68289
      end mouseUp
    * Part 67709:3 ""
      on mouseUp
      go to card id 68717
      end mouseUp
  * Card 68717 "" (5 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put  bg field "pict name" & " (slot)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 68717:1 ""
      on mouseUp
      go to card id 61232
      end mouseUp
    * Part 68717:2 ""
      on mouseUp
      go to card id 64325
      end mouseUp
    * Part 68717:3 "left"
      on mouseUp
      go to card id 66650
      end mouseUp
    * Part 68717:4 "right"
      on mouseUp
      go to card id 66650
      end mouseUp
    * Part 68717:5 "marker"
  * Card 68289 "" (2 parts)
    * Part 68289:1 "left"
      on mouseUp
      go to card id 67709
      end mouseUp
    * Part 68289:2 "right"
      on mouseUp
      go to card id 68068
      end mouseUp
  * Card 67304 "" (3 parts)
    * Part 67304:3 "marker"
    * Part 67304:1 "down"
      on mouseUp
      go to card id 67498
      end mouseUp
    * Part 67304:2 ""
      on mouseUp
      go to card id 69187
      end mouseUp
  * Card 69187 "" (3 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    put empty into which
    if MY_ObserveAngle is 271 then put "Space" into which
    if MY_ObserveAngle is 83 then put "Gear" into which
    if MY_ObserveAngle is 129 then put "Boat" into which
    if MY_ObserveAngle is 152 then put "Tree" into which
    if which is not empty then
    show card button marker
    put bg field "pict name" & " " & which & "|" & the rect ¬
    of card button marker into pictAdd
    else
    hide card button marker
    end if
    pass openCard
    end openCard

    * Part 69187:1 ""
      on mouseUp
      go to card id 67304
      end mouseUp
    * Part 69187:3 "marker"
    * Part 69187:2 ""
      on mouseUp
      go to card id 68940
      end mouseUp
  * Card 68940 "" (5 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    put empty into which
    if MY_ObserveAngle is 271 then put "Space" into which
    if MY_ObserveAngle is 83 then put "Gear" into which
    if MY_ObserveAngle is 129 then put "Boat" into which
    if MY_ObserveAngle is 152 then put "Tree" into which
    if which is not empty then
    put bg field "pict name" & " " & which & "|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 68940:6 ""
    * Part 68940:2 ""
    * Part 68940:5 "marker"
      on mouseUp
      global  pictAdd, MY_ObserveAngle
      push card
      if MY_ObserveAngle is 271 then go card id 70509
      if MY_ObserveAngle is 83 then go card id 70175
      if MY_ObserveAngle is 129 then go card id 66100
      if MY_ObserveAngle is 152 then go card id 70908
      end mouseUp
    * Part 68940:1 "left"
      on mouseUp
      go to card id 87373
      end mouseUp
    * Part 68940:4 "right"
      on mouseUp
      go to card id 86555
      end mouseUp
  * Card 86555 "" (2 parts)
    * Part 86555:1 "left"
      on mouseUp
      go to card id 68940
      end mouseUp
    * Part 86555:2 "right"
      on mouseUp
      go to card id 69458
      end mouseUp
  * Card 66100 "" (2 parts)
    * Part 66100:1 ""
      on mouseUp
      vd
      pop card
      --go to card id 68940
      end mouseUp
    * Part 66100:2 ""
  * Card 70175 "" (2 parts)
    * Part 70175:1 ""
      on mouseUp
      vd
      pop card
      --go to card id 68940
      end mouseUp
    * Part 70175:2 ""
  * Card 70509 "" (2 parts)
    * Part 70509:1 ""
      on mouseUp
      vd
      pop card
      --go to card id 68940
      end mouseUp
    * Part 70509:2 ""
  * Card 70908 "" (2 parts)
    * Part 70908:1 ""
      on mouseUp
      vd
      pop card
      --go to card id 68940
      end mouseUp
    * Part 70908:2 ""
  * Card 69458 "" (5 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put  bg field "pict name" & " (slot)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 69458:1 "left"
      on mouseUp
      go to card id 86555
      end mouseUp
    * Part 69458:2 "right"
      on mouseUp
      go to card id 87373
      end mouseUp
    * Part 69458:3 "down"
      on mouseUp
      go to card id 69720
      end mouseUp
    * Part 69458:4 "marker"
    * Part 69458:5 "left"
      on mouseUp
      go to card id 86555
      end mouseUp
  * Card 87373 "" (2 parts)
    * Part 87373:1 "left"
      on mouseUp
      go to card id 69458
      end mouseUp
    * Part 87373:2 "right"
      on mouseUp
      go to card id 68940
      end mouseUp
  * Card 69720 "" (2 parts)
    * Part 69720:1 "up"
      on mouseUp
      go to card id 69458
      end mouseUp
    * Part 69720:2 ""
      on mouseUp
      go to card id 68289
      end mouseUp
  * Card 61932 "" (4 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put bg field "pict name" & " (slot)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 61932:4 "marker"
    * Part 61932:2 ""
      on mouseUp
      go to card id 62394
      end mouseUp
    * Part 61932:3 ""
      on mouseUp
      go to card id 61232
      end mouseUp
    * Part 61932:1 "down"
      on mouseUp
      go to card id 61232
      end mouseUp
  * Card 62394 "" (3 parts)

    on openCard
    global pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 then
    put bg field "pict name" & " (slot)|" & the rect ¬
    of card button marker into pictAdd
    end if
    if MY_ObserveAngle is 152 then
    put  bg field "pict name" & " (slot/tree)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 62394:4 "marker"
    * Part 62394:1 ""
      on mouseUp
      go to card id 62704
      end mouseUp
    * Part 62394:2 ""
      on mouseUp
      go to card id 61932
      end mouseUp
  * Card 62704 "" (3 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle, MY_Boat, MY_GearGate
    if MY_ObserveAngle is 271 then
    put  "ObservSlotSpace|" & the rect ¬
    of card button marker into pictAdd
    end if
    if MY_ObserveAngle is 152 then
    put "ObservSlotTree|" & the rect ¬
    of card button marker into pictAdd
    end if
    if MY_ObserveAngle is 83 then
    get "ObservSlotGear (" & MY_GearGate
    put it & ")|" & the rect ¬
    of card button marker into pictAdd
    end if
    if MY_ObserveAngle is 129 then
    get "ObservSlotBoat (" & MY_Boat
    put it & ")|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 62704:1 "right"
      on mouseUp
      go to card id 81698
      end mouseUp
    * Part 62704:2 "left"
      on mouseUp
      go to card id 86247
      end mouseUp
    * Part 62704:3 "marker"
  * Card 81698 "" (2 parts)
    * Part 81698:1 "left"
      on mouseUp
      go to card id 62704
      end mouseUp
    * Part 81698:2 "right"
      on mouseUp
      go to card id 62806
      end mouseUp
  * Card 62806 "" (4 parts)

    on openCard
    global  pictAdd, MY_ObserveAngle
    if MY_ObserveAngle is 271 or MY_ObserveAngle is 83 or ¬
    MY_ObserveAngle is 129 or MY_ObserveAngle is 152 then
    put  bg field "pict name" & " (code)|" & the rect ¬
    of card button marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 62806:1 "down"
      on mouseUp
      go to card id 63062
      end mouseUp
    * Part 62806:2 "right"
      on mouseUp
      go to card id 86247
      end mouseUp
    * Part 62806:3 "left"
      on mouseUp
      go to card id 81698
      end mouseUp
    * Part 62806:4 "marker"
  * Card 86247 "" (2 parts)
    * Part 86247:1 "left"
      on mouseUp
      go to card id 62806
      end mouseUp
    * Part 86247:2 "right"
      on mouseUp
      go to card id 62704
      end mouseUp
  * Card 63062 "" (2 parts)
    * Part 63062:1 ""
      on mouseUp
      go to card id 62806
      end mouseUp
    * Part 63062:2 ""
      on mouseUp
      go to card id 62129
      end mouseUp
  * Card 48938 "" (32 parts)
    * Part 48938:1 "`"
      on mouseUp
      stop using stack MYRes4
      go to card id 48883
      end mouseUp
    * Part 48938:2 ""
    * Part 48938:11 ""
      on mouseUp
      go to card id 76069
      end mouseUp
    * Part 48938:3 ""
      on mouseUp
      go to card id 73496
      end mouseUp
    * Part 48938:4 ""
      on mouseUp
      go to card id 74269
      end mouseUp
    * Part 48938:5 ""
      on mouseUp
      go to card id 74947
      end mouseUp
    * Part 48938:6 ""
      on mouseUp
      go to card id 75389
      end mouseUp
    * Part 48938:7 ""
      on mouseUp
      go to card id 79654
      end mouseUp
    * Part 48938:8 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:9 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:10 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:12 ""
      on mouseUp
      go to card id 76069
      end mouseUp
    * Part 48938:13 ""
      on mouseUp
      go to card id 76069
      end mouseUp
    * Part 48938:14 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:15 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:16 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:17 ""
      on mouseUp
      go to card id 84489
      end mouseUp
    * Part 48938:18 ""
      on mouseUp
      go to card id 84489
      end mouseUp
    * Part 48938:19 ""
      on mouseUp
      go to card id 84489
      end mouseUp
    * Part 48938:20 ""
      on mouseUp
      go to card id 84489
      end mouseUp
    * Part 48938:21 ""
      on mouseUp
      go to card id 84489
      end mouseUp
    * Part 48938:23 ""
      on mouseUp
      go to card id 76069
      end mouseUp
    * Part 48938:24 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:25 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:26 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:27 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:28 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:29 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:30 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:31 ""
      on mouseUp
      go to card id 85075
      end mouseUp
    * Part 48938:32 ""
      on mouseUp
      go to card id 83883
      end mouseUp
    * Part 48938:33 ""
      on mouseUp
      go to card id 84489
      end mouseUp
  * Card 85075 "" (2 parts)
    * Part 85075:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 85075:2 ""
      on mouseUp
      HTVisual "wipe left",,,1
      go to card id 85465
      end mouseUp
  * Card 85465 "" (2 parts)
    * Part 85465:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 85465:2 ""
  * Card 84489 "" (2 parts)
    * Part 84489:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 84489:2 ""
      on mouseUp
      htvisual "wipe left",,,1
      go to card id 84836
      end mouseUp
  * Card 84836 "" (2 parts)
    * Part 84836:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 84836:2 ""
  * Card 76069 "" (2 parts)
    * Part 76069:2 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 76069:1 ""
      on mouseUp
      HTVisual "wipe left",,,1
      go to card id 84241
      end mouseUp
  * Card 84241 "" (2 parts)
    * Part 84241:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 84241:2 ""
  * Card 83051 "" (3 parts)
    * Part 83051:3 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 83051:1 ""
      on mouseDown
      get last word of field "pict name"
      repeat while the mouse is down
      subtract 1 from it
      if it ≥ 1 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe right",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mouseDown
    * Part 83051:2 ""
      on mousedown
      get last word of field "pict name"
      repeat while the mouse is down
      add 1 to it
      if it ≤ 13 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe left",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mousedown
  * Card 83883 "" (2 parts)
    * Part 83883:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 83883:2 ""
      on mouseUp
      HTVisual "wipe left",,,1
      go to card id 84121
      end mouseUp
  * Card 84121 "" (2 parts)
    * Part 84121:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 84121:2 ""
  * Card 79654 "" (2 parts)
    * Part 79654:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 79654:2 ""
      on mouseUp
      global MY_FirePage
      put 1 into MY_FirePage
      set lockmessages to true
      htlock true
      htvisual "wipe left",,,1
      go to card id 80097
      set lockmessages to false
      openCard
      go card
      end mouseUp
  * Card 80097 "" (4 parts)
    * Part 80097:5 "pagechange"
    * Part 80097:1 ""
      on mouseUp
      
      go to card id 48938
      end mouseUp
    * Part 80097:4 "none"
      on mousedown
      put 1 into num
      turn num
      repeat until the mouse is up
      add 1 to num
      if num > 5 then put 5 into pages
      else put 1 into pages
      turn pages
      end repeat
      end mousedown
      
      on turn count
      set the numberformat to "000"
      global MY_FirePage
      get MY_FirePage
      if it > 1  then
      subtract count from it
      if it < 1 then get 1
      put "Patterns " & it into WhichPict
      HTlock "true"
      HTVisual "wipe right",,,1
      HTAddPict WhichPict,the rect of card button "pagechange","srccopy"
      play stop
      put random(2) into x
      if x = 1 then play cpage1
      else play cpage2
      HTLock "forcefalse"
      put it into MY_FirePage
      soundidle
      end if
      end turn
    * Part 80097:3 "none"
      on mousedown
      put 1 into num
      turn num
      repeat until the mouse is up
      add 1 to num
      if num > 5 then put 5 into pages
      else put 1 into pages
      turn pages
      end repeat
      end mousedown
      
      on turn count
      set the numberformat to "000"
      global MY_FirePage
      get MY_FirePage
      if it < 150 then
      add count to it
      if it > 150 then get 150
      put "Patterns " & it into WhichPict
      htlock "true"
      HTVisual "wipe left",,,1
      HTAddPict WhichPict,the rect of card button "pagechange","srccopy"
      play stop
      put random(2) into x
      if x = 1 then play cpage1
      else play cpage2
      htlock "forcefalse"
      put it into MY_FirePage
      soundidle
      end if
      end turn
  * Card 75389 "" (2 parts)
    * Part 75389:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 75389:2 ""
      on mouseUp
      set lockmessages to true
      go to card id 83051
      put 1 into last word of field "pict name"
      set lockmessages to false
      htvisual "wipe left",,,1
      openCard
      go card
      end mouseUp
  * Card 75735 "" (2 parts)
    * Part 75735:1 ""
      on mouseUp
      go to card id 75389
      end mouseUp
    * Part 75735:2 ""
  * Card 74947 "" (2 parts)
    * Part 74947:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 74947:2 ""
      on mouseUp
      set lockmessages to true
      go to card id 75053
      put 1 into last word of field "pict name"
      set lockmessages to false
      HTVisual "wipe left",,,1
      openCard
      go card
      end mouseUp
  * Card 75053 "" (3 parts)
    * Part 75053:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 75053:2 ""
      on mousedown
      get last word of field "pict name"
      repeat while the mouse is down
      add 1 to it
      if it ≤ 8 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe left",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mousedown
    * Part 75053:3 ""
      on mouseDown
      get last word of field "pict name"
      repeat while the mouse is down
      subtract 1 from it
      if it ≥ 1 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe right",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mouseDown
  * Card 74269 "" (2 parts)
    * Part 74269:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 74269:2 ""
      on mouseUp
      set numberformat to "00"
      set lockmessages to true
      go to card id 74738
      put 1 into last word of field "pict name"
      set lockmessages to false
      HTVisual "wipe left",,,1
      openCard
      go card
      end mouseUp
  * Card 74738 "" (3 parts)
    * Part 74738:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 74738:2 ""
      on mouseDown
      set numberformat to "00"
      get last word of field "pict name"
      repeat while the mouse is down
      subtract 1 from it
      if it ≥ 1 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe right",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mouseDown
    * Part 74738:3 ""
      on mousedown
      set numberformat to "00"
      get last word of field "pict name"
      repeat while the mouse is down
      add 1 to it
      if it ≤ 12 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe left",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mousedown
  * Card 73496 "" (2 parts)
    * Part 73496:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 73496:2 ""
      on mouseUp
      set lockmessages to true
      go to card id 73926
      put 1 into last word of field "pict name"
      set lockmessages to false
      HTVisual "wipe left",,,1
      openCard
      go card
      end mouseUp
  * Card 73926 "" (3 parts)
    * Part 73926:1 ""
      on mouseUp
      go to card id 48938
      end mouseUp
    * Part 73926:2 ""
      on mousedown
      get last word of field "pict name"
      repeat while the mouse is down
      add 1 to it
      if it ≤ 14 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe left",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mousedown
    * Part 73926:4 ""
      on mouseDown
      get last word of field "pict name"
      repeat while the mouse is down
      subtract 1 from it
      if it ≥ 1 then
      put it into last word of field "pict name"
      htlock true
      HTVisual "wipe right",,,1
      put random(2) into x
      if x = 1 then dplay cpage1
      else dplay cpage2
      opencard
      end if
      end repeat
      end mouseDown
  * Card 46739 "" (7 parts)

    on mouseDownInMovie
    click at the mouseloc
    end mousedowninMovie
    
    on closeCard
    htlock "true"
    end closeCard
    
    on idle
    get "LibraryStairsDown.MooV"
    if there is a window it then close window it
    pass idle
    end idle
    
    on openCard
    global pictAdd,MY_LibStairs,MY_RedBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "Library1-NE B" into field "pict name"
    else
    put "Library1-NE" into field "pict name"
    end if
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "StairsDown" then
    put " StairsDown" after field "pict name"
    end if
    else
    if last word of field "pict name" is "StairsDown" then
    delete last word of field "pict name"
    end if
    end if
    if DU_End ≠ "win" then
    if char 1 of MY_RedBook is "0" and char 1 to 3 of ALL_Page is not "1,S" then
    get field "pict name"
    if last word of it is "StairsDown" then delete last word of it
    put it & " (RedPage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    end if
    --if there is a window "LibraryStairsDown.MooV" then close window "LibraryStairsDown.MooV"
    pass openCard
    end openCard

    * Part 46739:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 46739:5 "marker"
    * Part 46739:1 "left"
      on mouseUp
      go to card id 28679
      end mouseUp
    * Part 46739:2 "right"
      on mouseUp
      go to card id 47833
      end mouseUp
    * Part 46739:3 ""
      on mouseUp
      go to card id 48589
      loadmoov
      end mouseUp
    * Part 46739:7 ""
      on mouseUp
      go to card id 50447
      end mouseUp
    * Part 46739:8 ""
      on mouseUp
      go to card id 48883
      end mouseUp
  * Card 75919 "" (2 parts)

    on openCard
    global pictAdd,MY_RedBook,DU_End
    if DU_End = "win" then
    put "Library1-NE B interim" into field "pict name"
    else
    put "Library1-NE interim" into field "pict name"
    if char 1 of MY_RedBook is "0" then put "Library1-NE (RedPage)|" & the rect of card button Marker into pictAdd
    end if
    pass openCard
    end openCard
    
    on Stairs
    put "LibraryStairsDown.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "stairs","invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    set the passMovieClick of window theMovieName to false
    show window TheMovieName
    set the rate of window TheMovieName to "1.0"
    play "DR LibStairs Down"
    repeat until the rate of window TheMovieName is 0
    send movieIdle to window TheMovieName
    end repeat
    end if
    end Stairs

    * Part 75919:1 "marker"
    * Part 75919:2 "stairs"
      on mouseUp
      
      end mouseUp
  * Card 48589 "" (2 parts)

    on closeCard
    put "LibraryTwist.MooV" into TheMovieName
    if there is a window TheMovieName then close window TheMovieName
    end closeCard
    
    on loadmoov
    global MY_LibStairs
    if MY_LibStairs is "up" then
    put "LibraryTwist.MooV" into TheMovieName
    if there is not a window TheMovieName then
    soundidle
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button "picture","invisible","Floating"
    soundidle
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    set the passMovieClick of window theMovieName to false
    set the rate of window theMovieName to "0.0"
    end if
    end if
    end loadmoov

    * Part 48589:1 ""
      on mouseUp
      htlock "true"
      go to card id 46739
      end mouseUp
    * Part 48589:2 "picture"
      On mouseWithin
      global ALL_Cursor,Quick
      get the short name of the target
      if Quick is true then
      get 1002
      if it ≠ ALL_Cursor then
      deCurse "override",1002,"color","nodelay"
      put it into ALL_Cursor
      end if
      end if
      end mouseWithin
      
      on mousedown
      global MY_LibStairs,Quick
      set cursor to none
      if MY_LibStairs is "up" then
      soundStop
      Twist
      htlock "true"
      if Quick is "true" then
      play "DR LibStairs Up"
      put "down" into MY_LibStairs
      dplay "DR LibStairs Thump"
      go to card id 46739
      playQT "MR Elev Room Loud MoV",,loop,30
      else
      go to card id 75919
      put "down" into MY_LibStairs
      stairs
      go to card id 46739
      playQT "MR Elev Room Loud MoV",,loop,30
      end if
      else
      play "SW Buzzer"
      wait 15
      wait until the mouse is up
      play stop
      end if
      wait while the mouseclick
      end mousedown
      
      on Twist
      put "LibraryTwist.MooV" into TheMovieName
      if there is a window TheMovieName then
      play "TN Crtyd Pilars"
      show window TheMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window TheMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      close window TheMovieName
      end if
      end Twist
  * Card 48298 "" (7 parts)

    on openCard
    global pictAdd,MY_RedBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "Library1-N B" into field "pict name"
    else
    put "Library1-N" into field "pict name"
    if char 1 of MY_RedBook is "0" and char 1 to 3 of ALL_Page is not "1,S" then
    put field "pict name" & " (RedPage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    end if
    pass openCard
    end openCard

    * Part 48298:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 48298:5 "marker"
    * Part 48298:3 ""
      on mouseUp
      go to card id 50447
      end mouseUp
    * Part 48298:1 "right"
      on mouseUp
      go to card id 46439
      end mouseUp
    * Part 48298:2 "left"
      on mouseUp
      go to card id 46851
      end mouseUp
    * Part 48298:6 ""
      on mouseUp
      go to card id 59640
      end mouseUp
    * Part 48298:7 ""
      on mouseUp
      go to card id 48589
      loadmoov
      end mouseUp
  * Card 50447 "" (3 parts)

    on openCard
    global pictAdd,MY_RedBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "Library2-N B" into field "pict name"
    else
    put "Library2-N" into field "pict name"
    if char 1 of MY_RedBook is "0" and char 1 to 3 of ALL_Page is not "1,S" then
    put  field "pict name" & " (RedPage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    end if
    pass openCard
    end openCard
    
    on GrabPage which
    global MY_RedBook,ALL_Page
    if char which of MY_RedBook is "0" then
    if char 1 to 3 of ALL_Page is not (which & ",S") then
    put which & ",S,0" into ALL_Page
    set icon of the target to 20001
    else
    put empty into ALL_Page
    set icon of the target to 20000
    end if
    end if
    end GrabPage

    * Part 50447:16 ""
      on mouseUp
      go to card id 48298
      end mouseUp
    * Part 50447:2 "book"
      on mouseUp
      global ALL_Page,MY_Book,MY_RedBook,DU_end
      if DU_end is not "win" then
      if ALL_Page is not empty then
      if item 2 of ALL_Page = "S" then
      put item 1 of ALL_Page into whichPage
      --HyperCursor "Hand",1
      put empty into ALL_Page
      put 1 into char whichPage of MY_RedBook
      play "PutPage"
      end if
      end if
      -- go to either open book or END GAME
      if char 6 of MY_RedBook = "1" then go card id 80371
      else go to card id 72326
      end if
      dropState
      end mouseUp
    * Part 50447:4 "marker"
      on MouseDown
      global MY_RedBook,ALL_Page
      put the loc of me into origLoc
      if char 1 of MY_RedBook is "0" then
      if char 1 to 3 of ALL_Page is not "1,S" then
      if ALL_Page is not empty then dropPage
      put "1,S,0" into ALL_Page
      htlock true
      opencard
      UpdateCursor
      else
      put empty into ALL_Page
      UpdateCursor
      HTAddPict "Library2-N (RedPage)",the rect of card button Marker,"srccopy"
      end if
      end if
      dropState
      end MouseDown
  * Card 80371 "SirrusLose" (1 parts)

    on openCard
    htlock nobw
    fadeout
    pass openCard
    end openCard
    
    on idle
    get "SirrusLose.MooV"
    if there is not a window it then Sirrus
    end idle
    
    on closeCard
    global MY_Mechanical
    put true into MY_Mechanical
    put "SirrusLose.MooV" into TheMovieName
    if TheMovieName is in the windows then close window TheMovieName
    pass closeCard
    end closeCard
    
    on Sirrus
    put "SirrusLose.MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the callBackMsg of window theMovieName to "Done"
    --set the callBackTime of window theMovieName to "20.0"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    end if
    end Sirrus
    
    --on done
    --set the startTime of window "SirrusLose.MooV" to "46,00"
    --set the endTime of window TheMovieName to "47,0"
    --end done

    * Part 80371:1 "marker"
  * Card 72326 "" (2 parts)
    * Part 72326:1 ""
      on mouseUp
      go to card id 50447
      end mouseUp
    * Part 72326:2 ""
      on mouseUp
      soundstop
      HTVisual "wipe left",,,1
      go to card id 73249
      get "SirrusPage" & RedMooV() & ".MooV"
      if there is not a window it then Sirrus
      end mouseUp
  * Card 73249 "" (3 parts)

    function RedMooV
    global MY_RedBook
    if char 7 of MY_RedBook = "E" then
    return "Extra"
    else
    put 0 into thecount
    repeat with x = 1 to 6
    add char x of MY_RedBook to theCount
    end repeat
    return "Page" & theCount
    end if
    end RedMooV
    
    on closeCard
    global MY_LibStairs,MY_RedBook
    put "Sirrus" & RedMooV() & ".MooV" into TheMovieName
    if there is a window TheMovieName then close window TheMovieName
    if MY_LibStairs is up then playQT "AR Lite Wind MoV",,loop,30
    else playQT "MR Elev Room Loud MoV",,loop,30
    if RedMooV() = "Page5" then put "E" into char 7 of MY_RedBook
    pass closeCard
    end closeCard
    
    on Sirrus
    put "Sirrus" & RedMooV() & ".MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    if last char of RedMooV() = 0 then
    set the loop of window TheMovieName to true
    set the closeOnFinish of window TheMovieName to false
    set the startTime of window TheMovieName to "0,0"
    set the endTime of window TheMovieName to "10,0"
    else
    set the loop of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to true
    deCurse "override","hand","color","nodelay"
    set the fastidle of window TheMovieName to true
    end if
    set the seeAllFrames of window TheMovieName to false
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    show window TheMovieName
    set the rate of window TheMovieName to "1.0"
    if last char of RedMooV() = 0 then
    repeat until item 1 of the currTime of window TheMovieName > 3
    send movieIdle to window theMovieName
    end repeat
    set the startTime of window TheMovieName to "2,0"
    end if
    end if
    end Sirrus

    * Part 73249:1 ""
      on mouseUp
      htlock true
      go to card id 50447
      end mouseUp
    * Part 73249:2 ""
    * Part 73249:3 "marker"
  * Card 28679 "" (6 parts)

    on openCard
    play stop
    global MY_LibStairs,DU_End
    if DU_End is "win" then
    put "Library1-NW B" into field "pict name"
    else
    put "Library1-NW" into field "pict name"
    end if
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "DoorDown" then
    put " DoorDown" after field "pict name"
    end if
    else
    if last word of field "pict name" is "DoorDown" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 28679:6 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 28679:3 "left"
      on mouseUp
      go to card id 47338
      end mouseUp
    * Part 28679:4 "right"
      on mouseUp
      go to card id 46739
      end mouseUp
    * Part 28679:5 ""
      on mouseUp
      go to card id 59640
      end mouseUp
    * Part 28679:7 ""
      on mouseUp
      go to card id 49958
      end mouseUp
    * Part 28679:8 ""
      on mouseUp
      go to card id 50447
      end mouseUp
  * Card 59640 "" (2 parts)
    * Part 59640:1 ""
      on mouseUp
      go to card id 28679
      end mouseUp
    * Part 59640:2 ""
      on mouseUp
      global MapFlag
      soundstop
      put false into MapFlag
      go to card id 50330
      end mouseUp
  * Card 50330 "" (16 parts)

    on idle
    global MapFlag,Flasher
    if MapFlag is not true then
    Markers
    put true into MapFlag
    end if
    if the sound is "GR Tower Rotate Mix" then
    HTAddPict "MapTow1",the rect of card button "none","srccopy"
    put true into Flasher
    else
    if flasher is false then
    HTAddPict "MapTow1",the rect of card button "none","srccopy"
    put true into Flasher
    wait 5
    --play "SW GenLights On"
    else
    HTAddPict "MapTowClear",the rect of card button "none","srccopy"
    put false into Flasher
    --play stop
    end if
    end if
    end idle
    
    on Markers
    global pictAdd
    htlock true
    global MY_PlaMarker,MY_ShiMarker,MY_CloMarker,MY_GarMarker,MY_GeaMarker,MY_DocMarker,MY_MinMarker,MY_CabMarker
    put "MapLib1|" & the rect of card button Lib1 & return into pictAdd
    if MY_PlaMarker is "on" then
    put "MapPla1|" & the rect of card button Pla1 & return after pictAdd
    put "MapPla2|" & the rect of card button Pla2 & return after pictAdd
    end if
    if MY_ShiMarker is "on" then
    put "MapShi1|" & the rect of card button Shi1 & return after pictAdd
    end if
    if MY_CloMarker is "on" then
    put "MapClo1|" & the rect of card button Clo1 & return after pictAdd
    end if
    if MY_GarMarker is "on" then
    put "MapGar1|" & the rect of card button Gar1 & return after pictAdd
    put "MapGar2|" & the rect of card button Gar2 & return after pictAdd
    end if
    if MY_GeaMarker is "on" then
    put "MapGea1|" & the rect of card button Gea1 & return after pictAdd
    end if
    if MY_DocMarker is "on" then
    put "MapDoc1|" & the rect of card button Doc1 & return after pictAdd
    end if
    if MY_MinMarker is "on" then
    put "MapMin1|" & the rect of card button Min1 & return after pictAdd
    end if
    if MY_CabMarker is "on" then
    put "MapCab1|" & the rect of card button Cab1 & return after pictAdd
    end if
    dplay "EL Sharphum"
    openCard
    go card
    end Markers

    * Part 50330:1 "fullRegion"
      on mouseUp
      global MY_LibStairs
      if the sound is "done" then dplay "SW Kachunk"
      xline "0,0","0,0",1,1
      opencard
      go to card id 59640
      if MY_LibStairs is up then playQT "AR Lite Wind MoV",,loop,30
      else playQT "MR Elev Room Loud MoV",,loop,30
      end mouseUp
    * Part 50330:16 ""
    * Part 50330:17 "ClipRegion"
    * Part 50330:3 "Clo1"
    * Part 50330:5 "Pla1"
    * Part 50330:6 "Doc1"
    * Part 50330:7 "Gea1"
    * Part 50330:8 "Gar1"
    * Part 50330:10 "Shi1"
    * Part 50330:11 "Lib1"
    * Part 50330:12 "Cab1"
    * Part 50330:13 "Pla2"
    * Part 50330:14 "none"
      on mouseWithin
      deCurse "override",2003,"color","nodelay"
      end mouseWithin
      
      on mouseDown
      global MY_ObserveAngle,MY_ShiMarker,MY_GeaMarker,MY_DocMarker,MY_CabMarker
      xclip the rect of card button clipRegion
      deCurse "override",2004,"color","nodelay"
      HTAddPict "MapTow1",the rect of card button "none","srccopy"
      htlock true
      HTVisual "scroll down",,the rect of card button "theText",5,4
      HTAddPict "Map - TowerRotation",the rect of card button "theText","srccopy"
      htlock forcefalse
      --put loc of card button cover into origLoc
      put MY_ObserveAngle into theAngle
      put 30 into color
      get theAngle
      if (it ≥ 264 and it ≤ 278 and MY_ShiMarker is "on") or ¬
      (it ≥ 76 and it ≤ 90 and MY_GeaMarker is "on") or ¬
      (it ≥ 123 and it ≤ 136 and MY_DocMarker is "on") or ¬
      (it ≥ 145 and it ≤ 159 and MY_CabMarker is "on") then put 137 into color
      plotLine theAngle,color
      put 0 into incr
      get theAngle
      play stop
      repeat
      add trunc(incr) to theAngle
      if theAngle > 360 then put theAngle - 360 into theAngle
      get theAngle
      put 137 into color
      if it ≥ 264 and it ≤ 278 and MY_ShiMarker is "on" then
      get 271
      put 1 into incr
      else if it ≥ 76 and it ≤ 90 and MY_GeaMarker is "on" then
      get 83
      put 1 into incr
      else if it ≥ 123 and it ≤ 136 and MY_DocMarker is "on" then
      get 129
      put 1 into incr
      else if it ≥ 145 and it ≤ 159 and MY_CabMarker is "on" then
      get 152
      put 1 into incr
      else
      put 30 into color
      end if
      wait 2
      if it ≠ oldIt then
      set the visible of card button clipRegion to not the visible of card button clipRegion
      plotLine it,color
      put it into oldIt
      end if
      if the sound is "done" then play "EL Tower Mtr" tempo 328  c c c c c c c c c c c c c c c c c
      add 1 to incr
      if incr > 7 then put 7 into incr
      
      if the mouse is up then
      play stop
      if it ≠ MY_ObserveAngle then Play "GR Tower Rotate Mix"
      put the ticks into theStart
      put false into flag
      deCurse "override",2003,"color","nodelay"
      repeat until the sound is "done"
      if the mouse is down then
      put it into MY_ObserveAngle
      if the clickloc is within the rect of me then
      put 1 into incr
      put true into flag
      play stop
      exit repeat
      else
      xclip the rect of card button fullRegion
      htlock true
      HTVisual "scrollAway down",,the rect of card button "theText",5,4
      HTAddPict "Map - (BlankWords)",the rect of card button "theText","srccopy"
      htlock forcefalse
      show card button clipRegion
      xclip the rect of card button fullRegion
      click at the clickLoc
      exit mouseDown
      end if
      end if
      HTAddPict "Map - (BlankWords)",the rect of card button "theText","srccopy"
      wait 10
      HTAddPict "Map - TowerRotation",the rect of card button "theText","srccopy"
      wait 10
      end repeat
      if flag is false then exit repeat
      end if
      end repeat
      go card
      put it into MY_ObserveAngle
      htlock true
      HTVisual "scrollAway down",,the rect of card button "theText",5,4
      HTAddPict "Map - (BlankWords)",the rect of card button "theText","srccopy"
      htlock forcefalse
      show card button clipRegion
      xclip the rect of card button fullRegion
      end mouseDown
      
      on plotLine angle, color
      put (angle * pi) / 180 into angle
      put trunc(310 * cos(angle)) into x
      put trunc(310 * sin(angle)) into y
      get the loc of card button "none"
      put it into thePoint
      add x to item 1 of thePoint
      add y to item 2 of thePoint
      if color is 30 then xLine it,thePoint,1,color
      else xLine it,thePoint,2,color
      end plotLine
    * Part 50330:4 "Min1"
    * Part 50330:9 "Gar2"
    * Part 50330:18 "theText"
  * Card 46851 "qcen" (6 parts)

    on openCard
    global MY_LibStairs
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "DoorDown" then
    put " DoorDown" after field "pict name"
    end if
    playQT "MR Elev Room Loud MoV",,loop,30
    else
    if last word of field "pict name" is "DoorDown" then
    delete last word of field "pict name"
    end if
    playQT "AR Lite Wind MoV",,loop,30
    end if
    pass openCard
    end openCard

    * Part 46851:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 46851:1 "left"
      on mouseUp
      go to card id 47448
      end mouseUp
    * Part 46851:2 "right"
      on mouseUp
      go to card id 48298
      end mouseUp
    * Part 46851:3 ""
      on mouseUp
      go to card id 49958
      end mouseUp
    * Part 46851:5 ""
      on mouseUp
      go to card id 59640
      end mouseUp
    * Part 46851:6 ""
      on mouseUp
      go to card id 49781
      end mouseUp
  * Card 49958 "" (5 parts)

    on openCard
    global MY_LibStairs
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "DoorDown" then
    put " DoorDown" after field "pict name"
    show card button DoorBlock
    end if
    else
    if last word of field "pict name" is "DoorDown" then
    delete last word of field "pict name"
    hide card button DoorBlock
    end if
    end if
    pass openCard
    end openCard

    * Part 49958:1 "left"
      on mouseUp
      go to card id 47338
      end mouseUp
    * Part 49958:2 ""
    * Part 49958:3 ""
      on mouseUp
      soundstop
      go to card id 11357
      playQT "AR Lite Wind MoV",,loop,180
      xMemory(1)
      end mouseUp
    * Part 49958:4 "doorBlock"
    * Part 49958:5 "right"
      on mouseUp
      go to card id 28679
      end mouseUp
  * Card 47338 "" (7 parts)

    on openCard
    global pictAdd,MY_LibStairs,MY_BlueBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "Library1-SW B" into field "pict name"
    else
    put "Library1-SW" into field "pict name"
    end if
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "DoorDown" then
    put " DoorDown" after field "pict name"
    end if
    else
    if last word of field "pict name" is "DoorDown" then
    delete last word of field "pict name"
    end if
    end if
    if DU_End ≠ "win" then
    if char 1 of MY_BlueBook is "0" and char 1 to 3 of ALL_Page is not "1,A" then
    get field "pict name"
    if last word of it is "DoorDown" then delete last word of it
    put it & " (BluePage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    end if
    pass openCard
    end openCard

    * Part 47338:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 47338:5 "marker"
    * Part 47338:1 "left"
      on mouseUp
      go to card id 47833
      end mouseUp
    * Part 47338:2 "right"
      on mouseUp
      go to card id 28679
      end mouseUp
    * Part 47338:3 ""
      on mouseUp
      go to card id 49781
      end mouseUp
    * Part 47338:6 ""
      on mouseUp
      go to card id 49958
      end mouseUp
    * Part 47338:7 ""
      on mouseUp
      go to card id 49518
      end mouseUp
  * Card 49781 "" (3 parts)
    * Part 49781:1 ""
      on mouseUp
      go to card id 47338
      end mouseUp
    * Part 49781:2 ""
    * Part 49781:3 "none"
      on mouseUp
      playQT "MR Elev Room Loud MoV",,loop,20
      vd
      go to card id 87741
      htlock true
      vs left
      go to card id 56926
      end mouseUp
  * Card 87741 "" (0 parts)
  * Card 80468 "" (0 parts)
  * Card 56926 "" (4 parts)

    on openCard
    global pictAdd,MY_LibStairs,MY_RedBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "FirePlace1-NE DoorUp BurntBook" into field "pict name"
    else
    put "FirePlace1-NE DoorUp" into field "pict name"
    if char 1 of MY_RedBook is "0" and char 1 to 3 of ALL_Page is not "1,S" then
    get field "pict name"
    put "(RedPage)|" into last word of it
    put it & the rect ¬
    of card button Marker1 & return into pictAdd
    end if
    end if
    if MY_LibStairs is "down" then
    put "FirePlace1-NE (StairsDown)|" & the rect ¬
    of card button Marker2 after pictAdd
    end if
    pass openCard
    end openCard

    * Part 56926:3 "marker1"
    * Part 56926:4 "marker2"
    * Part 56926:1 "theDoor"
      on mouseUp
      global MY_LibStairs
      if MY_LibStairs is up then playQT "AR Lite Wind MoV",,loop,30
      else playQT "MR Elev Room Loud MoV",,loop,30
      go to card id 46739
      end mouseUp
    * Part 56926:2 ""
      on mouseDown
      play "SW PushButton In"
      get the loc of me
      xCIcon3 it,4001
      wait until the mouse is up
      play "SW PushButton Out"
      go card
      play stop
      dplay "DR FrplDr Dn"
      HTVisual "scroll down",,the rect of card button theDoor,2,32
      go to card id 61587
      go to card id 63906
      play stop
      play "EL SharpHum"
      end mouseDown
  * Card 63906 "" (50 parts)

    on FireButton
    get the loc of the target
    play stop
    play "AR FirePlacePuzzle In"
    if the short name of the target is "o" then
    put 3016 into x
    repeat until x < 3001
    xCIcon3 it,x
    wait 1
    subtract 3 from x
    end repeat
    set the name of the target to "x"
    else
    put 3002 into x
    repeat until x > 3017
    xCIcon3 it,x
    wait 1
    add 3 to x
    end repeat
    set the name of the target to "o"
    end if
    end FireButton
    
    on clearButton
    repeat with x = 2 to 49
    set the name of card button x to "x"
    end repeat
    end clearButton
    
    on openCard
    clearButton
    pass openCard
    end openCard
    
    function checkButton
    get empty
    repeat with x = 2 to 49
    put the short name of card button x after it
    end repeat
    if it = "oxoxxooxxoxxxxxoxxxooooxxxoxxxxxooxxoxooxxxoxxxx" then return true
    else if it = "ooxxxxooxooxoxoooxoxxxoooxxoxxooooxxooxxoooooxox" then return true
    else return false
    end checkButton

    * Part 63906:1 "x"
      on mouseDown
      get the loc of me
      xCIcon3 it,4002
      play "SW PushButton In"
      wait until the mouse is up
      play "SW PushButton Out"
      go card
      
      put checkButton() into doTurn
      if doTurn then
      soundstop
      play "MR FrplRotate Start"
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      Rotate
      play stop
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      repeat until the rate of window "FirePlace1-NE.MooV" is 0
      send movieIdle to window "FirePlace1-NE.MooV"
      end repeat
      --set the currTime of window "FirePlace1-NE.MooV" to "3,45"
      go to card id 65888
      hide window "FirePlace1-NE.MooV"
      close window "FirePlace1-NE.MooV"
      play stop
      play "MR FrplRotate End"
      wait until the sound is "done"
      htlock "true"
      HTVisual "scrollaway up",,the rect of card button theDoor,2,32
      play "DR FrplDr Up"
      go to card id 71909
      else
      go to card id 61587
      play "SW BreakerClose"
      dplay "DR FrplDr Up"
      HTVisual "scrollaway up",,the rect of card button theDoor,2,32
      go to card id 56926
      playQT "MR Elev Room Loud MoV",,loop,20
      end if
      end mouseDown
      
      on Rotate
      global ST_book, theMovieName
      put "FirePlace1-NE.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      set cursor to none
      Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "0"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "0"
      set the currTime of window TheMovieName to "0"
      set the endTime of window TheMovieName to "3,45"
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "1.0"
      show window TheMovieName
      end if
      end Rotate
    * Part 63906:2 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:3 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:4 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:5 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:6 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:7 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:8 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:9 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:10 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:11 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:12 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:13 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:14 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:15 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:16 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:17 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:18 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:19 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:20 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:21 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:22 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:23 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:24 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:25 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:26 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:27 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:28 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:29 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:30 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:31 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:33 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:34 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:35 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:36 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:37 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:38 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:39 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:40 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:41 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:42 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:43 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:44 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:45 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:46 "o"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:47 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:48 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:49 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:50 "x"
      on mousedown
      FireButton
      end mousedown
    * Part 63906:51 "marker"
      on mousedown
      FireButton
      end mousedown
  * Card 61587 "" (2 parts)
    * Part 61587:2 "theDoor"
    * Part 61587:1 ""
      on mouseUp
      go to card id 56926
      end mouseUp
  * Card 65888 "" (2 parts)
    * Part 65888:2 "theDoor"
    * Part 65888:1 "marker"
  * Card 71909 "" (5 parts)

    on openCard
    global pictAdd,ALL_Page,DU_End
    put field "pict name" into thePict
    delete last word of thePict
    if DU_End is "win" then
    put thePict & " (noRed)|" & the rect of card button redPage¬
    & return into pictAdd
    put thePict & " (noBlue)|" & the rect of card button bluePage¬
    & return after pictAdd
    else if char 1 to 3 of ALL_Page is "6,S" then
    put  thePict & " (noRed)|" & the rect ¬
    of card button redPage into pictAdd
    else if char 1 to 3 of ALL_Page is "6,A" then
    put  thePict & " (noBlue)|" & the rect ¬
    of card button bluePage into pictAdd
    end if
    pass openCard
    end openCard

    * Part 71909:5 "theDoor"
    * Part 71909:1 ""
      on mouseDown
      play "SW PushButton In"
      get the loc of me
      xCIcon3 it,4002
      wait until the mouse is up
      play "SW PushButton Out"
      play "DR FrplDr Dn"
      HTVisual "scroll down",,the rect of card button theDoor,2,32
      go card id 65888
      play "MR FrplRotate Start"
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      Rotate
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      play "MR FrplRotate Mid"
      repeat until the rate of window "FirePlace1-NE.MooV" is 0
      send movieIdle to window "FirePlace1-NE.MooV"
      end repeat
      go to card id 63906
      hide window "FirePlace1-NE.MooV"
      close window "FirePlace1-NE.MooV"
      play stop
      play "MR FrplRotate End"
      end mouseDown
      
      on Rotate
      global ST_book, theMovieName
      put "FirePlace1-NE.MooV" into TheMovieName
      if there is not a window TheMovieName then
      set cursor to none
      Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "0"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "3,40"
      set the currTime of window TheMovieName to "3,40"
      set the endTime of window TheMovieName to the duration of window TheMovieName
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "1.0"
      show window TheMovieName
      end if
      end Rotate
    * Part 71909:2 "redpage"
      on MouseDown
      global ALL_Page,DU_End
      if DU_End ≠ "win" then
      if char 1 to 3 of ALL_Page is not "6,S" then
      if ALL_Page is not empty then dropPage
      put "6,S,0" into ALL_Page
      else
      put empty into ALL_Page
      end if
      openCard
      go card
      dropState
      end if
      end MouseDown
    * Part 71909:3 "bluepage"
      on MouseDown
      global ALL_Page,DU_End
      if DU_End ≠ "Win" then
      if char 1 to 3 of ALL_Page is not "6,A" then
      if ALL_Page is not empty then dropPage
      put "6,A,0" into ALL_Page
      else
      put empty into ALL_Page
      end if
      openCard
      go card
      dropState
      end if
      end MouseDown
    * Part 71909:4 ""
      on mouseUp
      go to card id 23753
      end mouseUp
  * Card 23753 "" (2 parts)
    * Part 23753:1 ""
      on mouseUp
      go to card id 71909
      end mouseUp
    * Part 23753:2 ""
      on mouseUp
      fadeout
      go to card id 28552
      end mouseUp
  * Card 28552 "" (3 parts)

    on idle
    if there is not a window "AtrusBook1.MooV" and ¬
    there is not a window "AtrusBook2.MooV" then Atrus
    end idle
    
    on mouseDownInMovie
    set cursor to none
    --deCurse "override",2003,"color","nodelay"
    htlock true
    put "AtrusBook2.MooV" into TheMovieName
    if there is a window TheMovieName then
    send pause to window theMovieName
    hide window TheMovieName
    end if
    put "AtrusBook1.MooV" into TheMovieName
    if there is a window TheMovieName then
    send pause to window theMovieName
    hide window TheMovieName
    end if
    play "transport"
    go to card "black"
    set cursor to none
    go to card "black" of stack "Dunny Age"
    set cursor to none
    vd
    wait until the sound is "done"
    play "transport"
    go to card "restart" of stack "Dunny Age"
    set cursor to none
    end mouseDownInMovie
    
    on closeCard
    htlock true
    put "AtrusBook2.MooV" into TheMovieName
    if TheMovieName is in the windows then close window TheMovieName
    put "AtrusBook1.MooV" into TheMovieName
    if TheMovieName is in the windows then close window TheMovieName
    pass closeCard
    end closeCard
    
    on Atrus
    global MY_Atrus,DU_End
    if MY_Atrus is empty then put "AtrusBook1.MooV" into TheMovieName
    else put "AtrusBook2.MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    --set the endTime of window TheMovieName to "1,140"
    if DU_End is "win" then
    set the startTime of window theMovieName to "14,40"
    set the currTime of window theMovieName to "14,40"
    set the loop of window TheMovieName to true
    else
    if MY_Atrus is empty then set the callBackTime of window theMovieName to "3,14,0"
    else set the callBackTime of window theMovieName to "16,10"
    if MY_Atrus is empty then set the callBackMsg of window theMovieName to "Done1"
    else set the callBackMsg of window theMovieName to "Done2"
    end if
    set the passMovieClick of window theMovieName to false
    show window TheMovieName
    set the rate of window TheMovieName to "1.0"
    end if
    put 2 into MY_Atrus
    end Atrus
    
    on done1
    put "AtrusBook1.MooV" into TheMovieName
    set the startTime of window theMovieName to "3,8,40"
    set the currTime of window theMovieName to "3,8,40"
    set the rate of window TheMovieName to "1.0"
    end done1
    
    on done2
    put "AtrusBook2.MooV" into TheMovieName
    set the startTime of window theMovieName to "14,40"
    set the currTime of window theMovieName to "14,40"
    set the rate of window TheMovieName to "1.0"
    end done2

    * Part 28552:1 ""
      on mouseUp
      go to card id 71909
      end mouseUp
    * Part 28552:2 ""
    * Part 28552:3 "marker"
      on mouseUp
      send mouseDownInMovie to card
      end mouseUp
  * Card 47448 "" (7 parts)

    on openCard
    global pictAdd,MY_BlueBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "Library1-S B" into field "pict name"
    else
    put "Library1-S" into field "pict name"
    if char 1 of MY_BlueBook is "0" and char 1 to 3 of ALL_Page is not "1,A" then
    put field "pict name" & " (BluePage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    end if
    pass openCard
    end openCard

    * Part 47448:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 47448:5 "marker"
    * Part 47448:1 "left"
      on mouseUp
      go to card id 46439
      end mouseUp
    * Part 47448:2 "right"
      on mouseUp
      go to card id 46851
      end mouseUp
    * Part 47448:3 ""
      on mouseUp
      go to card id 49518
      end mouseUp
    * Part 47448:6 ""
      on mouseUp
      go to card id 49308
      loadmoov
      end mouseUp
    * Part 47448:7 ""
      on mouseUp
      go to card id 49781
      end mouseUp
  * Card 49518 "" (3 parts)

    on openCard
    global pictAdd,MY_BlueBook,ALL_Page,DU_End
    if DU_End is "win" then
    put "Library2-S B" into field "pict name"
    else
    put "Library2-S" into field "pict name"
    if char 1 of MY_BlueBook is "0" and char 1 to 3 of ALL_Page is not "1,A" then
    put field "pict name" & " (BluePage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    end if
    pass openCard
    end openCard
    
    on GrabPage which
    global MY_BlueBook,ALL_Page
    if char which of MY_BlueBook is "0" then
    if char 1 to 3 of ALL_Page is not (which & ",A") then
    put which & ",A,0" into ALL_Page
    set icon of the target to 20001
    else
    put empty into ALL_Page
    set icon of the target to 20000
    end if
    end if
    end GrabPage

    * Part 49518:1 ""
      on mouseUp
      go to card id 47448
      end mouseUp
    * Part 49518:2 "book"
      on mouseUp
      global ALL_Page,MY_Book,MY_BlueBook,DU_end
      if DU_end is not "win" then
      if ALL_Page is not empty then
      if item 2 of ALL_Page = "A" then
      put item 1 of ALL_Page into whichPage
      --HyperCursor "Hand",1
      put empty into ALL_Page
      put 1 into char whichPage of MY_BlueBook
      play "PutPage"
      end if
      end if
      -- go to either open book or END GAME
      if char 6 of MY_BlueBook = "1" then go card id 81655
      else go to card id 70993
      end if
      dropState
      end mouseUp
    * Part 49518:4 "marker"
      on MouseDown
      global pictAdd,MY_BlueBook,ALL_Page
      put the loc of me into origLoc
      if char 1 of MY_BlueBook is "0" then
      if char 1 to 3 of ALL_Page is not "1,A" then
      if ALL_Page is not empty then dropPage
      put "1,A,0" into ALL_Page
      htlock true
      opencard
      else
      put empty into ALL_Page
      UpdateCursor
      HTAddPict "Library2-S (BluePage)",the rect of card button Marker,"srccopy"
      end if
      end if
      dropState
      end MouseDown
  * Card 81655 "AchenarLose" (1 parts)

    on openCard
    play "transport"
    htlock nobw
    fadeout
    pass openCard
    end openCard
    
    on idle
    get "AchenarLose.MooV"
    if there is not a window it then Achenar
    end idle
    
    on closeCard
    put "AchenarLose.MooV" into TheMovieName
    if TheMovieName is in the windows then close window TheMovieName
    pass closeCard
    end closeCard
    
    on Achenar
    put "AchenarLose.MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the callBackMsg of window theMovieName to "Done"
    --set the callBackTime of window theMovieName to "20.0"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    end if
    end Achenar

    * Part 81655:1 "marker"
  * Card 70993 "" (2 parts)
    * Part 70993:1 ""
      on mouseUp
      go to card id 49518
      end mouseUp
    * Part 70993:2 ""
      on mouseUp
      soundstop
      HTVisual "wipe left",,,1
      go to card id 72136
      get "AchenarPage" & BlueMooV() & ".MooV"
      if there is not a window it then Achenar
      end mouseUp
  * Card 72136 "" (3 parts)

    function BlueMooV
    global MY_BlueBook
    if char 7 of MY_BlueBook = "E" then
    return "Extra"
    else
    put 0 into thecount
    repeat with x = 1 to 6
    add char x of MY_BlueBook to theCount
    end repeat
    return "Page" & theCount
    end if
    end BlueMooV
    
    on closeCard
    global MY_BlueBook, MY_LibStairs
    put "Achenar" & BlueMooV() & ".MooV" into TheMovieName
    if TheMovieName is in the windows then close window TheMovieName
    if MY_LibStairs is up then playQT "AR Lite Wind MoV",,loop,30
    else playQT "MR Elev Room Loud MoV",,loop,30
    if BlueMooV() = "Page5" then put "E" into char 7 of MY_BlueBook
    pass closeCard
    end closeCard
    
    on Achenar
    put "Achenar" & BlueMooV() & ".MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    if last char of BlueMooV() = 0 then
    set the loop of window TheMovieName to true
    set the closeOnFinish of window TheMovieName to false
    set the startTime of window TheMovieName to "0,0"
    set the endTime of window TheMovieName to "17,0"
    else
    set the loop of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to true
    deCurse "override","hand","color","nodelay"
    set the fastidle of window TheMovieName to true
    end if
    set the seeAllFrames of window TheMovieName to false
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    show window TheMovieName
    set the rate of window TheMovieName to "1.0"
    if last char of BlueMooV() = 0 then
    repeat until item 1 of the currTime of window TheMovieName > 3
    send movieIdle to window theMovieName
    end repeat
    set the startTime of window TheMovieName to "2,0"
    end if
    end if
    end Achenar

    * Part 72136:1 ""
      on mouseUp
      htlock true
      go to card id 49518
      end mouseUp
    * Part 72136:2 ""
    * Part 72136:3 "marker"
  * Card 47833 "" (6 parts)

    on mouseDownInMovie
    click at the mouseloc
    end mousedowninMovie
    
    on closeCard
    get "LibraryStairsUp.MooV"
    if there is a window it then close window it
    pass closeCard
    end closeCard
    
    on openCard
    global MY_LibStairs,DU_End
    if DU_End is "win" then
    put "Library1-SE B" into field "pict name"
    else
    put "Library1-SE" into field "pict name"
    end if
    if MY_LibStairs is "down" then
    if last word of field "pict name" is not "StairsDown" then
    put " StairsDown" after field "pict name"
    end if
    else
    if last word of field "pict name" is "StairsDown" then
    delete last word of field "pict name"
    end if
    end if
    if there is a window "LibraryStairsUp.MooV" then close window "LibraryStairsUp.MooV"
    pass openCard
    end openCard

    * Part 47833:4 "up"
      on mouseUp
      push card
      go to card id 44018
      end mouseUp
    * Part 47833:1 "left"
      on mouseUp
      go to card id 46739
      end mouseUp
    * Part 47833:2 "right"
      on mouseUp
      go to card id 47338
      end mouseUp
    * Part 47833:3 ""
      on mouseUp
      go to card id 49308
      loadmoov
      end mouseUp
    * Part 47833:5 ""
      on mouseUp
      go to card id 48883
      end mouseUp
    * Part 47833:6 ""
      on mouseUp
      go to card id 49518
      end mouseUp
  * Card 76679 "" (2 parts)

    on opencard
    global DU_End
    if DU_End = "win" then
    put "Library1-SE B StairsDown" into field "pict name"
    else
    put "Library1-SE StairsDown" into field "pict name"
    end if
    pass openCard
    end opencard
    
    on Stairs
    global ST_book, theMovieName
    put "LibraryStairsUp.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button stairs,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    --set the startTime of window TheMovieName to it
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    play "DR LibStairs Up"
    repeat until the rate of window TheMovieName is 0
    send movieIdle to window TheMovieName
    end repeat
    end if
    end Stairs

    * Part 76679:1 "stairs"
    * Part 76679:2 "marker"
  * Card 49308 "" (2 parts)

    on closeCard
    put "LibraryTwirl.MooV" into TheMovieName
    if there is a window TheMovieName then close window TheMovieName
    pass closeCard
    end closeCard
    
    on loadmoov
    global MY_LibStairs
    if MY_LibStairs is "down" then
    set cursor to none
    put "LibraryTwirl.MooV" into TheMovieName
    if there is not a window TheMovieName then
    soundidle
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button "picture","invisible","Floating"
    soundidle
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    set the passMovieClick of window theMovieName to false
    set the rate of window theMovieName to "0.0"
    end if
    end if
    end loadmoov

    * Part 49308:1 ""
      on mouseUp
      go to card id 47833
      end mouseUp
    * Part 49308:2 "picture"
      On mouseWithin
      global ALL_Cursor,Quick
      get the short name of the target
      if Quick is true then
      get 1002
      if it ≠ ALL_Cursor then
      deCurse "override",1002,"color","nodelay"
      put it into ALL_Cursor
      end if
      end if
      end mouseWithin
      
      on mouseDown
      global MY_LibStairs,Quick
      set cursor to none
      if MY_LibStairs is "down" then
      soundstop
      Twirl
      if Quick is true then
      play "DR LibStairs Up"
      put "up" into MY_LibStairs
      dplay "DR LibStairs Thump"
      go to card id 47833
      playQT "AR Lite Wind MoV",,loop,30
      else
      go to card id 76679
      put "up" into MY_LibStairs
      stairs
      htlock true
      htvisual "wipe down",,the rect of card button marker,2,32
      play stop
      dplay "DR LibStairs Thump"
      go to card id 47833
      htlock forcefalse
      playQT "AR Lite Wind MoV",,loop,30
      end if
      else
      play "SW Buzzer"
      wait 15
      wait until the mouse is up
      play stop
      end if
      wait while the mouseclick
      end mouseDown
      
      on Twirl
      global ST_book, theMovieName
      put "LibraryTwirl.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then loadMooV
      if there is a window TheMovieName then
      play "TN Crtyd Pilars"
      show window TheMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window TheMovieName is 0
      send movieIdle to window TheMovieName
      end repeat
      close window TheMovieName
      end if
      end Twirl
  * Card 27316 "" (4 parts)
    * Part 27316:1 "left"
      on mouseUp
      go to card id 79339
      end mouseUp
    * Part 27316:2 ""
      on mouseUp
      go to card id 30742
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
    * Part 27316:3 "right"
      on mouseUp
      go to card id 79339
      end mouseUp
    * Part 27316:4 "qbre1"
      on mouseUp
      go card
      end mouseUp
  * Card 30742 "" (3 parts)
    * Part 30742:1 "right"
      on mouseUp
      go to card id 27647
      end mouseUp
    * Part 30742:2 ""
      on mouseUp
      go to card id 31038
      end mouseUp
    * Part 30742:3 "left"
      on mouseUp
      go to card id 82210
      end mouseUp
  * Card 82210 "" (2 parts)
    * Part 82210:1 "right"
      on mouseUp
      go to card id 30742
      end mouseUp
    * Part 82210:3 "left"
      on mouseUp
      go to card id 27647
      end mouseUp
  * Card 27647 "" (2 parts)
    * Part 27647:1 ""
      on mouseUp
      go to card id 79339
      playQT "AR Lite Wind MoV",,loop,200
      end mouseUp
    * Part 27647:2 "left"
      on mouseUp
      go to card id 30742
      end mouseUp
  * Card 79339 "" (3 parts)
    * Part 79339:1 ""
      on mouseUp
      go to card id 18697
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 79339:2 "right"
      on mouseUp
      go to card id 27316
      end mouseUp
    * Part 79339:3 "left"
      on mouseUp
      go to card id 27316
      end mouseUp
  * Card 31383 "qbre1" (3 parts)

    on openCard
    global pictAdd,MY_GenBreaker
    if MY_GenBreaker = 1 then
    put  field "pict name" & " (Thrown)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    playQT "AR Lite Wind MoV",,loop,230
    pass openCard
    end openCard

    * Part 31383:1 ""
      on mouseUp
      go to card id 31038
      end mouseUp
      
      on mouseWithin
      deCurse "override","down","color","nodelay"
      end mouseWithin
    * Part 31383:2 "marker"
    * Part 31383:3 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global MY_GenBreaker,MY_GenVolts
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      if the mouse is down then
      -- added 12/6/93 to correct nothing in it when clicking fast
      get (the mouseV - theStart) div 8
      if it < 1 then get 1
      if it > 4 then get 4
      if MY_GenBreaker = 1 then if it < 2 then get 2
      --
      repeat until the mouse is up
      soundidle
      if the mouseLoc is not within the rect of card button marker then
      deCurse "override",2003,"color","nodelay"
      exit repeat
      end if
      get (the mouseV - theStart) div 8
      if it < 1 then get 1
      if it > 4 then get 4
      if MY_GenBreaker = 1 then if it < 2 then get 2
      if it <> old then
      put it into old
      xCIcon3 the loc of card button marker, 4110 + it
      if it = 4 then
      if MY_GenBreaker = 1 then
      if MY_GenVolts ≤ 59 then put 0 into MY_GenBreaker
      play stop
      play "MR FrplRotate Start"
      else
      play stop
      play "SW BreakerClose"
      end if
      end if
      end if
      end repeat
      if it > 1 then
      repeat with x = (4110 + it) down to 4111
      if MY_GenBreaker = 1 then put 4112 into x
      xCIcon3 the loc of card button marker, x
      end repeat
      end if
      end if
      end mouseDown
  * Card 31038 "" (2 parts)
    * Part 31038:1 ""
      on mouseUp
      go to card id 31383
      end mouseUp
    * Part 31038:2 ""
      on mouseUp
      go to card id 30742
      end mouseUp
  * Card 24061 "" (3 parts)
    * Part 24061:1 "right"
      on mouseUp
      go to card id 24064
      play stop
      end mouseUp
    * Part 24061:2 ""
      on mouseUp
      go to card id 29282
      playQT "AR Lite Wind MoV",,loop,150
      end mouseUp
    * Part 24061:3 "left"
      on mouseUp
      go to card id 24064
      play stop
      end mouseUp
  * Card 24064 "" (6 parts)

    on openCard
    global pictAdd,MY_Boat
    if MY_Boat is "up" then
    put field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker after pictAdd
    end if
    pass openCard
    end openCard

    * Part 24064:5 "BoatMarker"
    * Part 24064:1 ""
      on mouseUp
      go to card id 27005
      playQT "AR Lite Wind MoV",,loop,200
      end mouseUp
    * Part 24064:2 ""
      on mouseUp
      go to card id 12527
      end mouseUp
    * Part 24064:3 "left"
      on mouseUp
      go to card id 24061
      end mouseUp
    * Part 24064:6 "right"
      on mouseUp
      go to card id 24061
      end mouseUp
    * Part 24064:7 "left"
      on mouseUp
      go to card id 24061
      end mouseUp
  * Card 29282 "" (3 parts)
    * Part 29282:1 "right"
      on mouseUp
      go to card id 29665
      end mouseUp
    * Part 29282:2 ""
      on mouseUp
      go to card id 29906
      playQT "AR Lite Wind MoV",,loop,50
      end mouseUp
    * Part 29282:3 "left"
      on mouseUp
      go to card id 29665
      end mouseUp
  * Card 29665 "" (4 parts)
    * Part 29665:1 ""
      on mouseUp
      go to card id 24064
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
    * Part 29665:2 "left"
      on mouseUp
      go to card id 29282
      end mouseUp
    * Part 29665:3 "right"
      on mouseUp
      go to card id 29282
      end mouseUp
    * Part 29665:4 "qpat"
      on mouseUp
      go to card id 24064
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
  * Card 29906 "" (2 parts)
    * Part 29906:1 ""
      on mouseUp
      go to card id 29282
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 29906:2 ""
      on mouseUp
      go to card id 30320
      playQT "AR Lite Wind MoV",,loop,250
      end mouseUp
  * Card 30320 "qbre2" (3 parts)

    on openCard
    global pictAdd,MY_GenBreaker
    if MY_GenBreaker = 2 then
    put field "pict name" & " (Thrown)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    playQT "AR Lite Wind MoV",,loop,250
    pass openCard
    end openCard

    * Part 30320:2 ""
      on mouseUp
      go to card id 29906
      playQT "AR Lite Wind MoV",,loop,50
      end mouseUp
      
      on mouseWithin
      deCurse "override","down","color","nodelay"
      end mouseWithin
    * Part 30320:3 "marker"
    * Part 30320:4 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      
      on mouseDown
      global MY_GenBreaker,MY_GenVolts
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      if the mouse is down then
      -- added 12/6/93 -- to rid quick clicking (no it) problem
      get (the mouseV - theStart) div 8
      if it < 1 then get 1
      if it > 4 then get 4
      if MY_GenBreaker = 2 then if it < 2 then get 2
      ---------------------
      repeat until the mouse is up
      soundidle
      if the mouseLoc is not within the rect of card button marker then
      deCurse "override",2003,"color","nodelay"
      exit repeat
      end if
      get (the mouseV - theStart) div 8
      if it < 1 then get 1
      if it > 4 then get 4
      if MY_GenBreaker = 2 then if it < 2 then get 2
      if it <> old then
      put it into old
      xCIcon3 the loc of card button marker, 4100 + it
      if it = 4 then
      if MY_GenBreaker = 2 then
      if MY_GenVolts ≤ 59 then put 0 into MY_GenBreaker
      play stop
      play "MR FrplRotate Start"
      else
      play stop
      play "SW BreakerClose"
      end if
      end if
      end if
      end repeat
      if it > 1 then
      repeat with x = (4100 + it) down to 4101
      if MY_GenBreaker = 2 then put 4102 into x
      xCIcon3 the loc of card button marker, x
      end repeat
      end if
      end if
      end mouseDown
  * Card 23279 "" (1 parts)

    on openCard
    hide menubar
    hide message
    go next
    end openCard

    * Part 23279:2 "New Button"
      on mouseUp
      lock screen
      lock messages
      repeat with x = 1 to the number of cards
      go to card x
      if there is a bg fld "pict name" then
      if bg fld "pict name" is not empty then
      set cursor to busy
      get bg fld "pict name"
      set itemDelimiter to ":"
      get ":Myst Graphics:" & the last item of it
      put it into bg fld "pict name"
      --put it
      end if
      end if
      end repeat
      go first
      end mouseUp
  * Card 5726 "" (4 parts)

    on openCard
    global MY_gearGate
    if MY_GearGate is "open" and the last word of bg field 1 ≠ "GearOpen" then
    put " GearOpen" after bg field 1
    end if
    if MY_GearGate ≠ "open" and the last word of bg field 1 = "GearOpen" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 5726:1 "left"
      on mouseUp
      go to card id 5956
      end mouseUp
    * Part 5726:4 "gearMarker"
    * Part 5726:2 "right"
      on mouseUp
      go to card id 5956
      end mouseUp
    * Part 5726:3 ""
      on mouseUp
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,40
      go to card id 10316
      end mouseUp
  * Card 5956 "" (9 parts)

    on openCard
    global pictAdd,MY_Boat,MY_DocMarker
    put "Platform0.5-W" into field "pict name"
    hide card button qboa
    if MY_Boat is "up" then
    show card button qboa
    if MY_DocMarker is not "on" then
    put field "pict name" & " (up/off)|" & the rect ¬
    of card button DocMarker2 & return after pictAdd
    end if
    else
    if MY_DocMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button DocMarker after pictAdd
    end if
    end if
    if MY_Boat is "up" then put " BoatUp" after bg field 1
    pass openCard
    end openCard

    * Part 5956:7 "docmarker2"
    * Part 5956:6 "docmarker"
    * Part 5956:5 "boatMarker"
    * Part 5956:1 ""
      on mouseUp
      go to card id 6551
      end mouseUp
    * Part 5956:3 "left"
      on mouseUp
      go to card id 5726
      end mouseUp
    * Part 5956:4 ""
      on mouseUp
      go to card id 6798
      end mouseUp
    * Part 5956:9 "qboa"
      on mouseUp
      go to card id 6551
      end mouseUp
    * Part 5956:10 "qdoc"
      on mouseUp
      go to card id 6551
      end mouseUp
    * Part 5956:11 "qdoc"
      on mouseUp
      go to card id 6551
      end mouseUp
  * Card 6278 "" (5 parts)

    on openCard
    global pictAdd,MY_gearGate
    if MY_GearGate is "open" then
    put return &  field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker after pictAdd
    end if
    pass openCard
    end openCard

    * Part 6278:1 ""
      on mouseUp
      go to card id 5726
      end mouseUp
    * Part 6278:2 "right"
      on mouseUp
      go to card id 6551
      end mouseUp
    * Part 6278:4 "left"
      on mouseUp
      go to card id 6798
      end mouseUp
    * Part 6278:5 "gearMarker"
    * Part 6278:3 "right"
      on mouseUp
      go to card id 6798
      end mouseUp
  * Card 6551 "" (8 parts)

    on openCard
    global pictAdd,MY_DocMarker,MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    hide card button qboa
    if MY_Boat is "up" then
    show card button "qboa"
    if MY_DocMarker is not "on" then
    put field "pict name" & " (up/down)|" & the rect ¬
    of card button DocMarker2 & return after pictAdd
    end if
    else
    if MY_DocMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button DocMarker after pictAdd
    end if
    end if
    pass openCard
    end openCard

    * Part 6551:6 "docMarker2"
    * Part 6551:4 "boatMarker"
    * Part 6551:3 "left"
      on mouseUp
      go to card id 5726
      end mouseUp
    * Part 6551:5 "docMarker"
    * Part 6551:2 ""
      on mouseUp
      go to card id 4495
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      end mouseUp
    * Part 6551:1 "right"
      on mouseUp
      go to card id 6798
      end mouseUp
    * Part 6551:7 "qdoc"
      on mouseUp
      go to card id 4495
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      end mouseUp
    * Part 6551:8 "qboa"
      on mouseUp
      go to card id 4495
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,180
      end mouseUp
  * Card 6798 "" (6 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up"  and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 6798:4 "boatMarker"
    * Part 6798:2 "left"
      on mouseUp
      go to card id 6551
      end mouseUp
    * Part 6798:1 ""
      on mouseUp
      go to card id 7516
      end mouseUp
    * Part 6798:3 "right"
      on mouseUp
      go to card id 6278
      end mouseUp
    * Part 6798:6 "qdoc left"
      on mouseUp
      go to card id 6551
      end mouseUp
    * Part 6798:7 "qste"
      on mouseUp
      go to card id 7516
      end mouseUp
  * Card 7040 "" (10 parts)

    on openCard
    global pictAdd,MY_DocMarker,MY_Boat,MY_gearGate
    if the last word of bg field 1 is "BoatUp" then ¬
    delete the last word of bg field 1
    
    if MY_DocMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button DocMarker & return after pictAdd
    end if
    if MY_GearGate is "open" then
    put field "pict name" & " (gearOpen)|" & the rect ¬
    of card button GearMarker & return after pictAdd
    end if
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up" and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 7040:6 "gearMarker"
    * Part 7040:5 "DocMarker"
    * Part 7040:1 ""
      on mouseUp
      go to card id 6278
      end mouseUp
    * Part 7040:3 "left"
      on mouseUp
      go to card id 7902
      end mouseUp
    * Part 7040:4 "boatMarker"
    * Part 7040:2 "right"
      on mouseUp
      go to card id 7191
      end mouseUp
    * Part 7040:7 "qgea"
      on mouseUp
      go to card id 6278
      end mouseUp
    * Part 7040:9 "qdoc3 right"
      on mouseUp
      go to card id 7191
      end mouseUp
    * Part 7040:10 "qdoc3"
      on mouseUp
      go to card id 6278
      end mouseUp
    * Part 7040:11 "qdoc3"
      on mouseUp
      go card
      end mouseUp
  * Card 7191 "" (5 parts)

    on openCard
    global MY_Boat,BirdStartTime
    put the ticks + 120 into BirdStartTime
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up" and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard
    
    on idle
    global MY_Boat,BirdStartTime
    if my_boat is "down" then
    if the ticks > BirdStartTime then
    put random(4) into which
    if which < 4 then
    if there is a window "BirdsMoov" then
    hide window "BirdsMoov"
    put random(2) into side
    if side is 1 then
    put (random(168) + 316) into x
    else
    put (random(117) + 60) into x
    end if
    set the loc of card button "moovmarker" to x,24
    set the windowRect of window "BirdsMoov" to the rect of card button "moovmarker"
    htlock forcefalse
    end if
    soundidle
    birds which
    soundidle
    if there is a window "BirdsMoov" then
    set the rate of window "BirdsMoov" to "1.0"
    show window "BirdsMoov"
    end if
    end if
    put the ticks + (random(1000) + 800) into BirdStartTime
    end if
    end if
    pass idle
    end idle
    
    on closecard
    htlock true
    if there is a window "BirdsMoov" then close window "birdsMoov"
    pass closecard
    end closecard
    
    on Birds x
    do ( "put " & quote & "Birds" & x & ".MooV" & quote & " into theMovieName")
    if there is not a window "BirdsMoov" then
    Movie theMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    if there is a window theMovieName then
    set the TimeFormat of window theMovieName to "MovieTime"
    set the dontErase of window theMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window theMovieName to "256"
    set the mute of window theMovieName to true
    set the badge of window theMovieName to false
    set the controllerVisible of window theMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window theMovieName to false
    set the loop of window theMovieName to false
    set the seeAllFrames of window theMovieName to false
    set the startTime of window theMovieName to "0"
    --set the endTime of window theMovieName to "2,240"
    --set the callBackMsg of window MtheMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the windowName of window theMovieName to "BirdsMooV"
    end if
    else
    set the movie of window "BirdsMoov" to theMovieName
    end if
    end Birds

    * Part 7191:3 "boatMarker"
    * Part 7191:2 "left"
      on mouseUp
      go to card id 7040
      end mouseUp
    * Part 7191:1 "right"
      on mouseUp
      go to card id 7516
      end mouseUp
    * Part 7191:4 "qdoc2"
      on mouseUp
      go card
      end mouseUp
    * Part 7191:5 "moovMarker"
  * Card 7516 "" (3 parts)
    * Part 7516:1 ""
      on mouseUp
      go to card id 7902
      end mouseUp
    * Part 7516:2 "left"
      on mouseUp
      go to card id 7191
      end mouseUp
    * Part 7516:3 "right"
      on mouseUp
      go to card id 7040
      end mouseUp
  * Card 7902 "qste" (4 parts)

    on opencard
    playQT "BR Seagulls/Water Slosh Mx MoV",,loop,110
    pass opencard
    end opencard

    * Part 7902:3 ""
      on mouseUp
      go to card id 8079
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,70
      end mouseUp
    * Part 7902:1 "right"
      on mouseUp
      go to card id 7040
      end mouseUp
    * Part 7902:6 "qpla"
      on mouseUp
      go to card id 8079
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,70
      end mouseUp
    * Part 7902:7 "qpat2"
      on mouseUp
      go to card id 8079
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,70
      end mouseUp
  * Card 12527 "" (6 parts)
    * Part 12527:1 ""
      on mouseUp
      go to card id 13071
      playQT "AR Lite Wind MoV",,loop,250
      end mouseUp
    * Part 12527:2 "right"
      on mouseUp
      go to card id 12581
      end mouseUp
    * Part 12527:3 ""
      on mouseUp
      go to card id 24061
      end mouseUp
    * Part 12527:4 "left"
      on mouseUp
      go to card id 12581
      end mouseUp
    * Part 12527:5 "qshi"
      on mouseUp
      go to card id 13071
      playQT "AR Lite Wind MoV",,loop,250
      end mouseUp
    * Part 12527:7 "qbre2"
      on mouseUp
      go to card id 24061
      end mouseUp
  * Card 12581 "" (6 parts)

    on openCard
    global pictAdd,MY_Boat
    if MY_Boat is "up" then
    put  field "pict name" & " (boat-up)|" & the rect ¬
    of card button BoatMarker after pictAdd
    end if
    pass openCard
    end openCard

    * Part 12581:6 "boatMarker"
    * Part 12581:3 ""
      on mouseUp
      go to card id 27005
      playQT "AR Lite Wind MoV",,loop,200
      end mouseUp
    * Part 12581:1 "left"
      on mouseUp
      go to card id 12527
      end mouseUp
    * Part 12581:2 "right"
      on mouseUp
      go to card id 12527
      end mouseUp
    * Part 12581:4 ""
      on mouseUp
      go to card id 11521
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 12581:5 ""
      on mouseUp
      go to card id 11357
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
  * Card 13071 "" (5 parts)

    on openCard
    global pictAdd,MY_ShiMarker
    if MY_ShiMarker is "on" then
    put  field "pict name" & " (Switch-on)|" & the rect ¬
    of card button ShiMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 13071:3 "ShiMarker"
      --on mouseUp
      global MY_ShiMarker
      put field "pict name" into WhichPict
      if MY_ShiMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_ShiMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_ShiMarker
      end if
      go this card
      end mouseUp
    * Part 13071:1 "right"
      on mouseUp
      go to card id 12994
      end mouseUp
    * Part 13071:4 "left"
      on mouseUp
      go to card id 12994
      end mouseUp
    * Part 13071:2 ""
      on mouseUp
      go to card id 13372
      end mouseUp
    * Part 13071:5 "qshi"
      on mouseUp
      go to card id 13372
      end mouseUp
  * Card 12994 "" (3 parts)
    * Part 12994:1 ""
      on mouseUp
      go to card id 12581
      playQT "AR Lite Wind MoV",,loop,230
      end mouseUp
    * Part 12994:2 "right"
      on mouseUp
      go to card id 13071
      end mouseUp
    * Part 12994:3 "left"
      on mouseUp
      go to card id 13071
      end mouseUp
  * Card 13372 "" (4 parts)

    on openCard
    global pictAdd,MY_ShiMarker
    if MY_ShiMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button ShiMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 13372:4 "ShiMarker"
    * Part 13372:2 "right"
      on mouseUp
      go to card id 14084
      end mouseUp
    * Part 13372:3 "left"
      on mouseUp
      go to card id 14084
      end mouseUp
    * Part 13372:1 ""
      on mouseUp
      go to card id 13712
      end mouseUp
  * Card 14084 "" (4 parts)
    * Part 14084:1 ""
      on mouseUp
      go to card id 12994
      end mouseUp
    * Part 14084:2 "right"
      on mouseUp
      go to card id 13372
      end mouseUp
    * Part 14084:3 "left"
      on mouseUp
      go to card id 13372
      end mouseUp
    * Part 14084:4 "qpat"
      on mouseUp
      go to card id 12994
      end mouseUp
  * Card 13712 "qshi" (4 parts)

    on openCard
    global pictAdd,MY_ShiMarker
    if MY_ShiMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button ShiMarker into pictAdd
    end if
    playQT "AR Lite Wind MoV",,loop,250
    pass openCard
    end openCard

    * Part 13712:5 ""
      on mouseUp
      go to card id 55197
      end mouseUp
    * Part 13712:1 "left"
      on mouseUp
      go to card id 14069
      end mouseUp
    * Part 13712:2 "right"
      on mouseUp
      go to card id 14069
      end mouseUp
    * Part 13712:4 "ShiMarker"
      on mouseDown
      global MY_ShiMarker
      htlock true
      if MY_ShiMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button shimarker, "Srccopy"
      put "off" into MY_ShiMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button shimarker, "Srccopy"
      put "on" into MY_ShiMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
  * Card 55197 "" (3 parts)

    on openCard
    global MY_GenVolts, MY_GenBreaker, MY_SpacePower
    if MY_GenBreaker = 0 then put MY_GenVolts into MY_SpacePower
    else put 0 into MY_SpacePower
    hide card button EnterShip
    show card button OpenDoor
    pass openCard
    end openCard

    * Part 55197:1 "left"
      on mouseUp
      put 0 into x
      if the visible of card button "EnterShip" is "true" then  put 1 into x
      go to card id 14069
      if x = 1 then play "DR Spaceship Up"
      end mouseUp
    * Part 55197:2 "openDoor"
      on mouseUp
      global MY_SpacePower
      play stop
      if MY_SpacePower = 59 then
      put  field "pict name" into WhichPict
      put WhichPict & " (open)" into WhichPict
      htlock true
      play "DR Spaceship Up"
      HTvisual "wipe up",,the rect of card button openDoor,2,32
      HTAddPict WhichPict, the rect of me, "Srccopy"
      htlock forcefalse
      hide me
      show card button Entership
      else
      if MY_SpacePower > 0 then
      play "DR Spaceship Fail"
      end if
      end if
      end mouseUp
    * Part 55197:3 "EnterShip"
      on mouseUp
      global MY_SpacePower
      go to card id 55730
      playQT "AR Lite Wind MoV",,loop,150
      end mouseUp
  * Card 55730 "" (3 parts)
    * Part 55730:1 ""
      on mouseUp
      htlock bw
      soundstop
      -- playQT "AR Lite Wind MoV",,loop,80
      go to card id 55938
      end mouseUp
    * Part 55730:2 "right"
      on mouseUp
      go to card id 55329
      end mouseUp
    * Part 55730:3 "left"
      on mouseUp
      go to card id 78050
      end mouseUp
  * Card 78050 "" (4 parts)

    on openCard
    global pictAdd,MY_ShiMarker
    if MY_ShiMarker is not "on" then
    put field "pict name" & " (Switch-off)|" & the rect ¬
    of card button ShiMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 78050:4 "shiMarker"
    * Part 78050:1 "right"
      on mouseUp
      go to card id 55730
      end mouseUp
    * Part 78050:2 ""
      on mouseUp
      --go to card id 31832 of stack "Selenitic Age"
      playQT "AR Lite Wind MoV",,loop,250
      go to card id 14069
      play "DR Spaceship Up"
      end mouseUp
    * Part 78050:3 "left"
      on mouseUp
      go to card id 55329
      end mouseUp
  * Card 55938 "" (12 parts)

    on openCard
    global MY_SpaceNotes
    repeat with x = 1 to 5
    set the loc of button ("n" & x) to line x of MY_SpaceNotes
    end repeat
    pass openCard
    end openCard
    
    on closeCard
    global MY_SpaceNotes
    repeat with x = 1 to 5
    put the loc of button ("n" & x) into line x of MY_SpaceNotes
    end repeat
    htlock "nobw"
    if there is a window "SeleniticBook.MooV" then close window "SeleniticBook.MooV"
    pass closeCard
    end closeCard
    
    on leverSound which
    global MY_SpacePower
    deCurse "override",2004,"color","nodelay"
    put the loc of the target into theLoc
    put the mouseV-item 2 of theLoc into theOff
    repeat until the mouse is up
    get the mouseV - theOff
    if it < 216 then get 216
    if it > 279 then get 279
    put adjustNote(it) into theNote
    if theNote ≠ oldNote then
    play stop
    if MY_SpacePower = 59 then play "MU Organ" tempo 5 theNote
    put theNote into oldNote
    end if
    put it into item 2 of theLoc
    set the loc of the target to theLoc
    xcIcon3 the loc of the target,500
    end repeat
    play stop
    hide the target
    show the target
    end leverSound
    
    function adjustNote loc
    return trunc(((276 - loc)+92) div 1.82)
    end adjustNote
    
    function playNotes
    put empty into allNotes
    wait until the sound is "done"
    repeat with x = 1 to 5
    get item 2 of the loc of card button ("n" & x)
    put adjustNote(it) into theNote
    xcIcon3 the loc of card button ("n" & x),500
    play "MU Organ" tempo 200 theNote
    put theNote & space after allNotes
    wait until the sound is done
    wait 5
    --hide card button ("n" & x)
    --show card button ("n" & x)
    end repeat
    htlock bw
    hide card button cover
    show card button cover
    htlock nobw
    return allNotes
    end playNotes
    
    
    on mouseDownInMovie which
    global MY_Selenitic
    if which is "SeleniticBook.MooV" then
    if MY_Selenitic is not "true" then
    put "true" into MY_Selenitic
    set the currTime of window which to "5,50"
    set the endTime of window which to "21,50"
    set the startTime of window which to "5,50"
    set the rate of window which to "1.0"
    --repeat until the mouse is down
    --send movieIdle to which
    --end repeat
    --close window which
    else
    put "false" into MY_Selenitic
    deCurse "override",2003,"color","nodelay"
    if there is a window "SeleniticBook.MooV" then
    hide window "SeleniticBook.MooV"
    close window "SeleniticBook.MooV"
    end if
    play "transport"
    go to card "black"
    htlock true
    lock screen
    go to card "black" of stack "Selenitic Age"
    vd
    wait until the sound is "done"
    play "transport"
    go to card id 45136 of stack "Selenitic Age"
    PlayQT "WA Lapping Mov",, loop, 50
    end if
    end if
    end mouseDownInMovie
    
    on Book
    global ST_book, theMovieName
    put "SeleniticBook.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button CRT,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the endTime of window TheMovieName to "5,50"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the startTime of window TheMovieName to "0"
    show window TheMovieName
    set the rate of window TheMovieName to "1.0"
    end if
    set the startTime of window TheMovieName to "1,6"
    --close window theMovieName
    end Book

    * Part 55938:13 "cover"
    * Part 55938:12 "lever"
    * Part 55938:1 "right"
      on mouseUp
      htlock nobw
      htlock true
      playQT "AR Lite Wind MoV",,loop,80
      go to card id 63509
      end mouseUp
    * Part 55938:2 ""
    * Part 55938:3 "left"
      on mouseUp
      htlock nobw
      htlock true
      playQT "AR Lite Wind MoV",,loop,80
      go to card id 63509
      end mouseUp
    * Part 55938:4 ""
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global MY_SpacePower
      htlock nobw
      deCurse "override",2004,"color","nodelay"
      put the mouseV into theStart
      put "Spaceship Controls" into thePict
      put the rect of card button lever into theLoc
      put "0,0,53,108" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      get 0
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button lever then exit repeat
      get (the mouseV - theStart) div 8
      if it < 0 then get 0
      if it > 8 then get 8
      put it * 53 into item 1 of theClip
      put it * 53 + 53 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it = 8 then
      if itsDown is not true then
      deCurse "override",2003,"color","nodelay"
      play stop
      play "SW Spaceship Lever"
      if MY_SpacePower = 59 then
      get playNotes()
      if it is "55 67 70 60 53 " then
      play stop
      play "EL SharpHum"
      Book
      get 8
      exit repeat
      else
      if there is a window "SeleniticBook.MooV" then close window "SeleniticBook.MooV"
      end if
      end if
      put true into itsDown
      end if
      get 8
      else
      put empty into itsDown
      end if
      end repeat
      deCurse "override",2003,"color","nodelay"
      if it > 0 then
      repeat
      subtract 2 from it
      if it < 0 then get 0
      put it * 53 into item 1 of theClip
      put it * 53 + 53 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≤ 0 then exit repeat
      end repeat
      end if
      htlock bw
      end mouseDown
    * Part 55938:5 "CRT"
      on mouseDown
      
      end mouseDown
    * Part 55938:6 "N1"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      leverSound 1
      end mouseDown
    * Part 55938:7 "N2"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      leverSound 1
      end mouseDown
    * Part 55938:8 "N3"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      leverSound 1
      end mouseDown
    * Part 55938:9 "N4"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      leverSound 1
      end mouseDown
    * Part 55938:10 "N5"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      leverSound 1
      end mouseDown
  * Card 63509 "" (5 parts)

    on openCard
    global pictAdd,MY_ShiMarker
    if MY_ShiMarker is not "on" then
    put field "pict name" & " (Switch-off)|" & the rect ¬
    of card button ShiMarker into pictAdd
    end if
    pass openCard
    end openCard
    
    on closecard
    htlock "true"
    pass closecard
    end closecard

    * Part 63509:5 "shiMarker"
    * Part 63509:4 "right"
      on mouseUp
      htlock bw
      htlock true
      opencard
      go to card id 55938
      end mouseUp
    * Part 63509:1 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,150
      go to card id 55329
      end mouseUp
    * Part 63509:2 "left"
      on mouseUp
      soundstop
      htlock bw
      htlock "true"
      opencard
      htlock true
      go to card id 55938
      end mouseUp
    * Part 63509:3 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,150
      go to card id 78050
      end mouseUp
  * Card 56157 "" (41 parts)

    on openCard
    global keyCounter
    put 0 into keyCounter
    pass opencard
    end openCard
    
    on pushKey theKey
    global keyCounter,MY_SpacePower
    add 1 to keyCounter
    get the Loc of the target
    set the loc of card button mask to 0,0
    xCIcon3 it,1000 + theKey
    play stop
    if MY_SpacePower = 59 then play "MU Organ" tempo 1 48 + theKey
    repeat until the mouse is up
    put the mouseloc into ml
    if  ml is not within the rect of the target then
    if keyCounter > 10 then exit repeat
    set the loc of card button mask to it
    --play stop
    if ml is within the rect of card button keyboard then click at ml
    else play stop
    exit pushKey
    end if
    end repeat
    set the loc of card button mask to it
    if keyCounter > 10 then
    put 0 into keycounter
    play stop
    exit to hypercard
    end if
    put 0 into keyCounter
    play stop
    end pushKey

    * Part 56157:3 "left"
      on mouseUp
      go to card id 65713
      end mouseUp
    * Part 56157:1 "right"
      on mouseUp
      go to card id 65713
      end mouseUp
    * Part 56157:2 "keyboard"
      on mouseUp
      play stop
      end mouseUp
    * Part 56157:42 "mask"
      on mouseUp
      play stop
      end mouseUp
    * Part 56157:4 "0"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:6 "2"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:5 "1"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:7 "4"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:8 "6"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:9 "7"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:10 "9"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:11 "11"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:12 "12"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:13 "14"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:14 "16"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:15 "18"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:16 "19"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:17 "21"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:18 "23"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:25 "35"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:24 "33"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:23 "31"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:22 "30"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:21 "28"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:20 "26"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:19 "24"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:26 "3"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:27 "5"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:28 "8"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:29 "10"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:30 "13"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:31 "15"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:32 "17"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:33 "20"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:34 "22"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:35 "25"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:36 "27"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:37 "29"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:38 "32"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:39 "34"
      on mouseDown
      pushKey the short name of me
      end mouseDown
    * Part 56157:41 "m2"
      on mouseUp
      put the loc of me
      end mouseUp
  * Card 65713 "" (3 parts)
    * Part 65713:1 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,150
      go to card id 55730
      end mouseUp
    * Part 65713:2 "right"
      on mouseUp
      go to card id 56157
      end mouseUp
    * Part 65713:3 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,150
      go to card id 78050
      end mouseUp
  * Card 55329 "" (3 parts)
    * Part 55329:1 ""
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,50
      go to card id 56157
      end mouseUp
    * Part 55329:2 "left"
      on mouseUp
      go to card id 55730
      end mouseUp
    * Part 55329:3 "right"
      on mouseUp
      go to card id 78050
      end mouseUp
  * Card 14069 "" (4 parts)
    * Part 14069:1 ""
      on mouseUp
      go to card id 14084
      end mouseUp
    * Part 14069:2 "right"
      on mouseUp
      go to card id 13712
      end mouseUp
    * Part 14069:3 "left"
      on mouseUp
      go to card id 13712
      end mouseUp
    * Part 14069:4 "qpat"
      on mouseUp
      go to card id 14084
      end mouseUp
  * Card 11197 "" (5 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up" and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 11197:3 "boatMarker"
    * Part 11197:1 ""
      on mouseUp
      go to card id 5956
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,70
      end mouseUp
    * Part 11197:2 "right"
      on mouseUp
      go to card id 10316
      end mouseUp
    * Part 11197:4 "qste"
      on mouseUp
      go to card id 5956
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,70
      end mouseUp
    * Part 11197:5 "qdoc"
      on mouseUp
      go to card id 5956
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,70
      end mouseUp
  * Card 28930 "" (4 parts)
    * Part 28930:1 ""
      on mouseUp
      go to card id 44564
      playQT "MU Generator Stairs MoV",,loop,200
      end mouseUp
    * Part 28930:3 "right"
      on mouseUp
      go to card id 56481
      end mouseUp
    * Part 28930:5 "left"
      on mouseUp
      go to card id 56481
      end mouseUp
    * Part 28930:6 "qgen"
      on mouseUp
      go to card id 44564
      playQT "MU Generator Stairs MoV",,loop,200
      end mouseUp
  * Card 44564 "" (4 parts)
    * Part 44564:1 ""
      on mouseUp
      go to card id 33668
      end mouseUp
    * Part 44564:2 "right"
      on mouseUp
      go to card id 40600
      end mouseUp
    * Part 44564:3 "left"
      on mouseUp
      go to card id 40600
      end mouseUp
    * Part 44564:4 "qgen"
      on mouseUp
      go to card id 33668
      end mouseUp
  * Card 33668 "" (4 parts)
    * Part 33668:1 ""
      on mouseUp
      go to card id 33976
      end mouseUp
    * Part 33668:2 "right"
      on mouseUp
      go to card id 35605
      end mouseUp
    * Part 33668:3 "left"
      on mouseUp
      go to card id 35605
      end mouseUp
    * Part 33668:5 "qgen"
      on mouseUp
      go to card id 33976
      end mouseUp
  * Card 35605 "" (4 parts)
    * Part 35605:1 ""
      on mouseUp
      go to card id 40600
      end mouseUp
    * Part 35605:3 "left"
      on mouseUp
      go to card id 33668
      end mouseUp
    * Part 35605:4 "right"
      on mouseUp
      go to card id 33668
      end mouseUp
    * Part 35605:5 "qgen2"
      on mouseUp
      go to card id 40600
      end mouseUp
  * Card 40600 "" (4 parts)
    * Part 40600:1 ""
      on mouseUp
      go to card id 56481
      playQT "MU Generator Stairs MoV",,loop,125
      end mouseUp
    * Part 40600:2 "right"
      on mouseUp
      go to card id 44564
      end mouseUp
    * Part 40600:3 "left"
      on mouseUp
      go to card id 44564
      end mouseUp
    * Part 40600:4 "qgen2"
      on mouseUp
      go to card id 56481
      playQT "MU Generator Stairs MoV",,loop,125
      end mouseUp
  * Card 56481 "" (2 parts)
    * Part 56481:1 ""
      on mouseUp
      go to card id 40799
      playQT "MU Generator Stairs MoV",,loop,75
      end mouseUp
    * Part 56481:2 "left"
      on mouseUp
      go to card id 28930
      end mouseUp
  * Card 40799 "qgen2" (3 parts)

    on opencard
    playQT "MU Generator Stairs MoV",,loop,75
    pass opencard
    end opencard

    * Part 40799:1 ""
      on mouseUp
      playQT "AR Howling&Birds Mov",,loop,100
      go to card id 18697
      end mouseUp
    * Part 40799:2 "left"
      on mouseUp
      go to card id 44417
      end mouseUp
    * Part 40799:4 "right"
      on mouseUp
      go to card id 44417
      end mouseUp
  * Card 33976 "" (4 parts)
    * Part 33976:1 ""
      on mouseUp
      go to card id 34228
      end mouseUp
    * Part 33976:2 "right"
      on mouseUp
      go to card id 44138
      end mouseUp
    * Part 33976:4 "left"
      on mouseUp
      go to card id 44138
      end mouseUp
    * Part 33976:5 "qgen"
      on mouseUp
      go to card id 34228
      end mouseUp
  * Card 35524 "" (4 parts)
    * Part 35524:1 ""
      on mouseUp
      go to card id 44138
      end mouseUp
    * Part 35524:2 "right"
      on mouseUp
      go to card id 34228
      end mouseUp
    * Part 35524:4 "left"
      on mouseUp
      go to card id 34228
      end mouseUp
    * Part 35524:5 "qgen2"
      on mouseUp
      go to card id 44138
      end mouseUp
  * Card 44138 "" (4 parts)
    * Part 44138:1 ""
      on mouseUp
      go to card id 35605
      end mouseUp
    * Part 44138:2 "left"
      on mouseUp
      go to card id 33976
      end mouseUp
    * Part 44138:3 "right"
      on mouseUp
      go to card id 33976
      end mouseUp
    * Part 44138:4 "qgen2"
      on mouseUp
      go to card id 35605
      end mouseUp
  * Card 34228 "" (4 parts)
    * Part 34228:1 ""
      on mouseUp
      go to card id 34394
      playQT "MU Generator Stairs MoV",,loop,125
      end mouseUp
    * Part 34228:2 "right"
      on mouseUp
      go to card id 35524
      end mouseUp
    * Part 34228:3 "left"
      on mouseUp
      go to card id 35524
      end mouseUp
    * Part 34228:4 "qgen"
      on mouseUp
      go to card id 34394
      playQT "MU Generator Stairs MoV",,loop,125
      end mouseUp
  * Card 34394 "" (2 parts)
    * Part 34394:1 ""
      on mouseUp
      go to card id 34663
      playQT "MU Generator Stairs MoV",,loop,75
      end mouseUp
    * Part 34394:2 "left"
      on mouseUp
      go to card id 35305
      end mouseUp
  * Card 35305 "" (3 parts)
    * Part 35305:1 ""
      on mouseUp
      go to card id 35524
      playQT "MU Generator Stairs MoV",,loop,200
      end mouseUp
    * Part 35305:2 "right"
      on mouseUp
      go to card id 34394
      end mouseUp
    * Part 35305:3 "qgen2"
      on mouseUp
      go to card id 35524
      playQT "MU Generator Stairs MoV",,loop,200
      end mouseUp
  * Card 34663 "qgen" (4 parts)
    * Part 34663:1 "right"
      on mouseUp
      go to card id 34888
      end mouseUp
    * Part 34663:2 "left"
      on mouseUp
      go to card id 34888
      end mouseUp
    * Part 34663:5 "none"
      on mouseDown
      global  MY_GenVolts
      HTAddPict field "pict name" & " (button)", the rect of me, "Srccopy"
      play stop
      play "SW PushButton In"
      wait until the mouse is up
      HTvisual "scrollaway up",,the rect of card button door,2,32
      dplay "DR GenRoom Up"
      go to card id 43558
      if MY_GenVolts > 0 then playQT "EL GenAll MoV",,loop,50,,"14,41","14,41","23,40",true
      soundidle
      if the mouseclick then
      click at the clickLoc
      exit mousedown
      end if
      repeat with x = 1 to 3
      soundidle
      put  field "pict name" into WhichPict
      put "OpenLight" & x into last word of WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      play stop
      play "SW GenLights On"
      if the mouseclick then
      click at the clickLoc
      exit mousedown
      end if
      wait 40
      soundidle
      end repeat
      end mouseDown
    * Part 34663:8 "door"
  * Card 43558 "" (5 parts)
    * Part 43558:6 "marker"
    * Part 43558:1 "none"
      on mouseDown
      put field "pict name" into WhichPict
      delete last word of WhichPict
      put WhichPict & " (button)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      play stop
      play "SW PushButton In"
      wait until the mouse is up
      HTvisual "scroll down",,the rect of card button door,2,32
      dplay "DR GenRoom Down"
      go to card id 34663
      playQT "MU Generator Stairs MoV",,loop,75
      end mouseDown
    * Part 43558:2 "door"
      on mouseUp
      global MY_GenBreaker,MY_GenVolts
      if MY_GenBreaker is empty then put 0 into MY_GenBreaker
      if MY_GenVolts > 0 then
      playQT "EL GenAll MoV",,loop,150,,,,,true
      else
      fadeout
      end if
      go to card id 35918
      end mouseUp
    * Part 43558:3 "right"
      on mouseUp
      go to card id 34888
      playQT "MU Generator Stairs MoV",,loop,75
      play "DR GenRoom Down"
      end mouseUp
    * Part 43558:4 "left"
      on mouseUp
      go to card id 34888
      playQT "MU Generator Stairs MoV",,loop,75
      play "DR GenRoom Down"
      end mouseUp
  * Card 34888 "" (4 parts)
    * Part 34888:1 ""
      on mouseUp
      go to card id 35305
      playQT "MU Generator Stairs MoV",,loop,75
      end mouseUp
    * Part 34888:2 "right"
      on mouseUp
      go to card id 34663
      end mouseUp
    * Part 34888:3 "left"
      on mouseUp
      go to card id 34663
      end mouseUp
    * Part 34888:5 "qgen2"
      on mouseUp
      go to card id 35305
      playQT "MU Generator Stairs MoV",,loop,75
      end mouseUp
  * Card 10316 "" (6 parts)

    on openCard
    global pictAdd,MY_GeaMarker,MY_gearGate
    if MY_GeaMarker is "on" then
    if the last word of bg field 1 = "GearOpen" then delete the last word of bg field 1
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button GeaMarker into pictAdd
    end if
    if MY_GearGate is "open" and the last word of bg field 1 ≠ "GearOpen" then
    put " GearOpen" after bg field 1
    end if
    if MY_GearGate ≠ "open" and the last word of bg field 1 = "GearOpen" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 10316:6 "gearMarker"
    * Part 10316:5 "geaMarker"
      --on mouseDown
      global MY_GeaMarker
      put field "pict name" into WhichPict
      if MY_GeaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      if the result ≠ empty then answer "Error calling Ted:" && the result
      put "off" into MY_GeaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      if the result ≠ empty then answer "Error calling Ted:" && the result
      put "on" into MY_GeaMarker
      end if
      go this card
      end mouseDown
    * Part 10316:2 "left"
      on mouseUp
      go to card id 11197
      end mouseUp
    * Part 10316:3 ""
      on mouseUp
      global MY_gearGate
      set cursor to none
      go to card id 10973
      if MY_GearGate is "open" then
      playQT "FlyGearGate/Music.MooV",,loop,50,,,,,true
      else
      playQT "FlyGearGate/Music.MooV",,loop,30,,,,,true
      end if
      end mouseUp
    * Part 10316:1 "right"
      on mouseUp
      go to card id 11197
      end mouseUp
    * Part 10316:7 ""
      on mouseUp
      go to card id 10973
      end mouseUp
  * Card 31619 "" (5 parts)

    on openCard
    global pictAdd,MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate & "|" & the rect ¬
    of card button TreeGate into pictAdd
    pass openCard
    end openCard
    
    on TreeUpdate
    global MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate into thePict
    HTAddPict thePict,the rect of card button TreeGate,"srccopy"
    htlock "forcefalse"
    end TreeUpdate

    * Part 31619:5 "TreeGate"
    * Part 31619:1 ""
      on mouseUp
      go to card id 31932
      end mouseUp
    * Part 31619:3 "left"
      on mouseUp
      go to card id 32948
      end mouseUp
    * Part 31619:4 "right"
      on mouseUp
      go to card id 32948
      end mouseUp
    * Part 31619:6 "qtre"
      on mouseUp
      go to card id 31932
      end mouseUp
  * Card 32948 "" (3 parts)
    * Part 32948:1 ""
      on mouseUp
      go to card id 19652
      end mouseUp
    * Part 32948:2 ""
      on mouseUp
      go to card id 21170
      end mouseUp
    * Part 32948:3 "right"
      on mouseUp
      go to card id 31619
      end mouseUp
  * Card 31932 "" (4 parts)

    on openCard
    global pictAdd,MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate & "|" & the rect ¬
    of card button TreeGate into pictAdd
    pass openCard
    end openCard
    
    on TreeUpdate
    global MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate into thePict
    HTAddPict thePict,the rect of card button TreeGate,"srccopy"
    htlock "forcefalse"
    end TreeUpdate

    * Part 31932:4 "treeGate"
    * Part 31932:1 ""
      on mouseUp
      global MY_ChannelWood
      go to card id 32178
      put false into MY_ChannelWood
      end mouseUp
    * Part 31932:2 "right"
      on mouseUp
      go to card id 32604
      end mouseUp
    * Part 31932:3 "left"
      on mouseUp
      go to card id 32604
      end mouseUp
  * Card 32604 "" (3 parts)
    * Part 32604:1 ""
      on mouseUp
      go to card id 32948
      end mouseUp
    * Part 32604:2 "right"
      on mouseUp
      go to card id 31932
      end mouseUp
    * Part 32604:3 "left"
      on mouseUp
      go to card id 31932
      end mouseUp
  * Card 32178 "qtre" (5 parts)

    on openCard
    global pictAdd,MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate & "|" & the rect ¬
    of card button TreeGate into pictAdd
    if item 1 of MY_TreeGate = 5 then show card button TreeDoor
    else hide card button TreeDoor
    playQT "AR Howling&Birds Mov",,loop,100
    pass openCard
    end openCard
    
    on TreeUpdate
    global MY_TreeGate
    if item 1 of MY_TreeGate = 5 then show card button TreeDoor
    else hide card button TreeDoor
    put field "pict name" & space & item 1 of MY_TreeGate into thePict
    HTAddPict thePict,the rect of card button TreeGate,"srccopy"
    htlock "forcefalse"
    end TreeUpdate

    * Part 32178:4 "TreeGate"
    * Part 32178:5 "up"
      on mouseUp
      go to card id 83585
      end mouseUp
    * Part 32178:1 "right"
      on mouseUp
      go to card id 32403
      end mouseUp
    * Part 32178:2 "left"
      on mouseUp
      go to card id 32403
      end mouseUp
    * Part 32178:3 "TreeDoor"
      on mouseUp
      go to card id 57929
      vs left
      go to card id 45039
      ww
      end mouseUp
  * Card 57929 "" (0 parts)
  * Card 83585 "" (2 parts)

    on openCard
    global pictAdd,MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate & "|" & the rect ¬
    of card button TreeGate into pictAdd
    pass openCard
    end openCard
    
    on TreeUpdate
    global MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate into thePict
    HTAddPict thePict,the rect of card button TreeGate,"srccopy"
    htlock "forcefalse"
    end TreeUpdate

    * Part 83585:2 "treeGate"
    * Part 83585:1 "down"
      on mouseUp
      go to card id 32178
      end mouseUp
  * Card 45039 "" (5 parts)

    on openCard
    global pictAdd,MY_TreeGate
    get field "pict name"
    delete last char of it
    delete last char of it
    put item 1 of MY_TreeGate into Level
    put  it & space & Level & "|" & the rect ¬
    of card button TreeMarker into pictAdd
    if level > 6 then show card button "down"
    else hide card button "down"
    if Level is 1 then playQT "FlyChannel/Music.MooV",fadein,loop,50,,,,,true
    else fadeout
    pass openCard
    end openCard
    
    
    on TreeUpdate
    global MY_TreeGate
    get field "pict name"
    delete last char of it
    delete last char of it
    put item 1 of MY_TreeGate into Level
    if level > 6 then show card button "down"
    else hide card button "down"
    if Level is 1 then playQT "FlyChannel/Music.MooV",fadein,loop,50,,,,,true
    else fadeout
    put it & space & Level into thePict
    HTAddPict thePict,the rect of card button TreeMarker,"srccopy"
    htlock "forcefalse"
    end TreeUpdate

    * Part 45039:2 "TreeMarker"
    * Part 45039:1 "TreeRoom"
      on mouseUp
      global pictAdd,MY_TreeGate
      put item 1 of MY_TreeGate into Level
      if Level = 1 then
      go to card id 45222
      playQT "FlyChannel/Music.MooV",fadein,loop,100,,,,,true
      else
      if Level = 5 or Level = 6 then
      go to card id 32403
      playQT "AR Howling&Birds Mov",,loop,100
      end if
      end if
      end mouseUp
    * Part 45039:6 "down"
      on mouseUp
      global MY_TreeGate
      put item 1 of MY_TreeGate into Level
      if Level > 5 then go to card id 71480
      end mouseUp
    * Part 45039:7 "markerButton"
    * Part 45039:8 ""
      on mouseDown
      global MY_CabinValve,MY_TreeGate
      put the rect of card button markerButton into theLoc
      htsavePict theLoc,"clipboard","srccopy","backdrop"
      if the sound is "done" then play "SW Pushbutton In"
      HTAddPict "TreeGateIn (Button In)",the rect of card button markerButton,"srccopy"
      if item 1 of MY_TreeGate > 5 then
      put MY_CabinValve into ValveHolder
      put 0 into MY_CabinValve
      playQT "AR Gas MoV",,"loop",200
      repeat until the mouse is up
      soundIdle
      if item 1 of MY_TreeGate > 5 then treeUpdate
      end repeat
      put ValveHolder into MY_CabinValve
      end if
      if the sound is "done" then play "SW Pushbutton Out"
      htaddPict empty,theLoc,"srccopy","clipboard"
      if item 1 of MY_TreeGate is 13 then fadeout
      end mouseDown
      
      on TreeUpdate
      global MY_TreeGate, MY_CabinValve, MY_Match, MY_Pilot
      set itemDelimiter to ","
      soundIdle
      put MY_CabinValve into CabinValve
      if item 1 of MY_TreeGate > 1 then
      put the seconds into now
      get abs(1/FurnaceTime(CabinValve) * 2.5)
      if now - item 2 of MY_TreeGate > it then
      put furnaceTime(CabinValve) into theRate
      subtract 1 from item 1 of MY_TreeGate
      put now into item 2 of MY_TreeGate
      put item 1 of MY_TreeGate into Level
      if level > 6 then show card button "down"
      else hide card button "down"
      put "TreeGate" & space & Level into thePict
      HTAddPict thePict,the rect of card button TreeMarker,"srccopy"
      play stop
      play "PD TreeGate down"
      end if
      end if
      end TreeUpdate
  * Card 71480 "" (3 parts)

    on openCard
    global pictAdd,MY_TreeGate
    put field "pict name" & space & item 1 of MY_TreeGate & "|" & the rect ¬
    of card button TreeDoor into pictAdd
    pass openCard
    end openCard
    
    on TreeUpdate
    send openCard
    go to this card
    end TreeUpdate

    * Part 71480:3 "treedoor"
    * Part 71480:1 "up"
      on mouseUp
      go to card id 45039
      end mouseUp
    * Part 71480:2 ""
      
  * Card 45222 "" (3 parts)
    * Part 45222:1 ""
      on mouseUp
      playQT "FlyChannel/Music.MooV",,loop,120,,,,,true
      go to card id 45561
      end mouseUp
    * Part 45222:3 "right"
      on mouseUp
      go to card id 46046
      end mouseUp
    * Part 45222:4 "left"
      on mouseUp
      go to card id 46046
      end mouseUp
  * Card 45802 "" (5 parts)

    on openCard
    global pictAdd,MY_TreeGate,MY_CabinValve
    get field "pict name"
    put item 1 of MY_TreeGate into Level
    if Level > 4 then
    put ((Level + 1) Mod 2) + 3 into Level
    end if
    put it & space & Level & "|" & the rect ¬
    of card button TreeMarker & return into pictAdd
    put "TreeRoomFarValve " & (MY_CabinValve mod 6) + 1 into WhichPict
    put WhichPict & "|" & the rect of card button marker after pictAdd
    pass openCard
    end openCard
    
    on TreeUpdate
    send openCard
    go to this card
    end TreeUpdate

    * Part 45802:5 "marker"
    * Part 45802:1 "right"
      on mouseUp
      go to card id 45561
      end mouseUp
    * Part 45802:2 "left"
      on mouseUp
      go to card id 45561
      end mouseUp
    * Part 45802:3 ""
      on mouseUp
      playQT "FlyChannel/Music.MooV",,loop,100,,,,,true
      go to card id 46046
      end mouseUp
    * Part 45802:4 "treeMarker"
  * Card 46046 "" (8 parts)

    on openCard
    global pictAdd,MY_TreeGate,MY_CabinValve
    get field "pict name"
    put item 1 of MY_TreeGate into Level
    if Level > 4 then
    put ((Level + 1) Mod 2) + 3 into Level
    end if
    put it & space & Level & "|" & the rect ¬
    of card button TreeMarker & return into pictAdd
    put "TreeRoomValve " & (MY_CabinValve mod 6) + 1 into WhichPict
    put WhichPict & "|" & the rect of card button marker after pictAdd
    if level = 1 then show card button InTree
    else hide card button InTree
    pass openCard
    end openCard
    
    
    on TreeUpdate
    global MY_TreeGate
    get field "pict name"
    put item 1 of MY_TreeGate into Level
    if Level > 4 then
    put ((Level + 1) Mod 2) + 3 into Level
    end if
    put it & space & Level into thePict
    HTAddPict thePict,the rect of card button TreeMarker,"srccopy"
    htlock "forcefalse"
    end TreeUpdate

    * Part 46046:9 "treeMarker"
    * Part 46046:8 "marker"
    * Part 46046:1 "InTree"
      on mouseUp
      set cursor to none
      go to card id 57929
      vs left
      go to card id 45039
      ww
      end mouseUp
    * Part 46046:2 "right"
      on mouseUp
      go to card id 45222
      end mouseUp
    * Part 46046:3 "left"
      on mouseUp
      go to card id 45222
      end mouseUp
    * Part 46046:6 ""
      on mouseWithin
      deCurse "override","8001","color","nodelay"
      end mouseWithin
      
      on mouseDown
      global MY_CabinValve,MY_TreeGate
      put "TreeRoomValve " into WhichPict
      repeat until the mouse is up
      if MY_CabinValve < 1 then exit repeat
      if the sound is "done" then play "SQ WheelLarge"
      soundidle
      subtract 1 from MY_CabinValve
      get (MY_CabinValve mod 6) + 1
      HTAddPict WhichPict & it, the rect of card button marker, "Srccopy"
      end repeat
      put the seconds into item 2 of MY_TreeGate
      end mouseDown
    * Part 46046:7 ""
      on mouseWithin
      deCurse "override","8000","color","nodelay"
      end mouseWithin
      
      on mouseDown
      global MY_CabinValve,MY_TreeGate
      put "TreeRoomValve " into WhichPict
      repeat until the mouse is up
      if MY_CabinValve > 24 then exit repeat
      if the sound is "done" then play "SQ WheelLarge"
      soundidle
      add 1 to MY_CabinValve
      get (MY_CabinValve mod 6) + 1
      HTAddPict WhichPict & it, the rect of card button marker, "Srccopy"
      end repeat
      put the seconds into item 2 of MY_TreeGate
      end mouseDown
    * Part 46046:10 ""
  * Card 45561 "" (3 parts)
    * Part 45561:1 "left"
      on mouseUp
      global MY_CabinValve
      if MY_CabinValve ≤ 12 then
      go to card id 45802
      else
      playQT "FlyChannel/Music.MooV",,loop,100,,,,,true
      go to card id 46046
      end if
      end mouseUp
    * Part 45561:2 "right"
      on mouseUp
      global MY_CabinValve
      if MY_CabinValve ≤ 12 then
      go to card id 45802
      else
      playQT "FlyChannel/Music.MooV",,loop,100,,,,,true
      go to card id 46046
      end if
      end mouseUp
    * Part 45561:3 ""
      on mouseUp
      playQT "FlyChannel/Music.MooV",,loop,150,,,,,true
      go to card id 77210
      end mouseUp
  * Card 77210 "" (2 parts)
    * Part 77210:1 ""
      on mouseUp
      playQT "FlyChannel/Music.MooV",,loop,120
      go to card id 45561
      end mouseUp
    * Part 77210:2 ""
      on mouseUp
      playQT "FlyChannel/Music.MooV",,loop,250,,,,,true
      go to card id 77588
      end mouseUp
  * Card 77588 "" (3 parts)

    on opencard
    pass opencard
    end opencard
    
    on closecard
    global My_flyTree
    put empty into MY_FlyTree
    pass closecard
    end closecard
    
    on mouseDownInMovie
    deCurse "override",2003,"color","nodelay"
    if there is a window "FlyChannel/Music.MooV" then
    htlock true
    hide window "FlyChannel/Music.MooV"
    end if
    fadeout
    play "transport"
    go to card black
    htlock false
    lock screen
    go to card "Black" of stack "Channelwood Age"
    if there is a window "FlyChannel/Music.MooV" then
    close window "FlyChannel/Music.MooV"
    end if
    vd
    wait until the sound is "done"
    play "transport"
    go to card "Restart" of stack "Channelwood Age"
    end mouseDownInMovie
    
    on idle
    global MY_FlyTree
    if MY_FlyTree is empty then
    flyby
    put true into MY_FlyTree
    end if
    end idle
    
    on FlyBy
    put "FlyChannel/Music.MooV" into TheMovieName
    if there is not a window TheMovieName then
    set cursor to none
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the windowLoc of window theMovieName to the topleft of card button marker
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "250"
    set the controllerVisible of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    --set the rate of window TheMovieName to "0.0"
    --set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    deCurse "override","hand","color","nodelay"
    set the fastidle of window TheMovieName to "true"
    end if
    end FlyBy

    * Part 77588:1 ""
      on mouseUp
      htlock true
      if there is a window "FlyChannel/Music.MooV" then hide window "FlyChannel/Music.MooV"
      playQT "FlyChannel/Music.MooV",,loop,120,,,,,true
      set the FastIdle of window "FlyChannel/Music.MooV" to "false"
      go to card id 45561
      end mouseUp
    * Part 77588:2 ""
      on mouseUp
      end mouseUp
    * Part 77588:3 "marker"
      on mouseUp
      deCurse "override",2003,"color","nodelay"
      if there is a window "FlyChannel/Music.MooV" then
      htlock true
      hide window "FlyChannel/Music.MooV"
      end if
      fadeout
      play "transport"
      go to card black
      htlock false
      lock screen
      go to card "Black" of stack "Channelwood Age"
      if there is a window "FlyChannel/Music.MooV" then
      close window "FlyChannel/Music.MooV"
      end if
      vd
      wait until the sound is "done"
      play "transport"
      go to card "Restart" of stack "Channelwood Age"
      end mouseUp
  * Card 23444 "Black" (2 parts)
    * Part 23444:2 "creditMarker"
    * Part 23444:3 "quitter"
  * Card 32403 "" (4 parts)
    * Part 32403:1 ""
      on mouseUp
      go to card id 32604
      end mouseUp
    * Part 32403:2 "right"
      on mouseUp
      go to card id 32178
      end mouseUp
    * Part 32403:3 "left"
      on mouseUp
      go to card id 32178
      end mouseUp
    * Part 32403:4 "qcab"
      on mouseUp
      go to card id 32604
      end mouseUp
  * Card 8079 "" (7 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 8079:4 "PlaMarker"
      --on mouseUp
      global MY_PlaMarker
      put field "pict name" into WhichPict
      if MY_PlaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_PlaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      go this card
      end mouseUp
    * Part 8079:2 "left"
      on mouseUp
      go to card id 2123
      end mouseUp
    * Part 8079:3 ""
      on mouseUp
      go to card id 3604
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
    * Part 8079:1 "right"
      on mouseUp
      go to card id 2123
      end mouseUp
    * Part 8079:5 "qpat2"
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,70
      go to card id 3604
      end mouseUp
    * Part 8079:7 "qpla"
      on mouseUp
      playQT "AR Lite Wind MoV",,loop,70
      go to card id 3604
      end mouseUp
    * Part 8079:8 ""
      on mouseUp
      go to card id 25971
      end mouseUp
  * Card 8631 "" (4 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put "Woodpath1-N (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 8631:1 ""
      on mouseUp
      go to card id 8079
      end mouseUp
    * Part 8631:2 ""
      on mouseUp
      go to card id 25971
      end mouseUp
    * Part 8631:3 ""
    * Part 8631:4 "PlaMarker"
      --on mouseUp
      global MY_PlaMarker
      put field "pict name" into WhichPict
      if MY_PlaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_PlaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      go this card
      end mouseUp
  * Card 25971 "" (3 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put "Woodpath1-N (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 25971:1 ""
      on mouseUp
      go to card id 8079
      end mouseUp
    * Part 25971:2 ""
    * Part 25971:3 "PlaMarker"
      --on mouseUp
      global MY_PlaMarker
      put field "pict name" into WhichPict
      if MY_PlaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_PlaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      go this card
      end mouseUp
  * Card 2123 "qpat1" (11 parts)

    on openCard
    global pictAdd,MY_Boat,MY_DocMarker
    if the last word of bg field 1 is "boatup" then
    delete the last word of bg field 1
    end if
    if MY_DocMarker is "On" then
    put field "pict name" & " (switch-on)|" & the rect ¬
    of card button DocMarker into pictAdd
    end if
    if MY_Boat is "up" then put " BoatUp" after bg field 1
    playQT "BR Seagulls/Water Slosh Mx MoV",,loop,30
    pass openCard
    end openCard

    * Part 2123:4 "boatMarker"
    * Part 2123:5 "left"
      on mouseUp
      go to card id 8079
      end mouseUp
    * Part 2123:1 ""
      on mouseUp
      go to card id 7040
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,90
      end mouseUp
    * Part 2123:2 "right"
      on mouseUp
      go to card id 8079
      end mouseUp
    * Part 2123:3 "left"
      on mouseUp
      go to card id 8079
      end mouseUp
    * Part 2123:6 "DocMarker"
    * Part 2123:7 "qdoc2"
      on mouseUp
      go to card id 7040
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,90
      end mouseUp
    * Part 2123:8 "qdoc3"
      on mouseUp
      go to card id 7040
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,90
      end mouseUp
    * Part 2123:9 ""
    * Part 2123:10 ""
      on mouseUp
      go to card id 7191
      end mouseUp
    * Part 2123:11 "qdoc2"
      on mouseUp
      go to card id 7191
      end mouseUp
  * Card 3604 "" (7 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 3604:3 "PlaMarker"
      --on mouseUp
      global MY_PlaMarker
      put field "pict name" into WhichPict
      if MY_PlaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_PlaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      go this card
      end mouseUp
    * Part 3604:1 ""
      on mouseUp
      go to card id 9189
      end mouseUp
    * Part 3604:2 ""
      on mouseUp
      go to card id 9960
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
    * Part 3604:4 ""
      on mouseUp
      go to card id 9960
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
    * Part 3604:5 "left"
      on mouseUp
      go to card id 9648
      end mouseUp
    * Part 3604:7 "right"
      on mouseUp
      go to card id 9648
      end mouseUp
    * Part 3604:8 "right"
      on mouseUp
      go to card id 9648
      end mouseUp
  * Card 9648 "" (4 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up" and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 9648:1 ""
      on mouseUp
      go to card id 2123
      playQT "BR Seagulls/Water Slosh Mx MoV",,loop,30
      end mouseUp
    * Part 9648:2 "right"
      on mouseUp
      go to card id 3604
      end mouseUp
    * Part 9648:3 "left"
      on mouseUp
      go to card id 8794
      end mouseUp
    * Part 9648:5 ""
      on mouseUp
      go to card id 91471
      end mouseUp
  * Card 28321 "" (2 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" then
    put "Woodpath2-S BoatUp Crumpled" into bg field 1
    end if
    if MY_Boat ≠ "up" then
    put "Woodpath2-S Crumpled" into bg field 1
    end if
    pass openCard
    end openCard

    * Part 28321:1 ""
      on mouseUp
      go to card id 9648
      end mouseUp
    * Part 28321:2 ""
      on mouseUp
      go to card id 91471
      end mouseUp
  * Card 91471 "" (2 parts)

    on openCard
    global MY_Boat
    if MY_Boat is "up" then
    put "Woodpath2-S BoatUp Note" into bg field 1
    end if
    if MY_Boat ≠ "up" then
    put "Woodpath2-S Note" into bg field 1
    end if
    pass openCard
    end openCard

    * Part 91471:1 ""
      on mouseUp
      go to card id 9648
      end mouseUp
    * Part 91471:2 ""
  * Card 8794 "" (4 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 8794:4 "PlaMarker"
      --on mouseUp
      global MY_PlaMarker
      put  field "pict name" into WhichPict
      if MY_PlaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_PlaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      go this card
      end mouseUp
    * Part 8794:1 ""
      on mouseUp
      go to card id 9189
      end mouseUp
    * Part 8794:2 "left"
      on mouseUp
      go to card id 9960
      end mouseUp
    * Part 8794:3 "right"
      on mouseUp
      go to card id 9648
      end mouseUp
  * Card 9189 "qpla" (6 parts)

    on openCard
    global pictAdd,MY_PlaMarker
    if MY_PlaMarker is "on" then
    put  field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    hide card button doorOpen
    hide card button enterPla
    playQT "AR Lite Wind MoV",,loop,70
    pass openCard
    end openCard

    * Part 9189:1 "right"
      on mouseUp
      if the visible of card button doorOpen is true then
      go to card id 9457
      fadeout
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      playQT "AR Lite Wind MoV",fadein,loop,70
      else
      go to card id 9457
      end if
      end mouseUp
    * Part 9189:2 "left"
      on mouseUp
      if the visible of card button doorOpen is true then
      go to card id 9457
      fadeout
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      playQT "AR Lite Wind MoV",fadein,loop,70
      else
      go to card id 9457
      end if
      end mouseUp
    * Part 9189:3 "DoorClosed"
      on mouseUp
      global MY_PlaLight,MY_PlaMarker
      hc
      put field "pict name" into WhichPict
      htlock true
      htvisual "wipe left",,the rect of card button doorclosed,1,16
      if MY_PlaLight is not "off" then
      put WhichPict & " (open/on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      else
      put WhichPict & " (open/off)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      end if
      play stop
      play "cdoorsqueak2" tempo 150 c
      htlock forcefalse
      show card button "DoorOpen"
      show card button "EnterPla"
      wait until the sound is "done"
      play stop
      playQT "MU Planetarium MoV",,loop,40
      end mouseUp
    * Part 9189:4 "PlaMarker"
      on mouseDown
      global MY_PlaMarker,MY_PlaLight
      htlock true
      if MY_PlaMarker is "on" then
      put field "pict name" & " (Switch-Off)" into WhichPict
      HTAddPict WhichPict, the rect of card button plamarker, "Srccopy"
      put "off" into MY_PlaMarker
      else
      put field "pict name" & " (Switch-On)" into WhichPict
      HTAddPict WhichPict, the rect of card button plamarker, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      play stop
      play "SW Marker"
      htlock forcefalse
      end mouseDown
    * Part 9189:6 "EnterPla"
      on mouseUp
      global MY_PlaLight
      if MY_PlaLight is not "off" then
      soundIdle
      go to card id 30143
      else
      soundIdle
      go to card id 38896
      end if
      playQT "MU Planetarium MoV",fadein,loop,150
      end mouseUp
    * Part 9189:5 "DoorOpen"
      on mouseUp
      set cursor to none
      play stop
      htlock "true"
      htvisual "wipe right",,the rect of card button doorclosed,2,32
      dplay "DR Creak Open"
      soundstop
      send openCard
      play stop
      play "DR door close"
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
  * Card 30143 "" (3 parts)
    * Part 30143:2 "right"
      on mouseUp
      go to card id 30633
      end mouseUp
    * Part 30143:3 "left"
      on mouseUp
      go to card id 30633
      end mouseUp
    * Part 30143:4 ""
      on mouseUp
      go to card id 42183
      end mouseUp
  * Card 42183 "" (3 parts)
    * Part 42183:1 "right"
      on mouseUp
      go to card id 42482
      end mouseUp
    * Part 42183:2 "left"
      on mouseUp
      go to card id 42482
      end mouseUp
    * Part 42183:3 ""
      on mouseUp
      go to card id 42659
      end mouseUp
  * Card 42659 "" (2 parts)
    * Part 42659:1 "up"
      on mouseUp
      push card
      dplay "EL Servo Motor"
      soundidle
      go to card id 41677
      play stop
      playQT "MU Planetarium MoV",,loop,60
      end mouseUp
    * Part 42659:2 ""
      on mouseUp
      go to card id 42482
      end mouseUp
  * Card 42800 "" (33 parts)

    on slideKnob which,startlim,endlim
    put 170 into theTop
    put 260 into theBottom
    put (endlim - startlim)/(theBottom - theTop) into incr
    put card field which into theOld
    put the loc of the target into theLoc
    repeat until the mouse is up
    get the mouseV
    if it < theTop then get theTop
    if it > theBottom then get theBottom
    put it into item 2 of theLoc
    set the loc of the target to theLoc
    get trunc(((it - theTop) * incr) + startlim)
    if it ≠ theOld then
    put it into card field which
    put it into theOld
    do "show" & which && it
    end if
    end repeat
    end slideKnob
    
    on arrow which,startlim,endlim,delta
    put 170 into theTop
    put 260 into theBottom
    put (theBottom - theTop)/(endlim - startlim) into incr
    set the icon of the target to 9450 + delta
    put card field which into number
    add delta to number
    if number > endlim then put endlim into number
    if number < startlim then put startlim into number
    do "show" & which && number
    ---- set the thumb loc
    get the loc of card button which
    put trunc(((number - startLim) * incr) + theTop) into item 2 of it
    set the loc of card button which to it
    ----------------------
    if the mouse is down then wait 5
    repeat while the mouse is down
    --wait 5
    add delta to number
    if number > endlim then put endlim into number
    if number < startlim then put startlim into number
    do "show" & which && number
    ---- set the thumb loc
    get the loc of card button which
    put trunc(((number - startLim) * incr) + theTop) into item 2 of it
    set the loc of card button which to it
    ----------------------
    end repeat
    put number into card field which
    set the icon of the target to 0
    end arrow
    
    on showMonth monthNum
    put "JAN FEB MAR APR MAY JUN JUL AUG SEP OCT NOV DEC" into monthList
    put word monthNum of monthList into MonthText
    set icon of card button M1 to "LCD-" & char 1 of MonthText
    set icon of card button M2 to "LCD-" & char 2 of MonthText
    set icon of card button M3 to "LCD-" & char 3 of MonthText
    end showMonth
    
    on showDay DayNum
    if the number of chars of DayNum = 1 then put "*" & DayNum into DayNum
    set icon of card button D1 to "LCD-" & char 1 of DayNum
    set icon of card button D2 to "LCD-" & char 2 of DayNum
    end showDay
    
    on showYear YearNum
    if the number of chars of YearNum = 1 then put "***" & YearNum into YearNum
    if the number of chars of YearNum = 2 then put "**" & YearNum into YearNum
    if the number of chars of YearNum = 3 then put "*" & YearNum into YearNum
    set icon of card button Y1 to "LCD-" & char 1 of YearNum
    set icon of card button Y2 to "LCD-" & char 2 of YearNum
    set icon of card button Y3 to "LCD-" & char 3 of YearNum
    set icon of card button Y4 to "LCD-" & char 4 of YearNum
    end showYear
    
    on showTime TimeNum
    put TimeNum mod 60 into theMin
    put TimeNum div 60 into theHour
    if theHour > 11 then
    put "P" into theAMPM
    put theHour - 12 into theHour
    else
    put "A" into theAMPM
    end if
    if theHour = 0 then put 12 into theHour
    if the number of chars of theMin = 1 then put "0" & theMin into theMin
    if the number of chars of theHour = 1 then put "*" & theHour into theHour
    set icon of card button T1 to "LCD-" & char 1 of theHour
    set icon of card button T2 to "LCD-" & char 2 of theHour
    set icon of card button T3 to "LCD-" & char 1 of theMin
    set icon of card button T4 to "LCD-" & char 2 of theMin
    set icon of card button T5 to "LCD-" & theAMPM
    end showTime
    
    on openCard
    set lockmessages to true
    put card field month of card id 41677 into card field month
    put card field day of card id 41677 into card field day
    put card field year of card id 41677 into card field year
    put card field time of card id 41677 into card field time
    set lockmessages to false
    showMonth card field month
    showDay card field day
    showYear card field year
    showTime card field time
    global pictAdd
    put "PlaKnob|" & the rect ¬
    of card button KnobA into pictAdd
    pass openCard
    end openCard

    * Part 42800:2 ""
      on mouseUp
      go to card id 42659
      end mouseUp
    * Part 42800:35 ""
    * Part 42800:4 "KnobA"
      on mouseDown
      beep
      end mouseDown
    * Part 42800:5 "M1"
    * Part 42800:6 "M2"
    * Part 42800:7 "M3"
    * Part 42800:8 "D1"
    * Part 42800:9 "D2"
    * Part 42800:10 "Y1"
    * Part 42800:11 "Y2"
    * Part 42800:12 "Y3"
    * Part 42800:13 "Y4"
    * Part 42800:14 "T2"
    * Part 42800:15 "T3"
    * Part 42800:16 "T4"
    * Part 42800:17 ""
      on mouseDown
      arrow Month,1,12,1
      end mouseDown
    * Part 42800:18 "month"
    * Part 42800:19 ""
      on mouseDown
      arrow Month,1,12,-1
      end mouseDown
    * Part 42800:20 ""
      on mouseDown
      arrow Day,1,31,1
      end mouseDown
    * Part 42800:21 ""
      on mouseDown
      arrow Day,1,31,-1
      end mouseDown
    * Part 42800:22 "day"
    * Part 42800:23 ""
      on mouseDown
      arrow Year,0,9999,-1
      end mouseDown
    * Part 42800:24 ""
      on mouseDown
      arrow Year,0,9999,1
      end mouseDown
    * Part 42800:25 "Year"
    * Part 42800:26 "Day"
      on mouseDown
      slideKnob Day,1,31
      end mouseDown
    * Part 42800:27 "Year"
      on mouseDown
      slideKnob Year,0,9999
      end mouseDown
    * Part 42800:28 "Month"
      on mouseDown
      slideKnob Month,1,12
      end mouseDown
    * Part 42800:29 "T1"
    * Part 42800:30 "T5"
    * Part 42800:31 "Time"
      on mouseDown
      slideKnob Time,0,1439
      end mouseDown
    * Part 42800:32 "Time"
    * Part 42800:33 ""
      on mouseDown
      arrow Time,0,1439,-1
      end mouseDown
    * Part 42800:34 ""
      on mouseDown
      arrow Time,0,1439,1
      end mouseDown
  * Card 42482 "" (3 parts)
    * Part 42482:1 "right"
      on mouseUp
      go to card id 42183
      end mouseUp
    * Part 42482:3 ""
      on mouseUp
      go to card id 30633
      end mouseUp
    * Part 42482:4 "left"
      on mouseUp
      go to card id 42183
      end mouseUp
  * Card 30633 "" (4 parts)
    * Part 30633:1 "right"
      on mouseUp
      go to card id 30143
      end mouseUp
    * Part 30633:2 "left"
      on mouseUp
      go to card id 30143
      end mouseUp
    * Part 30633:3 "none"
      on mouseDown
      global MY_PlaLight
      put the loc of me into origLoc
      put field "pict name" into WhichPict
      delete last word of WhichPict
      put WhichPict & " (button-on)" into WhichPict
      soundidle
      HTAddPict WhichPict, the rect of me, "Srccopy"
      set loc of me to 0,0
      play stop
      play "SW Pushbutton In"
      repeat until the mouse is up
      soundidle
      end repeat
      go to card id 38607
      play stop
      play "SW Pushbutton Out"
      put "off" into MY_PlaLight
      set the loc of me to origLoc
      end mouseDown
    * Part 30633:4 ""
      on mouseUp
      go to card id 9457
      fadeout
      play "DR Creak Open"
      wait 30
      play stop
      play "DR Door Close"
      playQT "AR Lite Wind MoV",fadein,loop,70
      end mouseUp
  * Card 38607 "" (5 parts)
    * Part 38607:2 "right"
      on mouseUp
      go to card id 38896
      end mouseUp
    * Part 38607:1 "none"
      on mouseDown
      global MY_PlaLight
      put the loc of me into origLoc
      put field "pict name" into WhichPict
      delete last word of WhichPict
      put WhichPict & " (button-off)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      soundidle
      set loc of me to 0,0
      play stop
      play "SW Pushbutton In"
      repeat until the mouse is up
      soundidle
      end repeat
      go to card id 30633
      soundidle
      play stop
      play "SW Pushbutton Out"
      put "on" into MY_PlaLight
      set the loc of me to origLoc
      end mouseDown
    * Part 38607:3 "left"
      on mouseUp
      go to card id 38896
      end mouseUp
    * Part 38607:4 ""
      on mouseUp
      go to card id 9457
      fadeout
      play "DR Creak Open"
      wait 20
      play stop
      play "DR Door Close"
      playQT "AR Lite Wind MoV",fadein,loop,70
      end mouseUp
    * Part 38607:5 "up"
      on mouseUp
      push card
      go to card id 78339
      end mouseUp
  * Card 38896 "" (4 parts)
    * Part 38896:2 "right"
      on mouseUp
      go to card id 38607
      end mouseUp
    * Part 38896:3 "left"
      on mouseUp
      go to card id 38607
      end mouseUp
    * Part 38896:4 ""
      on mouseUp
      go to card id 41124
      end mouseUp
    * Part 38896:5 "up"
      on mouseUp
      push card
      go to card id 78339
      end mouseUp
  * Card 41124 "" (3 parts)
    * Part 41124:1 ""
      on mouseUp
      go to card id 41328
      end mouseUp
    * Part 41124:2 "right"
      on mouseUp
      go to card id 41827
      end mouseUp
    * Part 41124:3 "left"
      on mouseUp
      go to card id 41827
      end mouseUp
  * Card 41328 "" (2 parts)
    * Part 41328:1 "up"
      on mouseUp
      push card
      play "EL Servo Motor"
      go to card id 41677
      end mouseUp
    * Part 41328:2 ""
      on mouseUp
      go to card id 41827
      end mouseUp
  * Card 41827 "" (4 parts)
    * Part 41827:1 "right"
      on mouseUp
      go to card id 41124
      end mouseUp
    * Part 41827:2 "left"
      on mouseUp
      go to card id 41124
      end mouseUp
    * Part 41827:3 ""
      on mouseUp
      go to card id 38607
      end mouseUp
    * Part 41827:4 "up"
      on mouseUp
      push card
      go to card id 78339
      end mouseUp
  * Card 78339 "" (1 parts)
    * Part 78339:1 "down"
      on mouseUp
      htlock "true"
      HTVisual "pan up",,,0,32
      pop card
      end mouseUp
  * Card 41677 "" (36 parts)

    on starMachine
    global thePict,MY_PlaMonth,MY_PlaDay,MY_PlaYear,MY_PlaTime,MY_PlaLastDate
    xcIcon3 the loc of card button knobA, 504
    if MY_PlaMonth is empty then
    put 1 into MYPlaMonth
    put 1 into MYPlaDay
    put 1 into MYPlaYear
    put 1 into MYPlaTime
    end if
    put MY_PlaMonth && MY_PlaDay && MY_PlaYear && MY_PlaTime into theSetting
    if theSetting ≠ MY_PlaLastDate then
    put (50 + (abs(MY_PlaYear - (word 3 of MY_PlaLastDate)) div 50) * 2 + the ticks) into theLoops
    put theSetting into MY_PlaLastDate
    play "MR PlanetMotors2" tempo 1 C
    repeat while theLoops > the ticks
    soundIdle
    get random(408) & comma & random(408)
    set the scroll of window thePict to it
    end repeat
    play stop
    end if
    SetStars
    hide card button knobA
    show card button knobA
    end starMachine
    
    --on closeCard
    HTLock"nobw"
    global thePict
    if there is a window thePict then close window thePict
    put empty into thePict
    pass closeCard
    end closeCard
    
    on idle
    global MY_PlaLight,thePict,MY_PlaMonth,MY_PlaDay,MY_PlaYear,MY_PlaTime,MY_PlaLastDate
    if MY_PlaLight is "on" then put "PlanetariumStarFieldLight" into thePict
    else put "PlanetariumStarField" into thePict
    if there is not a window thePict then
    put thePict into WhichPict
    xmemory(1)
    picture WhichPict,resource,rect,false,2
    
    set the rect of window WhichPict to the rect of card button "space"
    show window thePict
    arrow Month,1,12,0,true
    arrow Day,1,31,0,true
    arrow Year,0,9999,0,true
    arrow Time,0,1439,0,true
    starMachine
    end if
    put MY_PlaMonth && MY_PlaDay && MY_PlaYear && MY_PlaTime into theSetting
    if theSetting ≠ MY_PlaLastDate then
    xcIcon3 the loc of card button knobA, 501
    wait 5
    hide card button knobA
    show card button knobA
    end if
    end idle
    
    on SetStars
    global thePict,MY_PlaMonth,MY_PlaDay,MY_PlaYear,MY_PlaTime,MY_PlaLastDate
    put trunc(MY_PlaTime * .28) mod 407 into theX
    put ((MY_PlaDay * 20) + (MY_PlaMonth * 65) + (MY_PlaYear * 250)) mod 407 into theY
    set the scroll of window thePict to theX,theY
    --put theX && theY
    end SetStars
    
    on slideKnob which,startlim,endlim
    global MY_PlaMonth,MY_PlaDay,MY_PlaYear,MY_PlaTime,MY_PlaLastDate
    deCurse "override",2004,"color","nodelay"
    put 97 into theTop
    put 187 into theBottom
    put (endlim - startlim)/(theBottom - theTop) into incr
    do "put MY_Pla" & which & " into theOld"
    --put card field which into theOld
    put the loc of the target into theLoc
    repeat until the mouse is up
    soundIdle
    get the mouseV
    if it < theTop then get theTop
    if it > theBottom then get theBottom
    put it into item 2 of theLoc
    set the loc of the target to theLoc
    xcIcon3 the loc of the target,502
    get trunc(((it - theTop) * incr) + startlim)
    if it ≠ theOld then
    do "put it into MY_Pla" & which
    --put it into card field which
    put it into theOld
    do "show" & which && it
    end if
    end repeat
    hide the target
    show the target
    end slideKnob
    
    on arrow which,startlim,endlim,delta,init
    global MY_PlaMonth,MY_PlaDay,MY_PlaYear,MY_PlaTime,MY_PlaLastDate
    put 97 into theTop
    put 187 into theBottom
    put (theBottom - theTop)/(endlim - startlim) into incr
    if init is not true then set the icon of the target to 9450 + delta
    --put card field which into number
    do "put MY_Pla" & which & " into number"
    add delta to number
    if number > endlim then put endlim into number
    if number < startlim then put startlim into number
    do "show" & which && number
    ---- set the thumb loc
    get the loc of card button which
    put trunc(((number - startLim) * incr) + theTop) into item 2 of it
    set the loc of card button which to it
    xcIcon3 the loc of card button which,502
    ----------------------
    if the mouse is down then wait 5
    repeat while the mouse is down
    soundIdle
    --wait 5
    add delta to number
    if number > endlim then put endlim into number
    if number < startlim then put startlim into number
    do "show" & which && number
    ---- set the thumb loc
    get the loc of card button which
    put trunc(((number - startLim) * incr) + theTop) into item 2 of it
    set the loc of card button which to it
    xcIcon3 the loc of card button which,502
    ----------------------
    end repeat
    do "put number into MY_Pla" & which
    --put number into card field which
    if init is not true then set the icon of the target to 0
    hide card button which
    show card button which
    end arrow
    
    on showMonth monthNum
    put "JAN FEB MAR APR MAY JUN JUL AUG SEP OCT NOV DEC" into monthList
    put word monthNum of monthList into MonthText
    play stop
    play "BP ShortElec"
    set icon of card button M1 to "LCD-" & char 1 of MonthText
    set icon of card button M2 to "LCD-" & char 2 of MonthText
    set icon of card button M3 to "LCD-" & char 3 of MonthText
    end showMonth
    
    on showDay DayNum
    if the number of chars of DayNum = 1 then put "*" & DayNum into DayNum
    play stop
    play "BP ShortElec"
    set icon of card button D1 to "LCD-" & char 1 of DayNum
    set icon of card button D2 to "LCD-" & char 2 of DayNum
    end showDay
    
    on showYear YearNum
    if the number of chars of YearNum = 1 then put "***" & YearNum into YearNum
    if the number of chars of YearNum = 2 then put "**" & YearNum into YearNum
    if the number of chars of YearNum = 3 then put "*" & YearNum into YearNum
    play stop
    play "BP ShortElec"
    set icon of card button Y1 to "LCD-" & char 1 of YearNum
    set icon of card button Y2 to "LCD-" & char 2 of YearNum
    set icon of card button Y3 to "LCD-" & char 3 of YearNum
    set icon of card button Y4 to "LCD-" & char 4 of YearNum
    end showYear
    
    on showTime TimeNum
    put TimeNum mod 60 into theMin
    put TimeNum div 60 into theHour
    if theHour > 11 then
    put "P" into theAMPM
    put theHour - 12 into theHour
    else
    put "A" into theAMPM
    end if
    if theHour = 0 then put 12 into theHour
    if the number of chars of theMin = 1 then put "0" & theMin into theMin
    if the number of chars of theHour = 1 then put "*" & theHour into theHour
    play stop
    play "BP ShortElec"
    set icon of card button T1 to "LCD-" & char 1 of theHour
    set icon of card button T2 to "LCD-" & char 2 of theHour
    set icon of card button T3 to "LCD-" & char 1 of theMin
    set icon of card button T4 to "LCD-" & char 2 of theMin
    set icon of card button T5 to "LCD-" & theAMPM
    end showTime
    
    on openCard
    global MY_PlaLight
    HTLock "bw"
    if MY_plaLight is "on" then put "lightsOn" into last word of field "pict name"
    else put "lightsOff" into last word of field "pict name"
    pass openCard
    end openCard

    * Part 41677:2 "down"
      on mouseUp
      global thePict
      htlock "true"
      if there is a window thePict then close window thePict
      put empty into thePict
      HTVisual "pan up",,,0,32
      soundidle
      dplay "EL Servo Motor"
      htlock "nobw"
      pop card
      play stop
      playQT "MU Planetarium MoV",fadein,loop,150
      end mouseUp
    * Part 41677:39 ""
    * Part 41677:4 "KnobA"
      on mouseDown
      set cursor to none
      play "SW PushButton In"
      StarMachine
      play stop
      play "SW PushButton Out"
      end mouseDown
    * Part 41677:6 "M1"
    * Part 41677:7 "M2"
    * Part 41677:8 "M3"
    * Part 41677:9 "D1"
    * Part 41677:10 "D2"
    * Part 41677:11 "Y1"
    * Part 41677:12 "Y2"
    * Part 41677:13 "Y3"
    * Part 41677:14 "Y4"
    * Part 41677:15 "T1"
    * Part 41677:16 "T2"
    * Part 41677:17 "T3"
    * Part 41677:18 "T4"
    * Part 41677:19 "T5"
    * Part 41677:20 ""
      on mouseDown
      arrow Month,1,12,1
      end mouseDown
    * Part 41677:22 ""
      on mouseDown
      arrow Day,1,31,1
      end mouseDown
    * Part 41677:23 ""
      on mouseDown
      arrow Year,0,9999,1
      end mouseDown
    * Part 41677:24 ""
      on mouseDown
      arrow Time,0,1439,1
      end mouseDown
    * Part 41677:25 "Month"
      on mouseDown
      slideKnob Month,1,12
      end mouseDown
      
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
    * Part 41677:26 "Day"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      slideKnob Day,1,31
      end mouseDown
    * Part 41677:27 "Year"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      slideKnob Year,0,9999
      end mouseDown
    * Part 41677:28 "Time"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      slideKnob Time,0,1439
      end mouseDown
    * Part 41677:29 ""
      on mouseDown
      arrow Month,1,12,-1
      end mouseDown
    * Part 41677:30 ""
      on mouseDown
      arrow Day,1,31,-1
      end mouseDown
    * Part 41677:31 ""
      on mouseDown
      arrow Year,0,9999,-1
      end mouseDown
    * Part 41677:32 ""
      on mouseDown
      arrow Time,0,1439,-1
      end mouseDown
    * Part 41677:33 "month"
    * Part 41677:34 "day"
    * Part 41677:35 "Year"
    * Part 41677:36 "Time"
    * Part 41677:38 "space"
    * Part 41677:40 "lastDate"
    * Part 41677:42 ""
      on mouseWithin
      deCurse "override",hand,"color","nodelay"
      deCurse "lock"
      end mousewithin
  * Card 9457 "" (7 parts)
    * Part 9457:4 "right"
      on mouseUp
      go to card id 9189
      end mouseUp
    * Part 9457:1 ""
      on mouseUp
      go to card id 9648
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
    * Part 9457:2 ""
      on mouseUp
      go to card id 9960
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
    * Part 9457:3 "left"
      on mouseUp
      go to card id 9189
      end mouseUp
    * Part 9457:5 ""
      on mouseUp
      go to card id 9648
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
    * Part 9457:6 ""
      on mouseUp
      go to card id 9960
      playQT "AR Lite Wind MoV",,loop,90
      end mouseUp
    * Part 9457:11 ""
      on mouseUp
      go to card id 9648
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
  * Card 9960 "" (6 parts)
    * Part 9960:1 "left"
      on mouseUp
      go to card id 10238
      end mouseUp
    * Part 9960:2 "right"
      on mouseUp
      go to card id 10238
      end mouseUp
    * Part 9960:3 ""
      on mouseUp
      go to card id 11357
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 9960:4 ""
      on mouseUp
      go to card id 11521
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 9960:5 ""
      on mouseUp
      go to card id 11943
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
    * Part 9960:6 "qbre2"
      on mouseUp
      go to card id 11943
      playQT "AR Lite Wind MoV",,loop,180
      end mouseUp
  * Card 10238 "" (6 parts)

    on openCard
    global pictAdd,MY_PlaMarker,MY_Boat
    if the last word of bg field 1 is "boatup" then
    delete the last word of bg field 1
    end if
    
    if MY_PlaMarker is "on" then
    put field "pict name" & " (Switch-on)|" & the rect ¬
    of card button PlaMarker into pictAdd
    end if
    if MY_Boat is "up" and the last word of bg field 1 ≠ "BoatUp" then
    put " BoatUp" after bg field 1
    end if
    if MY_Boat ≠ "up" and the last word of bg field 1 = "BoatUp" then
    delete the last word of bg field 1
    end if
    pass openCard
    end openCard

    * Part 10238:2 ""
      on mouseUp
      go to card id 9648
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
    * Part 10238:4 "right"
      on mouseUp
      go to card id 9960
      end mouseUp
    * Part 10238:5 "PlaMarker"
      --on mouseUp
      global MY_PlaMarker
      put field "pict name" into WhichPict
      if MY_PlaMarker is "on" then
      HTChangePict WhichPict,"Srccopy"
      put "off" into MY_PlaMarker
      else
      put WhichPict & " (Switch-on)" into WhichPict
      HTAddPict WhichPict, the rect of me, "Srccopy"
      put "on" into MY_PlaMarker
      end if
      go this card
      end mouseUp
    * Part 10238:1 ""
      on mouseUp
      go to card id 9189
      end mouseUp
    * Part 10238:3 "left"
      on mouseUp
      go to card id 9960
      end mouseUp
    * Part 10238:7 ""
      on mouseUp
      go to card id 9648
      playQT "AR Lite Wind MoV",,loop,70
      end mouseUp
  * Card 25499 "last" (0 parts)
  * Background 2365 "" (3 parts)
    * Part 2365:8 ""
      on mouseUp
      
      end mouseUp
    * Part 2365:1 "pict name"
      on mouseUp
      global stackPre
      if the optionkey is down then
      answer file "Which PICT file?" of type PICT
      if it ≠ empty then
      set itemDelimiter to ":"
      get ":Myst Graphics:Myst:" & the last item of it
      put it into me
      --put it
      --put it into WhichPict
      put stackPre & it into WhichPict
      else
      put empty into me
      put empty into WhichPict
      end if
      if WhichPict ≠ empty then
      HTChangePict WhichPict,"file"
      end if
      set itemDelimiter to ","
      go to this card
      end if
      end mouseUp
    * Part 2365:6 "Card ID"
