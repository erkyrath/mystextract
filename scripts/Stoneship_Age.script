Stack (183 cards, 1 backgrounds)

  
  on openStack
  global All_CurrStack,S_SCREENPOS,ST_GenTime,documents
  -- The documents paths are for MooVs - always on the CD
  put "Myst:Myst Graphics:Stoneship:" into documents
  SetScreen
  BlackFrame
  xMemory(1)
  HTudefpal 5001
  HyperTint "later","delay","iRes5","NoTEOpt"
  htlock novbl
  htlock nobw
  htlock nocolormap
  start using stack "STRes1"
  start using stack "STRes2"
  DeCurse "install"
  deCurse "override","hand","color","nodelay"
  initGlobals
  put "Stoneship Age" into All_CurrStack
  if ST_GenTime < the ticks then put 0 into ST_GenTime
  end openStack
  
  on closeStack
  DeCurse "remove"
  htlock true
  closemoovs
  HTRemove
  stop using stack "STRes1"
  stop using stack "STRes2"
  end closeStack
  
  on closemoovs
  global telename
  if there is a window telename then close window telename
  repeat with x = (the number of lines in the windows) down to 1
  if line x of the windows contains "moov" then close window (line x of the windows)
  else if line x of the windows contains "mov" then close window (line x of the windows)
  end repeat
  end closemoovs
  
  on openCard
  global pictAdd,startTime,HCSounds
  soundIdle
  HTChangePict fld "pict name","srcCopy"
  get the result
  if it is not empty then
  soundstop
  xmemory(1)
  HTChangePict bg fld "pict name","srccopy"
  end if
  soundIdle
  if pictAdd is not empty then
  set itemdelimiter to "|"
  repeat with x = 1 to the number of lines in pictAdd
  if line x of pictAdd is not empty then
  HTAddPict item 1 of line x of pictAdd, item 2 of line x of pictAdd,"srcCopy"
  end if
  soundIdle
  end repeat
  set itemdelimiter to ","
  put empty into pictAdd
  end if
  soundidle
  if HCSounds is not empty then
  play stop
  repeat with x = 1 to the number of lines in HCSounds
  do ("Play " & quote & line x of HCSounds & quote)
  end repeat
  put empty into HCSounds
  end if
  HTLock "forceFalse"
  soundIdle
  hide msg
  wait while the mouseclick
  updateCursor ML
  pass openCard
  end openCard
  
  on closeCard
  global startTime
  set cursor to none
  put the ticks into startTime
  HTLock "on"
  end closeCard
  
  on initGlobals
  global ST_Book
  put "down" into ST_Book
  end initGlobals
  
  on idle
  global ST_GenTime, ST_SonLight, ST_DadLight,ST_DomeTunnel
  soundidle
  if ST_GenTime ≠ 0 then
  if ST_GenTime > the ticks then wait 0 --put (ST_GenTime - the ticks) DIV 60
  else
  put "off" into ST_dadlight
  if ST_DomeTunnel is "open" then put "blue" into ST_sonlight
  else put "off" into ST_sonLight
  put 0 into ST_GenTime
  send "openCard" to this card
  go card
  end if
  end if
  end idle
  
  on Buzzer thevolume
  global ST_sonLight
  if ST_sonLight is "blue" then
  if thevolume is empty then put 256 into thevolume
  put "SW Buzzer.MoV" into theSoundName
  if there is not a window theSoundName then
  Movie TheSoundName,,,"invisible"
  set the dontErase of window TheSoundName to true
  set the movieCursorID of window TheSoundName to 128
  set the mute of window TheSoundName to false
  set the badge of window TheSoundName to false
  set the controllerVisible of window TheSoundName to false
  set the closeOnFinish of window TheSoundName to false
  set the loop of window TheSoundName to true
  set the seeAllFrames of window TheSoundName to false
  set the passMovieClick of window TheSoundName to false
  set the rate of window TheSoundName to "1.0"
  end if
  set the audioLevel of window theSoundName to thevolume
  end if
  end buzzer
  
  \0olume
  end if
  end buzzer
  
  \0 the passMovieClick of window TheSoundName to false
  set the rate of window TheSoundName to "1.0"
  end if
  set the audioLevel of window theSoundName to thevolume
  end if
  end buzzer
  
  \0
  \0nd buzzer
  
  \0dioLevel of window theSoundName to thevolume
  end if
  end buzzer

  * Card 3004 "restart" (6 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker2
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    PlayQT "AR Water/Wind Mov", , loop, 175
    pass openCard
    end openCard

    * Part 3004:5 "marker2"
    * Part 3004:1 "right"
      on mouseUp
      go to card id 4355
      PlayQT "AR Water/Wind Mov", , loop, 175
      end mouseUp
    * Part 3004:2 "left"
      on mouseUp
      go to card id 4785
      PlayQT "AR Water/Wind Mov", , loop, 175
      end mouseUp
    * Part 3004:3 ""
      on mouseUp
      go to card id 7277
      PlayQT "AR Water/Wind Mov", , loop, 175
      end mouseUp
    * Part 3004:4 ""
      on mouseUp
      go to card id 8154
      end mouseUp
    * Part 3004:9 "qbow"
      on mouseUp
      go to card id 7277
      PlayQT "AR Water/Wind Mov", , loop, 175
      end mouseUp
  * Card 25833 "Black" (0 parts)
  * Card 7277 "" (3 parts)
    * Part 7277:1 "right"
      on mouseUp
      go to card id 7674
      end mouseUp
    * Part 7277:2 "left"
      on mouseUp
      go to card id 8154
      end mouseUp
    * Part 7277:3 ""
      on mouseUp
      go to card id 8277
      end mouseUp
  * Card 8277 "" (3 parts)
    * Part 8277:1 "right"
      on mouseUp
      go to card id 8569
      end mouseUp
    * Part 8277:2 "left"
      on mouseUp
      go to card id 8569
      end mouseUp
    * Part 8277:3 ""
      on mouseUp
      go to card id 8776
      end mouseUp
  * Card 8776 "qbow" (4 parts)

    on opencard
    playqt "AR Water/Wind Mov","","loop","175"
    pass opencard
    end opencard

    * Part 8776:1 "right"
      on mouseUp
      go to card id 14498
      end mouseUp
    * Part 8776:2 "left"
      on mouseUp
      go to card id 9375
      end mouseUp
    * Part 8776:3 ""
      on mouseUp
      go to card id 9713
      end mouseUp
    * Part 8776:4 "qtel"
      on mouseUp
      go to card id 9713
      end mouseUp
  * Card 14498 "" (3 parts)
    * Part 14498:1 "left"
      on mouseUp
      go to card id 8776
      end mouseUp
    * Part 14498:2 "right"
      on mouseUp
      go to card id 9010
      end mouseUp
    * Part 14498:3 ""
      on mouseUp
      go to card id 38245
      end mouseUp
  * Card 24007 "" (5 parts)
    * Part 24007:1 "right"
      on mouseUp
      go to card id 38245
      end mouseUp
    * Part 24007:2 "left"
      on mouseUp
      go to card id 38423
      end mouseUp
    * Part 24007:3 ""
      on mouseUp
      go to card id 9713
      end mouseUp
    * Part 24007:4 ""
      on mouseUp
      go to card id 9713
      end mouseUp
    * Part 24007:5 "qtel"
      on mouseUp
      go to card id 9713
      end mouseUp
  * Card 25561 "" (3 parts)
    * Part 25561:1 "left"
      on mouseUp
      go to card id 38245
      end mouseUp
    * Part 25561:2 "right"
      on mouseUp
      go to card id 38423
      end mouseUp
    * Part 25561:3 "qste4 right"
      on mouseUp
      go to card id 38423
      end mouseUp
  * Card 38245 "" (2 parts)
    * Part 38245:1 "right"
      on mouseUp
      go to card id 25561
      end mouseUp
    * Part 38245:2 "left"
      on mouseUp
      go to card id 24007
      end mouseUp
  * Card 38423 "" (6 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker2
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 38423:1 "right"
      on mouseUp
      go to card id 24007
      end mouseUp
    * Part 38423:2 "left"
      on mouseUp
      go to card id 25561
      end mouseUp
    * Part 38423:3 "marker2"
      on mouseUp
      go to card id 9375
      end mouseUp
    * Part 38423:4 ""
      on mouseUp
      go to card id 9010
      end mouseUp
    * Part 38423:5 ""
      on mouseUp
      go to card id 9713
      end mouseUp
    * Part 38423:6 "qtel right"
      on mouseUp
      go to card id 24007
      end mouseUp
  * Card 9713 "" (4 parts)
    * Part 9713:1 ""
      on mouseUp
      go to card id 9774
      playQT "MU Telescope/Wind Mov", fadeboth, loop, 25
      end mouseUp
    * Part 9713:2 "right"
      on mouseUp
      go to card id 15443
      end mouseUp
    * Part 9713:3 "left"
      on mouseUp
      go to card id 15443
      end mouseUp
    * Part 9713:4 "qtel"
      on mouseUp
      go to card id 9774
      playQT "MU Telescope/Wind Mov", fadeboth, loop, 25
      end mouseUp
  * Card 9774 "" (4 parts)
    * Part 9774:1 ""
      on mouseUp
      go to card id 10143
      playQT "MU Telescope/Wind Mov", , loop, 50
      end mouseUp
    * Part 9774:2 "right"
      on mouseUp
      go to card id 15190
      end mouseUp
    * Part 9774:3 "left"
      on mouseUp
      go to card id 15190
      end mouseUp
    * Part 9774:4 "qtel"
      on mouseUp
      go to card id 10143
      playQT "MU Telescope/Wind Mov", , loop, 50
      end mouseUp
  * Card 10143 "" (4 parts)
    * Part 10143:1 ""
      on mouseUp
      go to card id 10287
      playQT "MU Telescope/Wind Mov", , loop, 75
      end mouseUp
    * Part 10143:2 "right"
      on mouseUp
      go to card id 14901
      end mouseUp
    * Part 10143:3 "left"
      on mouseUp
      go to card id 14901
      end mouseUp
    * Part 10143:4 "qtel"
      on mouseUp
      go to card id 10287
      playQT "MU Telescope/Wind Mov", , loop, 75
      end mouseUp
  * Card 10287 "" (4 parts)
    * Part 10287:1 ""
      on mouseUp
      go to card id 10747
      playQT "MU Telescope/Wind Mov", , loop, 90
      end mouseUp
    * Part 10287:2 "right"
      on mouseUp
      go to card id 14622
      end mouseUp
    * Part 10287:3 "left"
      on mouseUp
      go to card id 14622
      end mouseUp
    * Part 10287:4 "qtel"
      on mouseUp
      go to card id 10747
      playQT "MU Telescope/Wind Mov", , loop, 90
      end mouseUp
  * Card 14622 "" (4 parts)
    * Part 14622:3 "right"
      on mouseUp
      go to card id 10287
      end mouseUp
    * Part 14622:1 ""
      on mouseUp
      go to card id 14901
      playQT "MU Telescope/Wind Mov", , loop, 70
      end mouseUp
    * Part 14622:2 "left"
      on mouseUp
      go to card id 10287
      end mouseUp
    * Part 14622:5 "qtel2 right"
      on mouseUp
      go to card id 10287
      end mouseUp
  * Card 14901 "" (4 parts)
    * Part 14901:1 ""
      on mouseUp
      go to card id 15190
      playQT "MU Telescope/Wind Mov", , loop, 50
      end mouseUp
    * Part 14901:2 "right"
      on mouseUp
      go to card id 10143
      end mouseUp
    * Part 14901:3 "left"
      on mouseUp
      go to card id 10143
      end mouseUp
    * Part 14901:4 "qtel2"
      on mouseUp
      go to card id 15190
      playQT "MU Telescope/Wind Mov", , loop, 50
      end mouseUp
  * Card 15190 "" (4 parts)
    * Part 15190:1 ""
      on mouseUp
      go to card id 15443
      playQT "MU Telescope/Wind Mov", , loop, 25
      end mouseUp
    * Part 15190:2 "left"
      on mouseUp
      go to card id 9774
      end mouseUp
    * Part 15190:3 "right"
      on mouseUp
      go to card id 9774
      end mouseUp
    * Part 15190:4 "qtel2"
      on mouseUp
      go to card id 15443
      playQT "MU Telescope/Wind Mov", , loop, 25
      end mouseUp
  * Card 15443 "" (3 parts)
    * Part 15443:1 "right"
      on mouseUp
      go to card id 9713
      end mouseUp
    * Part 15443:3 "left"
      on mouseUp
      go to card id 14498
      end mouseUp
    * Part 15443:4 ""
      on mouseUp
      go to card id 44466
      playQT "AR Water/Wind Mov", fadeboth, loop, 175
      end mouseUp
  * Card 44466 "qtel2" (5 parts)

    on opencard
    playQT "AR Water/Wind Mov", fadeboth, loop, 175
    pass opencard
    end opencard

    * Part 44466:1 ""
      on mouseUp
      go to card id 9010
      end mouseUp
    * Part 44466:2 ""
      on mouseUp
      go to card id 9375
      end mouseUp
    * Part 44466:3 "left"
      on mouseUp
      go to card id 14498
      end mouseUp
    * Part 44466:4 "right"
      on mouseUp
      go to card id 9713
      end mouseUp
    * Part 44466:5 "qste4"
      on mouseUp
      go to card id 9010
      end mouseUp
  * Card 10747 "" (4 parts)
    * Part 10747:1 ""
      on mouseUp
      go to card id 10756
      playQT "MU Telescope/Wind Mov", , loop, 125
      end mouseUp
    * Part 10747:3 "right"
      on mouseUp
      go to card id 16564
      end mouseUp
    * Part 10747:4 "left"
      on mouseUp
      go to card id 16564
      end mouseUp
    * Part 10747:5 "qtel"
      on mouseUp
      go to card id 10756
      playQT "MU Telescope/Wind Mov", , loop, 125
      end mouseUp
  * Card 10756 "" (3 parts)
    * Part 10756:1 ""
      on mouseUp
      go to card id 11193
      playQT "MU Telescope/Wind Mov", , loop, 250
      end mouseUp
    * Part 10756:2 "right"
      on mouseUp
      go to card id 16326
      end mouseUp
    * Part 10756:3 "left"
      on mouseUp
      go to card id 16326
      end mouseUp
  * Card 11193 "qtel" (3 parts)

    on opencard
    playQT "MU Telescope/Wind Mov", , loop, 250
    pass opencard
    end opencard

    * Part 11193:1 "right"
      on mouseUp
      go to card id 16033
      end mouseUp
    * Part 11193:2 "left"
      on mouseUp
      go to card id 16033
      end mouseUp
    * Part 11193:3 ""
      on mouseUp
      soundstop
      put the ticks + 10 into endtime
      repeat until the ticks ≥ endtime
      send idle
      end repeat
      go to card id 57878
      end mouseUp
  * Card 57878 "" (5 parts)

    on mousewithin
    
    end mousewithin
    
    on mouseEnter
    
    end mouseEnter
    
    on mouseDowninPicture
    global theScroll,teleName
    deCurse "override",2004,"color","nodelay"
    deCurse "lock"
    put the mouseH into mouseStart
    put item 1 of the scroll of window teleName into theScroll
    put theScroll into origScroll
    repeat until the mouse is up
    put origScroll into theScroll
    put the mouseH into theMouse
    put round(theScroll + 3240 + (mouseStart - theMouse)) mod 3240 into theScroll
    set the scroll of window teleName to (theScroll & comma & theAdjust())
    end repeat
    deCurse "override","2003","color","nodelay"
    deCurse "lock"
    put the mouseH into theEndMouse
    put (theEndMouse - theMouse) div 2 into theSpeed
    repeat until theSpeed = 0
    if theSpeed < 0 then add 1 to theSpeed
    else subtract 1 from theSpeed
    put round(theScroll + 3240 - theSpeed) mod 3240 into theScroll
    set the scroll of window teleName to (theScroll & comma & theAdjust())
    if the mouse is down then
    mouseDownInPicture
    exit repeat
    end if
    end repeat
    end mouseDowninPicture
    
    on idle
    global theScroll,teleName
    if there is not a window teleName then
    set cursor to "none"
    put "telescope4" into teleName
    picture telescope4,resource,rect,false
    if the result is not empty then
    picture telescope4,resource,rect,false,4
    if the result is not empty then
    put the result
    answer "Sorry, you've run out of memory. Don't worry, just save your game, quit, and come right back here."
    go to card id 11193
    exit idle
    end if
    put "telescope4" into teleName
    end if
    set the rect of window teleName to the rect of card button "pict"
    set the scroll of window teleName to 0,0
    set the dithering of window teleName to false
    show window teleName
    deCurse "override","hand","color","nodelay"
    deCurse "lock"
    end if
    if there is a window teleName then
    get (theScroll & comma & theAdjust())
    if the scroll of window teleName ≠ it then set the scroll of window teleName to it
    if the mouseLoc is not within the rect of this card then
    deCurse "unlock"
    --deCurse "override","hand","color","nodelay"
    end if
    end if
    end idle
    
    function theAdjust
    global theScroll,ST_GenTime
    -- if the power's on and we're looking at the lighthouse and the time to flash is ok than flash it
    if ST_GenTime ≠ 0 and theScroll > 1125 and theScroll < 1305 and ((the ticks div 10) mod 5) > 2 then get 112 else get 0
    return it
    end theAdjust
    
    on openCard
    global theScroll
    put 0 into theScroll
    fadeOut
    xmemory(1)
    pass openCard
    end openCard
    
    on closeCard
    global theScroll,teleName
    put empty into theScroll
    playQT "MU Telescope/Wind Mov",fadeIn,loop,250
    if there is a window teleName then close window teleName
    pass closeCard
    end closeCard
    
    --on scrollTelescope delta
    global theScroll,teleName
    put 0 into ScrollVel
    if there is a window teleName then
    repeat until the mouse is up
    if delta > 0 then put min(delta + scrollVel,6) into scrollVel
    else put max(delta + scrollVel,-6) into scrollVel
    put scrollVel + theScroll into theScroll
    put round(theScroll + 3240 + scrollVel) mod 3240 into theScroll
    set the scroll of window teleName to (theScroll & comma & theAdjust())
    end repeat
    repeat until scrollVel = 0
    put round(theScroll + 3240 + scrollVel) mod 3240 into theScroll
    set the scroll of window teleName to (theScroll & comma & theAdjust())
    subtract delta from scrollVel
    end repeat
    end if
    end scrollTelescope

    * Part 57878:1 "scope"
      on mouseEnter
      deCurse "override","hand","color","nodelay"
      deCurse "lock"
      end mouseEnter
      
      on mouseLeave
      deCurse "override","hand","color","nodelay"
      deCurse "lock"
      end mouseLeave
      
      on mouseUp
      hc
      htlock true
      vd
      go to card id 11193
      end mouseUp
    * Part 57878:10 ""
      on mouseWithin
      deCurse "override",2003,"color","nodelay"
      deCurse "lock"
      end mousewithin
      
      on mouseDown
      global theScroll
      deCurse "override",2004,"color","nodelay"
      deCurse "lock"
      put the mouseH into mouseStart
      put item 1 of the scroll of window telescope4 into theScroll
      put theScroll into origScroll
      put the mouseH into theMouse
      repeat until the mouse is up
      put origScroll into theScroll
      put the mouseH into theMouse
      put round(theScroll + 3240 + (mouseStart - theMouse)) mod 3240 into theScroll
      set the scroll of window telescope4 to (theScroll & comma & theAdjust())
      end repeat
      deCurse "override","2003","color","nodelay"
      deCurse "lock"
      put the mouseH into theEndMouse
      put (theEndMouse - theMouse) div 2 into theSpeed
      repeat until theSpeed = 0
      if theSpeed < 0 then add 1 to theSpeed
      else subtract 1 from theSpeed
      put round(theScroll + 3240 - theSpeed) mod 3240 into theScroll
      set the scroll of window telescope4 to (theScroll & comma & theAdjust())
      if the mouse is down then
      mouseDownInPicture
      exit repeat
      end if
      end repeat
      end mouseDown
    * Part 57878:7 "left"
      on mousedown
      scrollTelescope -.1
      end mousedown
    * Part 57878:6 "right"
      on mousedown
      scrollTelescope .1
      end mousedown
    * Part 57878:2 "pict"
  * Card 16033 "" (4 parts)
    * Part 16033:1 "right"
      on mouseUp
      go to card id 11193
      end mouseUp
    * Part 16033:2 "left"
      on mouseUp
      go to card id 11193
      end mouseUp
    * Part 16033:3 ""
      on mouseUp
      go to card id 16326
      playQT "MU Telescope/Wind Mov", , loop, 150
      end mouseUp
    * Part 16033:4 "qtel2"
      on mouseUp
      go to card id 16326
      end mouseUp
  * Card 16326 "" (4 parts)
    * Part 16326:1 "right"
      on mouseUp
      go to card id 10756
      end mouseUp
    * Part 16326:2 "left"
      on mouseUp
      go to card id 10756
      end mouseUp
    * Part 16326:3 ""
      on mouseUp
      go to card id 16564
      playQT "MU Telescope/Wind Mov", , loop, 100
      end mouseUp
    * Part 16326:4 ""
      on mouseUp
      go to card id 16564
      end mouseUp
  * Card 16564 "" (4 parts)
    * Part 16564:1 "right"
      on mouseUp
      go to card id 10747
      end mouseUp
    * Part 16564:2 "left"
      on mouseUp
      go to card id 10747
      end mouseUp
    * Part 16564:3 ""
      on mouseUp
      go to card id 14622
      playQT "MU Telescope/Wind Mov", , loop, 90
      end mouseUp
    * Part 16564:4 ""
      on mouseUp
      go to card id 14622
      end mouseUp
  * Card 9375 "" (7 parts)

    on openCard
    global ST_Pump,ST_SonLight
    put "Boat4-N" into field "pict name"
    hide card button qAchD
    if ST_Pump = 2 then
    show card button qAchD
    if ST_SonLight is not "on" then
    put " dark/dry" after field "pict name"
    else
    put " dry" after field "pict name"
    end if
    else
    if ST_SonLight is not "on" then
    put " dark" after field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 9375:5 "marker2"
    * Part 9375:3 "marker"
    * Part 9375:6 "marker3"
    * Part 9375:4 ""
      on mouseUp
      go to card id 32358
      playQT "EV Drip II Mov",fadeboth , loop, 50
      end mouseUp
    * Part 9375:1 "right"
      on mouseUp
      go to card id 8776
      end mouseUp
    * Part 9375:2 "left"
      on mouseUp
      go to card id 9010
      end mouseUp
    * Part 9375:8 "qAchD"
      on mouseUp
      go to card id 32358
      playQT "EV Drip II Mov",fadeboth , loop, 50
      end mouseUp
  * Card 32358 "" (5 parts)

    on openCard
    global ST_Pump,ST_SonLight
    put field "pict name" into thePict
    hide card button qAchD
    if ST_Pump = 2 then
    show card button qAchD
    if ST_SonLight is not "on" then
    put " (dark,dry)" after thePict
    else
    put " (dry)" after thePict
    end if
    else
    if ST_SonLight is not "on" then
    put " (dark)" after thePict
    end if
    end if
    HTChangePict thePict,"srcCopy"
    htlock "forcefalse"
    end openCard

    * Part 32358:4 "marker2"
    * Part 32358:1 ""
      on mouseUp
      global ST_Pump
      if ST_Pump = 2 then go to card id 32643
      playQT "EV Drip II Mov",fadeboth , loop, 75
      end mouseUp
    * Part 32358:2 "right"
      on mouseUp
      go to card id 36189
      end mouseUp
    * Part 32358:3 "left"
      on mouseUp
      go to card id 36189
      end mouseUp
    * Part 32358:5 "qAchD"
      on mouseUp
      global ST_Pump
      if ST_Pump = 2 then go to card id 32643
      playQT "EV Drip II Mov",fadeboth , loop, 75
      end mouseUp
  * Card 32643 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 32643:1 ""
      on mouseUp
      go to card id 32964
      playQT "EV Drip II Mov",fadeboth , loop, 80
      Buzzer 10
      end mouseUp
    * Part 32643:2 "right"
      on mouseUp
      go to card id 35952
      end mouseUp
    * Part 32643:3 "left"
      on mouseUp
      go to card id 35952
      end mouseUp
    * Part 32643:4 "qAchD"
      on mouseUp
      go to card id 32964
      playQT "EV Drip II Mov",fadeboth , loop, 80
      Buzzer 10
      end mouseUp
  * Card 32964 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 32964:1 ""
      on mouseUp
      go to card id 33179
      playQT "EV Drip II Mov",fadeboth , loop, 90
      Buzzer 25
      end mouseUp
    * Part 32964:2 "right"
      on mouseUp
      go to card id 35832
      end mouseUp
    * Part 32964:3 "left"
      on mouseUp
      go to card id 35832
      end mouseUp
    * Part 32964:4 "qAchD"
      on mouseUp
      go to card id 33179
      playQT "EV Drip II Mov",fadeboth , loop, 90
      Buzzer 25
      end mouseUp
  * Card 33179 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 33179:1 ""
      on mouseUp
      go to card id 33288
      Buzzer 50
      end mouseUp
    * Part 33179:2 "right"
      on mouseUp
      go to card id 35436
      end mouseUp
    * Part 33179:3 "left"
      on mouseUp
      go to card id 35436
      end mouseUp
    * Part 33179:4 "qAchD"
      on mouseUp
      go to card id 33288
      Buzzer 50
      end mouseUp
  * Card 33288 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "off" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 33288:1 ""
      on mouseUp
      go to card id 33592
      Buzzer 100
      end mouseUp
    * Part 33288:2 "right"
      on mouseUp
      go to card id 35205
      end mouseUp
    * Part 33288:3 "left"
      on mouseUp
      go to card id 35205
      end mouseUp
    * Part 33288:4 "qAchD"
      on mouseUp
      go to card id 33592
      Buzzer 100
      end mouseUp
  * Card 33592 "" (7 parts)

    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle
    
    on openCard
    global ST_SonLight,pictAdd, ST_domeTunnel
    if ST_SonLight is "off" then
    hide card button door
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    show card button door
    if ST_SonLight is "on" then
    hide card pict
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    if ST_DomeTunnel is "open" then
    get the rect of card button marker
    put field "pict name" & " (open)|" & it into pictAdd
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on closeCard
    put "TunnelA6-down.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closeCard
    end closeCard
    
    on Done
    put "TunnelA6-down.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    end Done

    * Part 33592:7 "marker2"
    * Part 33592:5 "marker"
    * Part 33592:1 ""
      on mouseUp
      go to card id 34007
      Buzzer 75
      end mouseUp
    * Part 33592:2 "right"
      on mouseUp
      go to card id 34998
      end mouseUp
    * Part 33592:3 "left"
      on mouseUp
      go to card id 34998
      end mouseUp
    * Part 33592:4 "door"
      on mouseUp
      global ST_book,ST_DomeTunnel,pictAdd
      if ST_DomeTunnel is "open" then
      go to card id 44083
      Buzzer 200
      else
      play "SW Genlights on"
      hc
      put "TunnelA6-Down.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      Movie TheMovieName,"borderless",the topleft of card button marker2,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "256"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "0"
      set the endTime of window TheMovieName to "1,140"
      --set the callBackMsg of window theMovieName to "Done"
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "0.0"
      show window TheMovieName
      soundpause
      send preroll to window theMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window TheMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      get the rect of card button marker
      HTAddpict  ( field "pict name" & " (open)"),it,"srccopy"
      put "open" into ST_DomeTunnel
      close window theMovieName
      soundstart
      end if
      end if
      end mouseUp
    * Part 33592:8 "qAchD"
      on mouseUp
      go to card id 34007
      Buzzer 75
      end mouseUp
  * Card 31805 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 31805:2 "left"
      on mouseUp
      go to card id 34007
      Buzzer 75
      end mouseUp
    * Part 31805:1 ""
      on mouseUp
      go to card id 41982
      playQT "MU Compass/Bubbles Off Mov", , loop, 256
      Buzzer 250
      end mouseUp
    * Part 31805:3 "right"
      on mouseUp
      go to card id 34998
      Buzzer 75
      end mouseUp
  * Card 44083 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 44083:2 "left"
      on mouseUp
      go to card id 34007
      end mouseUp
    * Part 44083:1 ""
      on mouseUp
      go to card id 41982
      playQT "MU Compass/Bubbles Off Mov",, loop, 25
      Buzzer 250
      end mouseUp
    * Part 44083:3 "right"
      on mouseUp
      go to card id 34998
      end mouseUp
  * Card 41982 "" (4 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(blue)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (blue)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    put field "pict name" into WhichPict
    put "(dark)" into last word of WhichPict
    --put stackPre & ":Myst Graphics:Stoneship:Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 41982:1 ""
      on mouseUp
      go to card id 42238
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 175
      end mouseUp
    * Part 41982:2 "right"
      on mouseUp
      go to card id 41220
      end mouseUp
    * Part 41982:3 "left"
      on mouseUp
      go to card id 41220
      end mouseUp
    * Part 41982:5 "qdom1"
      on mouseUp
      go to card id 42238
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 175
      end mouseUp
  * Card 42238 "" (4 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(blue)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (blue)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    put field "pict name" into WhichPict
    put "(dark)" into last word of WhichPict
    --put stackPre & ":Myst Graphics:Stoneship:Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 42238:1 ""
      on mouseUp
      go to card id 42296
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 150
      end mouseUp
    * Part 42238:2 "right"
      on mouseUp
      go to card id 41079
      end mouseUp
    * Part 42238:3 "left"
      on mouseUp
      go to card id 41079
      end mouseUp
    * Part 42238:4 "qdom1"
      on mouseUp
      go to card id 42296
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 150
      end mouseUp
  * Card 42296 "" (3 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(dark)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (dark)" after field "pict name"
    end if
    pass openCard
    end openCard

    * Part 42296:1 ""
      on mouseUp
      go to card id 42593
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,150
      Buzzer 125
      end mouseUp
    * Part 42296:2 "right"
      on mouseUp
      go to card id 40849
      end mouseUp
    * Part 42296:3 "left"
      on mouseUp
      go to card id 40849
      end mouseUp
  * Card 42593 "qdom1" (3 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(dark)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    playQT "MU Compass/Bubbles On Mov", fadeboth, loop, 200
    else
    if ST_SonLight is not "on" then put " (dark)" after field "pict name"
    playQT "MU Compass/Bubbles Off Mov", fadeboth, loop, 150
    end if
    pass openCard
    end openCard

    * Part 42593:1 ""
      on mouseUp
      go to card id 42851
      end mouseUp
    * Part 42593:2 "right"
      on mouseUp
      go to card id 40560
      end mouseUp
    * Part 42593:3 "down"
      on mouseUp
      push card
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,250
      go to card id 40420
      Buzzer 100
      end mouseUp
  * Card 42851 "" (4 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(blue)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (blue)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    put field "pict name" into WhichPict
    put "(dark)" into last word of WhichPict
    --put stackPre & ":Myst Graphics:Stoneship:Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 42851:1 ""
      on mouseUp
      go to card id 43252
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,125
      Buzzer 150
      end mouseUp
    * Part 42851:2 "right"
      on mouseUp
      go to card id 40070
      end mouseUp
    * Part 42851:3 "left"
      on mouseUp
      go to card id 40070
      end mouseUp
    * Part 42851:4 "qDomB"
      on mouseUp
      go to card id 43252
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,125
      Buzzer 150
      end mouseUp
  * Card 43252 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    play stop
    Buzzer
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 43252:1 ""
      on mouseUp
      go to card id 43330
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 200
      end mouseUp
    * Part 43252:2 "right"
      on mouseUp
      go to card id 39710
      end mouseUp
    * Part 43252:3 "left"
      on mouseUp
      go to card id 39710
      end mouseUp
    * Part 43252:4 "qDomB"
      on mouseUp
      go to card id 43330
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 200
      end mouseUp
  * Card 43330 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 43330:1 ""
      on mouseUp
      go to card id 43543
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 200
      end mouseUp
    * Part 43330:2 "right"
      on mouseUp
      go to card id 39587
      end mouseUp
    * Part 43330:3 "left"
      on mouseUp
      go to card id 39587
      end mouseUp
    * Part 43330:4 "qDomB"
      on mouseUp
      go to card id 43543
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 200
      end mouseUp
  * Card 43543 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 43543:1 ""
      on mouseUp
      go to card id 44006
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,25
      Buzzer 255
      end mouseUp
    * Part 43543:2 "right"
      on mouseUp
      go to card id 39189
      end mouseUp
    * Part 43543:3 "left"
      on mouseUp
      go to card id 39189
      end mouseUp
  * Card 44006 "qDomB" (3 parts)

    on openCard
    global ST_SonLight,ST_dadlight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
    playQT theSound,,loop,25
    Buzzer 255
    pass openCard
    end openCard
    
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 44006:2 ""
      on mouseUp
      go to card id 43543
      Buzzer 200
      end mouseUp
    * Part 44006:1 "none"
      on mouseUp
      global st_sonlight
      if st_sonLight is not "blue" then
      vd
      go to card id 38754
      vs "left"
      end if
      go to card id 30263
      playQT "EV Drip II Mov",, loop, 90
      Buzzer 100
      end mouseUp
      
      on mousewithin
      deCurse "override","right","color","nodelay"
      end mousewithin
    * Part 44006:3 "none"
      on mouseUp
      global st_sonlight
      if st_sonLight is not "blue" then
      vd
      go to card id 38754
      vs "right"
      end if
      go to card id 29287
      playQT "EV Drip II Mov",, loop, 90
      Buzzer 100
      end mouseUp
      
      on mousewithin
      deCurse "override","left","color","nodelay"
      end mousewithin
  * Card 34007 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    pass openCard
    end if
    end openCard

    * Part 34007:1 ""
      on mouseUp
      go to card id 34261
      Buzzer 50
      end mouseUp
    * Part 34007:2 "right"
      on mouseUp
      go to card id 34573
      end mouseUp
    * Part 34007:3 "left"
      on mouseUp
      go to card id 34573
      end mouseUp
  * Card 34261 "qAchD" (7 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    show card button "none"
    hide card button "enter"
    playqt "EV Drip II Mov","","loop","90"
    Buzzer 50
    pass openCard
    end openCard

    * Part 34261:7 "doormarker"
    * Part 34261:1 "right"
      on mouseUp
      global ST_SonLight,ST_Qlist
      if ST_SonLight is "off" then
      if ST_Qlist contains "qAchD," then
      set the name of this card to "qAchD"
      else
      set the name of this card to empty
      end if
      else
      set the name of this card to "qAchD"
      end if
      if the visible of card button enter is true then
      go to card id 34559
      soundstop
      play "DR FrplDr Up"
      playQT "EV Drip II Mov",fadein,loop,60
      else
      go to card id 34559
      end if
      end mouseUp
    * Part 34261:6 "marker2"
    * Part 34261:4 "marker1"
    * Part 34261:5 "enter"
      on mouseUp
      global ST_SonLight,ST_Qlist
      if ST_SonLight is "off" then
      if ST_Qlist contains "qAchD," then
      set the name of this card to "qAchD"
      else
      set the name of this card to empty
      end if
      else
      set the name of this card to "qAchD"
      end if
      playQT "MU Achenar Rm Mov",,"loop",140
      go to card id 54498
      if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
      end mouseUp
    * Part 34261:2 "left"
      on mouseUp
      global ST_SonLight,ST_Qlist
      if ST_SonLight is "off" then
      if ST_Qlist contains "qAchD," then
      set the name of this card to "qAchD"
      else
      set the name of this card to empty
      end if
      else
      set the name of this card to "qAchD"
      end if
      if the visible of card button enter is true then
      go to card id 34559
      soundstop
      play "DR FrplDr Up"
      playQT "EV Drip II Mov",fadein,loop,60
      else
      go to card id 34559
      end if
      end mouseUp
    * Part 34261:3 "none"
      on mouseDown
      global ST_sonLight
      put field "pict name" into WhichPict
      put " (open)" after WhichPict
      HTLock "true"
      play "SW Pushbutton Out"
      HtVisual "scrollaway up",,the rect of card button doormarker,1,16
      if ST_sonLight is "on" then
      HTAddPict WhichPict,the rect of card button marker1,"srcCopy"
      else
      HTAddPict WhichPict,the rect of card button marker2,"srcCopy"
      end if
      play "DR FrplDr Dn"
      htlock "forcefalse"
      playQT "MU Achenar Rm Mov", fadein, loop, 25
      hide me
      show card button "enter"
      --go this card
      end mouseDown
  * Card 54498 "" (5 parts)
    * Part 54498:1 ""
      on mouseUp
      playQT "MU Achenar Rm Mov",,"loop",255
      go to card id 54590
      end mouseUp
    * Part 54498:2 "right"
      on mouseUp
      go to card id 56476
      end mouseUp
    * Part 54498:4 ""
      on mouseUp
      playQT "MU Achenar Rm Mov",,loop, 255
      go to card id 55640
      end mouseUp
    * Part 54498:5 "left"
      on mouseUp
      go to card id 56476
      end mouseUp
    * Part 54498:3 ""
      on mouseUp
      playQT "MU Achenar Rm Mov",, loop, 255
      go to card id 55086
      end mouseUp
  * Card 54590 "" (3 parts)
    * Part 54590:1 "left"
      on mouseUp
      go to card id 55086
      end mouseUp
    * Part 54590:2 "right"
      on mouseUp
      go to card id 55640
      end mouseUp
    * Part 54590:3 ""
      on mouseUp
      go to card id 56057
      end mouseUp
  * Card 56057 "" (3 parts)
    * Part 56057:1 ""
      on mouseUp
      go to card id 54590
      end mouseUp
    * Part 56057:2 ""
    * Part 56057:3 ""
  * Card 55086 "" (4 parts)

    on openCard
    global pictAdd,ALL_Page,MY_BlueBook
    if item 1 to 2 of ALL_Page is "4,A" or char 4 of MY_BlueBook = 1 then
    get the rect of card button page
    put field "pict name" & " (noPage)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 55086:4 "page"
    * Part 55086:1 "right"
      on mouseUp
      go to card id 54590
      end mouseUp
    * Part 55086:2 "left"
      on mouseUp
      go to card id 55464
      end mouseUp
    * Part 55086:3 ""
      on mouseUp
      go to card id 56279
      end mouseUp
  * Card 56279 "" (3 parts)

    on openCard
    global pictAdd,ALL_Page,MY_BlueBook
    if item 1 to 2 of ALL_Page is "4,A" or char 4 of MY_BlueBook = 1 then
    get the rect of card button page
    put field "pict name" & " (noPage)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 56279:1 ""
      on mouseUp
      go to card id 55086
      end mouseUp
    * Part 56279:2 ""
    * Part 56279:3 "page"
      on MouseDown
      global MY_BlueBook,ALL_Page
      if char 4 of MY_BlueBook is "0" then
      if char 1 to 3 of ALL_Page is not "4,A" then
      if All_Page is not empty then dropPage
      put "4,A,0" into ALL_Page
      htlock true
      opencard
      else
      put empty into ALL_Page
      UpdateCursor
      opencard
      end if
      end if
      dropState
      end MouseDown
  * Card 55464 "" (4 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 55464:4 "marker"
    * Part 55464:1 "right"
      on mouseUp
      go to card id 55086
      end mouseUp
    * Part 55464:2 "left"
      on mouseUp
      go to card id 55640
      end mouseUp
    * Part 55464:3 ""
      on mouseUp
      playQT "MU Achenar Rm Mov", , loop, 140
      go to card id 56476
      end mouseUp
  * Card 56476 "" (4 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 56476:4 "marker"
    * Part 56476:2 "left"
      on mouseUp
      go to card id 54498
      end mouseUp
    * Part 56476:1 ""
      on mouseUp
      go to card id 34559
      soundstop
      play "DR FrplDr Up"
      playQT "EV Drip II Mov", fadein, loop, 90
      end mouseUp
    * Part 56476:3 "right"
      on mouseUp
      go to card id 54498
      end mouseUp
  * Card 55640 "" (5 parts)
    * Part 55640:1 "right"
      on mouseUp
      go to card id 55464
      end mouseUp
    * Part 55640:2 "left"
      on mouseUp
      go to card id 54590
      end mouseUp
    * Part 55640:3 ""
      on mouseUp
      playQT "MU Achenar Rm Mov", , loop, 180
      go to card id 56690
      end mouseUp
    * Part 55640:5 ""
      on mouseUp
      push card
      go to card id 54156
      end mouseUp
    * Part 55640:6 ""
      on mouseUp
      push card
      go to card id 54808
      end mouseUp
  * Card 54808 "" (2 parts)
    * Part 54808:1 ""
      on mouseUp
      pop card
      end mouseUp
    * Part 54808:2 ""
  * Card 54156 "" (2 parts)
    * Part 54156:1 ""
      on mouseUp
      pop card
      end mouseUp
    * Part 54156:2 ""
  * Card 56690 "" (5 parts)
    * Part 56690:2 ""
      on mouseUp
      playQT "MU Achenar Rm Mov", , loop, 180
      go to card id 55640
      end mouseUp
    * Part 56690:1 ""
      on mouseUp
      go to card id 57056
      end mouseUp
    * Part 56690:3 ""
      on mouseUp
      playQT "MU Achenar Rm Mov", , loop, 120
      go to card id 57160
      resetButtons
      end mouseUp
    * Part 56690:4 ""
      on mouseUp
      push card
      go to card id 54808
      end mouseUp
    * Part 56690:5 ""
      on mouseUp
      push card
      go to card id 54156
      end mouseUp
  * Card 57160 "" (27 parts)

    on openCard
    global ST_ADrawers,pictAdd
    if char 6 of ST_ADrawers is "1" then
    get the rect of card button "m6"
    put field "pict name" & ".6|" & it into pictAdd
    end if
    repeat with x = 6 to 7
    if char x of ST_ADrawers is "1" then
    show card button ("close" & x)
    if x = 6 then show card button HalfPage
    repeat with y = x to 7
    hide card button ("open" & y)
    end repeat
    exit repeat
    else
    show card button ("open" & x)
    hide card button ("close" & x)
    end if
    end repeat
    pass openCard
    end openCard
    
    on leaveDrawers
    global ST_ADrawers
    put "0000000" into ST_ADrawers
    htLock true
    htvisual "wipe up",,,1,32
    resetDrawers
    go to card id 56690
    end leaveDrawers
    
    on resetDrawers
    global ST_ADrawers
    put field "pict name" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    hide card button HalfPage
    if ST_ADrawers contains "1" then
    repeat with x = 1 to 7
    if char x of ST_ADrawers is "1" then
    put field "pict name" & "." & x into WhichPict
    HTAddPict WhichPict,the rect of card button ("m" & x),"srcCopy"
    exit repeat
    end if
    end repeat
    go card
    repeat with x = 1 to 7
    if char x of ST_ADrawers is "1" then
    show card button ("close" & x)
    if x = 6 then show card button HalfPage
    repeat with y = x to 7
    hide card button ("open" & y)
    end repeat
    exit repeat
    else
    show card button ("open" & x)
    hide card button ("close" & x)
    end if
    end repeat
    play "DR Drawer"
    else
    resetButtons
    end if
    HTlock "forceFalse"
    end resetDrawers
    
    on resetButtons
    global ST_ADrawers
    show card button open1
    show card button open2
    show card button open3
    show card button open4
    show card button open5
    show card button open6
    show card button open7
    hide card button close1
    hide card button close2
    hide card button close3
    hide card button close4
    hide card button close5
    hide card button close6
    hide card button close7
    put "0000000" into ST_ADrawers
    end resetButtons

    * Part 57160:1 ""
      on mouseUp
      leaveDrawers
      end mouseUp
    * Part 57160:26 "m7"
    * Part 57160:25 "m6"
    * Part 57160:24 "m5"
    * Part 57160:23 "m4"
    * Part 57160:22 "m3"
    * Part 57160:21 "m2"
    * Part 57160:17 ""
    * Part 57160:2 ""
      on mouseUp
      go to card id 57056
      end mouseUp
    * Part 57160:19 "m1"
    * Part 57160:10 "close7"
      on mouseUp
      global ST_ADrawers
      show card button "open4"
      hide card button "close4"
      put 0 into char 7 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:11 "close6"
      on mouseUp
      global ST_ADrawers
      show card button "open4"
      hide card button "close4"
      put 0 into char 6 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:12 "close5"
      on mouseUp
      global ST_ADrawers
      show card button "open4"
      hide card button "close4"
      put 0 into char 5 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:13 "close4"
      on mouseUp
      global ST_ADrawers
      show card button "open4"
      hide card button "close4"
      put 0 into char 4 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,32
      resetDrawers
      end mouseUp
    * Part 57160:14 "close3"
      on mouseUp
      global ST_ADrawers
      show card button "open3"
      hide card button "close3"
      put 0 into char 3 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,32
      resetDrawers
      end mouseUp
    * Part 57160:15 "close2"
      on mouseUp
      global ST_ADrawers
      show card button "open4"
      hide card button "close4"
      put 0 into char 2 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,32
      resetDrawers
      end mouseUp
    * Part 57160:16 "close1"
      on mouseUp
      global ST_ADrawers
      show card button "open4"
      hide card button "close4"
      put 0 into char 1 of ST_Adrawers
      htLock true
      htvisual "wipe up",,,1,32
      resetDrawers
      end mouseUp
    * Part 57160:9 "open7"
      on mouseUp
      global ST_ADrawers
      put 1 into char 7 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:8 "open6"
      on mouseUp
      global ST_ADrawers
      put 1 into char 6 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:7 "open5"
      on mouseUp
      global ST_ADrawers
      put 1 into char 5 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:6 "open4"
      on mouseUp
      global ST_ADrawers
      put 1 into char 4 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:5 "open3"
      on mouseUp
      global ST_ADrawers
      put 1 into char 3 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:4 "open2"
      on mouseUp
      global ST_ADrawers
      put 1 into char 2 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:3 "open1"
      on mouseUp
      global ST_ADrawers
      put 1 into char 1 of ST_ADrawers
      htLock true
      htvisual "wipe down",,,1,16
      resetDrawers
      end mouseUp
    * Part 57160:18 "halfPage"
      on mouseUp
      go to card id 49743
      end mouseUp
    * Part 57160:27 ""
      on mouseUp
      leaveDrawers
      end mouseUp
    * Part 57160:28 ""
      on mouseUp
      leaveDrawers
      end mouseUp
  * Card 49743 "" (2 parts)
    * Part 49743:1 ""
      on mouseUp
      go to card id 57160
      end mouseUp
    * Part 49743:2 ""
  * Card 57056 "" (7 parts)

    on openCard
    fadeout
    pass opencard
    end openCard
    
    on mouseDownInMovie theMovie
    if theMovie is "Achenar-HoloControls.MooV" then -- added (1.0b8)
    global HoloSwitch
    deCurse "override",2004,"color","nodelay"
    repeat until the mouse is up
    get (the mouseH - the left of card button limit) div ((the right of card button limit - the left of card button limit) / 30)
    if it < 0 then get 0
    if it > 29 then get 29
    set the currTime of window "Achenar-HoloControls.MooV" to it * 60
    if HoloSwitch is "on" then set the currTime of window "Achenar-Holo.MooV" to (it + 7) * 51
    end repeat
    deCurse "override",2003,"color","nodelay"
    end if
    end mousedownInMovie
    
    on idle
    if there is not a window "Achenar-HoloControls.MooV" then ControlMovie
    if there is not a window "Achenar-Holo.MooV" then HoloMovie
    pass idle
    end idle
    
    on closeCard
    global HoloSwitch
    if HoloSwitch is "on" then
    put "Achenar-Holo.MooV" into TheMovieName
    set the endTime of window theMovieName to the duration of window theMovieName
    set the rate of window TheMovieName to "1.0"
    put "off" into HoloSwitch
    end if
    
    if there is a window "Achenar-HoloControls.MooV" then close window "Achenar-HoloControls.MooV"
    if there is a window "Achenar-Holo.MooV" then close window "Achenar-Holo.MooV"
    pass closeCard
    end closeCard
    
    on ControlMovie
    put "Achenar-HoloControls.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the timeFormat of window theMovieName to "movieTime"
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    show window TheMovieName
    end if
    end ControlMovie
    
    on HoloMovie
    put "Achenar-Holo.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker2,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the timeFormat of window theMovieName to "movieTime"
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    show window TheMovieName
    end if
    end HoloMovie

    * Part 57056:1 ""
      on mouseUp
      htlock true
      go to card id 56690
      playQT "MU Achenar Rm Mov",fadein,"loop",255
      end mouseUp
    * Part 57056:3 "down"
      on mouseUp
      htlock true
      go to card id 57160
      playQT "MU Achenar Rm Mov",fadein,"loop",255
      end mouseUp
    * Part 57056:2 ""
    * Part 57056:4 "marker"
    * Part 57056:5 "limit"
    * Part 57056:6 "marker2"
    * Part 57056:7 ""
      on mouseUp
      global HoloSwitch
      if HoloSwitch is not "on" then
      xcIcon3 the loc of me,6500
      put "Achenar-Holo.MooV" into TheMovieName --∆
      set the startTime of window TheMovieName to "0"
      get the currTime of window "Achenar-HoloControls.MooV" div 60
      set the endTime of window theMovieName to (it + 7) * 51
      set the rate of window TheMovieName to "1.0"
      put "on" into HoloSwitch
      play "SW Pushbutton In"
      play "EL SharpHum loop"
      else
      put "Achenar-Holo.MooV" into TheMovieName --∆
      --set the startTime of window TheMovieName to "0"
      set the endTime of window theMovieName to the duration of window theMovieName
      set the rate of window TheMovieName to "1.0"
      set the currTime of window theMovieName to 1800
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window theMovieName = 0
      send movieIdle to window theMovieName
      end repeat
      get loc of me
      set loc of me to 0,0
      set loc of me to it
      put "off" into HoloSwitch
      play "SW Pushbutton In"
      play "EL SharpHum"
      end if
      ww
      end mouseUp
  * Card 34559 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "off" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 34559:1 "right"
      on mouseUp
      go to card id 34261
      end mouseUp
    * Part 34559:2 "left"
      on mouseUp
      go to card id 34261
      end mouseUp
    * Part 34559:3 ""
      on mouseUp
      go to card id 34573
      Buzzer 75
      end mouseUp
    * Part 34559:4 "qAchU"
      on mouseUp
      go to card id 34573
      Buzzer 75
      end mouseUp
  * Card 34573 "" (7 parts)

    on openCard
    global ST_SonLight,pictAdd, ST_domeTunnel
    if ST_SonLight is "off" then
    hide card button door
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    show card button door
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    if ST_DomeTunnel is "open" then
    get the rect of card button marker
    put field "pict name" & " (open)|" & it into pictAdd
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle
    
    on closeCard
    put "TunnelA7-up.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closeCard
    end closeCard
    
    on Done
    put "TunnelA7-up.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    end Done

    * Part 34573:6 "marker"
    * Part 34573:5 "marker2"
    * Part 34573:1 ""
      on mouseUp
      go to card id 34998
      playQT "EV Drip II Mov", , loop, 100
      Buzzer 75
      end mouseUp
    * Part 34573:2 "right"
      on mouseUp
      go to card id 34007
      end mouseUp
    * Part 34573:3 "left"
      on mouseUp
      go to card id 34007
      end mouseUp
    * Part 34573:4 "door"
      on mouseUp
      global ST_book,theMovieName,ST_DomeTunnel,pictAdd
      if ST_DomeTunnel is "open" then
      go to card id 31805
      Buzzer 200
      else
      play "SW Genlights on"
      hc
      put "TunnelA7-up.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      Movie TheMovieName,"borderless",the topleft of card button marker2,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "256"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "0"
      set the endTime of window TheMovieName to "1,140"
      --set the callBackMsg of window theMovieName to "Done"
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "0.0"
      show window TheMovieName
      soundpause
      send preroll to window theMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window TheMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      get the rect of card button marker
      HTAddpict  ( field "pict name" & " (open)"),it,"srccopy"
      put "open" into ST_DomeTunnel
      close window theMovieName
      soundstart
      end if
      end if
      end mouseUp
    * Part 34573:7 "qAchU"
      on mouseUp
      go to card id 34998
      playQT "EV Drip II Mov", , loop, 100
      Buzzer 75
      end mouseUp
  * Card 34998 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    pass openCard
    end if
    end openCard

    * Part 34998:1 ""
      on mouseUp
      go to card id 35205
      Buzzer 50
      end mouseUp
    * Part 34998:2 "right"
      on mouseUp
      go to card id 33592
      end mouseUp
    * Part 34998:3 "left"
      on mouseUp
      go to card id 33592
      end mouseUp
    * Part 34998:4 "qAchU"
      on mouseUp
      go to card id 35205
      Buzzer 50
      end mouseUp
  * Card 35205 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 35205:1 ""
      on mouseUp
      go to card id 35436
      Buzzer 25
      end mouseUp
    * Part 35205:2 "right"
      on mouseUp
      go to card id 33288
      end mouseUp
    * Part 35205:3 "left"
      on mouseUp
      go to card id 33288
      end mouseUp
    * Part 35205:4 "qAchU"
      on mouseUp
      go to card id 35436
      Buzzer 25
      end mouseUp
  * Card 35436 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 35436:1 ""
      on mouseUp
      go to card id 35832
      Buzzer 10
      end mouseUp
    * Part 35436:2 "right"
      on mouseUp
      go to card id 33179
      end mouseUp
    * Part 35436:3 "left"
      on mouseUp
      go to card id 33179
      end mouseUp
    * Part 35436:4 "qAchU"
      on mouseUp
      go to card id 35832
      Buzzer 10
      end mouseUp
  * Card 35832 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 35832:1 ""
      on mouseUp
      go to card id 35952
      if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
      end mouseUp
    * Part 35832:2 "right"
      on mouseUp
      go to card id 32964
      end mouseUp
    * Part 35832:3 "left"
      on mouseUp
      go to card id 32964
      end mouseUp
    * Part 35832:5 "qAchU"
      on mouseUp
      go to card id 35952
      if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
      end mouseUp
  * Card 35952 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 35952:1 ""
      on mouseUp
      go to card id 36189
      end mouseUp
    * Part 35952:2 "right"
      on mouseUp
      go to card id 32643
      end mouseUp
    * Part 35952:3 "left"
      on mouseUp
      go to card id 32643
      end mouseUp
  * Card 36189 "qAchU" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    playQT "EV Drip II Mov","fadeboth","loop","80"
    if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
    pass openCard
    end openCard

    * Part 36189:1 ""
      on mouseUp
      go to card id 14498
      playQT "AR Water/Wind Mov", fadeboth, loop, 175
      end mouseUp
    * Part 36189:2 "right"
      on mouseUp
      go to card id 32358
      end mouseUp
    * Part 36189:3 "left"
      on mouseUp
      go to card id 32358
      end mouseUp
  * Card 9010 "" (4 parts)
    * Part 9010:1 "left"
      on mouseUp
      go to card id 14498
      end mouseUp
    * Part 9010:2 ""
      on mouseUp
      go to card id 8569
      end mouseUp
    * Part 9010:3 "right"
      on mouseUp
      go to card id 9375
      end mouseUp
    * Part 9010:4 "qste4"
      on mouseUp
      go to card id 8569
      end mouseUp
  * Card 8569 "" (3 parts)
    * Part 8569:1 "right"
      on mouseUp
      go to card id 8277
      end mouseUp
    * Part 8569:2 "left"
      on mouseUp
      go to card id 8277
      end mouseUp
    * Part 8569:3 ""
      on mouseUp
      go to card id 7846
      end mouseUp
  * Card 7674 "" (5 parts)

    on openCard
    global pictAdd,ST_Pump
    if ST_Pump is empty then put 0 into ST_Pump
    if ST_Pump = 1 then
    get the rect of card button marker
    put field "pict name" & " (dry)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 7674:5 "marker"
    * Part 7674:3 "right"
      on mouseUp
      go to card id 7846
      playQT "AR Water/Wind Mov", , loop, 256
      end mouseUp
    * Part 7674:1 "left"
      on mouseUp
      go to card id 7277
      end mouseUp
    * Part 7674:2 ""
      on mouseUp
      go to card id 5066
      end mouseUp
    * Part 7674:4 ""
      on mouseUp
      go to card id 5269
      end mouseUp
  * Card 7846 "qste4" (5 parts)

    on openCard
    global pictAdd,ST_Pump
    if ST_Pump is empty then put 0 into ST_Pump
    if ST_Pump = 1 then
    get the rect of card button marker
    put field "pict name" & " (dry)|" & it into pictAdd
    end if
    playQT "AR Water/Wind Mov","","loop","175"
    pass openCard
    end openCard

    * Part 7846:5 "marker"
    * Part 7846:1 "left"
      on mouseUp
      go to card id 7674
      end mouseUp
    * Part 7846:2 ""
      on mouseUp
      go to card id 5066
      end mouseUp
    * Part 7846:3 "right"
      on mouseUp
      go to card id 8154
      end mouseUp
    * Part 7846:4 ""
      on mouseUp
      go to card id 11348
      end mouseUp
  * Card 11348 "" (4 parts)
    * Part 11348:1 ""
      on mouseUp
      go to card id 11707
      end mouseUp
    * Part 11348:2 "right"
      on mouseUp
      go to card id 13219
      end mouseUp
    * Part 11348:3 "left"
      on mouseUp
      go to card id 13219
      end mouseUp
    * Part 11348:4 "qpum"
      on mouseUp
      go to card id 11707
      end mouseUp
  * Card 11707 "" (4 parts)
    * Part 11707:1 ""
      on mouseUp
      go to card id 11823
      end mouseUp
    * Part 11707:2 "right"
      on mouseUp
      go to card id 13046
      end mouseUp
    * Part 11707:3 "left"
      on mouseUp
      go to card id 13046
      end mouseUp
    * Part 11707:4 "qpum"
      on mouseUp
      go to card id 11823
      end mouseUp
  * Card 11823 "" (3 parts)
    * Part 11823:1 ""
      on mouseUp
      go to card id 12033
      end mouseUp
    * Part 11823:2 "right"
      on mouseUp
      go to card id 12578
      end mouseUp
    * Part 11823:3 "left"
      on mouseUp
      go to card id 12578
      end mouseUp
  * Card 12033 "qpum" (6 parts)

    on openCard
    global ST_Pump
    soundIdle
    HTChangePict fld "pict name","srcCopy"
    if ST_Pump is empty then put 0 into ST_Pump
    if ST_Pump is not 0 then swLite ST_Pump
    soundIdle
    htlock forcefalse
    playQT "AR Water/Wind Mov","","loop","175"
    end openCard
    
    on swDown which
    global ST_Pump
    htlock true
    allOff
    put the rect of card button ("SW" & which) into theLoc
    put word which of "0,54,52,108 53,54,104,108 105,54,156,108" into theClip
    HTAddPict "Path/Umbrella4-N Switch",theLoc,"srccopy","srcRect",theClip
    htlock forcefalse
    play stop
    play "SW Pushbutton Out"
    end swDown
    
    on swLite which
    global ST_Pump
    put the rect of card button ("SW" & which) into theLoc
    put word which of "0,108,52,162 53,108,104,162 105,108,156,162" into theClip
    HTAddPict "Path/Umbrella4-N Switch",theLoc,"srccopy","srcRect",theClip
    end swLite
    
    on allOff
    put the rect of card button marker into theLoc
    put "0,0,156,54" into theClip
    HTAddPict "Path/Umbrella4-N Switch",theLoc,"srccopy","srcRect",theClip
    end allOff

    * Part 12033:7 "marker"
    * Part 12033:1 "right"
      on mouseUp
      go to card id 12443
      PlayQT "AR Water/Wind Mov", , loop, 175
      end mouseUp
    * Part 12033:2 "left"
      on mouseUp
      go to card id 12443
      end mouseUp
    * Part 12033:3 "sw1"
      on mouseDown
      global ST_Pump, ST_DomeTunnel
      if ST_Pump ≠ 1 then
      swDown 1
      put 1 into ST_Pump
      put "closed" into ST_Dometunnel
      wait until the mouse is up
      swLite 1
      else
      swDown 1
      put 0 into ST_Pump
      wait until the mouse is up
      allOff
      end if
      play "AR Pump Mix"
      end mouseDown
    * Part 12033:4 "sw2"
      on mouseDown
      global ST_Pump, ST_DomeTunnel
      if ST_Pump ≠ 2 then
      swDown 2
      put 2 into ST_Pump
      wait until the mouse is up
      swLite 2
      else
      swDown 2
      put 0 into ST_Pump
      put "closed" into ST_Dometunnel
      wait until the mouse is up
      allOff
      end if
      play "AR Pump Mix"
      end mouseDown
    * Part 12033:5 "sw3"
      on mouseDown
      global ST_Pump, ST_DomeTunnel
      if ST_Pump ≠ 3 then
      swDown 3
      put 3 into ST_Pump
      put "closed" into ST_Dometunnel
      wait until the mouse is up
      swLite 3
      else
      swDown 3
      put 0 into ST_Pump
      wait until the mouse is up
      allOff
      end if
      play "AR Pump Mix"
      end mouseDown
  * Card 12443 "" (4 parts)
    * Part 12443:1 ""
      on mouseUp
      go to card id 12578
      end mouseUp
    * Part 12443:2 "right"
      on mouseUp
      go to card id 12033
      end mouseUp
    * Part 12443:3 "left"
      on mouseUp
      go to card id 12033
      end mouseUp
    * Part 12443:4 "qste2"
      on mouseUp
      go to card id 12578
      end mouseUp
  * Card 12578 "" (4 parts)
    * Part 12578:1 "right"
      on mouseUp
      go to card id 11823
      end mouseUp
    * Part 12578:2 "left"
      on mouseUp
      go to card id 11823
      end mouseUp
    * Part 12578:3 ""
      on mouseUp
      go to card id 13046
      end mouseUp
    * Part 12578:4 "qste2"
      on mouseUp
      go to card id 13046
      end mouseUp
  * Card 13046 "" (4 parts)
    * Part 13046:1 "right"
      on mouseUp
      go to card id 11707
      end mouseUp
    * Part 13046:2 "left"
      on mouseUp
      go to card id 11707
      end mouseUp
    * Part 13046:3 ""
      on mouseUp
      go to card id 13219
      end mouseUp
    * Part 13046:4 "qste2"
      on mouseUp
      go to card id 13219
      end mouseUp
  * Card 13219 "" (5 parts)
    * Part 13219:1 "right"
      on mouseUp
      go to card id 11348
      end mouseUp
    * Part 13219:2 "left"
      on mouseUp
      go to card id 11348
      end mouseUp
    * Part 13219:3 ""
      on mouseUp
      go to card id 4355
      play QT "EV Wind/Water Mov", , loop, 250
      end mouseUp
    * Part 13219:4 ""
      on mouseUp
      go to card id 3004
      end mouseUp
    * Part 13219:5 "qbow"
      on mouseUp
      go to card id 3004
      end mouseUp
  * Card 8154 "" (7 parts)

    on openCard
    global ST_Pump,ST_SonLight
    put "Boat2-N" into field "pict name"
    hide card button qSirD
    if ST_Pump = 2 then
    show card button qSirD
    if ST_SonLight is not "on" then
    put " dark/dry" after field "pict name"
    else
    put " dry" after field "pict name"
    end if
    else
    if ST_SonLight is not "on" then
    put " dark" after field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 8154:6 "marker2"
    * Part 8154:7 "marker3"
    * Part 8154:1 "left"
      on mouseUp
      go to card id 7846
      end mouseUp
    * Part 8154:2 "right"
      on mouseUp
      go to card id 7277
      end mouseUp
    * Part 8154:3 "marker"
    * Part 8154:5 ""
      on mouseUp
      go to card id 28272
      playQT "EV Drip II Mov", , loop, 50
      end mouseUp
    * Part 8154:9 "qSirD"
      on mouseUp
      go to card id 28272
      playQT "EV Drip II Mov", , loop, 50
      end mouseUp
  * Card 28272 "" (5 parts)

    on openCard
    global ST_Pump,ST_SonLight
    put field "pict name" into thePict
    hide card button qSirD
    if ST_Pump = 2 then
    show card button qSirD
    if ST_SonLight is not "on" then
    put " (dark,dry)" after thePict
    else
    put " (dry)" after thePict
    end if
    else
    if ST_SonLight is not "on" then
    put " (dark)" after thePict
    end if
    end if
    HTChangePict thePict,"srcCopy"
    htlock "forcefalse"
    end openCard

    * Part 28272:7 "marker2"
    * Part 28272:1 ""
      on mouseUp
      global ST_Pump
      if ST_Pump = 2 then go to card id 28578
      playQT "EV Drip II Mov", , loop, 90
      Buzzer 10
      end mouseUp
    * Part 28272:2 "right"
      on mouseUp
      go to card id 32230
      end mouseUp
    * Part 28272:5 "left"
      on mouseUp
      go to card id 32230
      end mouseUp
    * Part 28272:8 "qSirD"
      on mouseUp
      global ST_Pump
      if ST_Pump = 2 then go to card id 28578
      playQT "EV Drip II Mov", , loop, 90
      Buzzer 10
      end mouseUp
  * Card 28578 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 28578:1 ""
      on mouseUp
      go to card id 28820
      Buzzer 25
      end mouseUp
    * Part 28578:2 "right"
      on mouseUp
      go to card id 31259
      end mouseUp
    * Part 28578:4 "left"
      on mouseUp
      go to card id 31259
      end mouseUp
    * Part 28578:5 "qSirD"
      on mouseUp
      go to card id 28820
      Buzzer 25
      end mouseUp
  * Card 28820 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 28820:1 ""
      on mouseUp
      go to card id 36440
      playQT "EV Drip II Mov", , loop, 90
      Buzzer 50
      end mouseUp
    * Part 28820:4 "right"
      on mouseUp
      go to card id 31136
      end mouseUp
    * Part 28820:5 "left"
      on mouseUp
      go to card id 31136
      end mouseUp
    * Part 28820:6 "qSirD"
      on mouseUp
      go to card id 36440
      playQT "EV Drip II Mov", , loop, 90
      Buzzer 50
      end mouseUp
  * Card 36440 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 36440:1 ""
      on mouseUp
      go to card id 36761
      Buzzer 75
      end mouseUp
    * Part 36440:2 "right"
      on mouseUp
      go to card id 30890
      end mouseUp
    * Part 36440:3 "left"
      on mouseUp
      go to card id 30890
      end mouseUp
    * Part 36440:4 "qSirD"
      on mouseUp
      go to card id 36761
      Buzzer 75
      end mouseUp
  * Card 36761 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "off" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 36761:1 ""
      on mouseUp
      go to card id 29150
      Buzzer 100
      end mouseUp
    * Part 36761:2 "right"
      on mouseUp
      go to card id 30666
      end mouseUp
    * Part 36761:3 "left"
      on mouseUp
      go to card id 30666
      end mouseUp
    * Part 36761:4 "qSirD"
      on mouseUp
      go to card id 29150
      Buzzer 100
      end mouseUp
  * Card 29150 "" (7 parts)

    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle
    
    on openCard
    global ST_SonLight,pictAdd, ST_domeTunnel
    if ST_SonLight is "off" then
    hide card button door
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    show card button door
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    if ST_DomeTunnel is "open" then
    get the rect of card button marker
    put field "pict name" & " (open)|" & it into pictAdd
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on closeCard
    put "TunnelC6-Down.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closeCard
    end closeCard
    
    on Done
    put "TunnelC6-Down.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    end Done

    * Part 29150:7 "marker"
      on mouseUp
      
      end mouseUp
    * Part 29150:1 ""
      on mouseUp
      go to card id 29287
      Buzzer 75
      end mouseUp
    * Part 29150:2 "right"
      on mouseUp
      go to card id 30263
      end mouseUp
    * Part 29150:3 "left"
      on mouseUp
      go to card id 30263
      end mouseUp
    * Part 29150:5 "door"
      on mouseUp
      global ST_book,ST_DomeTunnel,pictAdd
      if ST_DomeTunnel is "open" then
      go to card id 31581
      Buzzer 150
      else
      play "SW Genlights on"
      hc
      put "TunnelC6-Down.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      Movie TheMovieName,"borderless",the topleft of card button marker2,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "256"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "0"
      set the endTime of window TheMovieName to "1,140"
      --set the callBackMsg of window theMovieName to "Done"
      set the passMovieClick of window theMovieName to false
      show window TheMovieName
      soundpause
      send preroll to window theMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window TheMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      get the rect of card button marker
      HTAddpict  ( field "pict name" & " (open)"),it,"srccopy"
      close window theMovieName
      end if
      soundstart
      put "open" into ST_DomeTunnel
      --play "MR Mech Bsmt Stairs"
      end if
      end mouseUp
    * Part 29150:8 "marker2"
    * Part 29150:9 "qSirD"
      on mouseUp
      go to card id 29287
      Buzzer 75
      end mouseUp
  * Card 29287 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    pass openCard
    end if
    end openCard

    * Part 29287:1 ""
      on mouseUp
      go to card id 29531
      Buzzer 50
      end mouseUp
    * Part 29287:2 "right"
      on mouseUp
      go to card id 30057
      end mouseUp
    * Part 29287:3 "left"
      on mouseUp
      go to card id 30057
      end mouseUp
  * Card 29531 "qSirD" (7 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    show card button "none"
    hide card button "enter"
    playQT "EV Drip II Mov",, loop, 90
    buzzer 50
    pass openCard
    end openCard

    * Part 29531:7 "doormarker"
    * Part 29531:3 "marker1"
    * Part 29531:5 "marker2"
    * Part 29531:2 "left"
      on mouseUp
      global ST_SonLight,ST_Qlist
      if ST_SonLight is "off" then
      if ST_Qlist contains "qSirD," then
      set the name of this card to "qSirD"
      else
      set the name of this card to empty
      end if
      else
      set the name of this card to "qSirD"
      end if
      if the visible of card button enter is true then
      go to card id 29732
      soundstop
      play "DR FrplDr Up"
      playQT "EV Drip II Mov",fadein,loop,60
      else
      go to card id 29732
      end if
      end mouseUp
    * Part 29531:4 "none"
      on mouseDown
      global ST_sonLight
      put field "pict name" into WhichPict
      put " (open)" after WhichPict
      HTlock "true"
      HtVisual "scrollaway up",,the rect of card button doormarker,1,16
      if ST_sonLight is "on" then
      HTAddPict WhichPict,the rect of card button marker1,"srcCopy"
      play "SW Pushbutton Out"
      playQT "MU Sirrus Rm Mov", fadein, loop, 25
      else
      HTAddPict WhichPict,the rect of card button marker2,"srcCopy"
      play "SW Pushbutton Out"
      playQT "MU Sirrus Rm Mov", fadein, loop, 25
      end if
      play "DR FrplDr Up"
      HTLock "forcefalse"
      hide me
      show card button "enter"
      --go this card
      end mouseDown
    * Part 29531:6 "enter"
      on mouseUp
      global ST_SonLight,ST_Qlist
      if ST_SonLight is "off" then
      if ST_Qlist contains "qSirD," then
      set the name of this card to "qSirD"
      else
      set the name of this card to empty
      end if
      else
      set the name of this card to "qSirD"
      end if
      go to card id 46193
      playQT "MU Sirrus Rm Mov", fadein, loop, 180
      if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
      end mouseUp
    * Part 29531:1 "right"
      on mouseUp
      global ST_SonLight,ST_Qlist
      if ST_SonLight is "off" then
      if ST_Qlist contains "qSirD," then
      set the name of this card to "qSirD"
      else
      set the name of this card to empty
      end if
      else
      set the name of this card to "qSirD"
      end if
      if the visible of card button enter is true then
      go to card id 29732
      soundstop
      play "DR FrplDr Up"
      playQT "EV Drip II Mov",fadein,loop,60
      else
      go to card id 29732
      end if
      end mouseUp
  * Card 46193 "" (3 parts)
    * Part 46193:1 "right"
      on mouseUp
      go to card id 47876
      end mouseUp
    * Part 46193:2 "left"
      on mouseUp
      go to card id 47876
      end mouseUp
    * Part 46193:3 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 256
      go to card id 50415
      end mouseUp
  * Card 50415 "" (5 parts)

    on openCard
    if there is a window "Sirrus-SphereWest.MooV" then close window "Sirrus-SphereWest.MooV"
    if there is a window "Sirrus-SphereEast.MooV" then close window "Sirrus-SphereWest.MooV"
    pass openCard
    end openCard

    * Part 50415:4 "left"
      on mouseUp
      go to card id 51138
      end mouseUp
    * Part 50415:1 "right"
      on mouseUp
      go to card id 50580
      end mouseUp
    * Part 50415:2 ""
      on mouseUp
      push card
      go to card id 52299
      end mouseUp
    * Part 50415:3 ""
      on mouseUp
      push card
      go to card id 52563
      end mouseUp
    * Part 50415:5 ""
      on mouseUp
      go to card id 53126
      end mouseUp
  * Card 53126 "" (2 parts)
    * Part 53126:1 ""
      on mouseUp
      go to card id 50415
      end mouseUp
    * Part 53126:2 ""
  * Card 52563 "" (4 parts)

    on openCard
    globeMovie
    pass openCard
    end openCard
    
    on globeMovie
    put "Sirrus-SphereWest.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end globeMovie

    * Part 52563:1 ""
      on mouseUp
      htlock true
      vd
      pop card
      end mouseUp
    * Part 52563:2 ""
    * Part 52563:3 ""
      on mouseEnter
      get "Sirrus-SphereWest.MooV"
      show window it
      set the rate of window it to 1
      repeat until the mouseLoc is not within the rect of me
      soundidle
      send movieIdle to window it
      if the sound is "done" then play "EL Globe Mid"
      end repeat
      play stop
      play "El Globe End"
      htlock true
      hide window it
      HTVisual "tdfBlend2",,,0
      set rate of window it to 0
      htlock forcefalse
      end mouseEnter
    * Part 52563:4 "marker"
  * Card 52299 "" (4 parts)

    on openCard
    globeMovie
    pass openCard
    end openCard
    
    on closeCard
    get "Sirrus-SphereEast.MooV"
    if there is a window it then close window it
    pass closeCard
    end closeCard
    
    on globeMovie
    put "Sirrus-SphereEast.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end globeMovie

    * Part 52299:1 ""
      on mouseUp
      htlock true
      vd
      pop card
      end mouseUp
    * Part 52299:2 ""
    * Part 52299:3 "marker"
    * Part 52299:4 ""
      on mouseEnter
      get "Sirrus-SphereEast.MooV"
      show window it
      set the rate of window it to 1
      repeat until the mouseLoc is not within the rect of me
      soundidle
      send movieIdle to window it
      if the sound is "done" then play "EL Globe Mid"
      end repeat
      play stop
      play "EL Globe End"
      htlock true
      hide window it
      set rate of window it to 0
      HTVisual "tdfBlend2",,,0
      htlock false
      end mouseEnter
  * Card 50580 "" (5 parts)

    on openCard
    if there is a window "Sirrus-SphereEast.MooV" then close window "Sirrus-SphereWest.MooV"
    pass openCard
    end openCard

    * Part 50580:1 "left"
      on mouseUp
      go to card id 50415
      end mouseUp
    * Part 50580:2 ""
    * Part 50580:3 "right"
      on mouseUp
      go to card id 50899
      end mouseUp
    * Part 50580:4 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 190
      go to card id 51439
      end mouseUp
    * Part 50580:5 ""
      on mouseUp
      push card
      go to card id 52299
      end mouseUp
  * Card 51439 "" (2 parts)

    on openCard
    if there is a window "Sirrus-Desk.MooV" then close window "Sirrus-Desk.MooV"
    pass openCard
    end openCard

    * Part 51439:1 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 255
      go to card id 50580
      end mouseUp
    * Part 51439:2 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 140
      soundidle
      go to card id 51501
      end mouseUp
  * Card 51501 "" (11 parts)

    on mouseDownInMovie
    if the mouseLoc is within the rect of card button ball then
    if the rate of window "Sirrus-Desk.Moov" is "0.0" then  -- added (1.0b8)
    set the rate of window "Sirrus-Desk.MooV" to 1
    play stop  -- added (1.0b8)
    play "EL FieldHum II"
    end if
    end if
    end mousedownInMovie
    
    on openCard
    global pictAdd,ST_temp
    if ST_temp is true then
    get the rect of card button "marker"
    put field "pict name" & " (open)|" & it into pictAdd
    put false into ST_temp
    hide card button "open"
    show card button "close"
    show card button "drawer"
    else
    show card button "open"
    hide card button "close"
    hide card button "drawer"
    end if
    pass openCard
    end openCard
    
    on idle
    if there is not a window "Sirrus-Desk.MooV" then GenMovie
    pass idle
    end idle
    
    on genMovie
    soundidle
    put "Sirrus-Desk.MooV" into TheMovieName --∆
    Movie TheMovieName,"borderless",the topleft of card button marker2,"invisible","Floating"
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    show window TheMovieName
    end if
    end genMovie

    * Part 51501:1 ""
      on mouseUp
      htlock true
      if there is a window "Sirrus-Desk.MooV" then hide window "Sirrus-Desk.MooV"
      if the visible of card button close is true then send mouseUp to card button close
      playQT "MU Sirrus Rm Mov",, loop, 255
      go to card id 51439
      end mouseUp
    * Part 51501:3 ""
    * Part 51501:10 "marker"
    * Part 51501:7 "close"
      on mouseUp
      HTVisual "Wipe Up",,,1,32
      play stop
      play "DR Drawer"
      openCard
      go card
      show card button "open"
      hide card button "close"
      hide card button "drawer"
      end mouseUp
    * Part 51501:2 "open"
      on mouseUp
      put field "pict name" into WhichPict
      put " (open)" after WhichPict
      htlock true
      HTvisual "wipe down",,,1,16
      play stop  -- added (1.0b8)
      play "DR Drawer"
      HTAddPict WhichPict,the rect of card button marker,"srcCopy"
      HTlock forceFalse
      --go card
      show card button "close"
      hide card button "open"
      show card button "drawer"
      end mouseUp
    * Part 51501:4 ""
    * Part 51501:5 ""
    * Part 51501:6 ""
    * Part 51501:8 "drawer"
      on mouseUp
      if there is a window "Sirrus-Desk.MooV" then hide window "Sirrus-Desk.MooV"
      go to card id 52816
      end mouseUp
    * Part 51501:9 "marker2"
    * Part 51501:11 "ball"
  * Card 52816 "" (2 parts)

    on openCard
    if there is a window "Sirrus-Desk.MooV" then close window "Sirrus-Desk.MooV"
    pass openCard
    end openCard

    * Part 52816:1 ""
      on mouseUp
      global ST_temp
      put true into ST_temp
      go to card id 51501
      end mouseUp
    * Part 52816:2 ""
  * Card 50899 "" (4 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 50899:4 "marker"
    * Part 50899:1 "left"
      on mouseUp
      go to card id 50580
      end mouseUp
    * Part 50899:2 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop,180
      go to card id 47876
      end mouseUp
    * Part 50899:3 "right"
      on mouseUp
      go to card id 51138
      end mouseUp
  * Card 51138 "" (4 parts)

    on openCard
    if there is a window "Sirrus-SphereWest.MooV" then close window "Sirrus-SphereWest.MooV"
    pass openCard
    end openCard

    * Part 51138:1 "left"
      on mouseUp
      go to card id 50899
      end mouseUp
    * Part 51138:2 "right"
      on mouseUp
      go to card id 50415
      end mouseUp
    * Part 51138:3 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 190
      go to card id 51730
      end mouseUp
    * Part 51138:4 ""
      on mouseUp
      push card
      go to card id 52563
      end mouseUp
  * Card 51730 "" (2 parts)
    * Part 51730:1 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 255
      go to card id 51138
      end mouseUp
    * Part 51730:2 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 140
      go to card id 52184
      resetButtons
      end mouseUp
  * Card 52184 "" (22 parts)

    on closeDrawers
    put field "pict name" into WhichPict
    --HTvisual "wipe up"
    HTChangePict WhichPict,"srcCopy"
    end closeDrawers
    
    on resetDrawers
    global ST_Drawers,ALL_Page,MY_RedBook
    put "(plates),(cloth),(empty),(page),(coins),(jewels)" into drawerStuff
    put field "pict name" into WhichPict
    hide card button page
    if item 1 to 2 of ALL_Page is "4,S" or char 4 of MY_RedBook = 1 then put "(noPage)" into item 4 of drawerStuff
    else if char 4 of ST_Drawers is 1 then show card button page
    if ST_Drawers contains "1" then
    repeat with x = 1 to 6
    if char x of ST_Drawers is "1" then
    put field "pict name" & space & item x of drawerStuff into WhichPict
    HTAddPict WhichPict,the rect of card button ("open" & x),"srcCopy"
    if x < 5 then exit repeat
    end if
    end repeat
    repeat with x = 1 to 6
    if char x of ST_Drawers is "1" then
    show card button ("close" & x)
    show card button ("open" & x)
    else
    hide card button ("close" & x)
    hide card button ("open" & x)
    --show card button ("o" & x)
    end if
    end repeat
    else
    htlock true
    go card
    resetButtons
    end if
    HTLock "ForceFalse"
    end resetDrawers
    
    on resetButtons
    global ST_Drawers
    show card button o1
    show card button o2
    show card button o3
    show card button o4
    show card button o5
    show card button o6
    hide card button open1
    hide card button open2
    hide card button open3
    hide card button open4
    hide card button open5
    hide card button open6
    hide card button close1
    hide card button close2
    hide card button close3
    hide card button close4
    hide card button close5
    hide card button close6
    hide card button drawerL
    hide card button drawerR
    hide card button page
    put "000000" into ST_Drawers
    end resetButtons

    * Part 52184:1 ""
      on mouseUp
      playQT "MU Sirrus Rm Mov",, loop, 190
      go to card id 51730
      end mouseUp
    * Part 52184:9 "o6"
      on mouseUp
      global ST_Drawers
      if char 1 to 4 of ST_Drawers contains 1 then
      play "DR Drawer"  -- added (1.0b8)
      HTVisual "wipe up",,,2,32
      closeDrawers
      end if
      put "0000" into char 1 to 4 of ST_drawers
      put 1 into char 6 of ST_drawers
      HTLock "true"
      HTVisual "wipe down",,,1,32
      play stop  -- added (1.0b8)
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      end mouseUp
    * Part 52184:10 "o5"
      on mouseUp
      global ST_Drawers
      if char 1 to 4 of ST_Drawers contains 1 then
      play "DR Drawer"  -- added (1.0b8)
      HTVisual "wipe up",,,2,32
      closeDrawers
      end if
      put "0000" into char 1 to 4 of ST_drawers
      put 1 into char 5 of ST_drawers
      HTLock "true"
      HTVisual "wipe down",,,1,32
      play stop  -- added (1.0b8)
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      end mouseUp
    * Part 52184:15 "drawerL"
    * Part 52184:16 "drawerR"
    * Part 52184:21 "o1"
      on mouseUp
      global ST_drawers
      htlock true
      if char 5 to 6 of ST_Drawers contains 1 then
      HTVisual "wipe up",,,1,32
      closeDrawers
      end if
      put 1 into char 1 of ST_drawers
      put "00" into char 5 to 6 of ST_drawers
      HTVisual "wipe down",,,1,32
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      htlock forcefalse
      end mouseUp
    * Part 52184:22 "o2"
      on mouseUp
      global ST_Drawers
      htlock true
      if char 5 to 6 of ST_Drawers contains 1 then
      HTVisual "wipe up",,,1,32
      closeDrawers
      end if
      put 1 into char 2 of ST_drawers
      put "00" into char 5 to 6 of ST_drawers
      HTVisual "wipe down",,,2,32
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      htlock forcefalse
      end mouseUp
    * Part 52184:24 "o4"
      on mouseUp
      global ST_Drawers
      htlock true
      if char 5 to 6 of ST_Drawers contains 1 then
      HTVisual "wipe up",,,1,32
      closeDrawers
      end if
      put 1 into char 4 of ST_drawers
      put "00" into char 5 to 6 of ST_drawers
      HTVisual "wipe down",,,4,32
      resetDrawers
      play "DR Drawer"  -- added (1.0b8)
      htlock forcefalse
      end mouseUp
    * Part 52184:26 "open6"
    * Part 52184:14 "close6"
      on mouseUp
      global ST_Drawers
      hide card button close6
      show card button open6
      hide card button drawerR
      put 0 into char 6 of ST_drawers
      if char 5 of ST_Drawers = 0 then HTVisual "wipe up",,,1,32
      else HTLock "true"
      play "DR Drawer"  -- added (1.0b8)
      closeDrawers
      HTVisual "wipe up",,,1,32
      resetDrawers
      end mouseUp
    * Part 52184:5 "open4"
      on mouseUp
      global ALL_Page
      if item 1 to 2 of ALL_Page is "4,S" then
      put empty into ALL_Page
      resetDrawers
      deCurse "override","hand","color","nodelay"
      end if
      dropState
      end mouseUp
    * Part 52184:23 "o3"
      on mouseUp
      global ST_Drawers
      htlock true
      if char 5 to 6 of ST_Drawers contains 1 then
      HTVisual "wipe up",,,1,32
      closeDrawers
      end if
      put 1 into char 3 of ST_drawers
      put "00" into char 5 to 6 of ST_drawers
      HTVisual "wipe down",,,3,32
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      htlock forcefalse
      end mouseUp
    * Part 52184:12 "close4"
      on mouseUp
      global ST_Drawers
      hide card button close4
      show card button open4
      put 0 into char 4 of ST_drawers
      HTLock "forcefalse"
      HTLock "true"
      closeDrawers
      HTVisual "wipe up",,,4,32
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      end mouseUp
    * Part 52184:17 "page"
      on mouseUp
      global ALL_Page
      htlock true
      if All_Page is not empty then dropPage2
      put "4,S,0" into ALL_Page
      htlock true
      resetDrawers
      dropState
      end mouseUp
      
      on DropPage2
      global All_page
      if ALL_page is not empty then
      play "putpage"
      if item 2 of ALL_Page is "A" then Drop BluePage
      else if item 2 of ALL_Page is "S" then Drop RedPage
      else Drop AtrusPage
      put empty into All_page
      play stop
      updatecursor
      end if
      end DropPage2
    * Part 52184:4 "open3"
    * Part 52184:8 "close3"
      on mouseUp
      global ST_Drawers
      show card button "open3"
      show card button "open4"
      hide card button "close3"
      put 0 into char 3 of ST_drawers
      HTLock "true"
      closeDrawers
      play "DR Drawer"  -- added (1.0b8)
      HTVisual "wipe up",,,3,32
      resetDrawers
      end mouseUp
    * Part 52184:3 "open2"
    * Part 52184:7 "close2"
      on mouseUp
      global ST_Drawers
      hide card button "close2"
      show card button "open2"
      put 0 into char 2 of ST_drawers
      HTLock "true"
      closeDrawers
      HTVisual "wipe up",,,2,32
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      end mouseUp
    * Part 52184:2 "open1"
    * Part 52184:6 "close1"
      on mouseUp
      global ST_Drawers
      show card button "open1"
      hide card button "close1"
      put 0 into char 1 of ST_drawers
      HTLock "true"
      closeDrawers
      HTVisual "wipe up",,,1,32
      play "DR Drawer"  -- added (1.0b8)
      resetDrawers
      end mouseUp
    * Part 52184:25 "open5"
    * Part 52184:13 "close5"
      on mouseUp
      global ST_Drawers
      hide card button close5
      show card button open5
      hide card button drawerL
      put 0 into char 5 of ST_drawers
      if char 6 of ST_Drawers = 0 then HTVisual "wipe up",,,1,32
      else HTLock "true"
      play "DR Drawer"  -- added (1.0b8)
      closeDrawers
      HTVisual "wipe up",,,1,32
      resetDrawers
      end mouseUp
  * Card 47876 "" (4 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 47876:4 "marker"
    * Part 47876:1 "right"
      on mouseUp
      go to card id 46193
      end mouseUp
    * Part 47876:2 "left"
      on mouseUp
      go to card id 46193
      end mouseUp
    * Part 47876:3 ""
      on mouseUp
      go to card id 29732
      play "DR FrplDr Up"
      playQT "EV Drip II Mov", FadeIn, loop, 90
      Buzzer 50
      end mouseUp
  * Card 29732 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "off" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 29732:1 "right"
      on mouseUp
      go to card id 29531
      end mouseUp
    * Part 29732:2 "left"
      on mouseUp
      go to card id 29531
      end mouseUp
    * Part 29732:3 ""
      on mouseUp
      go to card id 30057
      Buzzer 100
      end mouseUp
    * Part 29732:4 "qSirU"
      on mouseUp
      go to card id 30057
      Buzzer 100
      end mouseUp
  * Card 30057 "" (6 parts)

    on openCard
    global ST_SonLight,pictAdd, ST_domeTunnel
    if ST_SonLight is "off" then
    hide card button door
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    show card button door
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    if ST_DomeTunnel is "open" then
    get the rect of card button marker
    put field "pict name" & " (open)|" & it into pictAdd
    end if
    else if ST_SonLight is "blue" then
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end if
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle
    
    on closeCard
    put "TunnelC7-up.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closeCard
    end closeCard
    
    on Done
    put "TunnelC7-up.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    end Done

    * Part 30057:6 "marker"
    * Part 30057:1 ""
      on mouseUp
      go to card id 30263
      Buzzer 75
      end mouseUp
    * Part 30057:2 "right"
      on mouseUp
      go to card id 29287
      end mouseUp
    * Part 30057:3 "left"
      on mouseUp
      go to card id 29287
      end mouseUp
    * Part 30057:5 "door"
      on mouseUp
      global ST_book, theMovieName,ST_DomeTunnel,pictAdd
      if ST_DomeTunnel is "open" then
      go to card id 39028
      Buzzer 150
      else
      play "SW Genlights on"
      hc
      put "TunnelC7-up.MooV" into TheMovieName --∆
      if there is not a window TheMovieName then
      Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "256"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "0"
      set the endTime of window TheMovieName to "1,140"
      --set the callBackMsg of window theMovieName to "Done"
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "0.0"
      show window TheMovieName
      soundpause
      send preroll to window theMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window TheMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      get the rect of card button marker
      HTAddpict  ( field "pict name" & " (open)"),it,"srccopy"
      close window theMovieName
      soundstart
      end if
      put "open" into ST_DomeTunnel
      end if
      end mouseUp
    * Part 30057:7 "qSirU"
      on mouseUp
      go to card id 30263
      Buzzer 75
      end mouseUp
  * Card 39028 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 39028:3 "right"
      on mouseUp
      go to card id 29287
      end mouseUp
    * Part 39028:1 ""
      on mouseUp
      global ST_dadLight
      go to card id 39189
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound, fadein, loop, 25
      Buzzer 255
      end mouseUp
    * Part 39028:4 "left"
      on mouseUp
      go to card id 30263
      end mouseUp
  * Card 31581 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 31581:1 "right"
      on mouseUp
      go to card id 29287
      Buzzer 100
      end mouseUp
    * Part 31581:2 ""
      on mouseUp
      go to card id 39189
      playQT "MU Compass/Bubbles Off Mov", fadeboth, loop, 25
      Buzzer 250
      end mouseUp
    * Part 31581:3 "left"
      on mouseUp
      go to card id 30263
      end mouseUp
  * Card 39189 "" (4 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(blue)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (blue)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    put field "pict name" into WhichPict
    put "(dark)" into last word of WhichPict
    --put stackPre & ":Myst Graphics:Stoneship:Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 39189:1 ""
      on mouseUp
      go to card id 39587
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 175
      end mouseUp
    * Part 39189:2 "right"
      on mouseUp
      go to card id 43543
      end mouseUp
    * Part 39189:3 "left"
      on mouseUp
      go to card id 43543
      end mouseUp
    * Part 39189:5 "qDom2"
      on mouseUp
      go to card id 39587
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 175
      end mouseUp
  * Card 39587 "" (4 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(blue)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (blue)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    put field "pict name" into WhichPict
    put "(dark)" into last word of WhichPict
    --put stackPre & ":Myst Graphics:Stoneship:Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 39587:1 ""
      on mouseUp
      go to card id 39710
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 150
      end mouseUp
    * Part 39587:2 "right"
      on mouseUp
      go to card id 43330
      end mouseUp
    * Part 39587:3 "left"
      on mouseUp
      go to card id 43330
      end mouseUp
    * Part 39587:5 "qDom2"
      on mouseUp
      go to card id 39710
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 150
      end mouseUp
  * Card 39710 "" (3 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(dark)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (dark)" after field "pict name"
    end if
    pass openCard
    end openCard

    * Part 39710:1 ""
      on mouseUp
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,150
      go to card id 40070
      Buzzer 125
      end mouseUp
    * Part 39710:2 "right"
      on mouseUp
      go to card id 43252
      end mouseUp
    * Part 39710:3 "left"
      on mouseUp
      go to card id 43252
      end mouseUp
  * Card 40070 "qDom2" (3 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(dark)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    playQT "MU Compass/Bubbles On Mov", fadeboth, loop, 200
    else
    if ST_SonLight is not "on" then put " (dark)" after field "pict name"
    playQT "MU Compass/Bubbles Off Mov", fadeboth, loop, 150
    end if
    pass openCard
    end openCard

    * Part 40070:1 "down"
      on mouseUp
      push card
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,250
      go to card id 40420
      Buzzer 100
      end mouseUp
    * Part 40070:2 ""
      on mouseUp
      go to card id 40560
      end mouseUp
    * Part 40070:3 "left"
      on mouseUp
      go to card id 42851
      end mouseUp
  * Card 40560 "" (4 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(blue)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (blue)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    put field "pict name" into WhichPict
    put "(dark)" into last word of WhichPict
    --put stackPre & ":Myst Graphics:Stoneship:Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    play stop
    put "on" into ST_Flash
    end if
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 40560:1 ""
      on mouseUp
      go to card id 40849
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,125
      Buzzer 150
      end mouseUp
    * Part 40560:2 "right"
      on mouseUp
      go to card id 42593
      end mouseUp
    * Part 40560:3 "left"
      on mouseUp
      go to card id 42593
      end mouseUp
    * Part 40560:4 "qdomA"
      on mouseUp
      go to card id 40849
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,125
      Buzzer 150
      end mouseUp
  * Card 40849 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 40849:1 ""
      on mouseUp
      go to card id 41079
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 175
      end mouseUp
    * Part 40849:2 "right"
      on mouseUp
      go to card id 42296
      end mouseUp
    * Part 40849:3 "left"
      on mouseUp
      go to card id 42296
      end mouseUp
    * Part 40849:4 "qdomA"
      on mouseUp
      go to card id 41079
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,75
      Buzzer 175
      end mouseUp
  * Card 41079 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 41079:1 ""
      on mouseUp
      go to card id 41220
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 200
      end mouseUp
    * Part 41079:2 "right"
      on mouseUp
      go to card id 42238
      end mouseUp
    * Part 41079:3 "left"
      on mouseUp
      go to card id 42238
      end mouseUp
    * Part 41079:4 "qdomA"
      on mouseUp
      go to card id 41220
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,50
      Buzzer 200
      end mouseUp
  * Card 41220 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 41220:1 ""
      on mouseUp
      go to card id 41476
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,25
      Buzzer 255
      end mouseUp
    * Part 41220:2 "right"
      on mouseUp
      go to card id 41982
      end mouseUp
    * Part 41220:3 "left"
      on mouseUp
      go to card id 41982
      end mouseUp
  * Card 41476 "qdomA" (3 parts)

    on openCard
    global ST_SonLight,ST_Dadlight
    if ST_SonLight is "on" then
    if the last word of field "pict name" is "(blue)" then
    delete last word of field "pict name"
    end if
    else
    if the last word of field "pict name" is not "(blue)" then
    put " (blue)" after field "pict name"
    end if
    end if
    put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
    playQT theSound,,loop,25
    Buzzer 255
    pass openCard
    end openCard
    
    on idle
    global ST_Flash,ST_sonLight
    if ST_sonLight is "blue" then
    if ST_Flash is "on" then
    --put stackPre & field "pict name" into WhichPict
    --put "(dark)" into last word of WhichPict
    put "Tunnel-black" into WhichPict
    put "off" into ST_Flash
    else
    put field "pict name" into WhichPict
    put "on" into ST_Flash
    end if
    HTChangePict WhichPict,"srcCopy"
    htlock forcefalse
    end if
    pass idle
    end idle

    * Part 41476:2 ""
      on mouseUp
      go to card id 41220
      Buzzer 200
      end mouseUp
    * Part 41476:1 "none"
      on mousewithin
      deCurse "override","right","color","nodelay"
      end mousewithin
      
      on mouseUp
      global st_sonlight
      if st_sonLight is not "blue" then
      vd
      go to card id 38754
      vs "left"
      end if
      go to card id 34007
      playQT "EV Drip II Mov",, loop, 90
      Buzzer 100
      end mouseUp
    * Part 41476:3 "none"
      on mouseUp
      global st_sonlight
      if st_sonLight is not "blue" then
      vd
      go to card id 38754
      vs "right"
      end if
      go to card id 34998
      playQT "EV Drip II Mov",, loop, 90
      Buzzer 100
      end mouseUp
      
      on mousewithin
      deCurse "override","left","color","nodelay"
      end mousewithin
  * Card 38754 "" (0 parts)
  * Card 40420 "" (38 parts)

    on openCard
    global ST_SonLight,ST_DadLight
    get the last word of field "pict name"
    if it is "spot" or it is "(dark)" then delete last word of field "pict name"
    if ST_DadLight is "on" then
    put " spot" after field "pict name"
    else
    if ST_SonLight is not "on" then put " (dark)" after field "pict name"
    end if
    pass openCard
    end openCard
    
    on compassButton
    global ST_sonlight,ST_dadLight,ST_dadLight,ST_GenTime
    if ST_sonlight is not on then
    play "SW Pushbutton In"
    -- click sound
    else
    play "SW Pushbutton In"
    put 8000 + (the id of the target - 2) into theIcon
    put the loc of the target into theLoc
    xcIcon3 theLoc,theIcon
    if theIcon is 8012 then
    put "on" into ST_dadLight
    playQT "MU Compass/Bubbles On Mov",,loop, 256
    get the last word of field "pict name"
    if it is "spot" or it is "(dark)" then
    delete last word of field "pict name"
    put " spot" after field "pict name"
    end if
    openCard
    go card
    else
    playQT "MU Compass/Bubbles Off Mov",,loop, 200
    put "blue" into ST_SonLight
    put "off" into ST_dadLight
    Buzzer 100
    put 0 into ST_GenTime
    play "SW Pushbutton In"
    openCard
    go card
    end if
    end if
    end compassButton

    * Part 40420:1 "up"
      on mouseUp
      global ST_DadLight
      put "MU Compass/Bubbles " & ST_DadLight & " Mov" into theSound
      playQT theSound,,loop,150
      HTVisual "scroll down",,,1,32
      pop card
      Buzzer 125
      end mouseUp
    * Part 40420:39 ""
    * Part 40420:38 ""
    * Part 40420:37 ""
    * Part 40420:36 ""
    * Part 40420:40 ""
    * Part 40420:2 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:3 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:4 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:5 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:6 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:7 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:8 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:9 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:10 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:11 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:12 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:13 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:14 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:15 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:16 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:17 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:18 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:19 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:20 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:21 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:22 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:23 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:24 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:25 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:26 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:27 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:28 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:29 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:30 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:31 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:32 ""
      on mouseDown
      compassButton
      end mouseDown
    * Part 40420:33 ""
      on mouseDown
      compassButton
      end mouseDown
  * Card 30263 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    put "Tunnel-black" into WhichPict
    HTChangePict WhichPict,"srcCopy"
    HTLock "forceFalse"
    else
    pass openCard
    end if
    end openCard

    * Part 30263:1 ""
      on mouseUp
      go to card id 30666
      playQT "EV Drip II Mov",fadeboth , loop, 90
      Buzzer 50
      end mouseUp
    * Part 30263:2 "right"
      on mouseUp
      go to card id 29150
      end mouseUp
    * Part 30263:3 "left"
      on mouseUp
      go to card id 29150
      end mouseUp
    * Part 30263:4 "qSirU"
      on mouseUp
      go to card id 30666
      playQT "EV Drip II Mov",fadeboth , loop, 90
      Buzzer 50
      end mouseUp
  * Card 30666 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 30666:1 ""
      on mouseUp
      go to card id 30890
      Buzzer 25
      end mouseUp
    * Part 30666:2 "right"
      on mouseUp
      go to card id 36761
      end mouseUp
    * Part 30666:4 "left"
      on mouseUp
      go to card id 36761
      end mouseUp
    * Part 30666:5 "qSirU"
      on mouseUp
      go to card id 30890
      Buzzer 25
      end mouseUp
  * Card 30890 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 30890:1 ""
      on mouseUp
      go to card id 31136
      Buzzer 25
      end mouseUp
    * Part 30890:2 "right"
      on mouseUp
      go to card id 36440
      end mouseUp
    * Part 30890:4 "left"
      on mouseUp
      go to card id 36440
      end mouseUp
    * Part 30890:5 "qSirU"
      on mouseUp
      go to card id 31136
      Buzzer 25
      end mouseUp
  * Card 31136 "" (4 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 31136:1 ""
      on mouseUp
      go to card id 31259
      Buzzer 10
      end mouseUp
    * Part 31136:2 "right"
      on mouseUp
      go to card id 28820
      end mouseUp
    * Part 31136:4 "left"
      on mouseUp
      go to card id 28820
      end mouseUp
    * Part 31136:5 "qSirU"
      on mouseUp
      go to card id 31259
      Buzzer 10
      end mouseUp
  * Card 31259 "" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 31259:1 ""
      on mouseUp
      go to card id 32230
      if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
      end mouseUp
    * Part 31259:3 "right"
      on mouseUp
      go to card id 28578
      end mouseUp
    * Part 31259:4 "left"
      on mouseUp
      go to card id 28578
      end mouseUp
  * Card 32230 "qSirU" (3 parts)

    on openCard
    global ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    if the last word of field "pict name" is not "(dark)" then
    put " (dark)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(dark)" then
    delete last word of field "pict name"
    end if
    end if
    playqt "EV Drip II Mov","","loop","90"
    if there is a window "SW Buzzer.Mov" then close window "SW Buzzer.Mov"
    pass openCard
    end openCard

    * Part 32230:1 ""
      on mouseUp
      go to card id 7674
      playQT "AR Water/Wind Mov",fadeboth, loop, 175
      end mouseUp
    * Part 32230:2 "right"
      on mouseUp
      go to card id 28272
      end mouseUp
    * Part 32230:3 "left"
      on mouseUp
      go to card id 28272
      end mouseUp
  * Card 4785 "qste3" (4 parts)

    on opencard
    playQT "AR Water/Wind Mov","","loop","175"
    
    pass opencard
    end opencard

    * Part 4785:1 "right"
      on mouseUp
      go to card id 3004
      play QT "AR Water/Wind Mov",,loop,256
      end mouseUp
    * Part 4785:2 "left"
      on mouseUp
      go to card id 5066
      end mouseUp
    * Part 4785:3 ""
      on mouseUp
      go to card id 11348
      end mouseUp
    * Part 4785:4 "qpum"
      on mouseUp
      go to card id 11348
      end mouseUp
  * Card 5066 "qste" (5 parts)

    on openCard
    global pictAdd,ST_Pump
    play stop
    if ST_Pump is empty then put 0 into ST_Pump
    if ST_Pump = 1 then
    get the rect of card button marker
    put field "pict name" & " (dry)|" & it into pictAdd
    show card button "down1"
    show card button "qdad1"
    else
    hide card button "down1"
    hide card button "qdad1"
    end if
    playQT "AR Water/Wind Mov","","loop","175"
    pass openCard
    end openCard

    * Part 5066:1 "right"
      on mouseUp
      go to card id 4785
      end mouseUp
    * Part 5066:2 "left"
      on mouseUp
      go to card id 4355
      end mouseUp
    * Part 5066:3 "marker"
    * Part 5066:4 "down1"
      on mouseUp
      go to card id 16772
      PlayQT "EV Drip II Mov", fadeboth, loop, 100
      end mouseUp
    * Part 5066:5 "qdad1"
      on mouseUp
      go to card id 16772
      PlayQT "EV Drip II Mov", fadeboth, loop, 100
      end mouseUp
  * Card 16772 "" (4 parts)
    * Part 16772:1 ""
      on mouseUp
      go to card id 16949
      PlayQT "EV Drip II Mov", , loop, 125
      end mouseUp
    * Part 16772:2 "right"
      on mouseUp
      go to card id 23242
      end mouseUp
    * Part 16772:3 "left"
      on mouseUp
      go to card id 23242
      end mouseUp
    * Part 16772:4 "qDad1"
      on mouseUp
      go to card id 16949
      PlayQT "EV Drip II Mov", , loop, 125
      end mouseUp
  * Card 16949 "" (4 parts)
    * Part 16949:1 ""
      on mouseUp
      go to card id 17160
      PlayQT "EV Drip II Mov", , loop, 125
      end mouseUp
    * Part 16949:2 "right"
      on mouseUp
      go to card id 22922
      end mouseUp
    * Part 16949:3 "left"
      on mouseUp
      go to card id 22922
      end mouseUp
    * Part 16949:4 "qDad1"
      on mouseUp
      go to card id 17160
      PlayQT "EV Drip II Mov", , loop, 125
      end mouseUp
  * Card 17160 "" (3 parts)
    * Part 17160:1 ""
      on mouseUp
      go to card id 17526
      PlayQT "EV Drip II Mov", , loop, 140
      end mouseUp
    * Part 17160:2 "right"
      on mouseUp
      go to card id 22530
      end mouseUp
    * Part 17160:3 "left"
      on mouseUp
      go to card id 22530
      end mouseUp
  * Card 17526 "qdad1" (7 parts)

    on opencard
    hide card button "enter"
    hide card button "qdadD"
    show card button "none"
    playQT "EV Drip II Mov","","loop","140"
    pass opencard
    end opencard

    * Part 17526:4 "doormarker"
    * Part 17526:6 "marker"
    * Part 17526:5 "enter"
      on mouseUp
      go to card id 18133
      playQT ,,loop,75
      end mouseUp
    * Part 17526:3 "left"
      on mouseUp
      if the visible of card button "Enter" is true then
      go to card id 22387
      play "DR FrplDr Dn"
      PlayQT "EV Drip II Mov",, loop, 100
      else
      go to card id 22387
      end if
      end mouseUp
    * Part 17526:1 "none"
      on mouseUp
      global ST_DadLight
      hc
      htlock true
      play "SW Pushbutton Out"
      HTVisual "scrollaway up",,the rect of card button doormarker,1,16
      if ST_DadLight is "on" then
      HTAddPict "Tunnel4-Down (dooropen) (light)",¬
      the rect of card button "marker","srccopy"
      playQT "MU Book/Bubbles Mov",,loop,50
      else
      HTAddPict "Tunnel4-Down (dooropen)",¬
      the rect of card button "marker","srccopy"
      playQT "EV Bubbles Mov",,loop, 75
      end if
      play "DR FrplDr Dn"
      htlock forcefalse
      hide card button none
      show card button "enter"
      show card button "qdadD"
      end mouseUp
    * Part 17526:2 "right"
      on mouseUp
      if the visible of card button "Enter" is true then
      go to card id 22387
      play "DR FrplDr Dn"
      PlayQT "EV Drip II Mov",, loop, 100
      else
      go to card id 22387
      end if
      end mouseUp
    * Part 17526:8 "qdadD"
      on mouseUp
      go to card id 18133
      playQT ,,loop,75
      end mouseUp
  * Card 17724 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 17724:1 ""
      on mouseUp
      go to card id 18133
      end mouseUp
    * Part 17724:2 "right"
      on mouseUp
      go to card id 22387
      end mouseUp
    * Part 17724:3 "left"
      on mouseUp
      go to card id 22387
      end mouseUp
  * Card 18133 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 18133:1 ""
      on mouseUp
      go to card id 18382
      playQT ,,loop,100
      end mouseUp
    * Part 18133:2 "right"
      on mouseUp
      go to card id 22222
      end mouseUp
    * Part 18133:3 "left"
      on mouseUp
      go to card id 22222
      end mouseUp
  * Card 18382 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 18382:1 ""
      on mouseUp
      go to card id 18589
      playQT ,,loop,125
      end mouseUp
    * Part 18382:2 "left"
      on mouseUp
      go to card id 21969
      end mouseUp
    * Part 18382:3 "right"
      on mouseUp
      go to card id 21969
      end mouseUp
  * Card 18589 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 18589:1 ""
      on mouseUp
      go to card id 18724
      playQT ,,loop,150
      end mouseUp
    * Part 18589:3 "left"
      on mouseUp
      go to card id 21345
      end mouseUp
    * Part 18589:4 "right"
      on mouseUp
      go to card id 21345
      end mouseUp
  * Card 18724 "" (4 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 18724:1 ""
      on mouseUp
      go to card id 19153
      playQT ,,loop,175
      end mouseUp
    * Part 18724:2 "right"
      on mouseUp
      go to card id 20949
      end mouseUp
    * Part 18724:3 "left"
      on mouseUp
      go to card id 20949
      end mouseUp
    * Part 18724:5 "qDadD"
      on mouseUp
      go to card id 19153
      playQT ,,loop,175
      end mouseUp
  * Card 19153 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 19153:1 ""
      on mouseUp
      go to card id 19700
      playQT ,,loop,200
      end mouseUp
    * Part 19153:2 "right"
      on mouseUp
      go to card id 20695
      end mouseUp
    * Part 19153:3 "left"
      on mouseUp
      go to card id 20695
      end mouseUp
  * Card 19700 "qdadD" (3 parts)

    on openCard
    global ST_DadLight
    put "BookRoom.MooV" into theMovieName
    if there is a window TheMovieName then close window theMovieName
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    show card button "none"
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    hide card button "none"
    end if
    playQT "","","loop","200"
    pass openCard
    end openCard

    * Part 19700:1 "right"
      on mouseUp
      go to card id 19768
      end mouseUp
    * Part 19700:3 "left"
      on mouseUp
      go to card id 20098
      end mouseUp
    * Part 19700:4 "none"
      on mouseUp
      HTVisual "scroll up",,,0,64
      go to card id 15664
      playQT ,,loop,250
      bookMovie
      end mouseUp
      
      on mousewithin
      deCurse "override","down","color","nodelay"
      end mousewithin
  * Card 15664 "" (3 parts)

    on openCard
    hide card button book
    pass openCard
    end openCard
    
    on bookMovie
    set cursor to none
    put "BookRoom.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button table,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the useCustomClut of window TheMovieName to true
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    end if
    end bookMovie
    
    --on closeCard
    put "BookRoom.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    close window theMovieName
    end if
    pass closeCard
    end closeCard

    * Part 15664:2 "none"
      on mouseUp
      put "BookRoom.MooV" into theMovieName
      if there is a window TheMovieName then close window theMovieName
      HTVisual "scroll down",,,0,64
      go to card id 19700
      playQT ,,loop,200
      end mouseUp
    * Part 15664:3 "table"
      on mouseUp
      global soundMooV
      put "BookRoom.MooV" into TheMovieName
      put soundMooV into tempMooV
      fadeOut
      if there is a window TheMovieName then
      show window TheMovieName
      set the starttime of window theMovieName to "0"
      set the currTime of window theMovieName to "0"
      set the endTime of window theMovieName to "5,40"
      set the rate of window TheMovieName to "2.0"
      show card button book
      end if
      play "cGas"
      repeat until the rate of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      go card id 23473
      hide window theMovieName
      playQT tempMooV,fadein,loop,250
      end mouseUp
    * Part 15664:4 "book"
  * Card 23473 "" (2 parts)
    * Part 23473:2 ""
      on mouseUp
      global soundMooV
      put "BookRoom.MooV" into TheMovieName
      if there is a window TheMovieName then
      put soundMooV into tempMooV
      fadeOut
      set the currTime of window TheMovieName to the endTime of window theMovieName
      show window theMovieName
      set the starttime of window theMovieName to "5,40"
      set the currTime of window theMovieName to "5,40"
      set the endTime of window theMovieName to "11,20"
      set the rate of window TheMovieName to "2.0"
      play "cGas"
      repeat until the rate of window TheMovieName = 0
      send movieIdle to window TheMovieName
      end repeat
      playQT tempMooV,fadein,loop,250
      end if
      go card id 15664
      playQT ,,loop,200
      if there is a window TheMovieName then hide window theMovieName
      send mouseUp to card button "none"
      end mouseUp
    * Part 23473:1 ""
      on mouseUp
      global ST_book
      put "up" into ST_book
      go to card id 53406
      end mouseUp
  * Card 53791 "" (1 parts)

    on opencard
    beep
    put "you're on card 53791"
    pass opencard
    end opencard
    
    on idle
    put "BookRoom.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to true
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    set the currTime of window TheMovieName to the endTime of window TheMovieName
    set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    show window TheMovieName
    --set the rate of window TheMovieName to "-2.0"
    --show card button book
    end if
    go card id 15664
    end idle

    * Part 53791:1 "marker"
  * Card 53406 "" (2 parts)
    * Part 53406:2 ""
      on mouseUp
      go to card id 23473
      end mouseUp
    * Part 53406:1 ""
      on mouseUp
      go to card id 53570
      end mouseUp
  * Card 53570 "" (3 parts)

    on mouseDownInMovie
    deCurse "override",2003,"color","nodelay"
    lock screen
    put "BookRoom.MooV" into theMovieName
    if there is a window TheMovieName then close window theMovieName
    put "MystLib.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    hide window TheMovieName
    close window TheMovieName
    end if
    play "transport"
    soundstop
    go to card "black"
    unlock screen
    htlock true
    lock screen
    go to card "black" of stack "Myst"
    vd
    push card id 46439 of stack "Myst"
    wait until the sound is "done"
    play "transport"
    go to card id 44018 of stack "Myst"
    end mouseDownInMovie
    
    on idle
    get "MystLib.MooV"
    if there is not a window it then flyby
    end idle
    
    on closeCard
    put "MystLib.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    hide window TheMovieName
    close window TheMovieName
    end if
    pass closeCard
    end closeCard
    
    on FlyBy
    put "MystLib.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    end if
    end FlyBy

    * Part 53570:1 ""
      on mouseUp
      go to card id 23473
      end mouseUp
    * Part 53570:2 ""
    * Part 53570:3 "marker"
      on mouseUp
      send MouseDownInMovie to card
      end mouseUp
  * Card 20098 "" (2 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 20098:1 "right"
      on mouseUp
      go to card id 19700
      end mouseUp
    * Part 20098:2 "left"
      on mouseUp
      go to card id 20478
      end mouseUp
  * Card 20478 "" (4 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 20478:1 ""
      on mouseUp
      go to card id 20695
      playQT ,,loop,175
      end mouseUp
    * Part 20478:2 "right"
      on mouseUp
      go to card id 20098
      end mouseUp
    * Part 20478:3 "left"
      on mouseUp
      go to card id 19768
      end mouseUp
    * Part 20478:5 "qDad2"
      on mouseUp
      go to card id 20695
      playQT ,,loop,175
      end mouseUp
  * Card 20695 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 20695:1 ""
      on mouseUp
      go to card id 20949
      playQT ,,loop,150
      end mouseUp
    * Part 20695:2 "right"
      on mouseUp
      go to card id 19153
      end mouseUp
    * Part 20695:3 "left"
      on mouseUp
      go to card id 19153
      end mouseUp
  * Card 20949 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 20949:1 ""
      on mouseUp
      go to card id 21345
      playQT ,,loop,125
      end mouseUp
    * Part 20949:2 "right"
      on mouseUp
      go to card id 18724
      end mouseUp
    * Part 20949:3 "left"
      on mouseUp
      go to card id 18724
      end mouseUp
  * Card 21345 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 21345:1 ""
      on mouseUp
      go to card id 21969
      playQT ,,loop,100
      end mouseUp
    * Part 21345:2 "right"
      on mouseUp
      go to card id 18589
      end mouseUp
    * Part 21345:3 "left"
      on mouseUp
      go to card id 18589
      end mouseUp
  * Card 21969 "" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 21969:1 ""
      on mouseUp
      go to card id 22222
      playQT ,,loop,75
      end mouseUp
    * Part 21969:2 "right"
      on mouseUp
      go to card id 18382
      end mouseUp
    * Part 21969:3 "left"
      on mouseUp
      go to card id 18382
      end mouseUp
  * Card 22222 "qDad2" (3 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    playQT "","","loop","75"
    pass openCard
    end openCard

    * Part 22222:1 ""
      on mouseUp
      go to card id 22387
      play "DR FrplDr Up"
      playQT "EV Drip II Mov", , loop, 100
      end mouseUp
    * Part 22222:2 "right"
      on mouseUp
      go to card id 18133
      end mouseUp
    * Part 22222:3 "left"
      on mouseUp
      go to card id 18133
      end mouseUp
  * Card 22387 "" (4 parts)
    * Part 22387:1 ""
      on mouseUp
      go to card id 22530
      playQT "EV Drip II Mov", , loop, 75
      end mouseUp
    * Part 22387:2 "right"
      on mouseUp
      go to card id 17526
      end mouseUp
    * Part 22387:3 "left"
      on mouseUp
      go to card id 17526
      end mouseUp
    * Part 22387:4 "qdadU"
      on mouseUp
      go to card id 22530
      playQT "EV Drip II Mov", , loop, 75
      end mouseUp
  * Card 22530 "" (4 parts)
    * Part 22530:1 ""
      on mouseUp
      go to card id 22922
      playQT "EV Drip II Mov", , loop, 50
      end mouseUp
    * Part 22530:2 "right"
      on mouseUp
      go to card id 17160
      end mouseUp
    * Part 22530:3 "left"
      on mouseUp
      go to card id 17160
      end mouseUp
    * Part 22530:4 "qDadU"
      on mouseUp
      go to card id 22922
      playQT "EV Drip II Mov", , loop, 50
      end mouseUp
  * Card 22922 "" (3 parts)
    * Part 22922:1 ""
      on mouseUp
      go to card id 23242
      end mouseUp
    * Part 22922:2 "right"
      on mouseUp
      go to card id 16949
      end mouseUp
    * Part 22922:3 "left"
      on mouseUp
      go to card id 16949
      end mouseUp
  * Card 23242 "qDadU" (4 parts)

    on openCard
    global pictAdd,ST_SonLight
    if ST_SonLight is empty then put "off" into ST_SonLight
    if ST_SonLight is not "on" then
    get the rect of card button marker2
    put field "pict name" & " (dark)|" & it into pictAdd
    end if
    playQT  "EV Drip II Mov","","loop","50"
    pass openCard
    end openCard

    * Part 23242:4 "marker2"
    * Part 23242:1 ""
      on mouseUp
      go to card id 3004
      playQT "AR Water/Wind Mov", fadeboth, loop, 175
      end mouseUp
    * Part 23242:2 "right"
      on mouseUp
      go to card id 16772
      end mouseUp
    * Part 23242:3 "left"
      on mouseUp
      go to card id 16772
      end mouseUp
  * Card 19768 "" (2 parts)

    on openCard
    global ST_DadLight
    if ST_DadLight is empty then put "off" into ST_DadLight
    if ST_DadLight is "on" then
    if the last word of field "pict name" is not "(light)" then
    put " (light)" after field "pict name"
    end if
    else
    if the last word of field "pict name" is "(light)" then
    delete last word of field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 19768:1 "left"
      on mouseUp
      go to card id 19700
      end mouseUp
    * Part 19768:2 "right"
      on mouseUp
      go to card id 20478
      end mouseUp
  * Card 4355 "qste2" (7 parts)

    on opencard
    playqt "AR Water/Wind Mov","","loop","175"
    pass opencard
    end opencard

    * Part 4355:1 "left"
      on mouseUp
      go to card id 3004
      end mouseUp
    * Part 4355:2 "right"
      on mouseUp
      go to card id 5066
      end mouseUp
    * Part 4355:3 ""
      on mouseUp
      go to card id 5269
      end mouseUp
    * Part 4355:4 ""
      on mouseUp
      go to card id 7277
      end mouseUp
    * Part 4355:5 "qlig"
      on mouseUp
      go to card id 5269
      end mouseUp
    * Part 4355:6 "qbow"
      on mouseUp
      go to card id 7277
      end mouseUp
    * Part 4355:8 "qbow left"
      on mouseUp
      go to card id 3004
      end mouseUp
  * Card 5269 "" (4 parts)
    * Part 5269:1 ""
      on mouseUp
      go to card id 5411
      end mouseUp
    * Part 5269:2 "right"
      on mouseUp
      go to card id 7102
      end mouseUp
    * Part 5269:3 "left"
      on mouseUp
      go to card id 7102
      end mouseUp
    * Part 5269:4 "qlig"
      on mouseUp
      go to card id 5411
      end mouseUp
  * Card 5411 "" (4 parts)
    * Part 5411:1 ""
      on mouseUp
      go to card id 5866
      end mouseUp
    * Part 5411:2 "right"
      on mouseUp
      go to card id 6838
      end mouseUp
    * Part 5411:3 "left"
      on mouseUp
      go to card id 6838
      end mouseUp
    * Part 5411:4 "qlig"
      on mouseUp
      go to card id 5866
      end mouseUp
  * Card 5866 "" (6 parts)

    on openCard
    global pictAdd,ST_Pump,ST_Chest,ST_ChestValve
    if ST_Pump is empty then put 0 into ST_Pump
    if ST_Pump = 3 then
    get the rect of card button marker
    put field "pict name" & " (dry)|" & it into pictAdd
    else
    if ST_Chest is not "filled" and ST_ChestValve is "closed" then
    get the rect of card button marker2
    put field "pict name" & " (up)|" & it into pictAdd
    end if
    end if
    pass openCard
    end openCard

    * Part 5866:5 "marker"
    * Part 5866:1 "up"
      on mouseUp
      go to card id 6006
      end mouseUp
    * Part 5866:2 ""
      on mouseUp
      go to card id 6360
      end mouseUp
    * Part 5866:3 "right"
      on mouseUp
      go to card id 6623
      end mouseUp
    * Part 5866:4 "left"
      on mouseUp
      go to card id 6623
      end mouseUp
    * Part 5866:6 "marker2"
  * Card 6360 "qlig" (6 parts)

    on openCard
    global ST_Pump,ST_Chest,ST_ChestValve
    put "Path/Lighthouse4-S" into field "pict name"
    if ST_Pump = 3 then
    put " dry" after field "pict name"
    else
    if ST_Chest is not "filled" and ST_ChestValve is "closed" then
    put " up" after field "pict name"
    end if
    end if
    playqt "AR Water/Wind Mov","","loop","175"
    pass openCard
    end openCard

    * Part 6360:4 "marker"
    * Part 6360:1 "right"
      on mouseUp
      go to card id 6623
      end mouseUp
    * Part 6360:2 "left"
      on mouseUp
      go to card id 6623
      end mouseUp
    * Part 6360:3 ""
      on mouseUp
      global st_pump
      go to card id 13528
      if st_pump ≠ 3 then playQT "EV Drip II Mov", fadeboth, loop, 150
      else fadeout
      end mouseUp
    * Part 6360:5 "marker2"
    * Part 6360:6 ""
      on mouseUp
      global st_pump
      if st_pump is 3 then
      go to card id 21557
      else go to card id 13528
      end mouseUp
  * Card 13528 "" (8 parts)

    on openCard
    global pictAdd,ST_Pump, ST_Hatch,ST_Chest,ST_ChestValve
    put "Lighthouse1-S" into field "pict name"
    if ST_Hatch = "open" or ST_Hatch = "closed" then
    get the rect of card button marker2
    put return & field "pict name" & " (open)|" & it into pictAdd
    end if
    if ST_Pump = 3 then
    put " dry" after field "pict name"
    else
    if ST_Chest is not "filled" and ST_ChestValve is "closed" then
    put " up" after field "pict name"
    end if
    end if
    pass openCard
    end openCard

    * Part 13528:7 "marker2"
    * Part 13528:8 "marker3"
    * Part 13528:1 ""
      on mouseUp
      go to card id 13801
      end mouseUp
    * Part 13528:2 "right"
      on mouseUp
      go to card id 14325
      end mouseUp
    * Part 13528:3 "left"
      on mouseUp
      go to card id 14325
      end mouseUp
    * Part 13528:4 "marker"
    * Part 13528:5 ""
      on mouseUp
      go to card id 19307
      end mouseUp
    * Part 13528:6 "down"
      on mouseUp
      global ST_pump
      if ST_pump is 3 then go to card id 21557
      else go to card id 19307
      end mouseUp
  * Card 19307 "" (10 parts)

    on openCard
    global pictAdd,ST_Pump,ST_Chest,ST_ChestValve
    hide card button "closeChest"
    hide card button "key"
    show card button "chest"
    put "Lighthouse2-S down" into field "pict name"
    if ST_Pump = 3 then
    put " dry" after field "pict name"
    else
    if ST_Chest is not "filled" and ST_ChestValve is "closed" then
    put " up" after field "pict name"
    end if
    end if
    pass openCard
    end openCard
    
    on idle
    global preLoad
    if preLoad is empty then
    MoviePre
    put true into preLoad
    end if
    end idle
    
    on moviePre
    global ST_Pump,ST_Chest,ST_ChestValve,theMovieName
    if ST_Chest is not "filled" and ST_ChestValve is "closed" and ST_Pump ≠ 3 then
    put "key (chest).MooV" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker4,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    else
    if ST_Pump = 3 then put "Key (dry).MooV" into theMovieName
    else put "Key.MooV" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker3,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end if
    end moviePre
    
    on closeCard
    global preLoad,theMovieName
    if there is a window theMovieName then close window theMovieName
    put empty into theMovieName
    put empty into preLoad
    pass closeCard
    end closeCard

    * Part 19307:4 "marker"
    * Part 19307:5 "marker2"
    * Part 19307:1 "up"
      on mouseUp
      htlock true
      go to card id 13801
      end mouseUp
    * Part 19307:2 ""
      on mouseUp
      go to card id 13528
      end mouseUp
    * Part 19307:3 "left"
      on mouseUp
      htlock true
      go to card id 13829
      end mouseUp
    * Part 19307:6 "chest"
      on mouseDown
      global ST_key,ST_ChestValve,ST_Chest,ST_pump
      set cursor to none
      if ST_Chest is not "filled" and ST_ChestValve is "closed" and ST_Pump ≠ 3 then
      HTlock true
      put "key (chest).MooV" into theMovieName
      keyOpen
      play "DR Keylock II"
      put field "pict name" into WhichPict
      put " (open)" after WhichPict
      HTAddPict WhichPict,the rect of card button marker2,"srcCopy"
      if ST_Key is not false then
      put "(empty)" into last word of WhichPict
      HTAddPict WhichPict,the rect of card button key,"srcCopy"
      end if
      HTVisual "wipe Up",,,1,32
      HTlock forceFalse
      --go this card
      --if there is a window theMovieName then hide window theMovieName
      hide me
      show card button closeChest
      show card button key
      else
      if ST_Pump = 3 then key "Key (dry).MooV"
      else key "Key.MooV"
      end if
      end mouseDown
      
      on keyOpen
      put "key (chest).MooV" into theMovieName
      if there is a window TheMovieName then
      show window TheMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      end if
      end keyOpen
      
      on key theMovieName
      if there is a window TheMovieName then
      show window TheMovieName
      set the rate of window TheMovieName to "1.0"
      repeat until the rate of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      set the rate of window theMovieName to -1
      repeat until the currTime of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      hide window theMovieName
      end if
      end key
    * Part 19307:7 "closeChest"
      on mouseUp
      put "key (chest).MooV" into theMovieName
      set the startTime of window TheMovieName to "0"
      set the currTime of window theMovieName to the endTime of window TheMovieName
      show window TheMovieName
      HTLock "on"
      HTVisual "Wipe Down",,,1,64
      openCard
      go this card
      set the rate of window TheMovieName to "-1.0"
      repeat until the currTime of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      hide window theMovieName
      show card button "chest"
      hide card button "closeChest"
      hide card button "key"
      end mouseUp
    * Part 19307:8 "key"
      on mouseUp
      global ST_Key
      put field "pict name" into WhichPict
      if ST_Key is false then
      put " (empty)" after WhichPict
      HTAddPict WhichPict,the rect of me,"srcCopy"
      put true into ST_key
      deCurse "override",5001,"color","nodelay"
      else
      if ST_Key is true then
      put " (open)" after WhichPict
      HTAddPict WhichPict,the rect of card button marker2,"srcCopy"
      put false into ST_Key
      deCurse "override","hand","color","nodelay"
      end if
      end if
      end mouseUp
    * Part 19307:9 "marker3"
    * Part 19307:10 "marker4"
  * Card 13801 "" (6 parts)

    on openCard
    global pictAdd,ST_Hatch
    if ST_Hatch = "open" then
    get the rect of card button marker1
    put field "pict name" & " (open)|" & it into pictAdd
    else
    if ST_Hatch = "closed" then
    get the rect of card button marker2
    put field "pict name" & " (nolock)|" & it into pictAdd
    end if
    end if
    pass openCard
    end openCard
    
    
    
    on idle
    global preLoad
    if preLoad is empty then
    MoviePre
    put true into preLoad
    end if
    end idle
    
    on moviePre
    global ST_Key,theMovieName
    if ST_Key is true then
    put "OpenLock.MooV" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker4,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end if
    end moviePre
    
    on closeCard
    global preLoad,theMovieName
    if there is a window theMovieName then close window theMovieName
    put empty into theMovieName
    put empty into preLoad
    pass closeCard
    end closeCard

    * Part 13801:7 "marker4"
      on mouseUp
      
      end mouseUp
    * Part 13801:1 "right"
      on mouseUp
      go to card id 13829
      end mouseUp
    * Part 13801:2 "left"
      on mouseUp
      go to card id 13829
      end mouseUp
    * Part 13801:3 "marker1"
      on mouseDown
      global ST_Hatch
      if ST_Hatch is empty then put "locked" into ST_Hatch
      if ST_Hatch is "locked" then
      -- jiggle latch noise
      else
      if ST_Hatch is "closed" then
      put field "pict name" into WhichPict
      put " (open)" after WhichPict
      htlock true
      HTAddPict WhichPict,the rect of me,"srcCopy"
      dplay "DR Creak 2"
      put "open" into ST_Hatch
      opencard
      
      play stop
      else
      go to card id 27714
      playQT "EV Drip II Mov", , loop, 50
      end if
      end if
      end mouseDown
    * Part 13801:5 "marker2"
      on mouseUp
      global ST_Hatch,ST_key
      if ST_Hatch is empty then put "locked" into ST_Hatch
      if ST_Key is true then
      if ST_Hatch is "locked" then
      put "OpenLock.MooV" into theMovieName
      if there is a window theMovieName then
      deCurse "override","hand","color","nodelay"
      show window theMovieName
      set rate of window theMovieName to 1
      end if
      put field "pict name" into WhichPict
      put " (nolock)" after WhichPict
      HTAddPict WhichPict,the rect of me,"srcCopy"
      go this card
      play "Dr Keylock III"
      repeat until the rate of window theMovieName is "0"
      send movieIdle to window theMovieName
      end repeat
      hide window theMovieName
      close window theMovieName
      play "wa drip "
      put "closed" into  ST_Hatch
      put "floor" into ST_key
      end if
      end if
      end mouseUp
    * Part 13801:6 "down"
      on mouseUp
      go to card id 19307
      end mouseUp
  * Card 2260 "" (4 parts)

    on closeCard
    pass closeCard
    end closeCard
    
    on mouseDownInMovie
    MoveGen
    end mouseDownInMovie
    
    on MoveGen
    play stop
    play "EL Gen Crank Start"
    global ST_dadlight,ST_sonLight,ST_GenTime
    put "Generator.MooV" into TheMovie
    set the rate of window theMovie to "1"
    put the ticks into theStart
    repeat until the mouse is up
    send movieIdle to window theMovie
    if the sound is "done" then play "EL Gen Crank Mid"
    end repeat
    put the ticks - theStart into theTime
    if ST_GenTime < the ticks then put the ticks + (theTime * 30) into ST_GenTime
    else add theTime * 30 to ST_GenTime
    -- maximum of 10 minutes in battery (see card script of battery for details)
    if ST_GenTime - the ticks > 36000 then put the ticks + 36000 into ST_GenTime
    play stop
    play "EL Gen Crank End"
    repeat with x = 10 down to 0
    set the rate of window theMovie to x/10
    send movieIdle to window theMovie
    wait 3
    end repeat
    put on into ST_sonlight
    repeat until the mouse is up -- added (1.0b8)
    soundidle  -- added (1.0b8)
    end repeat  -- added (1.0b8)
    end MoveGen
    
    on idle
    if there is not a window "Generator.MooV" then GenMovie
    pass idle
    end idle
    
    on genMovie
    put "Generator.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    end if
    if there is a window TheMovieName then
    set the rate of window TheMovieName to "0.0"
    show window TheMovieName
    end if
    end genMovie

    * Part 2260:1 ""
      on mouseUp
      htlock true
      if there is a window "Generator.MooV" then hide window "Generator.MooV"
      lock screen
      go to card id 2347
      end mouseUp
    * Part 2260:2 "right"
      on mouseUp
      htlock true
      if there is a window "Generator.MooV" then hide window "Generator.MooV"
      go to card id 27714
      end mouseUp
    * Part 2260:3 "left"
      on mouseUp
      htlock true
      if there is a window "Generator.MooV" then hide window "Generator.MooV"
      go to card id 27714
      end mouseUp
    * Part 2260:5 "marker"
      on mousedown
      global ST_sonlight, ST_dadlight
      put "Generator.MooV" into TheMovieName --∆
      if there is a window TheMovieName then
      set the currTime of window TheMovieName to "0"
      show window TheMovieName
      end if
      MoveGen
      end mousedown
  * Card 27714 "" (5 parts)

    on openCard
    global pictAdd,ST_Hatch
    if ST_Hatch = "closed" then
    get the rect of card button marker
    put field "pict name" & " (closed)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 27714:7 "marker"
    * Part 27714:1 "right"
      on mouseUp
      go to card id 2260
      end mouseUp
    * Part 27714:2 "left"
      on mouseUp
      go to card id 2260
      end mouseUp
    * Part 27714:5 ""
      on mouseUp
      global ST_Hatch
      if ST_Hatch is "open" then
      go to card id 28050
      playQT "EV Drip II Mov", , loop, 100
      else
      put "open" into ST_Hatch
      htlock true
      htvisual"wipe down"
      openCard
      play "cdoorclose" c5
      go this card
      playQT "EV Drip II Mov", , loop, 100
      end if
      end mouseUp
    * Part 27714:6 ""
      on mouseDown
      global ST_Hatch
      if ST_Hatch is "open" then
      put "closed" into ST_Hatch
      htlock true
      HTVisual "wipe up"
      openCard
      play "cdoorclose" a4
      go this card
      end if
      end mouseDown
  * Card 28050 "" (2 parts)
    * Part 28050:5 ""
      on mouseUp
      go to card id 27714
      end mouseUp
    * Part 28050:3 ""
      on mouseUp
      if there is a window "Generator.MooV" then close window "Generator.MooV"
      go to card id 13801
      playQT "EV Drip II Mov", , loop, 150
      end mouseUp
  * Card 2347 "" (5 parts)

    on openCard
    global oldlevel
    put 0 into oldlevel
    HTLock true
    HTChangePict "LighthouseTop1-Battery","srccopy"
    setLevel
    HTLock forcefalse
    end openCard
    
    on idle
    setLevel
    end idle
    
    on setLevel
    global ST_GenTime,oldLevel
    if ST_GenTime < the ticks then put 0 into theLevel
    else put (ST_GenTime - the Ticks) div 450 into theLevel
    -- 450 comes from 36000 (10 minutes) divided by 80 (height of meter)
    if thelevel < 10 then HTAddPict "LighthouseTop1-Battery (red)",the rect of card button LED,"srccopy"
    if theLevel ≠ oldLevel or (theLevel < 10 and theLevel ≠ 0) then
    put theLevel into oldLevel
    get the rect of card button level
    put item 4 of it - theLevel into item 2 of it
    set the rect of card button level to it
    put "0,0,21,85" into theClip
    put the top of card button level - the top of card button bounds into item 2 of theClip
    htlock true
    HTChangePict "LighthouseTop1-Battery","srccopy"
    HTAddPict "LighthouseTop1-Battery (level)",the rect of card button level,"srccopy","srcRect",theClip
    htlock forcefalse
    end if
    end setLevel

    * Part 2347:1 ""
      on mouseUp
      go to card id 2260
      playQT "EV Drip II Mov", , loop, 50
      end mouseUp
    * Part 2347:2 ""
    * Part 2347:4 "bounds"
    * Part 2347:3 "level"
    * Part 2347:5 "LED"
  * Card 13829 "" (7 parts)

    on openCard
    global ST_Pump
    put "Lighthouse2-N" into field "pict name"
    if ST_Pump = 3 then
    put " dry" after field "pict name"
    end if
    pass openCard
    end openCard

    * Part 13829:4 "marker"
    * Part 13829:1 "right"
      on mouseUp
      go to card id 13801
      end mouseUp
    * Part 13829:2 "left"
      on mouseUp
      go to card id 13801
      end mouseUp
    * Part 13829:3 ""
      on mouseUp
      go to card id 14325
      end mouseUp
    * Part 13829:5 "right"
      on mouseUp
      go to card id 19307
      end mouseUp
    * Part 13829:7 "down"
      on mouseUp
      go to card id 21190
      end mouseUp
    * Part 13829:9 ""
      on mouseUp
      global ST_Pump
      if ST_Pump = 3 then
      go to card id 21557
      end if
      end mouseUp
  * Card 21190 "" (3 parts)

    on openCard
    global ST_Pump
    put "Lighthouse2-N down" into field "pict name"
    if ST_Pump is empty then put 0 into ST_Pump
    if ST_Pump = 3 then
    put " dry" after field "pict name"
    end if
    pass openCard
    end openCard

    * Part 21190:3 "marker"
    * Part 21190:1 "up"
      on mouseUp
      go to card id 13829
      end mouseUp
    * Part 21190:2 ""
      on mouseUp
      global ST_pump
      if ST_pump is 3 then go to card id 21557
      else go to card id 13829
      end mouseUp
  * Card 21557 "" (4 parts)
    * Part 21557:1 ""
      on mouseUp
      go to card id 23638
      end mouseUp
    * Part 21557:2 "up"
      on mouseUp
      go to card id 13528
      end mouseUp
    * Part 21557:3 "left"
      on mouseUp
      go to card id 14325
      end mouseUp
    * Part 21557:4 "qLigD"
      on mouseUp
      go to card id 23638
      end mouseUp
  * Card 23638 "" (4 parts)
    * Part 23638:1 ""
      on mouseUp
      go to card id 24202
      end mouseUp
    * Part 23638:2 "right"
      on mouseUp
      go to card id 26476
      end mouseUp
    * Part 23638:4 "left"
      on mouseUp
      go to card id 26476
      end mouseUp
    * Part 23638:5 "qLigD"
      on mouseUp
      go to card id 24202
      end mouseUp
  * Card 24202 "" (7 parts)

    on openCard
    global pictAdd,ST_Key,ST_Hatch
    if ST_Key = "floor" then
    get the rect of card button marker
    put field "pict name" & " (key)|" & it after pictAdd
    end if
    if ST_Hatch is not "locked" then
    get the rect of card button marker3
    put field "pict name" & " (lock)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 24202:1 ""
      on mouseUp
      go to card id 24357
      end mouseUp
    * Part 24202:2 "right"
      on mouseUp
      go to card id 25863
      end mouseUp
    * Part 24202:3 "left"
      on mouseUp
      go to card id 25863
      end mouseUp
    * Part 24202:4 "marker"
    * Part 24202:5 "marker3"
    * Part 24202:6 "qLigD"
      on mouseUp
      go to card id 24357
      end mouseUp
    * Part 24202:7 "qLigD"
      on mouseUp
      go to card id 24357
      end mouseUp
  * Card 24357 "qLigD" (6 parts)

    on openCard
    global pictAdd,ST_ChestValve,ST_Key,ST_Hatch
    if ST_ChestValve = "open" then
    get the rect of card button marker
    put field "pict name" & " (open)|" & it & return after pictAdd
    end if
    if ST_Key = "floor" then
    get the rect of card button marker2
    put field "pict name" & " (key)|" & it & return after pictAdd
    end if
    if ST_Hatch is not "locked" then
    get the rect of card button marker3
    put field "pict name" & " (lock)|" & it after pictAdd
    end if
    soundstop
    pass openCard
    end openCard

    * Part 24357:3 "marker"
    * Part 24357:1 ""
      on mouseUp
      go to card id 25223
      end mouseUp
    * Part 24357:2 ""
      on mouseUp
      go to card id 27062
      end mouseUp
    * Part 24357:4 "marker2"
      on mouseUp
      global ST_Key
      put field "pict name" into WhichPict
      if ST_Key is "floor" then
      put true into ST_key
      deCurse "override",5001,"color","nodelay"
      HTLock true
      openCard
      else
      if ST_Key is true then
      put "floor" into ST_Key
      --HyperCursor "hand"
      HTLock true
      openCard
      end if
      end if
      end mouseUp
    * Part 24357:5 "marker3"
    * Part 24357:6 "qLigU"
      on mouseUp
      go card
      end mouseUp
  * Card 27062 "" (4 parts)

    on openCard
    global pictAdd,ST_ChestValve
    if ST_ChestValve = "open" then
    get the rect of card button marker2
    put field "pict name" & " (open)|" & it after pictAdd
    end if
    pass openCard
    end openCard
    
    on mouseDownInMovie
    set the rate of window "LighthouseSpigot.MooV" to 1
    end mousedownInMovie
    
    on closeCard
    if there is a window "LighthouseSpigot.MooV" then close window "LighthouseSpigot.MooV"
    pass closeCard
    end closeCard
    
    on spigotMovie
    put "LighthouseSpigot.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the timeFormat of window TheMovieName to "MovieTime"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    end if
    end spigotMovie

    * Part 27062:5 "marker2"
    * Part 27062:1 ""
      on mouseUp
      go to card id 24357
      end mouseUp
    * Part 27062:3 ""
    * Part 27062:2 "marker"
      on mouseDown
      global ST_ChestValve,ST_Chest
      hc
      if ST_ChestValve is "closed" then
      if ST_Chest is "Filled" then
      put "LighthouseSpigot.MooV" into TheMovieName --∆
      spigotMovie
      --set the currTime of window theMovieName to the endTime of window theMovieName
      set the currTime of window theMovieName to 350
      show window TheMovieName
      set rate of window theMovieName to 1
      play "SQ Small Wood Valve"
      repeat until the rate of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      
      play "WA running far" tempo 16 c c c c c c c c c c c c
      set the currTime of window theMovieName to 650
      set the startTime of window theMovieName to 750 -- (1.0b8)
      
      set the loop of window theMovieName to true
      set rate of window theMovieName to 1
      put the seconds into theStart
      repeat until the seconds ≥ theStart + 10
      send movieIdle to window theMovieName
      end repeat
      play stop
      set the rate of window theMovieName to 0
      set the currTime of window theMovieName to 0
      
      HTAddPict (field "pict name" & " (open)"),¬
      the rect of card button marker, "srccopy"
      put "open" into  ST_ChestValve
      put "closed" into ST_Chest
      hide window theMovieName
      else
      put "LighthouseSpigot.MooV" into TheMovieName --∆
      spigotMovie
      --set the currTime of window theMovieName to the endTime of window theMovieName
      set the currTime of window theMovieName to 350
      show window TheMovieName
      set rate of window theMovieName to -1
      play "SQ Small Wood Valve"
      repeat until the rate of window theMovieName is 0
      send movieIdle to window theMovieName
      end repeat
      HTAddPict (field "pict name" & " (open)"),¬
      the rect of card button marker, "srccopy"
      put "open" into  ST_ChestValve
      hide window theMovieName
      end if
      else
      put "LighthouseSpigot.MooV" into TheMovieName --∆
      spigotMovie
      play "SQ Small Wood Valve"
      set the currTime of window theMovieName to 0
      show window TheMovieName
      set the endTime of window theMovieName to 350
      set rate of window theMovieName to 1
      repeat until the rate of window theMovieName = 0
      send movieIdle to window theMovieName
      end repeat
      put "closed" into  ST_ChestValve
      HTLock true
      HTChangePict field "pict name","srccopy"
      HTLock forcefalse
      hide window theMovieName
      end if
      end mouseDown
  * Card 25223 "" (4 parts)
    * Part 25223:1 ""
      on mouseUp
      go to card id 25863
      end mouseUp
    * Part 25223:2 ""
      on mouseUp
      go to card id 24357
      end mouseUp
    * Part 25223:3 ""
      on mouseUp
      go to card id 24357
      end mouseUp
    * Part 25223:4 "qLigU"
      on mouseUp
      go to card id 25863
      end mouseUp
  * Card 25863 "" (3 parts)
    * Part 25863:1 ""
      on mouseUp
      go to card id 26476
      end mouseUp
    * Part 25863:2 "right"
      on mouseUp
      go to card id 24202
      end mouseUp
    * Part 25863:3 "qligU"
      on mouseUp
      go to card id 26476
      end mouseUp
  * Card 26476 "" (3 parts)
    * Part 26476:1 ""
      on mouseUp
      go to card id 26625
      end mouseUp
    * Part 26476:2 "left"
      on mouseUp
      go to card id 23638
      end mouseUp
    * Part 26476:3 "right"
      on mouseUp
      go to card id 23638
      end mouseUp
  * Card 26625 "qLigU" (3 parts)

    on opencard
    soundstop
    pass opencard
    end opencard

    * Part 26625:1 "left"
      on mouseUp
      go to card id 13528
      end mouseUp
    * Part 26625:2 ""
      on mouseUp
      go to card id 14325
      end mouseUp
    * Part 26625:3 "right"
      on mouseUp
      go to card id 21557
      end mouseUp
  * Card 14325 "" (4 parts)
    * Part 14325:1 "right"
      on mouseUp
      go to card id 13528
      end mouseUp
    * Part 14325:2 "left"
      on mouseUp
      go to card id 13528
      end mouseUp
    * Part 14325:3 ""
      on mouseUp
      global ST_Key
      if ST_Key = "true" then
      put "floor" into ST_Key
      --HyperCursor "hand",1
      end if
      go to card id 6623
      playQT "AR Water/wind Mov", fadeboth, loop, 175
      end mouseUp
    * Part 14325:4 "right"
      on mouseUp
      global ST_pump
      if ST_pump is 3 then go to card id 21557
      else go to card id 13528
      end mouseUp
  * Card 6623 "" (4 parts)
    * Part 6623:1 "right"
      on mouseUp
      go to card id 5866
      end mouseUp
    * Part 6623:2 "left"
      on mouseUp
      go to card id 5866
      end mouseUp
    * Part 6623:3 ""
      on mouseUp
      go to card id 6838
      end mouseUp
    * Part 6623:4 "qste3"
      on mouseUp
      go to card id 6838
      end mouseUp
  * Card 6838 "" (5 parts)
    * Part 6838:1 "right"
      on mouseUp
      go to card id 5411
      end mouseUp
    * Part 6838:2 "left"
      on mouseUp
      go to card id 5411
      end mouseUp
    * Part 6838:3 ""
      on mouseUp
      go to card id 7102
      end mouseUp
    * Part 6838:4 "qste3"
      on mouseUp
      go to card id 7102
      end mouseUp
    * Part 6838:5 "qste3"
      on mouseUp
      go to card id 7102
      end mouseUp
  * Card 7102 "" (5 parts)
    * Part 7102:1 "right"
      on mouseUp
      go to card id 5269
      end mouseUp
    * Part 7102:2 "left"
      on mouseUp
      go to card id 5269
      end mouseUp
    * Part 7102:3 ""
      on mouseUp
      go to card id 4785
      end mouseUp
    * Part 7102:4 ""
      on mouseUp
      go to card id 3004
      end mouseUp
    * Part 7102:5 ""
      on mouseUp
      go to card id 5066
      end mouseUp
  * Card 6006 "" (1 parts)
    * Part 6006:1 "down"
      on mouseUp
      go to card id 5866
      end mouseUp
  * Card 44679 "" (0 parts)
  * Background 2702 "" (3 parts)
    * Part 2702:6 ""
      on mouseUp
      end mouseUp
    * Part 2702:1 "pict name"
    * Part 2702:7 "globals"
