Stack (376 cards, 1 backgrounds)

  on doValveR which
  global CH_Valve
  put which into CH_Valve
  push card
  go to card id 87249
  end doValveR
  
  on doValveL which
  global CH_Valve
  put which into CH_Valve
  push card
  go to card id 87418
  end doValveL
  
  on doValveI which
  global CH_Valve
  put which into CH_Valve
  push card
  go to card id 86839
  end doValveI
  
  on closeCard
  global startTime
  set cursor to none
  put the ticks into startTime
  HTLock "on"
  end closeCard
  
  on windIdle
  if there is a window "windmooV" then send idle to window "windmoov"
  end windIdle
  
  on openCard
  global pictAdd,startTime,CH_WindMoov,NorthDesk,CH_PipeBridge,HCSounds
  soundIdle
  windIdle
  HTChangePict bg fld "pict name","srccopy"
  get the result
  if it is not empty then
  soundstop
  xmemory(1)
  HTChangePict bg fld "pict name","srccopy"
  end if
  soundIdle
  windIdle
  if pictAdd is not empty then
  set itemdelimiter to "|"
  repeat with x = 1 to the number of lines in pictAdd
  if line x of pictAdd is not empty then
  HTAddPict item 1 of line x of pictAdd,item 2 of line x of pictAdd,"srccopy"
  end if
  soundIdle
  windIdle
  end repeat
  set itemdelimiter to ","
  put empty into pictAdd
  end if
  if NorthDesk is not "true" then
  if there is a window "windmooV" then hide window "windmoov"
  end if
  if CH_WindMoov is not empty then
  if there is a window "windmoov" then
  set the windowRect of window "windmoov" to the rect of card button "moovmarker"
  set the movie of window "windmoov" to CH_WindMoov
  soundIdle
  windIdle
  end if
  end if
  if HCSounds is not empty then
  play stop
  repeat with x = 1 to the number of lines in HCSounds
  do ("Play " & quote & line x of HCSounds & quote)
  end repeat
  put empty into HCSounds
  end if
  HTLock "forceFalse"
  soundIdle
  windIdle
  if CH_WindMoov is not empty then
  if there is a window "windmoov" then show window "windmoov"
  put empty into CH_WindMooV
  end if
  if field "truepath" is not empty then
  if checkpath() then
  if char 8 of field "truepath" is "B" then
  if CH_PipeBridge is "up" then
  if word 2 of field "truepath" is "P" then playqt "L1 Slosh/Run/Motor Mov",,loop,100
  else if word 2 of field "truepath" is "Q" then playqt "L1 Slosh/Run/MotorQ Mov",,loop,100
  else playqt "L1 Slosh/Run Mov",,loop,100
  else
  playqt "L1 slosh Mov",,loop,100
  end if
  else
  if word 2 of field "truepath" is "P" then playqt "L1 Slosh/Run/Motor Mov",,loop,100
  else if word 2 of field "truepath" is "Q" then playqt "L1 Slosh/Run/MotorQ Mov",,loop,100
  else playqt "L1 Slosh/Run Mov",,loop,100
  end if
  else playqt "L1 slosh Mov",,loop,100
  end if
  hide msg
  wait while the mouseclick
  updateCursor ML
  pass openCard
  end openCard
  
  on openStack
  global All_CurrStack,S_SCREENPOS,documents
  -- The documents paths are for MooVs - always on the CD
  put "Myst:Myst Graphics:Channelwood:" into documents
  SetScreen
  set userlevel to 5 -- development only
  BlackFrame
  xMemory(1)
  HTUDefPal 7001
  HyperTint "later","delay","iRes5","NoTEOpt"
  htlock novbl
  htlock nobw
  htlock nocolormap
  start using stack "CHRes1"
  start using stack "CHRes2"
  start using stack "CHRes3"
  DeCurse "install"
  deCurse "override","hand","color","nodelay"
  put "Channelwood Age" into All_CurrStack
  end openStack
  
  on closeStack
  htlock true
  closemoovs
  if there is a window "windmoov" then close window "windmoov"
  if there is a window "monitor" then close window "monitor"
  if there is a window "holo" then close window "holo"
  DeCurse "remove"
  HTRemove
  stop using stack "CHres1"
  stop using stack "CHres2"
  stop using stack "CHres3"
  end closeStack
  
  function checkpath
  global CH_WaterPath
  put "true" into rc
  repeat with x = 1 to 7
  if char x of bg field "truepath" ≠ "-" then
  if char x of bg field "truepath" ≠ char x of CH_WaterPath then
  put "false" into rc
  exit repeat
  end if
  end if
  end repeat
  return rc
  end checkpath
  
  on closemoovs
  repeat with x = (the number of lines in the windows) down to 1
  if line x of the windows contains "moov" then close window (line x of the windows)
  else if line x of the windows contains "mov" then close window (line x of the windows)
  end repeat
  end closemoovs
  
  on windmill
  put "BW 35-N Windmill.MooV" into theMovieName
  if there is not a window TheMovieName then
  Movie TheMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
  end if
  if there is a window TheMovieName then
  set the dontErase of window TheMovieName to true
  set the movieCursorID of window theMovieName to 128
  set the audioLevel of window TheMovieName to "0"
  set the mute of window TheMovieName to true
  set the badge of window TheMovieName to false
  set the controllerVisible of window TheMovieName to false
  set the useCustomClut of window theMovieName to false
  set the closeOnFinish of window TheMovieName to false
  set the loop of window TheMovieName to true
  set the seeAllFrames of window TheMovieName to false
  set the startTime of window TheMovieName to "0"
  --set the endTime of window TheMovieName to "2,240"
  --set the callBackMsg of window theMovieName to "Done"
  set the passMovieClick of window theMovieName to false
  set the rate of window TheMovieName to "1.0"
  set the windowName of window TheMovieName to "windMoov"
  end if
  end windmill
  
  \0e
  set the rate of window TheMovieName to "1.0"
  set the windowName of window TheMovieName to "windMoov"
  end if
  end windmill

  * Card 21064 "" (7 parts)

    on openCard
    global pictAdd,CH_Pump
    global CH_WindMoov
    put "PH 1-N AxleSpin.MooV" into CH_WindMoov
    if CH_Pump is "on" then
    get the rect of card button marker
    put field "pict name" & " PumpSwitchOn|" & it & return into pictAdd
    end if
    htlock true
    pass opencard
    end openCard

    * Part 21064:18 "marker"
    * Part 21064:12 "up"
      on mouseUp
      go to card id 2952
      end mouseUp
    * Part 21064:13 "right"
      on mouseUp
      go to card id 4459
      end mouseUp
    * Part 21064:14 "left"
      on mouseUp
      go to card id 4459
      end mouseUp
    * Part 21064:15 ""
      on mouseUp
      go to card id 4696
      end mouseUp
    * Part 21064:17 ""
      on mouseUp
      global CH_waterPath,CH_PipeBridge
      go to card id 6746
      if char 1 of CH_waterPath is 1 then
      playQT "PH Pouring Mov",,loop,250
      else
      playQT "PH Pouring Mov",,loop,150
      end if
      end mouseUp
    * Part 21064:19 "moovmarker"
  * Card 2952 "" (3 parts)

    on Opencard
    global CH_WindMoov,moov
    put false into moov
    water
    put "PH 1-N (lookup) AxleSpin.MooV" into CH_WindMoov
    pass opencard
    end opencard
    
    on closecard
    htlock true
    put "PH 1-N Lookup Water.Moov" into theMovieName
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closecard
    end closecard
    
    on idle
    global moov
    put "PH 1-N Lookup Water.Moov" into theMovieName
    if moov is "false" then
    put "true" into moov
    if there is a window TheMovieName then
    set the rate of window TheMovieName to "1.0"
    show window theMovieName
    end if
    end if
    if there is a window TheMovieName then
    send movieidle to window theMovieName
    end if
    pass idle
    end idle
    
    on water
    put "PH 1-N Lookup Water.Moov" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button mooVMarker2,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    end if
    end water

    * Part 2952:1 "down"
      on mouseUp
      go to card id 21064
      end mouseUp
    * Part 2952:2 "moovmarker"
    * Part 2952:3 "moovmarker2"
  * Card 4459 "" (5 parts)
    * Part 4459:1 "left"
      on mouseUp
      go to card id 21064
      end mouseUp
    * Part 4459:2 "right"
      on mouseUp
      go to card id 21064
      end mouseUp
    * Part 4459:3 ""
      on mouseUp
      playQT "PH Pouring Mov",,loop,100
      go to card id 6971
      end mouseUp
    * Part 4459:4 ""
      on mouseUp
      playQT "PH Pouring Mov",,loop,100
      go to card id 6971
      end mouseUp
    * Part 4459:5 "qphp1"
      on mouseUp
      playQT "PH Pouring Mov",,loop,100
      go to card id 6971
      end mouseUp
  * Card 4696 "" (5 parts)

    on Opencard
    global CH_WindMoov
    put "PH 2-N AxleSpin.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 4696:2 ""
      on mouseUp
      go to card id 5138
      end mouseUp
    * Part 4696:6 ""
    * Part 4696:1 "right"
      on mouseUp
      go to card id 5088
      end mouseUp
    * Part 4696:4 "moovmarker"
    * Part 4696:5 "handle"
      on mouseStillDown
      soundIdle
      end mouseStillDown
      
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_waterPath
      deCurse "override",2004,"color","nodelay"
      put "windmoov" into theMovieName
      put 224 into theStart
      put "Pumphouse 2-N Switch" into thePict
      put the rect of card button handle into theLoc
      put "0,0,23,53" into theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button handle then exit repeat
      get (the mouseV - theStart) div 4
      if it < 0 then get 0
      if it ≥ 9 then
      playQT "EV Drip.MoV",,loop,150
      get 9
      else
      playqt "PH Pouring Mov",,loop,250
      end if
      put it * 23 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      set rate of window theMovieName to 1 - (it / 9)
      send movieIdle to window theMovieName
      end repeat
      playqt "PH Pouring Mov",,loop,200
      put "0,0,25,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      set rate of window theMovieName to "1"
      deCurse "override",2003,"color","nodelay"
      end mouseDown
  * Card 5088 "" (3 parts)

    on openCard
    global pictAdd,CH_pump
    if Ch_pump is "on" then
    get the rect of card button marker
    put field "pict name" & " correction|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 5088:1 "left"
      on mouseUp
      go to card id 4696
      end mouseUp
    * Part 5088:2 ""
      on mouseUp
      go to card id 4459
      end mouseUp
    * Part 5088:4 ""
      on mouseUp
      go to card id 6746
      end mouseUp
  * Card 5138 "" (3 parts)
    * Part 5138:1 ""
      on mouseUp
      playQT "PH Pouring Mov",,loop,150
      go to card id 5381
      end mouseUp
    * Part 5138:2 "left"
      on mouseUp
      go to card id 83657
      end mouseUp
    * Part 5138:3 "right"
      on mouseUp
      go to card id 83657
      end mouseUp
  * Card 5381 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "PH 4-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 5381:4 "moovmarker"
    * Part 5381:1 "right"
      on mouseUp
      go to card id 5784
      end mouseUp
    * Part 5381:2 "left"
      on mouseUp
      go to card id 5784
      end mouseUp
    * Part 5381:3 ""
      on mouseUp
      playQT "PH Pouring Mov",,loop,90
      go to card id 6397
      end mouseUp
  * Card 5784 "" (3 parts)
    * Part 5784:1 "right"
      on mouseUp
      go to card id 5381
      end mouseUp
    * Part 5784:2 "left"
      on mouseUp
      go to card id 5381
      end mouseUp
    * Part 5784:3 ""
      on mouseUp
      playQT "PH Pouring Mov",,loop,200
      go to card id 83657
      end mouseUp
  * Card 83657 "" (3 parts)
    * Part 83657:1 "left"
      on mouseUp
      go to card id 5138
      end mouseUp
    * Part 83657:2 "right"
      on mouseUp
      go to card id 5138
      end mouseUp
    * Part 83657:3 ""
      on mouseUp
      go to card id 5088
      end mouseUp
  * Card 6020 "" (1 parts)
    * Part 6020:1 "up"
      on mouseUp
      go to card id 6397
      end mouseUp
  * Card 6397 "" (4 parts)

    on openCard
    global MY_RedBook,MY_BlueBook,ALL_Page,moov
    global CH_WindMoov
    put "PH 5-N (lookup).MooV" into CH_WindMoov
    put false into moov
    pass openCard
    end openCard

    * Part 6397:1 "down"
      on mouseUp
      go to card id 6020
      end mouseUp
    * Part 6397:2 "right"
      on mouseUp
      go to card id 6577
      end mouseUp
    * Part 6397:3 "left"
      on mouseUp
      go to card id 6577
      end mouseUp
    * Part 6397:9 "moovmarker"
  * Card 6577 "" (3 parts)
    * Part 6577:1 "right"
      on mouseUp
      go to card id 6397
      end mouseUp
    * Part 6577:2 "left"
      on mouseUp
      go to card id 6397
      end mouseUp
    * Part 6577:3 ""
      on mouseUp
      playQT "PH Pouring Mov",,loop,150
      
      go to card id 5784
      end mouseUp
  * Card 6746 "" (2 parts)
    * Part 6746:1 ""
      on mouseUp
      go to card id 21064
      end mouseUp
    * Part 6746:2 "handle"
      on mouseDown
      global CH_waterPath,CH_PipeBridge
      put "PumpHouse FaucetMove" into thePict
      put the rect of card button handle into theLoc
      put "0,0,74,53" into theClip
      play stop
      play "SQ Small Wood Valve" c c c c c c c
      if char 1 of CH_waterPath is 1 then
      repeat with x = 1 to 14
      soundidle
      get x mod 7
      put it * 74 into item 1 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      put 0 into char 1 of CH_waterPath
      playQT "PH Pouring Mov",,loop,150
      else
      repeat with x = 14 down to 1
      soundidle
      get x mod 7
      put it * 74 into item 1 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      put 1 into char 1 of CH_waterPath
      playQT "PH Pouring Mov",,loop,250
      end if
      put "0,0,74,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      play stop
      ww
      end mouseDown
  * Card 6971 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (elev1up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 6971:4 "marker"
    * Part 6971:1 "right"
      on mouseUp
      go to card id 10780
      end mouseUp
    * Part 6971:2 "left"
      on mouseUp
      go to card id 10780
      end mouseUp
    * Part 6971:3 ""
      on mouseUp
      go to card id 7283
      end mouseUp
    * Part 6971:6 "qphp1"
      on mouseUp
      go to card id 7283
      end mouseUp
  * Card 7283 "" (4 parts)
    * Part 7283:1 "right"
      on mouseUp
      go to card id 10669
      end mouseUp
    * Part 7283:2 "left"
      on mouseUp
      go to card id 10669
      end mouseUp
    * Part 7283:3 ""
      on mouseUp
      go to card id 7663
      end mouseUp
    * Part 7283:5 "qphp1"
      on mouseUp
      go to card id 7663
      end mouseUp
  * Card 7663 "" (3 parts)

    --on opencard
    if checkpath() is "true" then playqt "PH Pouring Mov",,loop,25
    else playqt "L1 slosh Mov",,loop,25
    pass opencard
    end opencard

    * Part 7663:1 "left"
      on mouseUp
      go to card id 10298
      end mouseUp
    * Part 7663:2 ""
      on mouseUp
      go to card id 7761
      end mouseUp
    * Part 7663:4 "qphp1"
      on mouseUp
      go to card id 7761
      end mouseUp
  * Card 7761 "" (4 parts)
    * Part 7761:1 "right"
      on mouseUp
      go to card id 10036
      end mouseUp
    * Part 7761:2 "left"
      on mouseUp
      go to card id 10036
      end mouseUp
    * Part 7761:3 ""
      on mouseUp
      go to card id 8059
      end mouseUp
    * Part 7761:4 "qphp1"
      on mouseUp
      go to card id 8059
      end mouseUp
  * Card 8059 "" (4 parts)
    * Part 8059:1 "right"
      on mouseUp
      go to card id 9781
      end mouseUp
    * Part 8059:2 "left"
      on mouseUp
      go to card id 9781
      end mouseUp
    * Part 8059:3 ""
      on mouseUp
      go to card id 8323
      end mouseUp
    * Part 8059:4 "qphp1"
      on mouseUp
      go to card id 8323
      end mouseUp
  * Card 8323 "" (4 parts)
    * Part 8323:1 "right"
      on mouseUp
      go to card id 9721
      end mouseUp
    * Part 8323:2 "left"
      on mouseUp
      go to card id 9721
      end mouseUp
    * Part 8323:3 ""
      on mouseUp
      go to card id 8635
      end mouseUp
    * Part 8323:4 "qphp1"
      on mouseUp
      go to card id 8635
      end mouseUp
  * Card 8635 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (elev1up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 8635:4 "marker"
    * Part 8635:1 "right"
      on mouseUp
      go to card id 9420
      end mouseUp
    * Part 8635:2 "left"
      on mouseUp
      go to card id 9420
      end mouseUp
    * Part 8635:3 ""
      on mouseUp
      go to card id 8881
      end mouseUp
  * Card 8881 "qphp1" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (elev1up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 8881:4 "marker"
    * Part 8881:1 "right"
      on mouseUp
      go to card id 9075
      end mouseUp
    * Part 8881:2 ""
      on mouseUp
      go to card id 11029
      end mouseUp
    * Part 8881:3 "left"
      on mouseUp
      go to card id 9075
      end mouseUp
    * Part 8881:5 "qsi2"
      on mouseUp
      go to card id 11029
      end mouseUp
  * Card 9075 "" (4 parts)
    * Part 9075:1 "right"
      on mouseUp
      go to card id 8881
      end mouseUp
    * Part 9075:2 "left"
      on mouseUp
      go to card id 8881
      end mouseUp
    * Part 9075:3 ""
      on mouseUp
      go to card id 9420
      end mouseUp
    * Part 9075:4 "qphp2"
      on mouseUp
      go to card id 9420
      end mouseUp
  * Card 9420 "" (4 parts)
    * Part 9420:1 "left"
      on mouseUp
      go to card id 8635
      end mouseUp
    * Part 9420:2 "right"
      on mouseUp
      go to card id 8635
      end mouseUp
    * Part 9420:3 ""
      on mouseUp
      go to card id 9721
      end mouseUp
    * Part 9420:4 "qphp2"
      on mouseUp
      go to card id 9721
      end mouseUp
  * Card 9721 "" (4 parts)
    * Part 9721:1 "right"
      on mouseUp
      go to card id 8323
      end mouseUp
    * Part 9721:2 "left"
      on mouseUp
      go to card id 8323
      end mouseUp
    * Part 9721:3 ""
      on mouseUp
      go to card id 9781
      end mouseUp
    * Part 9721:4 "qphp2"
      on mouseUp
      go to card id 9781
      end mouseUp
  * Card 9781 "" (4 parts)
    * Part 9781:1 "right"
      on mouseUp
      go to card id 8059
      end mouseUp
    * Part 9781:2 "left"
      on mouseUp
      go to card id 8059
      end mouseUp
    * Part 9781:3 ""
      on mouseUp
      go to card id 10036
      end mouseUp
    * Part 9781:4 "qphp2"
      on mouseUp
      go to card id 10036
      end mouseUp
  * Card 10036 "" (4 parts)
    * Part 10036:1 "left"
      on mouseUp
      go to card id 7761
      end mouseUp
    * Part 10036:2 "right"
      on mouseUp
      go to card id 7761
      end mouseUp
    * Part 10036:3 ""
      on mouseUp
      go to card id 10298
      end mouseUp
    * Part 10036:4 "qphp2"
      on mouseUp
      go to card id 10298
      end mouseUp
  * Card 10298 "" (3 parts)
    * Part 10298:1 "right"
      on mouseUp
      go to card id 7663
      end mouseUp
    * Part 10298:2 ""
      on mouseUp
      go to card id 10669
      end mouseUp
    * Part 10298:3 "qphp2"
      on mouseUp
      go to card id 10669
      end mouseUp
  * Card 10669 "" (3 parts)
    * Part 10669:1 "right"
      on mouseUp
      go to card id 7283
      end mouseUp
    * Part 10669:2 "left"
      on mouseUp
      go to card id 7283
      end mouseUp
    * Part 10669:3 ""
      on mouseUp
      playQT "PH Pouring Mov",fadeboth,loop,100
      go to card id 10780
      end mouseUp
  * Card 10780 "qphp2" (3 parts)

    on opencard
    global quick
    if quick is true then
    playqt "PH Pouring Mov","fadeboth","loop","100"
    end if
    pass opencard
    end opencard

    * Part 10780:1 ""
      on mouseUp
      playqt "PH Pouring Mov",,loop,200
      go to card id 21064
      end mouseUp
    * Part 10780:2 "right"
      on mouseUp
      go to card id 6971
      end mouseUp
    * Part 10780:3 "left"
      on mouseUp
      go to card id 6971
      end mouseUp
  * Card 11029 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_UpperStairs
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 11029:4 "marker"
    * Part 11029:1 "right"
      on mouseUp
      go to card id 11327
      end mouseUp
    * Part 11029:2 "left"
      on mouseUp
      go to card id 11327
      end mouseUp
    * Part 11029:3 ""
      on mouseUp
      go to card id 11657
      end mouseUp
    * Part 11029:5 "qsi2"
      on mouseUp
      go to card id 11657
      end mouseUp
  * Card 11327 "" (4 parts)
    * Part 11327:1 "left"
      on mouseUp
      go to card id 11029
      end mouseUp
    * Part 11327:2 "right"
      on mouseUp
      go to card id 11029
      end mouseUp
    * Part 11327:3 ""
      on mouseUp
      go to card id 9075
      end mouseUp
    * Part 11327:4 "qphp2"
      on mouseUp
      go to card id 9075
      end mouseUp
  * Card 11657 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 11657:4 "marker"
    * Part 11657:1 "right"
      on mouseUp
      go to card id 11997
      end mouseUp
    * Part 11657:2 "left"
      on mouseUp
      go to card id 11997
      end mouseUp
    * Part 11657:3 ""
      on mouseUp
      go to card id 12062
      end mouseUp
    * Part 11657:5 "qsi2"
      on mouseUp
      go to card id 12062
      end mouseUp
  * Card 11997 "" (4 parts)
    * Part 11997:1 "right"
      on mouseUp
      go to card id 11657
      end mouseUp
    * Part 11997:2 "left"
      on mouseUp
      go to card id 11657
      end mouseUp
    * Part 11997:3 ""
      on mouseUp
      go to card id 11327
      end mouseUp
    * Part 11997:4 "qphp2"
      on mouseUp
      go to card id 11327
      end mouseUp
  * Card 12062 "" (4 parts)
    * Part 12062:1 "right"
      on mouseUp
      go to card id 12417
      end mouseUp
    * Part 12062:2 "left"
      on mouseUp
      go to card id 12417
      end mouseUp
    * Part 12062:3 ""
      on mouseUp
      go to card id 12547
      end mouseUp
    * Part 12062:4 "qsi2"
      on mouseUp
      go to card id 12547
      end mouseUp
  * Card 12417 "" (4 parts)
    * Part 12417:1 "right"
      on mouseUp
      go to card id 12062
      end mouseUp
    * Part 12417:2 "left"
      on mouseUp
      go to card id 12062
      end mouseUp
    * Part 12417:3 ""
      on mouseUp
      go to card id 11997
      end mouseUp
    * Part 12417:4 "qphp2"
      on mouseUp
      go to card id 11997
      end mouseUp
  * Card 12547 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 12547:4 "marker"
    * Part 12547:1 "right"
      on mouseUp
      go to card id 13049
      end mouseUp
    * Part 12547:2 "left"
      on mouseUp
      go to card id 13049
      end mouseUp
    * Part 12547:3 ""
      on mouseUp
      go to card id 13268
      end mouseUp
    * Part 12547:5 "qsi2"
      on mouseUp
      go to card id 13268
      end mouseUp
  * Card 13049 "" (4 parts)
    * Part 13049:1 "left"
      on mouseUp
      go to card id 12547
      end mouseUp
    * Part 13049:2 "right"
      on mouseUp
      go to card id 12547
      end mouseUp
    * Part 13049:3 ""
      on mouseUp
      go to card id 12417
      end mouseUp
    * Part 13049:4 "qphp2"
      on mouseUp
      go to card id 12417
      end mouseUp
  * Card 13268 "" (6 parts)

    on openCard
    global pictAdd,CH_LowerStairs,CH_Elevator1
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (DoorOpen)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (elev1up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 13268:5 "marker2"
    * Part 13268:4 "marker"
    * Part 13268:1 "right"
      on mouseUp
      go to card id 13553
      end mouseUp
    * Part 13268:2 "left"
      on mouseUp
      go to card id 13553
      end mouseUp
    * Part 13268:3 ""
      on mouseUp
      go to card id 13703
      end mouseUp
    * Part 13268:6 "qls"
      on mouseUp
      go to card id 13703
      end mouseUp
  * Card 13553 "" (5 parts)
    * Part 13553:1 "left"
      on mouseUp
      go to card id 13268
      end mouseUp
    * Part 13553:2 "right"
      on mouseUp
      go to card id 13268
      end mouseUp
    * Part 13553:3 ""
      on mouseUp
      go to card id 13049
      end mouseUp
    * Part 13553:4 "qphp2 left"
      on mouseUp
      go to card id 13268
      end mouseUp
    * Part 13553:5 "qphp2"
      on mouseUp
      go card
      end mouseUp
  * Card 13703 "qsi2" (11 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_LowerStairs,CH_Elevator1
    if char 2 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwRight)|" & it & return into pictAdd
    end if
    if CH_LowerStairs is "open" then
    get the rect of card button marker2
    put field "pict name" & " (DoorOpen)|" & it & return after pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker3
    put field "pict name" & " (elev1up)|" & it & return after pictAdd
    end if
    if there is not a window "windMoov" then windmill
    pass openCard
    end openCard

    * Part 13703:12 "moovMarker"
    * Part 13703:10 "marker3"
    * Part 13703:7 "marker"
    * Part 13703:6 "marker2"
    * Part 13703:1 "right"
      on mouseUp
      go to card id 13949
      end mouseUp
    * Part 13703:2 "left"
      on mouseUp
      go to card id 13949
      end mouseUp
    * Part 13703:3 ""
      on mouseUp
      go to card id 14175
      end mouseUp
    * Part 13703:4 ""
      on mouseUp
      go to card id 17626
      end mouseUp
    * Part 13703:8 ""
      on mouseUp
      doValveI 2
      end mouseUp
    * Part 13703:9 ""
    * Part 13703:11 "qls"
      on mouseUp
      go to card id 14175
      end mouseUp
  * Card 86839 "" (2 parts)

    on openCard
    HTChangePict bg fld "pict name","srccopy"
    setValve
    HTLock "forceFalse"
    end openCard
    
    on setValve
    global CH_Valve,CH_WaterPath
    put "Switch-In.PICS" into thePict
    put the rect of card button handle into theLoc
    put "0,0,94,83" into theClip
    if char CH_Valve of CH_WaterPath is 0 then
    put 11 * 94 into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    else
    put "0,0,94,83" into theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    end setValve

    * Part 86839:1 ""
      on mouseUp
      vd
      pop card
      end mouseUp
    * Part 86839:4 "handle"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Valve,CH_WaterPath
      deCurse "override",2004,"color","nodelay"
      put 250 into theStart
      put "Switch-In.PICS" into thePict
      put the rect of card button handle into theLoc
      put "0,0,94,83" into theClip
      play "SQ small wood valve"
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button handle then exit repeat
      get (the mouseH - theStart) div 4
      if it < 1 then get 1
      if it > 10 then get 10
      put it * 94 into item 1 of theClip
      put it * 94 + 94 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      play "LV Gate Valve II"
      deCurse "override",2003,"color","nodelay"
      if it > 5 then put 0 into char CH_Valve of CH_WaterPath
      else put 1 into char CH_Valve of CH_WaterPath
      setValve
      end mouseDown
  * Card 13949 "" (4 parts)
    * Part 13949:1 "left"
      on mouseUp
      go to card id 13703
      end mouseUp
    * Part 13949:2 "right"
      on mouseUp
      go to card id 13703
      end mouseUp
    * Part 13949:3 ""
      on mouseUp
      go to card id 13553
      end mouseUp
    * Part 13949:5 "qphp2"
      on mouseUp
      go to card id 13553
      end mouseUp
  * Card 14175 "" (5 parts)

    on openCard
    global pictAdd,CH_LowerStairs
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (DoorOpen)|" & it after pictAdd
    end if
    pass openCard
    end openCard

    * Part 14175:4 "marker"
    * Part 14175:1 "right"
      on mouseUp
      go to card id 14360
      end mouseUp
    * Part 14175:2 "left"
      on mouseUp
      go to card id 17626
      end mouseUp
    * Part 14175:3 ""
      on mouseUp
      go to card id 14602
      end mouseUp
    * Part 14175:5 "qls"
      on mouseUp
      go to card id 14602
      end mouseUp
  * Card 14360 "qsr2" (6 parts)

    on openCard
    global pictAdd,CH_WaterPath
    if char 2 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 14360:1 "left"
      on mouseUp
      go to card id 14175
      end mouseUp
    * Part 14360:2 "right"
      on mouseUp
      go to card id 17626
      end mouseUp
    * Part 14360:3 ""
      on mouseUp
      go to card id 13949
      end mouseUp
    * Part 14360:4 "right"
      on mouseUp
      go to card id 17626
      end mouseUp
    * Part 14360:5 "marker"
    * Part 14360:6 ""
      on mouseUp
      doValveL 2
      end mouseUp
  * Card 87418 "" (2 parts)

    on openCard
    HTChangePict bg fld "pict name","srccopy"
    setValve
    if there is a window "windMooV" then hide window "windMooV"
    HTLock "forceFalse"
    end openCard
    
    on setValve
    global CH_Valve,CH_WaterPath
    put "Switch-Left.PICS" into thePict
    put the rect of card button handle into theLoc
    put "0,0,86,83" into theClip
    if char CH_Valve of CH_WaterPath is 0 then
    put 11 * 86 into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    else
    put "0,0,86,83" into theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    end setValve

    * Part 87418:1 ""
      on mouseUp
      vd
      pop card
      end mouseUp
    * Part 87418:2 "handle"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Valve,CH_WaterPath
      deCurse "override",2004,"color","nodelay"
      put 234 into theStart
      put "Switch-Left.PICS" into thePict
      put the rect of card button handle into theLoc
      put "0,0,86,83" into theClip
      play "SQ small wood valve"
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button handle then exit repeat
      get 12 - ((the mouseH - theStart) div 4)
      if it < 1 then get 1
      if it > 10 then get 10
      put it * 86 into item 1 of theClip
      put it * 86 + 86 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      play "LV Gate Valve II"
      deCurse "override",2003,"color","nodelay"
      if it > 5 then put 0 into char CH_Valve of CH_WaterPath
      else put 1 into char CH_Valve of CH_WaterPath
      setValve
      end mouseDown
  * Card 14602 "" (5 parts)

    on openCard
    global pictAdd,CH_LowerStairs
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (DoorOpen)|" & it after pictAdd
    end if
    pass openCard
    end openCard

    * Part 14602:4 "marker"
    * Part 14602:1 "right"
      on mouseUp
      go to card id 15024
      end mouseUp
    * Part 14602:2 "left"
      on mouseUp
      go to card id 15024
      end mouseUp
    * Part 14602:3 ""
      on mouseUp
      go to card id 15273
      end mouseUp
    * Part 14602:5 "qls"
      on mouseUp
      go to card id 15273
      end mouseUp
  * Card 15024 "" (3 parts)
    * Part 15024:1 "left"
      on mouseUp
      go to card id 14602
      end mouseUp
    * Part 15024:2 "right"
      on mouseUp
      go to card id 14602
      end mouseUp
    * Part 15024:3 ""
      on mouseUp
      go to card id 14360
      end mouseUp
  * Card 15273 "" (6 parts)

    on openCard
    global pictAdd,CH_LowerStairs,CH_Elevator1
    if CH_LowerStairs is empty then put "closed" into CH_LowerStairs
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (DoorOpen)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 15273:5 "marker2"
    * Part 15273:4 "marker"
    * Part 15273:1 "right"
      on mouseUp
      go to card id 15551
      end mouseUp
    * Part 15273:2 "left"
      on mouseUp
      go to card id 15551
      end mouseUp
    * Part 15273:3 ""
      on mouseUp
      go to card id 15662
      end mouseUp
    * Part 15273:6 "qls"
      on mouseUp
      go to card id 15662
      end mouseUp
  * Card 15551 "" (6 parts)

    on Opencard
    global CH_WindMoov
    put "BW 10-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 15551:1 "right"
      on mouseUp
      go to card id 15273
      end mouseUp
    * Part 15551:2 "left"
      on mouseUp
      go to card id 15273
      end mouseUp
    * Part 15551:3 ""
      on mouseUp
      go to card id 15024
      end mouseUp
    * Part 15551:5 "moovmarker"
    * Part 15551:6 "qsr2"
      on mouseUp
      go to card id 15024
      end mouseUp
    * Part 15551:7 "qphp2"
      on mouseUp
      go card
      end mouseUp
  * Card 15662 "" (6 parts)

    on openCard
    global pictAdd,CH_LowerStairs,CH_Elevator1
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (Dooropen)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 15662:5 "marker2"
    * Part 15662:4 "marker"
    * Part 15662:1 "left"
      on mouseUp
      go to card id 15906
      end mouseUp
    * Part 15662:2 "right"
      on mouseUp
      go to card id 15906
      end mouseUp
    * Part 15662:3 ""
      on mouseUp
      go to card id 16172
      end mouseUp
    * Part 15662:6 "qls"
      on mouseUp
      go to card id 16172
      end mouseUp
  * Card 16172 "" (4 parts)

    on openCard
    global pictAdd,CH_LowerStairs
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (Dooropen)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 16172:6 "marker"
    * Part 16172:1 "right"
      on mouseUp
      go to card id 16582
      end mouseUp
    * Part 16172:2 "left"
      on mouseUp
      go to card id 16582
      end mouseUp
    * Part 16172:3 ""
      on mouseUp
      go to card id 16663
      end mouseUp
  * Card 16663 "qls" (3 parts)

    on openCard
    global CH_LowerStairs
    put "Boardwalk 13-W" into field "pict name"
    if CH_LowerStairs is "open" then
    put " DoorOpen" after field "pict name"
    end if
    pass openCard
    end openCard

    * Part 16663:1 "right"
      on mouseUp
      go to card id 17121
      end mouseUp
    * Part 16663:2 "left"
      on mouseUp
      go to card id 17121
      end mouseUp
    * Part 16663:3 "climbstairs"
      on mouseUp
      global CH_LowerStairs
      if CH_LowerStairs is "open" then
      go to card id 17225
      else
      play stop
      play "DR Gate Not Rattle"
      end if
      end mouseUp
  * Card 17121 "" (4 parts)
    * Part 17121:1 "right"
      on mouseUp
      go to card id 16663
      end mouseUp
    * Part 17121:2 "left"
      on mouseUp
      go to card id 16663
      end mouseUp
    * Part 17121:3 ""
      on mouseUp
      go to card id 16582
      end mouseUp
    * Part 17121:4 "qsr2"
      on mouseUp
      go to card id 16582
      end mouseUp
  * Card 16582 "" (4 parts)
    * Part 16582:1 "left"
      on mouseUp
      go to card id 16172
      end mouseUp
    * Part 16582:2 "right"
      on mouseUp
      go to card id 16172
      end mouseUp
    * Part 16582:3 ""
      on mouseUp
      go to card id 15551
      end mouseUp
    * Part 16582:4 "qsr2"
      on mouseUp
      go to card id 15551
      end mouseUp
  * Card 15906 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "BW 11-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 15906:1 "right"
      on mouseUp
      go to card id 15662
      end mouseUp
    * Part 15906:2 "left"
      on mouseUp
      go to card id 15662
      end mouseUp
    * Part 15906:3 ""
      on mouseUp
      go to card id 15551
      end mouseUp
    * Part 15906:4 "moovmarker"
  * Card 17225 "" (4 parts)
    * Part 17225:3 ""
      on mouseUp
      playQT "L2 Wind MoV",,loop,250
      go to card id 73346
      end mouseUp
    * Part 17225:4 "left"
      on mouseUp
      go to card id 73038
      end mouseUp
    * Part 17225:5 "right"
      on mouseUp
      go to card id 73038
      end mouseUp
    * Part 17225:6 "qts"
      on mouseUp
      playQT "L2 Wind MoV",,loop,250
      go to card id 73346
      end mouseUp
  * Card 73346 "" (4 parts)
    * Part 73346:1 "left"
      on mouseUp
      go to card id 73587
      end mouseUp
    * Part 73346:2 "right"
      on mouseUp
      go to card id 73587
      end mouseUp
    * Part 73346:3 ""
      on mouseUp
      go to card id 73852
      end mouseUp
    * Part 73346:4 "qts"
      on mouseUp
      go to card id 73852
      end mouseUp
  * Card 73852 "" (4 parts)
    * Part 73852:1 "left"
      on mouseUp
      go to card id 74168
      end mouseUp
    * Part 73852:2 "right"
      on mouseUp
      go to card id 74168
      end mouseUp
    * Part 73852:3 ""
      on mouseUp
      go to card id 74269
      end mouseUp
    * Part 73852:4 "qts"
      on mouseUp
      go to card id 74269
      end mouseUp
  * Card 74269 "" (4 parts)
    * Part 74269:1 "left"
      on mouseUp
      go to card id 74505
      end mouseUp
    * Part 74269:2 "right"
      on mouseUp
      go to card id 74505
      end mouseUp
    * Part 74269:3 ""
      on mouseUp
      go to card id 74809
      end mouseUp
    * Part 74269:4 "qts"
      on mouseUp
      go to card id 74809
      end mouseUp
  * Card 74809 "" (4 parts)
    * Part 74809:1 "left"
      on mouseUp
      go to card id 75252
      end mouseUp
    * Part 74809:2 "right"
      on mouseUp
      go to card id 75252
      end mouseUp
    * Part 74809:3 ""
      on mouseUp
      go to card id 75275
      end mouseUp
    * Part 74809:4 "qts"
      on mouseUp
      go to card id 75275
      end mouseUp
  * Card 75275 "" (3 parts)
    * Part 75275:1 "left"
      on mouseUp
      go to card id 75674
      end mouseUp
    * Part 75275:2 "right"
      on mouseUp
      go to card id 75674
      end mouseUp
    * Part 75275:3 ""
      on mouseUp
      go to card id 75778
      end mouseUp
  * Card 75778 "qts" (3 parts)

    on opencard
    global CH_UpperStairs
    put "Village Stairs 1-Up" into field "pict name"
    if  CH_UpperStairs is "closed" then
    put " closed" after field "pict name"
    hide card button "enterVillage"
    else
    show card button "enterVillage"
    end if
    playqt "L2 Wind MoV","","loop","250"
    pass opencard
    end opencard

    * Part 75778:1 "left"
      on mouseUp
      go to card id 76263
      end mouseUp
    * Part 75778:2 "right"
      on mouseUp
      go to card id 76263
      end mouseUp
    * Part 75778:3 "entervillage"
      on mouseUp
      go to card id 72768
      end mouseUp
  * Card 76263 "" (5 parts)

    on openCard
    global CH_WindMoov
    put "VS 1-Down Windmill.MooV" into CH_WindMoov
    pass openCard
    end openCard

    * Part 76263:1 "left"
      on mouseUp
      go to card id 75778
      end mouseUp
    * Part 76263:2 "right"
      on mouseUp
      go to card id 75778
      end mouseUp
    * Part 76263:3 ""
      on mouseUp
      go to card id 75674
      end mouseUp
    * Part 76263:5 "moovmarker"
    * Part 76263:6 "qbs"
      on mouseUp
      go to card id 75674
      end mouseUp
  * Card 75674 "" (4 parts)
    * Part 75674:1 "left"
      on mouseUp
      go to card id 75275
      end mouseUp
    * Part 75674:2 "right"
      on mouseUp
      go to card id 75275
      end mouseUp
    * Part 75674:3 ""
      on mouseUp
      go to card id 75252
      end mouseUp
    * Part 75674:4 "qbs"
      on mouseUp
      go to card id 75252
      end mouseUp
  * Card 75252 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (elev1up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 75252:4 "marker"
    * Part 75252:1 "left"
      on mouseUp
      go to card id 74809
      end mouseUp
    * Part 75252:2 "right"
      on mouseUp
      go to card id 74809
      end mouseUp
    * Part 75252:3 ""
      on mouseUp
      go to card id 74505
      end mouseUp
    * Part 75252:5 "qbs"
      on mouseUp
      go to card id 74505
      end mouseUp
  * Card 74505 "" (4 parts)
    * Part 74505:1 "left"
      on mouseUp
      go to card id 74269
      end mouseUp
    * Part 74505:2 "right"
      on mouseUp
      go to card id 74269
      end mouseUp
    * Part 74505:3 ""
      on mouseUp
      go to card id 74168
      end mouseUp
    * Part 74505:4 "qbs"
      on mouseUp
      go to card id 74168
      end mouseUp
  * Card 74168 "" (4 parts)
    * Part 74168:1 "left"
      on mouseUp
      go to card id 73852
      end mouseUp
    * Part 74168:2 "right"
      on mouseUp
      go to card id 73852
      end mouseUp
    * Part 74168:3 ""
      on mouseUp
      go to card id 73587
      end mouseUp
    * Part 74168:4 "qbs"
      on mouseUp
      go to card id 73587
      end mouseUp
  * Card 73587 "" (5 parts)

    on openCard
    global pictAdd,CH_LowerStairs,CH_Elevator1
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put "VillStairs 6-Down (Dooropen)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put "VillStairs 6-Down (Elev1Up)|" & it & return after pictAdd
    end if
    
    pass openCard
    end openCard

    * Part 73587:6 "marker2"
    * Part 73587:5 "marker"
    * Part 73587:1 "left"
      on mouseUp
      go to card id 73346
      end mouseUp
    * Part 73587:3 "right"
      on mouseUp
      go to card id 73346
      end mouseUp
    * Part 73587:4 ""
      on mouseUp
      go to card id 73038
      end mouseUp
  * Card 73038 "qbs" (4 parts)

    on opencard
    global CH_LowerStairs
    put "Village Stairs 7-down" into field "pict name"
    if CH_LowerStairs is "open" then
    put " open" after field "pict name"
    end if
    pass opencard
    end opencard

    * Part 73038:1 "left"
      on mouseUp
      go to card id 17225
      end mouseUp
    * Part 73038:2 "right"
      on mouseUp
      go to card id 17225
      end mouseUp
    * Part 73038:3 "none"
      on mouseUp
      global CH_LowerStairs
      if CH_LowerStairs is "open" then
      vd
      go to card id 17121
      else
      put "open" into CH_LowerStairs
      htlock true
      htvisual "wipe left",,,1,16
      dplay "DR wood open"
      opencard
      play stop
      end if
      end mouseUp
    * Part 73038:4 ""
      on mouseUp
      global CH_LowerStairs
      if CH_LowerStairs is "open" then
      put "closed" into CH_LowerStairs
      htvisual "wipe right",,,1,16
      dplay "DR wood shut"
      opencard
      end if
      end mouseUp
  * Card 17626 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (elev1up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 17626:4 "marker"
    * Part 17626:1 "right"
      on mouseUp
      go to card id 14175
      end mouseUp
    * Part 17626:2 "left"
      on mouseUp
      go to card id 17667
      end mouseUp
    * Part 17626:3 ""
      on mouseUp
      go to card id 17973
      end mouseUp
    * Part 17626:5 "qsi3"
      on mouseUp
      go to card id 17973
      end mouseUp
  * Card 17667 "qsl2" (9 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_LowerStairs
    global CH_WindMoov
    put "BW 8-N Windmill.MooV" into CH_WindMoov
    if char 2 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 17667:8 ""
      on mouseUp
      go to card id 13949
      end mouseUp
    * Part 17667:5 "marker"
    * Part 17667:1 "right"
      on mouseUp
      go to card id 17626
      end mouseUp
    * Part 17667:2 "left"
      on mouseUp
      go to card id 14175
      end mouseUp
    * Part 17667:3 ""
      on mouseUp
      go to card id 13949
      end mouseUp
    * Part 17667:4 "left"
      on mouseUp
      go to card id 14175
      end mouseUp
    * Part 17667:6 "moovmarker"
    * Part 17667:7 ""
      on mouseUp
      doValveR 2
      end mouseUp
    * Part 17667:9 "qphp2"
      on mouseUp
      go to card id 13949
      end mouseUp
  * Card 87249 "" (2 parts)

    on openCard
    HTChangePict bg fld "pict name","srccopy"
    setValve
    if there is a window "windMooV" then hide window "windMooV"
    HTLock "forceFalse"
    end openCard
    
    on setValve
    global CH_Valve,CH_WaterPath
    put "Switch-Right.PICS" into thePict
    put the rect of card button handle into theLoc
    put "0,0,87,83" into theClip
    if char CH_Valve of CH_WaterPath is 0 then
    put 11 * 87 into item 1 of theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    else
    put "0,0,87,83" into theClip
    HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
    end if
    end setValve

    * Part 87249:1 ""
      on mouseUp
      vd
      pop card
      end mouseUp
    * Part 87249:3 "handle"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Valve,CH_WaterPath
      deCurse "override",2004,"color","nodelay"
      put 250 into theStart
      put "Switch-Right.PICS" into thePict
      put the rect of card button handle into theLoc
      put "0,0,87,83" into theClip
      play "SQ small wood valve"
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button handle then exit repeat
      get 12 - ((the mouseH - theStart) div 4)
      if it < 1 then get 1
      if it > 10 then get 10
      put it * 87 into item 1 of theClip
      put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      play "LV Gate Valve II"
      deCurse "override",2003,"color","nodelay"
      if it > 5 then put 0 into char CH_Valve of CH_WaterPath
      else put 1 into char CH_Valve of CH_WaterPath
      setValve
      end mouseDown
  * Card 17973 "" (6 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_PipeBridge
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (elev1up)|" & it & return after pictAdd
    end if
    if CH_PipeBridge is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Pipe)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 17973:5 "marker2"
    * Part 17973:4 "marker"
    * Part 17973:1 "right"
      on mouseUp
      go to card id 18197
      end mouseUp
    * Part 17973:2 "left"
      on mouseUp
      go to card id 18197
      end mouseUp
    * Part 17973:3 ""
      on mouseUp
      go to card id 18638
      end mouseUp
    * Part 17973:6 "qsi3"
      on mouseUp
      go to card id 18638
      end mouseUp
  * Card 18197 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "BW 14-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 18197:1 "left"
      on mouseUp
      go to card id 17973
      end mouseUp
    * Part 18197:2 "right"
      on mouseUp
      go to card id 17973
      end mouseUp
    * Part 18197:3 ""
      on mouseUp
      go to card id 17667
      end mouseUp
    * Part 18197:4 "moovmarker"
  * Card 18638 "" (4 parts)
    * Part 18638:1 "right"
      on mouseUp
      go to card id 18775
      end mouseUp
    * Part 18638:2 "left"
      on mouseUp
      go to card id 18775
      end mouseUp
    * Part 18638:3 ""
      on mouseUp
      go to card id 19143
      end mouseUp
    * Part 18638:4 "qsi4"
      on mouseUp
      go to card id 19143
      end mouseUp
  * Card 18775 "" (4 parts)
    * Part 18775:1 "left"
      on mouseUp
      go to card id 18638
      end mouseUp
    * Part 18775:2 "right"
      on mouseUp
      go to card id 18638
      end mouseUp
    * Part 18775:3 ""
      on mouseUp
      go to card id 18197
      end mouseUp
    * Part 18775:4 "qsl2"
      on mouseUp
      go to card id 18197
      end mouseUp
  * Card 19143 "qsi3" (7 parts)

    on openCard
    global pictAdd,CH_WaterPath
    if CH_WaterPath is empty then put "0000000" into CH_WaterPath
    if char 3 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (Switch)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 19143:1 "right"
      on mouseUp
      go to card id 19212
      end mouseUp
    * Part 19143:3 ""
      on mouseUp
      go to card id 19459
      end mouseUp
    * Part 19143:4 ""
      on mouseUp
      go to card id 32060
      end mouseUp
    * Part 19143:5 "marker"
      on mouseUp
      doValveI 3
      end mouseUp
    * Part 19143:2 "left"
      on mouseUp
      go to card id 19212
      end mouseUp
    * Part 19143:7 "qsi7"
      on mouseUp
      go to card id 32060
      end mouseUp
    * Part 19143:8 "qsi4"
      on mouseUp
      go to card id 19459
      end mouseUp
  * Card 19212 "" (4 parts)
    * Part 19212:1 "right"
      on mouseUp
      go to card id 19143
      end mouseUp
    * Part 19212:2 "left"
      on mouseUp
      go to card id 19143
      end mouseUp
    * Part 19212:3 ""
      on mouseUp
      go to card id 18775
      end mouseUp
    * Part 19212:4 "qsl2"
      on mouseUp
      go to card id 18775
      end mouseUp
  * Card 32060 "" (3 parts)
    * Part 32060:1 "right"
      on mouseUp
      go to card id 19459
      end mouseUp
    * Part 32060:2 "left"
      on mouseUp
      go to card id 32368
      end mouseUp
    * Part 32060:3 ""
      on mouseUp
      go to card id 32743
      end mouseUp
  * Card 32368 "qsl3" (5 parts)

    on openCard
    global pictAdd,CH_WaterPath
    if char 3 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 32368:3 ""
      on mouseUp
      go to card id 19212
      end mouseUp
    * Part 32368:5 "marker"
      on mouseUp
      doValveR 3
      end mouseUp
    * Part 32368:1 "left"
      on mouseUp
      go to card id 19459
      end mouseUp
    * Part 32368:2 "right"
      on mouseUp
      go to card id 32060
      end mouseUp
    * Part 32368:4 "left"
      on mouseUp
      go to card id 19459
      end mouseUp
  * Card 32743 "" (3 parts)
    * Part 32743:1 "right"
      on mouseUp
      go to card id 32972
      end mouseUp
    * Part 32743:2 "left"
      on mouseUp
      go to card id 32972
      end mouseUp
    * Part 32743:3 ""
      on mouseUp
      go to card id 33225
      end mouseUp
  * Card 32972 "" (3 parts)
    * Part 32972:1 "left"
      on mouseUp
      go to card id 32743
      end mouseUp
    * Part 32972:2 "right"
      on mouseUp
      go to card id 32743
      end mouseUp
    * Part 32972:3 ""
      on mouseUp
      go to card id 32368
      end mouseUp
  * Card 33225 "" (4 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 33225:4 "marker"
    * Part 33225:1 "right"
      on mouseUp
      go to card id 33358
      end mouseUp
    * Part 33225:2 "left"
      on mouseUp
      go to card id 33358
      end mouseUp
    * Part 33225:3 ""
      on mouseUp
      go to card id 33578
      end mouseUp
  * Card 33358 "" (5 parts)

    on Opencard
    global CH_WindMoov
    put "BW 45-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 33358:1 "left"
      on mouseUp
      go to card id 33225
      end mouseUp
    * Part 33358:2 "right"
      on mouseUp
      go to card id 33225
      end mouseUp
    * Part 33358:3 ""
      on mouseUp
      go to card id 32972
      end mouseUp
    * Part 33358:4 "moovmarker"
    * Part 33358:5 "qsl3"
      on mouseUp
      go to card id 32972
      end mouseUp
  * Card 33578 "qsi7" (7 parts)

    on openCard
    global pictAdd,CH_Bridge,CH_WaterPath
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    if char 7 of CH_WaterPath is "1" then
    get the rect of card button marker2
    put field "pict name" & " (SwRight)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 33578:5 "marker"
    * Part 33578:1 "right"
      on mouseUp
      go to card id 33832
      end mouseUp
    * Part 33578:2 "left"
      on mouseUp
      go to card id 33832
      end mouseUp
    * Part 33578:3 ""
      on mouseUp
      go to card id 34259
      end mouseUp
    * Part 33578:4 ""
      on mouseUp
      go to card id 35112
      end mouseUp
    * Part 33578:6 "marker2"
      on mouseUp
      doValveI 7
      end mouseUp
    * Part 33578:7 "qbr1"
      on mouseUp
      go to card id 35112
      end mouseUp
  * Card 33832 "" (5 parts)
    * Part 33832:1 "left"
      on mouseUp
      go to card id 33578
      end mouseUp
    * Part 33832:2 "right"
      on mouseUp
      go to card id 33578
      end mouseUp
    * Part 33832:3 ""
      on mouseUp
      go to card id 33358
      end mouseUp
    * Part 33832:4 ""
      on mouseUp
      go to card id 33358
      end mouseUp
    * Part 33832:5 "qsl3"
      on mouseUp
      go to card id 33358
      end mouseUp
  * Card 35112 "" (5 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 35112:4 "marker"
    * Part 35112:1 "right"
      on mouseUp
      go to card id 35578
      end mouseUp
    * Part 35112:2 "left"
      on mouseUp
      go to card id 34259
      end mouseUp
    * Part 35112:3 ""
      on mouseUp
      go to card id 35651
      end mouseUp
    * Part 35112:5 "qbr1"
      on mouseUp
      go to card id 35651
      end mouseUp
  * Card 35578 "qsr7" (6 parts)

    on openCard
    global pictAdd,CH_WaterPath,moov
    global CH_WindMoov
    put "BW 47-N Windmill.MooV" into CH_WindMoov
    if char 7 of CH_WaterPath is "1" then
    get the rect of card button marker
    put field "pict name" & " (SwRight)|" & it & return into pictAdd
    end if
    put false into Moov
    pass openCard
    end openCard

    * Part 35578:1 "left"
      on mouseUp
      go to card id 35112
      end mouseUp
    * Part 35578:2 "right"
      on mouseUp
      go to card id 34259
      end mouseUp
    * Part 35578:3 ""
      on mouseUp
      go to card id 33832
      end mouseUp
    * Part 35578:4 "right"
      on mouseUp
      go to card id 34259
      end mouseUp
    * Part 35578:5 "marker"
      on mouseUp
      doValveL 7
      end mouseUp
    * Part 35578:6 "moovmarker"
  * Card 35651 "" (6 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 35651:5 "marker"
    * Part 35651:1 "right"
      on mouseUp
      go to card id 29713
      end mouseUp
    * Part 35651:2 "left"
      on mouseUp
      go to card id 35914
      end mouseUp
    * Part 35651:3 ""
      on mouseUp
      go to card id 30164
      end mouseUp
    * Part 35651:4 "right"
      on mouseUp
      go to card id 29713
      end mouseUp
    * Part 35651:6 "qbr1"
      on mouseUp
      go to card id 30164
      end mouseUp
  * Card 35914 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "BW 38-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 35914:1 "left"
      on mouseUp
      go to card id 29713
      end mouseUp
    * Part 35914:2 "right"
      on mouseUp
      go to card id 35651
      end mouseUp
    * Part 35914:3 ""
      on mouseUp
      go to card id 35578
      end mouseUp
    * Part 35914:4 "moovmarker"
  * Card 34259 "" (3 parts)
    * Part 34259:1 "right"
      on mouseUp
      go to card id 35112
      end mouseUp
    * Part 34259:2 "left"
      on mouseUp
      go to card id 34505
      end mouseUp
    * Part 34259:3 ""
      on mouseUp
      go to card id 34773
      end mouseUp
  * Card 34505 "" (7 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_elevator1
    if char 7 of CH_WaterPath is "1" then
    get the rect of card button marker
    put field "pict name" & " (SwRight)|" & it & return into pictAdd
    end if
    if CH_elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 34505:6 "marker2"
    * Part 34505:3 ""
      on mouseUp
      go to card id 33832
      end mouseUp
    * Part 34505:5 "marker"
      on mouseUp
      doValveR 7
      end mouseUp
    * Part 34505:1 "left"
      on mouseUp
      go to card id 35112
      end mouseUp
    * Part 34505:2 "right"
      on mouseUp
      go to card id 34259
      end mouseUp
    * Part 34505:4 "left"
      on mouseUp
      go to card id 35112
      end mouseUp
    * Part 34505:7 "qsl3"
      on mouseUp
      go to card id 33832
      end mouseUp
  * Card 34773 "" (2 parts)
    * Part 34773:1 "right"
      on mouseUp
      go to card id 35057
      end mouseUp
    * Part 34773:2 "left"
      on mouseUp
      go to card id 35057
      end mouseUp
  * Card 35057 "" (4 parts)

    on openCard
    global pictAdd,CH_elevator1
    if CH_elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 35057:4 "marker"
    * Part 35057:1 "left"
      on mouseUp
      go to card id 34773
      end mouseUp
    * Part 35057:2 "right"
      on mouseUp
      go to card id 34773
      end mouseUp
    * Part 35057:3 ""
      on mouseUp
      go to card id 34505
      end mouseUp
  * Card 19459 "" (5 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is empty then put "down" into CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 19459:4 "marker"
    * Part 19459:1 "right"
      on mouseUp
      go to card id 19870
      end mouseUp
    * Part 19459:2 "left"
      on mouseUp
      go to card id 32060
      end mouseUp
    * Part 19459:3 ""
      on mouseUp
      go to card id 20137
      end mouseUp
    * Part 19459:5 "qsi5"
  * Card 19870 "qsr3" (7 parts)

    on openCard
    global pictAdd,CH_WaterPath,moov
    global CH_WindMoov
    put "BW 17-N Windmill.MooV" into CH_WindMoov
    if char 3 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it into pictAdd
    end if
    put false into Moov
    pass openCard
    end openCard

    * Part 19870:1 "left"
      on mouseUp
      go to card id 19459
      end mouseUp
    * Part 19870:2 "right"
      on mouseUp
      go to card id 32060
      end mouseUp
    * Part 19870:3 ""
      on mouseUp
      go to card id 19212
      end mouseUp
    * Part 19870:4 "right"
      on mouseUp
      go to card id 32060
      end mouseUp
    * Part 19870:5 "marker"
      on mouseUp
      doValveL 3
      end mouseUp
    * Part 19870:6 "moovmarker"
    * Part 19870:7 "qsl2"
      on mouseUp
      go to card id 19212
      end mouseUp
  * Card 20137 "qsi4" (10 parts)

    on openCard
    global pictAdd,CH_PipeBridge,CH_Bridge,CH_WaterPath
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    if CH_Bridge is "up" then
    get the rect of card button marker2
    put fld "pict name" & " (BridgeUp)|" & it & return after pictAdd
    end if
    if char 4 of CH_WaterPath is "0" then
    get the rect of card button marker3
    put field "pict name" & " (SwLeft)|" & it after pictAdd
    end if
    pass openCard
    end openCard

    * Part 20137:7 "marker2"
    * Part 20137:3 ""
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 20137:6 "marker"
    * Part 20137:1 "right"
      on mouseUp
      go to card id 20241
      end mouseUp
    * Part 20137:2 "left"
      on mouseUp
      go to card id 20241
      end mouseUp
    * Part 20137:5 ""
      on mouseUp
      go to card id 20680
      end mouseUp
    * Part 20137:9 "qsi5"
      on mouseUp
      go to card id 20680
      end mouseUp
    * Part 20137:10 ""
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 20137:11 "qsi6"
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 20137:8 "marker3"
      on mouseUp
      doValveI 4
      end mouseUp
  * Card 20241 "" (5 parts)

    on Opencard
    global CH_WindMoov
    put "BW 19-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 20241:2 "right"
      on mouseUp
      go to card id 20137
      end mouseUp
    * Part 20241:3 "left"
      on mouseUp
      go to card id 20137
      end mouseUp
    * Part 20241:4 ""
      on mouseUp
      go to card id 19870
      end mouseUp
    * Part 20241:5 "moovmarker"
    * Part 20241:6 "qsl2"
      on mouseUp
      go to card id 19870
      end mouseUp
  * Card 2153 "" (5 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Bridgeup)|" & it  & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 2153:6 "marker"
    * Part 2153:1 "right"
      on mouseUp
      go to card id 20680
      end mouseUp
    * Part 2153:2 "left"
      on mouseUp
      go to card id 2465
      end mouseUp
    * Part 2153:3 ""
      on mouseUp
      go to card id 26492
      end mouseUp
    * Part 2153:7 "qbri1"
      on mouseUp
      go to card id 26492
      end mouseUp
  * Card 2465 "qsl4" (7 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_LowerStairs
    if char 4 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it & return into pictAdd
    end if
    if CH_LowerStairs is "Open" then
    get the rect of card button marker2
    put field "pict name" & " (DoorOpen)|" & it & return after pictAdd
    end if
    
    pass openCard
    end openCard

    * Part 2465:1 "right"
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 2465:2 "left"
      on mouseUp
      go to card id 20680
      end mouseUp
    * Part 2465:3 ""
      on mouseUp
      go to card id 20241
      end mouseUp
    * Part 2465:4 "left"
      on mouseUp
      go to card id 20680
      end mouseUp
    * Part 2465:5 "marker"
      on mouseUp
      doValveR 4
      end mouseUp
    * Part 2465:6 "marker2"
    * Part 2465:7 "qsr3"
      on mouseUp
      go to card id 20241
      end mouseUp
  * Card 26492 "qsi6" (7 parts)

    on openCard
    global pictAdd,CH_Bridge,CH_WaterPath
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    if char 6 of CH_WaterPath is "0" then
    get the rect of card button marker2
    put field "pict name" & " (SwLeft)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 26492:5 "marker"
    * Part 26492:4 ""
      on mouseUp
      go to card id 26960
      end mouseUp
    * Part 26492:3 ""
      on mouseUp
      go to card id 29021
      end mouseUp
    * Part 26492:6 "marker2"
      on mouseUp
      doValveI 6
      end mouseUp
    * Part 26492:1 "right"
      on mouseUp
      go to card id 26717
      end mouseUp
    * Part 26492:2 "left"
      on mouseUp
      go to card id 26717
      end mouseUp
    * Part 26492:8 "qbr1"
      on mouseUp
      go to card id 29021
      end mouseUp
  * Card 26717 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "BW 31-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 26717:1 "left"
      on mouseUp
      go to card id 26492
      end mouseUp
    * Part 26717:2 "right"
      on mouseUp
      go to card id 26492
      end mouseUp
    * Part 26717:3 ""
      on mouseUp
      go to card id 2465
      end mouseUp
    * Part 26717:4 "moovmarker"
  * Card 29021 "" (5 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Bridge)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 29021:4 "marker"
    * Part 29021:1 "right"
      on mouseUp
      go to card id 26960
      end mouseUp
    * Part 29021:2 "left"
      on mouseUp
      go to card id 29197
      end mouseUp
    * Part 29021:3 ""
      on mouseUp
      go to card id 29603
      end mouseUp
    * Part 29021:5 "qbr1 right"
      on mouseUp
      go to card id 26960
      end mouseUp
  * Card 29197 "qsl6" (8 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_Elevator1,CH_LowerStairs
    if char 6 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    if CH_LowerStairs is "open" then
    get the rect of card button marker3
    put field "pict name" & " (DoorOpen)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 29197:8 "marker3"
    * Part 29197:7 "marker2"
    * Part 29197:3 ""
      on mouseUp
      go to card id 26717
      end mouseUp
    * Part 29197:5 "marker"
      on mouseUp
      doValveR 6
      end mouseUp
    * Part 29197:1 "right"
      on mouseUp
      go to card id 29021
      end mouseUp
    * Part 29197:2 "left"
      on mouseUp
      go to card id 26960
      end mouseUp
    * Part 29197:4 "left"
      on mouseUp
      go to card id 26960
      end mouseUp
    * Part 29197:9 "qsl4"
      on mouseUp
      go to card id 26717
      end mouseUp
  * Card 29603 "" (5 parts)
    * Part 29603:1 "right"
      on mouseUp
      go to card id 29713
      end mouseUp
    * Part 29603:2 "left"
      on mouseUp
      go to card id 35914
      end mouseUp
    * Part 29603:3 ""
      on mouseUp
      go to card id 30164
      end mouseUp
    * Part 29603:4 "left"
      on mouseUp
      go to card id 35914
      end mouseUp
    * Part 29603:5 "qbr1"
      on mouseUp
      go to card id 29713
      end mouseUp
  * Card 29713 "" (7 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_LowerStairs,CH_PipeBridge
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    if CH_LowerStairs is "open" then
    get the rect of card button marker2
    put field "pict name" & " (DoorOpen)|" & it & return after pictAdd
    end if
    if CH_PipeBridge is "up" then
    get the rect of card button marker3
    put field "pict name" & " (Pipe)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 29713:6 "marker3"
    * Part 29713:5 "marker2"
    * Part 29713:4 "marker"
    * Part 29713:1 "left"
      on mouseUp
      go to card id 29603
      end mouseUp
    * Part 29713:2 "right"
      on mouseUp
      go to card id 35914
      end mouseUp
    * Part 29713:3 ""
      on mouseUp
      go to card id 29197
      end mouseUp
    * Part 29713:7 "qsl4"
      on mouseUp
      go to card id 29197
      end mouseUp
  * Card 30164 "" (5 parts)

    on openCard
    global pictAdd,CH_Bridge,CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1" into field "truepath"
    else put "1010-0-" into field "truepath"
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 30164:4 "marker"
    * Part 30164:1 "right"
      on mouseUp
      go to card id 30460
      end mouseUp
    * Part 30164:2 "left"
      on mouseUp
      go to card id 30460
      end mouseUp
    * Part 30164:3 ""
      on mouseUp
      go to card id 30631
      end mouseUp
    * Part 30164:5 "qbr1"
      on mouseUp
      go to card id 30631
      end mouseUp
  * Card 30460 "" (8 parts)

    on Opencard
    global CH_WindMoov,CH_LowerStairs,pictAdd
    global CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1" into field "truepath"
    else put "1010-0-" into field "truepath"
    put "BW 39-N Windmill.MooV" into CH_WindMoov
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (DoorOpen)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 30460:6 "marker"
    * Part 30460:1 "right"
      on mouseUp
      go to card id 30164
      end mouseUp
    * Part 30460:2 "left"
      on mouseUp
      go to card id 30164
      end mouseUp
    * Part 30460:3 ""
      on mouseUp
      go to card id 29713
      end mouseUp
    * Part 30460:4 ""
      on mouseUp
      go to card id 35914
      end mouseUp
    * Part 30460:5 "moovmarker"
    * Part 30460:7 "qsl6"
      on mouseUp
      go to card id 29713
      end mouseUp
    * Part 30460:8 "qsr7"
      on mouseUp
      go to card id 35914
      end mouseUp
  * Card 30631 "" (6 parts)

    on openCard
    global pictAdd,CH_Bridge,CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1" into field "truepath"
    else put "1010-0-" into field "truepath"
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 30631:4 "marker"
    * Part 30631:1 "right"
      on mouseUp
      go to card id 30934
      end mouseUp
    * Part 30631:2 "left"
      on mouseUp
      go to card id 30934
      end mouseUp
    * Part 30631:3 ""
      on mouseUp
      go to card id 31118
      end mouseUp
    * Part 30631:5 ""
      on mouseUp
      go to card id 31118
      end mouseUp
    * Part 30631:6 "qbr1"
      on mouseUp
      go to card id 31118
      end mouseUp
  * Card 30934 "" (6 parts)

    on Opencard
    global CH_WindMoov
    global CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1" into field "truepath"
    else put "1010-0-" into field "truepath"
    put "BW 40-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 30934:1 "left"
      on mouseUp
      go to card id 30631
      end mouseUp
    * Part 30934:2 "right"
      on mouseUp
      go to card id 30631
      end mouseUp
    * Part 30934:3 ""
      on mouseUp
      go to card id 30460
      end mouseUp
    * Part 30934:4 "moovmarker"
    * Part 30934:5 "qsr7"
      on mouseUp
      go to card id 30460
      end mouseUp
    * Part 30934:6 "qsl6"
      on mouseUp
      go to card id 30460
      end mouseUp
  * Card 31118 "" (4 parts)

    on openCard
    global pictAdd,CH_Bridge,CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1 Q" into field "truepath"
    else put "1010-0- Q" into field "truepath"
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 31118:4 "marker"
    * Part 31118:1 "right"
      on mouseUp
      go to card id 31432
      end mouseUp
    * Part 31118:2 "left"
      on mouseUp
      go to card id 31432
      end mouseUp
    * Part 31118:3 ""
      on mouseUp
      go to card id 31551
      end mouseUp
  * Card 31432 "" (5 parts)

    on opencard
    global CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1 Q" into field "truepath"
    else put "1010-0- Q" into field "truepath"
    pass opencard
    end opencard

    * Part 31432:1 "left"
      on mouseUp
      go to card id 31118
      end mouseUp
    * Part 31432:2 "right"
      on mouseUp
      go to card id 31118
      end mouseUp
    * Part 31432:3 ""
      on mouseUp
      go to card id 30934
      end mouseUp
    * Part 31432:4 "qsr7"
      on mouseUp
      go to card id 30934
      end mouseUp
    * Part 31432:5 "qsl6 left"
      on mouseUp
      go to card id 31118
      end mouseUp
  * Card 31551 "qbr1" (6 parts)

    on openCard
    global pictAdd,CH_Bridge,CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1 P" into field "truepath"
    else put "1010-0- P" into field "truepath"
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    show card button "crossbridge"
    show card button "qel3 right"
    else
    hide card button "crossbridge"
    hide card button "qel3 right"
    end if
    moviebridge
    pass openCard
    end openCard
    
    on movieBridge
    put "Bridge.MooV" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end movieBridge
    
    on closecard
    htlock true
    put "Bridge.Moov" into theMovieName
    if there is a window theMovieName then  close window theMovieName
    pass closecard
    end closecard

    * Part 31551:5 "marker"
    * Part 31551:1 "right"
      on mouseUp
      go to card id 31961
      end mouseUp
    * Part 31551:2 "left"
      on mouseUp
      go to card id 31961
      end mouseUp
    * Part 31551:3 "crossbridge"
      on mouseUp
      go to card id 36725
      end mouseUp
    * Part 31551:6 "handle"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Bridge,CH_waterPath
      deCurse "override",2004,"color","nodelay"
      put 207 into theStart
      put "Boardwalk BridgeSwitch" into thePict
      put the rect of card button handle into theLoc
      put "0,0,30,53" into theClip
      put true into playclick
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button handle then exit repeat
      get (the mouseV - theStart) div 4
      if it < 0 then get 0
      if it > 11 then get 11
      put it * 30 into item 1 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 11 then
      if playclick is "true" then
      play stop
      play "LV pump Lever"
      put "false" into playclick
      end if
      put char 1 to 3 of CH_waterPath & char 7 of CH_WaterPath into thePath1
      put char 1 to 4 of CH_waterPath & char 6 of CH_WaterPath into thePath2
      if thePath1 = "1001" or thePath2 = "10100" then
      if CH_Bridge is not "up" then
      put "Bridge.MooV" into theMovieName
      if there is a window theMovieName then
      set the startTime of window theMovieName to "0,0"
      set the currTime of window theMovieName to "0,0"
      set the endTime of window theMovieName to "5,5"
      show window theMovieName
      play "WA Sloshing"
      play "WA Sloshing"
      play "WA Sloshing"
      fadeout
      set the rate of window theMovieName to "1"
      repeat until the rate of window theMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      play stop
      end if
      show card button "crossbridge"
      put "up" into CH_Bridge
      htlock true
      play "LV pump Lever"
      opencard
      htlock forcefalse
      if there is a window theMovieName then
      hide window theMovieName
      end if
      else
      put "Bridge.MooV" into theMovieName
      if there is a window theMovieName then
      set the endTime of window theMovieName to "10,10"
      set the starttime of window theMovieName to "5,5"
      set the currTime of window theMovieName to "5,5"
      show window theMovieName
      play "WA Sloshing"
      play "WA Sloshing"
      play "WA Sloshing"
      fadeout
      set the rate of window theMovieName to "1"
      repeat until the rate of window theMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      play stop
      end if
      put "down" into CH_Bridge
      play "LV pump Lever"
      opencard
      if there is a window theMovieName then hide window theMovieName
      put "down" into CH_Bridge
      hide card button "crossbridge"
      end if
      exit repeat
      end if
      else put "true" into playclick
      
      end repeat
      put "0,0,87,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
    * Part 31551:7 "qel3 right"
      on mouseUp
      go to card id 31961
      end mouseUp
  * Card 31961 "" (5 parts)

    on opencard
    global CH_WaterPath
    if char 3 of CH_waterpath is "0" then put "100---1 P" into field "truepath"
    else put "1010-0- P" into field "truepath"
    pass opencard
    end opencard

    * Part 31961:1 "left"
      on mouseUp
      go to card id 31551
      end mouseUp
    * Part 31961:2 "right"
      on mouseUp
      go to card id 31551
      end mouseUp
    * Part 31961:3 ""
      on mouseUp
      go to card id 31432
      end mouseUp
    * Part 31961:4 "qsr7"
      on mouseUp
      go to card id 31432
      end mouseUp
    * Part 31961:5 "qsl6 left"
      on mouseUp
      go to card id 31551
      end mouseUp
  * Card 36725 "" (4 parts)
    * Part 36725:1 "right"
      on mouseUp
      go to card id 37065
      end mouseUp
    * Part 36725:2 "left"
      on mouseUp
      go to card id 37065
      end mouseUp
    * Part 36725:3 ""
      on mouseUp
      go to card id 37272
      end mouseUp
    * Part 36725:4 "qel3 right"
      on mouseUp
      go to card id 37065
      end mouseUp
  * Card 37065 "" (3 parts)
    * Part 37065:1 "left"
      on mouseUp
      go to card id 36725
      end mouseUp
    * Part 37065:2 "right"
      on mouseUp
      go to card id 36725
      end mouseUp
    * Part 37065:3 ""
      on mouseUp
      go to card id 31961
      end mouseUp
  * Card 37272 "" (4 parts)

    on openCard
    playqt "L1 slosh Mov",,loop,100
    pass openCard
    end openCard

    * Part 37272:1 "right"
      on mouseUp
      go to card id 37442
      end mouseUp
    * Part 37272:2 "left"
      on mouseUp
      go to card id 37442
      end mouseUp
    * Part 37272:3 ""
      on mouseUp
      go to card id 37667
      end mouseUp
    * Part 37272:4 "qel3 right"
      on mouseUp
      go to card id 37442
      end mouseUp
  * Card 37442 "qbr2" (3 parts)

    on openCard
    playqt "L1 slosh Mov",,loop,100
    pass openCard
    end openCard

    * Part 37442:1 "left"
      on mouseUp
      go to card id 37272
      end mouseUp
    * Part 37442:2 "right"
      on mouseUp
      go to card id 37272
      end mouseUp
    * Part 37442:3 ""
      on mouseUp
      go to card id 37065
      end mouseUp
  * Card 37667 "" (3 parts)
    * Part 37667:1 "right"
      on mouseUp
      go to card id 38065
      end mouseUp
    * Part 37667:2 "left"
      on mouseUp
      go to card id 38065
      end mouseUp
    * Part 37667:3 ""
      on mouseUp
      go to card id 38264
      end mouseUp
  * Card 38065 "" (3 parts)
    * Part 38065:1 "left"
      on mouseUp
      go to card id 37667
      end mouseUp
    * Part 38065:2 "right"
      on mouseUp
      go to card id 37667
      end mouseUp
    * Part 38065:3 ""
      on mouseUp
      go to card id 37442
      end mouseUp
  * Card 38264 "" (4 parts)
    * Part 38264:1 "right"
      on mouseUp
      go to card id 38457
      end mouseUp
    * Part 38264:2 "left"
      on mouseUp
      go to card id 38457
      end mouseUp
    * Part 38264:3 ""
      on mouseUp
      go to card id 38861
      end mouseUp
    * Part 38264:4 "qel3"
      on mouseUp
      go to card id 38861
      end mouseUp
  * Card 38457 "" (4 parts)
    * Part 38457:1 "left"
      on mouseUp
      go to card id 38264
      end mouseUp
    * Part 38457:2 "right"
      on mouseUp
      go to card id 38264
      end mouseUp
    * Part 38457:3 ""
      on mouseUp
      go to card id 38065
      end mouseUp
    * Part 38457:4 "qbr2"
      on mouseUp
      go to card id 38065
      end mouseUp
  * Card 38861 "" (4 parts)
    * Part 38861:1 "right"
      on mouseUp
      go to card id 39075
      end mouseUp
    * Part 38861:2 "left"
      on mouseUp
      go to card id 39075
      end mouseUp
    * Part 38861:3 ""
      on mouseUp
      go to card id 39330
      end mouseUp
    * Part 38861:4 "qel3"
      on mouseUp
      go to card id 39330
      end mouseUp
  * Card 39075 "" (3 parts)
    * Part 39075:1 "left"
      on mouseUp
      go to card id 38861
      end mouseUp
    * Part 39075:2 "right"
      on mouseUp
      go to card id 38861
      end mouseUp
    * Part 39075:3 ""
      on mouseUp
      go to card id 38457
      end mouseUp
  * Card 39330 "" (5 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 39330:5 "marker"
    * Part 39330:1 "right"
      on mouseUp
      go to card id 39528
      end mouseUp
    * Part 39330:2 "left"
      on mouseUp
      go to card id 39528
      end mouseUp
    * Part 39330:3 ""
      on mouseUp
      go to card id 39809
      end mouseUp
    * Part 39330:6 "qel3 left"
      on mouseUp
      go to card id 39528
      end mouseUp
  * Card 39528 "" (3 parts)
    * Part 39528:1 "left"
      on mouseUp
      go to card id 39330
      end mouseUp
    * Part 39528:2 "right"
      on mouseUp
      go to card id 39330
      end mouseUp
    * Part 39528:3 ""
      on mouseUp
      go to card id 39075
      end mouseUp
  * Card 39809 "" (4 parts)
    * Part 39809:1 "right"
      on mouseUp
      go to card id 40121
      end mouseUp
    * Part 39809:2 "left"
      on mouseUp
      go to card id 40121
      end mouseUp
    * Part 39809:3 ""
      on mouseUp
      go to card id 40222
      end mouseUp
    * Part 39809:4 "qel3 left"
      on mouseUp
      go to card id 40121
      end mouseUp
  * Card 40121 "" (4 parts)
    * Part 40121:1 "left"
      on mouseUp
      go to card id 39809
      end mouseUp
    * Part 40121:2 "right"
      on mouseUp
      go to card id 39809
      end mouseUp
    * Part 40121:3 ""
      on mouseUp
      go to card id 39528
      end mouseUp
    * Part 40121:4 "qbr2 left"
      on mouseUp
      go to card id 39809
      end mouseUp
  * Card 40222 "" (4 parts)
    * Part 40222:1 "right"
      on mouseUp
      go to card id 40631
      end mouseUp
    * Part 40222:2 "left"
      on mouseUp
      go to card id 40631
      end mouseUp
    * Part 40222:3 ""
      on mouseUp
      go to card id 40846
      end mouseUp
    * Part 40222:4 "qel3"
      on mouseUp
      go to card id 40846
      end mouseUp
  * Card 40631 "" (4 parts)
    * Part 40631:1 "left"
      on mouseUp
      go to card id 40222
      end mouseUp
    * Part 40631:2 "right"
      on mouseUp
      go to card id 40222
      end mouseUp
    * Part 40631:3 ""
      on mouseUp
      go to card id 40121
      end mouseUp
    * Part 40631:4 "qbr2"
      on mouseUp
      go to card id 40121
      end mouseUp
  * Card 40846 "" (5 parts)
    * Part 40846:1 "right"
      on mouseUp
      go to card id 42420
      end mouseUp
    * Part 40846:2 "left"
      on mouseUp
      go to card id 41077
      end mouseUp
    * Part 40846:3 ""
      on mouseUp
      go to card id 41960
      end mouseUp
    * Part 40846:4 "right"
      on mouseUp
      go to card id 42420
      end mouseUp
    * Part 40846:5 "qel3"
      on mouseUp
      go to card id 41960
      end mouseUp
  * Card 41077 "" (4 parts)

    on openCard
    playqt "L1 slosh Mov",,loop,100
    pass openCard
    end openCard

    * Part 41077:1 "left"
      on mouseUp
      go to card id 42420
      end mouseUp
    * Part 41077:2 "right"
      on mouseUp
      go to card id 40846
      end mouseUp
    * Part 41077:3 ""
      on mouseUp
      go to card id 40631
      end mouseUp
    * Part 41077:4 "qbr2"
      on mouseUp
      go to card id 40631
      end mouseUp
  * Card 41960 "" (3 parts)
    * Part 41960:1 ""
      on mouseUp
      go to card id 41466
      end mouseUp
    * Part 41960:2 "right"
      on mouseUp
      go to card id 42194
      end mouseUp
    * Part 41960:3 "left"
      on mouseUp
      go to card id 42194
      end mouseUp
  * Card 42194 "" (7 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 42194:5 "marker"
    * Part 42194:1 "left"
      on mouseUp
      go to card id 41960
      end mouseUp
    * Part 42194:2 "right"
      on mouseUp
      go to card id 41960
      end mouseUp
    * Part 42194:3 ""
      on mouseUp
      go to card id 41077
      end mouseUp
    * Part 42194:4 ""
      on mouseUp
      go to card id 42420
      end mouseUp
    * Part 42194:6 "qpip2"
      on mouseUp
      go to card id 42420
      end mouseUp
    * Part 42194:7 "qbr2 right"
      on mouseUp
      go to card id 41960
      end mouseUp
  * Card 41466 "qel3" (6 parts)

    on opencard
    hide card button "enterElevator"
    show card button "openElevator"
    
    pass opencard
    end opencard

    * Part 41466:5 "doormarker"
    * Part 41466:1 "right"
      on mouseUp
      if visible of card button openElevator is false then
      go to card id 41669
      play "DR wood shut"
      else
      go to card id 41669
      end if
      end mouseUp
    * Part 41466:2 "left"
      on mouseUp
      if visible of card button openElevator is false then
      go to card id 41669
      play "DR wood shut"
      else
      go to card id 41669
      end if
      end mouseUp
    * Part 41466:3 "enterElevator"
      on mouseUp
      go to card id 45661
      vs right
      go to card id 44320
      end mouseUp
    * Part 41466:4 "openelevator"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,2,16
      put WhichPict & " (DoorOpen)" into WhichPict
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "DR wood open"
      htlock forcefalse
      show card button "EnterElevator"
      hide card button "openelevator"
      end mouseUp
    * Part 41466:6 "up"
      on mouseUp
      go to card id 44827
      end mouseUp
  * Card 44827 "" (1 parts)
    * Part 44827:1 "down"
      on mouseUp
      go to card id 41466
      end mouseUp
  * Card 45661 "" (0 parts)
  * Card 42420 "" (6 parts)

    on openCard
    global pictAdd,CH_PipeBridge,CH_Elevator1
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 42420:5 "marker2"
    * Part 42420:4 "marker"
    * Part 42420:1 "right"
      on mouseUp
      go to card id 41077
      end mouseUp
    * Part 42420:2 "left"
      on mouseUp
      go to card id 42690
      end mouseUp
    * Part 42420:3 ""
      on mouseUp
      go to card id 42940
      end mouseUp
    * Part 42420:6 "qpip2"
      on mouseUp
      go to card id 42940
      end mouseUp
  * Card 44320 "" (3 parts)
    * Part 44320:1 ""
      on mouseUp
      put "Elevator3.Moov" into theMovieName
      if there is a window theMovieName then  close window theMovieName
      go to card id 41669
      play "DR wood shut"
      end mouseUp
    * Part 44320:3 "closedoor"
      on mousedown
      HTVisual "wipe right",,,1,32
      playQT ,,loop,50
      dplay "DR wood shut"
      go to card id 85464
      end mousedown
    * Part 44320:4 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_waterPath,CH_PipeBridge
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator3Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,55,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it ≥ 9 then
      get 9
      if the sound is "done" then play "SW breakerclose"
      end if
      put it * 55 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      put "0,0,55,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
  * Card 85464 "" (3 parts)

    on opencard
    setmovie
    pass opencard
    end opencard
    
    on idle
    playQT ,,loop,50
    end idle
    
    
    on setmovie
    put "Elevator3.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "MooVMarker","invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end setmovie

    * Part 85464:1 ""
      on mouseUp
      HTVisual "wipe left",,,1,32
      dplay "DR wood open"
      go to card id 44320
      end mouseUp
    * Part 85464:2 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_waterPath,CH_PipeBridge,quick
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator3Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,55,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it > 10 then get 10
      put it * 55 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 9 then
      put char 1 to 5 of CH_waterPath into thePath
      if thePath = "10110" and CH_PipeBridge is "up" then
      --if quick is "true" then  -- removed (1.0b8)
      --  skipmoov  -- removed (1.0b8)
      --  exit mousedown  -- removed (1.0b8)
      --else  -- removed (1.0b8)
      put "Elevator3.Moov" into theMovieName
      if there is a window theMovieName then
      play "MR wood Elev Strt"
      play "MR wood Elev Mid" c c c c c c c c c c c c c c c c c c c
      fadeOut
      show window theMovieName
      set the currTime of window theMovieName to "0"
      set the endTime of window theMovieName to "5,40"
      set the rate of window theMovieName to "1.0"
      end if
      -- end if  -- removed (1.0b8)
      repeat until the rate of window theMovieName is "0.0"
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "MR wood Elev End"
      playQT "L2 Wind Mov",,loop,50
      go to card id 85642
      hide window theMovieName
      exit repeat
      else
      if the sound is "done" then play "SW breakerclose"
      end if
      end if
      end repeat
      put "0,0,55,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
      
      --on skipmoov  -- removed (1.0b8)
      vd
      play "MR wood Elev End"
      playQT "L2 Wind Mov",,loop,50
      go to card id 85642
      end skipmoov
    * Part 85464:3 "MoovMarker"
  * Card 85642 "" (3 parts)

    on opencard
    setmovie
    pass opencard
    end opencard
    
    on setmovie
    put "Elevator3.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "MooVMarker","invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end setmovie

    * Part 85642:4 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_waterPath,CH_PipeBridge,quick
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator3Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,55,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it > 10 then get 10
      put it * 55 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 9 then
      put char 1 to 5 of CH_waterPath into thePath
      if thePath = "10110" and CH_PipeBridge is "up" then
      --if quick is "true" then  -- removed (1.0b8)
      --  skipmoov  -- removed (1.0b8)
      --  exit mousedown  -- removed (1.0b8)
      -- else  -- removed (1.0b8)
      put "Elevator3.Moov" into theMovieName
      if there is a window theMovieName then
      play "MR wood Elev Strt"
      play "MR wood Elev Mid" c c c c c c c c c c c c c c c c c c c
      fadeOut
      set the currTime of window theMovieName to "5,40"
      set the endTime of window theMovieName to the duration of window theMovieName
      set the rate of window theMovieName to "1.0"
      show window theMovieName
      end if
      --end if  -- removed (1.0b8)
      repeat until the rate of window theMovieName is "0.0"
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "MR wood Elev End"
      playQT "L1 Slosh Mov",,loop,50
      go to card id 85464
      hide window theMovieName
      end if
      exit repeat
      end if
      end repeat
      put "0,0,55,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
      
      --on skipmoov  -- removed (1.0b8)
      vd
      go to card id 85464
      end skipmoov
    * Part 85642:2 ""
      on mouseUp
      HTVisual "wipe left",,,1,32
      dplay "DR wood open"
      go to card id 85801
      dplay "EL SoftHum"
      go to card id 101798
      end mouseUp
    * Part 85642:3 "MoovMarker"
  * Card 85801 "" (1 parts)
    * Part 85801:3 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_waterPath,CH_PipeBridge
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator3Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,55,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it ≥ 9 then
      get 9
      if the sound is "done" then play "SW breakerclose"
      end if
      put it * 55 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      put "0,0,55,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      play "EL SoftHum"
      go to card id 101798
      end mouseDown
  * Card 101798 "" (3 parts)
    * Part 101798:1 "none"
      on mouseUp
      go to card id 85801
      play "SW switch flick"
      HTVisual "wipe right",,,1,32
      wait 20
      dplay "DR wood shut"
      go to card id 85642
      end mouseUp
    * Part 101798:2 ""
      on mouseUp
      put "Elevator3.Moov" into theMovieName
      if there is a window theMovieName then  close window theMovieName
      go to card id 86090
      play "DR wood shut"
      end mouseUp
    * Part 101798:3 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      go to card id 85801
      play "SW switch flick"
      send mousedown to card button "none"
      end mouseDown
  * Card 86090 "" (3 parts)
    * Part 86090:1 "left"
      on mouseUp
      go to card id 86416
      end mouseUp
    * Part 86090:2 "right"
      on mouseUp
      go to card id 86416
      end mouseUp
    * Part 86090:3 ""
      on mouseUp
      go to card id 100694
      end mouseUp
  * Card 100694 "" (2 parts)
    * Part 100694:1 ""
      on mouseUp
      go to card id 86090
      end mouseUp
    * Part 100694:2 ""
      on mouseUp
      go to card id 100894
      end mouseUp
  * Card 100894 "" (3 parts)

    on mouseDownInMovie
    deCurse "override",2003,"color","nodelay"
    htlock true
    put "MystLib.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    hide window TheMovieName
    close window TheMovieName
    end if
    play "transport"
    go to card "black"
    htlock true
    lock screen
    go to card "black" of stack "Myst"
    vd
    play "transport"
    push card id 46439 of stack "Myst"
    go to card id 44018 of stack "Myst"
    end mouseDownInMovie
    
    on idle
    get "MystLib.MooV"
    if there is not a window it then flyby
    end idle
    
    on closeCard
    put "MystLib.MooV" into TheMovieName --∆
    if there is a window TheMovieName then
    hide window TheMovieName
    close window TheMovieName
    end if
    pass closeCard
    end closeCard
    
    on FlyBy
    put "MystLib.MooV" into TheMovieName --∆
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to true
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "1,140"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "1.0"
    show window TheMovieName
    end if
    end FlyBy

    * Part 100894:1 ""
      on mouseUp
      go to card id 86090
      end mouseUp
    * Part 100894:2 ""
    * Part 100894:3 "marker"
      on mouseUp
      send mouseDownInMovie to card
      end mouseUp
  * Card 86416 "" (3 parts)
    * Part 86416:1 "left"
      on mouseUp
      go to card id 86090
      end mouseUp
    * Part 86416:2 "right"
      on mouseUp
      go to card id 86090
      end mouseUp
    * Part 86416:3 "openDoor"
      on mouseUp
      dplay "DR wood open"
      HTVisual "wipe right",,,1,32
      go to card id 86711
      end mouseUp
  * Card 86711 "" (4 parts)
    * Part 86711:1 "closeDoor"
      on mouseUp
      dplay "DR wood shut"
      HTVisual "wipe left",,,1,32
      go to card id 86416
      end mouseUp
    * Part 86711:2 ""
      on mouseUp
      go to card id 98476
      vs right
      go to card id 101798
      end mouseUp
    * Part 86711:3 "right"
      on mouseUp
      go to card id 86090
      end mouseUp
    * Part 86711:4 "left"
      on mouseUp
      go to card id 86090
      end mouseUp
  * Card 98476 "" (0 parts)
  * Card 42690 "" (5 parts)
    * Part 42690:1 "left"
      on mouseUp
      go to card id 41077
      end mouseUp
    * Part 42690:2 "right"
      on mouseUp
      go to card id 42420
      end mouseUp
    * Part 42690:3 ""
      on mouseUp
      go to card id 41960
      end mouseUp
    * Part 42690:4 "left"
      on mouseUp
      go to card id 41077
      end mouseUp
    * Part 42690:5 "qel3"
      on mouseUp
      go to card id 41960
      end mouseUp
  * Card 42940 "" (6 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 42940:4 "marker"
    * Part 42940:1 "right"
      on mouseUp
      go to card id 43125
      end mouseUp
    * Part 42940:2 "left"
      on mouseUp
      go to card id 43125
      end mouseUp
    * Part 42940:3 ""
      on mouseUp
      go to card id 43268
      end mouseUp
    * Part 42940:5 "qpip2"
      on mouseUp
      go to card id 43268
      end mouseUp
    * Part 42940:6 "qpip2 right"
      on mouseUp
      go to card id 43125
      end mouseUp
  * Card 43125 "" (3 parts)
    * Part 43125:1 "left"
      on mouseUp
      go to card id 42940
      end mouseUp
    * Part 43125:2 "right"
      on mouseUp
      go to card id 42940
      end mouseUp
    * Part 43125:3 ""
      on mouseUp
      go to card id 42690
      end mouseUp
  * Card 43268 "" (4 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 43268:4 "marker"
    * Part 43268:1 "right"
      on mouseUp
      go to card id 43713
      end mouseUp
    * Part 43268:2 "left"
      on mouseUp
      go to card id 43713
      end mouseUp
    * Part 43268:3 ""
      on mouseUp
      go to card id 43979
      end mouseUp
  * Card 43713 "" (4 parts)
    * Part 43713:1 "left"
      on mouseUp
      go to card id 43268
      end mouseUp
    * Part 43713:2 "right"
      on mouseUp
      go to card id 43268
      end mouseUp
    * Part 43713:3 ""
      on mouseUp
      go to card id 43125
      end mouseUp
    * Part 43713:4 "qel3"
      on mouseUp
      go to card id 43125
      end mouseUp
  * Card 43979 "qpip2" (4 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    moviebridge
    pass openCard
    end openCard
    
    on movieBridge
    put "PipeBridge.MooV" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button marker2,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end movieBridge
    
    on closecard
    htlock true
    put "PipeBridge.MooV" into theMovieName
    if there is a window theMovieName then close window theMovieName
    pass closecard
    end closecard

    * Part 43979:1 "right"
      on mouseUp
      go to card id 44229
      end mouseUp
    * Part 43979:2 "left"
      on mouseUp
      go to card id 44229
      end mouseUp
    * Part 43979:3 "marker2"
    * Part 43979:4 "none"
      on mouseDown
      global CH_pipebridge
      put "PipeBridge.MooV" into theMovieName
      if CH_PipeBridge is not "up" then
      if there is a window theMovieName then
      set the currtime of window theMovieName to "0"
      set the endtime of window theMovieName to "5,4"
      show window theMovieName
      play "GR ratchet iii"
      play "GR ratchet iii"
      play "GR ratchet iii"
      play "GR ratchet iii"
      set the rate of window theMovieName to "1.0"
      end if
      put "up" into CH_PipeBridge
      else
      if there is a window theMovieName then
      set the currtime of window theMovieName to "5,4"
      set the endtime of window theMovieName to "10,8"
      show window theMovieName
      playqt "L1 Slosh Mov",,loop,250
      play "GR ratchet iii"
      play "GR ratchet iii"
      play "GR ratchet iii"
      play "GR ratchet iii"
      set the rate of window theMovieName to "1.0"
      end if
      put "down" into CH_PipeBridge
      end if
      repeat until the rate of window theMovieName = 0
      soundIdle
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "SW GenLights On" tempo 90 c5
      opencard
      hide window theMovieName
      end mouseDown
  * Card 44229 "" (4 parts)
    * Part 44229:1 "left"
      on mouseUp
      go to card id 43979
      end mouseUp
    * Part 44229:2 "right"
      on mouseUp
      go to card id 43979
      end mouseUp
    * Part 44229:3 ""
      on mouseUp
      go to card id 43713
      end mouseUp
    * Part 44229:4 "qel3"
      on mouseUp
      go to card id 43713
      end mouseUp
  * Card 41669 "" (6 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 41669:4 "marker"
    * Part 41669:1 "left"
      on mouseUp
      go to card id 41466
      end mouseUp
    * Part 41669:2 "right"
      on mouseUp
      go to card id 41466
      end mouseUp
    * Part 41669:3 ""
      on mouseUp
      go to card id 42194
      end mouseUp
    * Part 41669:5 "qpip2"
      on mouseUp
      go to card id 42194
      end mouseUp
    * Part 41669:6 "qbr2"
      on mouseUp
      go to card id 42194
      end mouseUp
  * Card 26960 "" (4 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 26960:4 "marker"
    * Part 26960:1 "right"
      on mouseUp
      go to card id 27330
      end mouseUp
    * Part 26960:2 "left"
      on mouseUp
      go to card id 29021
      end mouseUp
    * Part 26960:3 ""
      on mouseUp
      go to card id 27623
      end mouseUp
  * Card 27330 "qsr6" (7 parts)

    on openCard
    global pictAdd,CH_WaterPath,moov
    global CH_WindMoov
    put "BW 32-N Windmill.MooV" into CH_WindMoov
    if char 6 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it & return into pictAdd
    end if
    put false into Moov
    pass openCard
    end openCard

    * Part 27330:1 "left"
      on mouseUp
      go to card id 26960
      end mouseUp
    * Part 27330:2 "right"
      on mouseUp
      go to card id 29021
      end mouseUp
    * Part 27330:3 ""
      on mouseUp
      go to card id 26717
      end mouseUp
    * Part 27330:4 "right"
      on mouseUp
      go to card id 29021
      end mouseUp
    * Part 27330:5 "marker"
      on mouseUp
      doValveL 6
      end mouseUp
    * Part 27330:6 "moovmarker"
    * Part 27330:7 "qsl4"
      on mouseUp
      go to card id 26717
      end mouseUp
  * Card 27623 "" (4 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 27623:4 "marker"
    * Part 27623:1 "right"
      on mouseUp
      go to card id 27804
      end mouseUp
    * Part 27623:2 "left"
      on mouseUp
      go to card id 27804
      end mouseUp
    * Part 27623:3 ""
      on mouseUp
      go to card id 28067
      end mouseUp
  * Card 27804 "" (5 parts)

    on Opencard
    global CH_WindMoov
    put "BW 34-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 27804:1 "right"
      on mouseUp
      go to card id 27623
      end mouseUp
    * Part 27804:2 "left"
      on mouseUp
      go to card id 27623
      end mouseUp
    * Part 27804:3 ""
      on mouseUp
      go to card id 27330
      end mouseUp
    * Part 27804:4 "moovmarker"
    * Part 27804:5 "qsl4"
      on mouseUp
      go to card id 27330
      end mouseUp
  * Card 28067 "" (4 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 28067:4 "marker"
    * Part 28067:1 "right"
      on mouseUp
      go to card id 28195
      end mouseUp
    * Part 28067:2 "left"
      on mouseUp
      go to card id 28195
      end mouseUp
    * Part 28067:3 ""
      on mouseUp
      go to card id 28497
      end mouseUp
  * Card 28195 "" (7 parts)

    on openCard
    global pictAdd,CH_elevator1,CH_WindMoov
    if CH_elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    put "BW 35-N Windmill.MooV" into CH_WindMoov
    pass openCard
    end openCard

    * Part 28195:5 "marker"
    * Part 28195:1 "left"
      on mouseUp
      go to card id 28067
      end mouseUp
    * Part 28195:2 "right"
      on mouseUp
      go to card id 28067
      end mouseUp
    * Part 28195:3 ""
      on mouseUp
      go to card id 27804
      end mouseUp
    * Part 28195:4 "MooVmarker"
    * Part 28195:6 "qsr6"
      on mouseUp
      go to card id 27804
      end mouseUp
    * Part 28195:7 "qsl4"
      on mouseUp
      go to card id 27804
      end mouseUp
  * Card 28497 "restart" (4 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 28497:4 "moovMarker"
    * Part 28497:3 "marker"
    * Part 28497:1 "right"
      on mouseUp
      go to card id 28810
      end mouseUp
    * Part 28497:2 "left"
      on mouseUp
      go to card id 28810
      end mouseUp
  * Card 26005 "Black" (0 parts)
  * Card 28810 "" (6 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_WindMoov
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    if there is not a window "WindMooV" then WindMill
    put "BW 36-N Windmill.MooV" into CH_WindMoov
    pass openCard
    end openCard

    * Part 28810:5 "marker"
    * Part 28810:1 "right"
      on mouseUp
      go to card id 28497
      end mouseUp
    * Part 28810:2 "left"
      on mouseUp
      go to card id 28497
      end mouseUp
    * Part 28810:3 ""
      on mouseUp
      go to card id 28195
      end mouseUp
    * Part 28810:4 "MooVmarker"
    * Part 28810:6 "qsr6"
      on mouseUp
      go to card id 28195
      end mouseUp
  * Card 20680 "" (7 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put fld "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 20680:5 "marker2"
    * Part 20680:1 "right"
      on mouseUp
      go to card id 20934
      end mouseUp
    * Part 20680:4 "marker"
    * Part 20680:2 "left"
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 20680:3 ""
      on mouseUp
      go to card id 21498
      end mouseUp
    * Part 20680:6 "qel1"
      on mouseUp
      go to card id 20934
      end mouseUp
    * Part 20680:7 "qpip1"
      on mouseUp
      go to card id 21498
      end mouseUp
  * Card 20934 "qsr4" (7 parts)

    on openCard
    global pictAdd,CH_WaterPath,moov
    global CH_WindMoov
    put "BW 20-N Windmill.MooV" into CH_WindMoov
    if char 4 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it into pictAdd
    end if
    put false into Moov
    pass openCard
    end openCard

    * Part 20934:3 ""
      on mouseUp
      go to card id 20241
      end mouseUp
    * Part 20934:5 "marker"
      on mouseUp
      doValveL 4
      end mouseUp
    * Part 20934:1 "left"
      on mouseUp
      go to card id 20680
      end mouseUp
    * Part 20934:2 "right"
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 20934:4 "right"
      on mouseUp
      go to card id 2153
      end mouseUp
    * Part 20934:7 "moovmarker"
    * Part 20934:8 "qsr3"
      on mouseUp
      go to card id 20241
      end mouseUp
  * Card 21498 "qsi5" (9 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_Elevator1,CH_PipeBridge
    if char 5 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    if CH_PipeBridge is "up" then
    get the rect of card button marker3
    put field "pict name" & " (Pipe)|" & it after pictAdd
    end if
    pass openCard
    end openCard

    * Part 21498:7 "marker3"
    * Part 21498:3 ""
      on mouseUp
      go to card id 23887
      end mouseUp
    * Part 21498:6 "marker2"
    * Part 21498:5 "marker"
      on mouseUp
      doValveI 5
      end mouseUp
    * Part 21498:1 "right"
      on mouseUp
      go to card id 21506
      end mouseUp
    * Part 21498:2 "left"
      on mouseUp
      go to card id 21506
      end mouseUp
    * Part 21498:4 ""
      on mouseUp
      go to card id 21943
      end mouseUp
    * Part 21498:9 "qel1 right"
      on mouseUp
      go to card id 21506
      end mouseUp
    * Part 21498:10 "qpip1"
      on mouseUp
      go to card id 23887
      end mouseUp
  * Card 21506 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "BW 22-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 21506:1 "left"
      on mouseUp
      go to card id 21498
      end mouseUp
    * Part 21506:2 "right"
      on mouseUp
      go to card id 21498
      end mouseUp
    * Part 21506:3 ""
      on mouseUp
      go to card id 20934
      end mouseUp
    * Part 21506:4 "moovmarker"
  * Card 23887 "" (6 parts)

    on openCard
    global pictAdd,CH_PipeBridge,CH_Bridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    if CH_Bridge is "up" then
    get the rect of card button marker2
    put field "pict name" & " (BridgeUp)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 23887:4 "marker2"
    * Part 23887:5 "marker"
    * Part 23887:1 "right"
      on mouseUp
      go to card id 21943
      end mouseUp
    * Part 23887:2 "left"
      on mouseUp
      go to card id 24265
      end mouseUp
    * Part 23887:3 ""
      on mouseUp
      go to card id 24323
      end mouseUp
    * Part 23887:6 "qpip1"
      on mouseUp
      go to card id 24323
      end mouseUp
  * Card 24265 "qsl5" (8 parts)

    on openCard
    global pictAdd,CH_WaterPath,CH_LowerStairs
    global CH_WindMoov
    put "BW 24-N Windmill.MooV" into CH_WindMoov
    if char 5 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it into pictAdd
    end if
    if CH_LowerStairs is "open" then
    get the rect of card button marker2
    put field "pict name" & " (Dooropen)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 24265:7 "marker2"
    * Part 24265:3 ""
      on mouseUp
      
      go to card id 21506
      end mouseUp
    * Part 24265:5 "marker"
      on mouseUp
      doValveR 5
      end mouseUp
    * Part 24265:1 "right"
      on mouseUp
      go to card id 23887
      end mouseUp
    * Part 24265:2 "left"
      on mouseUp
      go to card id 21943
      end mouseUp
    * Part 24265:4 "left"
      on mouseUp
      go to card id 21943
      end mouseUp
    * Part 24265:6 "moovmarker"
    * Part 24265:8 "qsr4"
      on mouseUp
      
      go to card id 21506
      end mouseUp
  * Card 24323 "" (5 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 24323:4 "marker"
    * Part 24323:1 "right"
      on mouseUp
      go to card id 24693
      end mouseUp
    * Part 24323:2 "left"
      on mouseUp
      go to card id 24693
      end mouseUp
    * Part 24323:3 ""
      on mouseUp
      go to card id 24946
      end mouseUp
    * Part 24323:5 "qpip1"
      on mouseUp
      go to card id 24946
      end mouseUp
  * Card 24693 "" (5 parts)

    on Opencard
    global CH_WindMoov,CH_LowerStairs,pictAdd
    put "BW 28-N Windmill.MooV" into CH_WindMoov
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (dooropen)|" & it & return into pictAdd
    end if
    pass opencard
    end opencard

    * Part 24693:1 "left"
      on mouseUp
      go to card id 24323
      end mouseUp
    * Part 24693:2 "right"
      on mouseUp
      go to card id 24323
      end mouseUp
    * Part 24693:3 ""
      on mouseUp
      go to card id 24265
      end mouseUp
    * Part 24693:4 "moovmarker"
    * Part 24693:5 "marker"
  * Card 24946 "" (4 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 24946:4 "marker"
    * Part 24946:1 "right"
      on mouseUp
      go to card id 25142
      end mouseUp
    * Part 24946:2 "left"
      on mouseUp
      go to card id 25142
      end mouseUp
    * Part 24946:3 ""
      on mouseUp
      go to card id 25490
      end mouseUp
  * Card 25142 "" (5 parts)

    on Opencard
    global CH_WindMoov
    put "BW 29-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 25142:1 "right"
      on mouseUp
      go to card id 24946
      end mouseUp
    * Part 25142:2 "left"
      on mouseUp
      go to card id 24946
      end mouseUp
    * Part 25142:3 ""
      on mouseUp
      go to card id 24693
      end mouseUp
    * Part 25142:4 "moovmarker"
    * Part 25142:5 "qsl5"
      on mouseUp
      go to card id 24693
      end mouseUp
  * Card 25490 "qpip1" (3 parts)

    on openCard
    global pictAdd,CH_PipeBridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 25490:4 "marker"
    * Part 25490:1 "right"
      on mouseUp
      go to card id 25804
      end mouseUp
    * Part 25490:2 "left"
      on mouseUp
      go to card id 25804
      end mouseUp
  * Card 25804 "" (5 parts)

    on Opencard
    global CH_WindMoov
    put "BW 30-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 25804:1 "right"
      on mouseUp
      go to card id 25490
      end mouseUp
    * Part 25804:2 "left"
      on mouseUp
      go to card id 25490
      end mouseUp
    * Part 25804:3 ""
      on mouseUp
      go to card id 25142
      end mouseUp
    * Part 25804:4 "moovmarker"
    * Part 25804:5 "qsl5"
      on mouseUp
      go to card id 25142
      end mouseUp
  * Card 21943 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 21943:4 "marker"
    * Part 21943:1 "right"
      on mouseUp
      go to card id 22077
      end mouseUp
    * Part 21943:2 "left"
      on mouseUp
      go to card id 23887
      end mouseUp
    * Part 21943:3 ""
      on mouseUp
      go to card id 22520
      end mouseUp
    * Part 21943:5 "qel1"
      on mouseUp
      go to card id 22520
      end mouseUp
  * Card 22077 "qsr5" (5 parts)

    on openCard
    global pictAdd,CH_WaterPath
    if char 5 of CH_WaterPath is "0" then
    get the rect of card button marker
    put field "pict name" & " (SwLeft)|" & it into pictAdd
    end if
    pass openCard
    end openCard

    * Part 22077:1 "right"
      on mouseUp
      go to card id 23887
      end mouseUp
    * Part 22077:2 "left"
      on mouseUp
      go to card id 21943
      end mouseUp
    * Part 22077:3 ""
      on mouseUp
      go to card id 21506
      end mouseUp
    * Part 22077:4 "right"
      on mouseUp
      go to card id 23887
      end mouseUp
    * Part 22077:5 "marker"
      on mouseUp
      doValveL 5
      end mouseUp
  * Card 22520 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 22520:4 "marker"
    * Part 22520:1 "right"
      on mouseUp
      go to card id 22730
      end mouseUp
    * Part 22520:2 "left"
      on mouseUp
      go to card id 22730
      end mouseUp
    * Part 22520:3 ""
      on mouseUp
      go to card id 22799
      end mouseUp
    * Part 22520:5 "qel1"
      on mouseUp
      go to card id 22799
      
      end mouseUp
  * Card 22730 "" (3 parts)
    * Part 22730:1 "right"
      on mouseUp
      go to card id 22520
      end mouseUp
    * Part 22730:2 "left"
      on mouseUp
      go to card id 22520
      end mouseUp
    * Part 22730:3 ""
      on mouseUp
      go to card id 22077
      end mouseUp
  * Card 22799 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1Up)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 22799:4 "marker"
    * Part 22799:1 "right"
      on mouseUp
      go to card id 23050
      end mouseUp
    * Part 22799:2 "left"
      on mouseUp
      go to card id 23050
      end mouseUp
    * Part 22799:3 ""
      on mouseUp
      go to card id 23467
      end mouseUp
  * Card 23050 "" (6 parts)

    on openCard
    global pictAdd,CH_PipeBridge,CH_Bridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (BridgeUp)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 23050:5 "marker2"
    * Part 23050:4 "marker"
    * Part 23050:1 "right"
      on mouseUp
      go to card id 22799
      end mouseUp
    * Part 23050:2 "left"
      on mouseUp
      go to card id 22799
      end mouseUp
    * Part 23050:3 ""
      on mouseUp
      go to card id 22730
      end mouseUp
    * Part 23050:6 "qsr5"
      on mouseUp
      go to card id 22730
      end mouseUp
  * Card 23467 "qel1" (6 parts)

    on opencard
    Global CH_Elevator1
    hide card button "None"
    show card button "OpenElevator"
    put "Boardwalk 27-W" into field "pict name"
    if CH_Elevator1 is "up" then
    put " Elev1Up" after field "Pict name"
    hide card Button "OpenElevator"
    end if
    pass opencard
    end opencard

    * Part 23467:5 "doormarker"
    * Part 23467:1 "right"
      on mouseUp
      global CH_Elevator1
      if visible of card button OpenElevator is false then
      go to card id 23632
      if CH_Elevator1 is "down" then
      play "DR wood shut"
      end if
      else
      go to card id 23632
      end if
      end mouseUp
    * Part 23467:2 "left"
      on mouseUp
      global CH_Elevator1
      if visible of card button OpenElevator is false then
      go to card id 23632
      if CH_Elevator1 is "down" then
      play "DR wood shut"
      end if
      else
      go to card id 23632
      end if
      end mouseUp
    * Part 23467:3 "none"
      on mouseUp
      vd
      go to card id 96885
      vs "left"
      go to card id 36337
      end mouseUp
    * Part 23467:4 "openelevator"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,1,16
      put WhichPict & " (DoorOpen)" into WhichPict
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "DR wood open"
      htlock forcefalse
      show card button "None"
      hide card button "OpenElevator"
      end mouseUp
    * Part 23467:6 "up"
      on mouseUp
      global CH_Elevator1
      if visible of card button OpenElevator is false then
      go to card id 98985
      if CH_Elevator1 is "down" then
      play "DR wood shut"
      end if
      else
      go to card id 98985
      end if
      end mouseUp
  * Card 98985 "" (2 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (ElevUp)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 98985:2 "marker"
    * Part 98985:1 "down"
      on mouseUp
      go to card id 23467
      end mouseUp
  * Card 96885 "" (0 parts)
  * Card 23632 "" (6 parts)

    on openCard
    global pictAdd,CH_PipeBridge,CH_Bridge
    if CH_PipeBridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (Pipe)|" & it & return into pictAdd
    end if
    if CH_Bridge is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Bridge)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 23632:5 "marker"
    * Part 23632:4 "marker2"
    * Part 23632:1 "right"
      on mouseUp
      go to card id 23467
      end mouseUp
    * Part 23632:2 "left"
      on mouseUp
      go to card id 23467
      end mouseUp
    * Part 23632:3 ""
      on mouseUp
      go to card id 23050
      end mouseUp
    * Part 23632:6 "qsr5"
      on mouseUp
      go to card id 23050
      end mouseUp
  * Card 36337 "" (4 parts)
    * Part 36337:3 "doormarker"
    * Part 36337:1 "leaveElevator"
      on mouseUp
      put "Elevator1.Moov" into theMovieName
      if there is a window theMovieName then  close window theMovieName
      go to card id 23632
      play "DR wood shut"
      end mouseUp
    * Part 36337:9 ""
      on mousedown
      HTVisual "wipe right",,the rect of card button doormarker,1,32
      playQT ,,loop,50
      dplay "DR wood shut"
      go to card id 83889
      
      end mousedown
    * Part 36337:10 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator1Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,48,53" into theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it ≥ 9 then
      get 9
      if the sound is "done" then play "SW breakerclose"
      end if
      put it * 48 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      soundidle
      end repeat
      play stop
      put "0,0,48,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
  * Card 83889 "" (4 parts)

    on opencard
    elevator
    pass opencard
    end opencard
    
    on elevator
    put "Elevator1.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "MooVMarker","invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end elevator

    * Part 83889:1 "doormarker"
    * Part 83889:3 ""
      on mouseUp
      HTVisual "wipe left",,the rect of card button doormarker,1,32
      dplay "DR wood open"
      go to card id 36337
      end mouseUp
    * Part 83889:4 "moovmarker"
    * Part 83889:6 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath,Quick
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator1Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,48,53" into theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it > 10 then get 10
      put it * 48 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 9 then
      put char 1 to 5 of CH_waterPath into thePath1
      if thePath1 = "10111" then
      -- if quick = "true" then  -- removed (1.0b8)
      --   skipmoov  -- removed (1.0b8)
      --   put "up" into CH_Elevator1  -- removed (1.0b8)
      --   exit mousedown  -- removed (1.0b8)
      -- else  -- removed (1.0b8)
      put "Elevator1.Moov" into theMovieName
      if there is a window theMovieName then
      play "MR wood Elev Strt"
      play "MR wood Elev Mid" c c c c c c c c c c c c c c c c c c c
      fadeOut
      set the currTime of window theMovieName to "0"
      set the endTime of window theMovieName to "5,20"
      show window theMovieName
      set the rate of window theMovieName to "1.0"
      end if
      -- end if  -- removed (1.0b8)
      repeat until the rate of window theMovieName is "0.0"
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "MR wood Elev End"
      playQT "L2 Wind Mov",,loop,50
      put "up" into CH_Elevator1
      go to card id 36433
      hide window theMovieName
      exit repeat
      else
      if the sound is "done" then play "SW breakerclose"
      end if
      end if
      soundidle
      end repeat
      put "0,0,48,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
      
      --on skipmoov  -- removed (1.0b8)
      put "up" into CH_Elevator1
      vd
      go to card id 36433
      end skipmoov
  * Card 36433 "" (4 parts)

    on opencard
    elevator
    pass opencard
    end opencard
    
    on elevator
    put "Elevator1.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "MooVMarker","invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end elevator

    * Part 36433:1 "doormarker"
    * Part 36433:3 "opendoor"
      on mouseUp
      HTVisual "wipe left",,the rect of card button doormarker,1,32
      dplay "DR wood open"
      go to card id 84124
      playQT "L2 Wind Mov",,loop,100
      end mouseUp
    * Part 36433:4 "moovmarker"
    * Part 36433:5 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath,quick
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator1Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,48,53" into theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it > 10 then get 10
      put it * 48 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 9 then
      put char 1 to 5 of CH_waterPath into thePath1
      if thePath1 = "10111" then
      --if quick is "true" then  -- removed (1.0b8)
      --  skipmoov  -- removed (1.0b8)
      --  put "down" into CH_Elevator1  -- removed (1.0b8)
      --  exit mousedown  -- removed (1.0b8)
      --else  -- removed (1.0b8)
      put "Elevator1.Moov" into theMovieName
      if there is a window theMovieName then
      play "MR wood Elev Strt"
      play "MR wood Elev Mid" c c c c c c c c c c c c c c c c c c c
      fadeOut
      set the currTime of window theMovieName to "5,20"
      set the endTime of window theMovieName to "10,40"
      show window theMovieName
      set the rate of window theMovieName to "1.0"
      end if
      --end if  -- removed (1.0b8)
      repeat until the rate of window theMovieName is "0.0"
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "MR wood Elev End"
      playQT "L1 Slosh/Run/Motor Mov",,loop,50
      put "down" into CH_Elevator1
      go to card id 83889
      hide window theMovieName
      exit repeat
      else
      if the sound is "done" then play "SW breakerclose"
      end if
      end if
      soundidle
      end repeat
      put "0,0,48,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
      
      --on skipmoov  -- removed (1.0b8)
      put "down" into CH_Elevator1
      vd
      go to card id 83889
      end skipmoov
  * Card 84124 "" (3 parts)
    * Part 84124:1 "closeDoor"
      on mouseUp
      HTVisual "wipe right",,,1,32
      dplay "DR wood shut"
      go to card id 36433
      playQT "L2 Wind Mov",,loop,50
      end mouseUp
    * Part 84124:2 ""
      on mouseUp
      put "Elevator1.Moov" into theMovieName
      if there is a window theMovieName then  close window theMovieName
      go to card id 46447
      playQT "L2 Wind/Ropes Mov",,loop,250
      play "DR wood shut"
      end mouseUp
    * Part 84124:3 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath
      deCurse "override",2004,"color","nodelay"
      put 211 into theStart
      put "Elevator1Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,48,53" into theClip
      repeat until the mouse is up
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it ≥ 9 then
      get 9
      if the sound is "done" then play "SW breakerclose"
      end if
      put it * 48 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      soundidle
      end repeat
      put "0,0,48,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
  * Card 46136 "qel4" (5 parts)

    on opencard
    hide card button "None"
    show card button "opendoor"
    pass opencard
    end opencard

    * Part 46136:1 "right"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 46447
      play "DR wood shut"
      else
      go to card id 46447
      end if
      end mouseUp
    * Part 46136:2 "left"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 46447
      play "DR wood shut"
      else
      go to card id 46447
      end if
      end mouseUp
    * Part 46136:4 "doormarker"
    * Part 46136:3 "opendoor"
      on mouseUp
      put field "pict name" into WhichPict
      play "DR wood open"
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,1,16
      put WhichPict & " Elev (DoorOpen)" into WhichPict
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      htlock forcefalse
      --play stop
      show card button "None"
      hide card button "Opendoor"
      end mouseUp
    * Part 46136:5 "none"
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      vd
      go to card id 96885
      vs "left"
      go to card id 84124
      end mouseUp
  * Card 46447 "" (4 parts)

    on openCard
    global pictAdd,CH_Bridge
    if CH_Bridge is "up" then
    get the rect of card button marker
    put field "pict name" & " (bridge)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 46447:5 "marker"
    * Part 46447:1 "right"
      on mouseUp
      go to card id 46136
      end mouseUp
    * Part 46447:3 ""
      on mouseUp
      go to card id 47569
      end mouseUp
    * Part 46447:4 "left"
      on mouseUp
      go to card id 46136
      end mouseUp
  * Card 47569 "" (4 parts)
    * Part 47569:1 ""
      on mouseUp
      go to card id 47869
      end mouseUp
    * Part 47569:2 ""
      on mouseUp
      go to card id 50393
      end mouseUp
    * Part 47569:3 "left"
      on mouseUp
      go to card id 50725
      end mouseUp
    * Part 47569:4 "right"
      on mouseUp
      go to card id 50725
      end mouseUp
  * Card 47869 "" (3 parts)
    * Part 47869:1 ""
      on mouseUp
      go to card id 47918
      end mouseUp
    * Part 47869:2 ""
      on mouseUp
      go to card id 49884
      end mouseUp
    * Part 47869:3 "left"
      on mouseUp
      go to card id 49611
      end mouseUp
  * Card 47918 "" (3 parts)
    * Part 47918:1 ""
      on mouseUp
      go to card id 48267
      end mouseUp
    * Part 47918:2 "left"
      on mouseUp
      go to card id 49214
      end mouseUp
    * Part 47918:3 "right"
      on mouseUp
      go to card id 49214
      end mouseUp
  * Card 48267 "" (3 parts)
    * Part 48267:1 ""
      on mouseUp
      go to card id 48563
      end mouseUp
    * Part 48267:2 "left"
      on mouseUp
      go to card id 49069
      end mouseUp
    * Part 48267:3 "right"
      on mouseUp
      go to card id 49069
      end mouseUp
  * Card 48563 "" (4 parts)
    * Part 48563:1 "left"
      on mouseUp
      go to card id 48888
      end mouseUp
    * Part 48563:3 "right"
      on mouseUp
      go to card id 48888
      end mouseUp
    * Part 48563:4 ""
    * Part 48563:5 ""
  * Card 48888 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (elev1down)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 48888:4 "marker"
    * Part 48888:1 "left"
      on mouseUp
      go to card id 48563
      end mouseUp
    * Part 48888:2 "right"
      on mouseUp
      go to card id 48563
      end mouseUp
    * Part 48888:3 ""
      on mouseUp
      go to card id 49069
      end mouseUp
  * Card 49069 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (elev1down)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 49069:4 "marker"
    * Part 49069:1 ""
      on mouseUp
      go to card id 49214
      end mouseUp
    * Part 49069:2 "left"
      on mouseUp
      go to card id 48267
      end mouseUp
    * Part 49069:3 "right"
      on mouseUp
      go to card id 48267
      end mouseUp
  * Card 49214 "" (5 parts)
    * Part 49214:1 ""
      on mouseUp
      go to card id 49611
      end mouseUp
    * Part 49214:2 ""
      on mouseUp
      go to card id 49884
      end mouseUp
    * Part 49214:3 ""
      on mouseUp
      go to card id 49884
      end mouseUp
    * Part 49214:4 "left"
      on mouseUp
      go to card id 47918
      end mouseUp
    * Part 49214:5 "right"
      on mouseUp
      go to card id 47918
      end mouseUp
  * Card 49884 "" (3 parts)
    * Part 49884:2 ""
      on mouseUp
      go to card id 50043
      end mouseUp
    * Part 49884:3 "left"
      on mouseUp
      go to card id 50514
      end mouseUp
    * Part 49884:4 ""
      on mouseUp
      go to card id 51081
      end mouseUp
  * Card 51081 "" (3 parts)
    * Part 51081:1 ""
      on mouseUp
      go to card id 51667
      end mouseUp
    * Part 51081:2 "left"
      on mouseUp
      go to card id 51416
      end mouseUp
    * Part 51081:3 "right"
      on mouseUp
      go to card id 51416
      end mouseUp
  * Card 51667 "" (4 parts)
    * Part 51667:1 ""
    * Part 51667:2 "left"
      on mouseUp
      go to card id 51770
      end mouseUp
    * Part 51667:3 "right"
      on mouseUp
      go to card id 51770
      end mouseUp
    * Part 51667:4 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 52119
      end mouseUp
  * Card 52119 "" (4 parts)
    * Part 52119:1 "left"
      on mouseUp
      go to card id 52457
      end mouseUp
    * Part 52119:2 "right"
      on mouseUp
      go to card id 52987
      end mouseUp
    * Part 52119:3 ""
    * Part 52119:4 ""
  * Card 52457 "" (5 parts)
    * Part 52457:1 "right"
      on mouseUp
      go to card id 52119
      end mouseUp
    * Part 52457:2 "left"
      on mouseUp
      go to card id 52658
      end mouseUp
    * Part 52457:3 ""
    * Part 52457:4 ""
    * Part 52457:5 ""
  * Card 52658 "" (6 parts)
    * Part 52658:1 "right"
      on mouseUp
      go to card id 52457
      end mouseUp
    * Part 52658:2 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 51770
      end mouseUp
    * Part 52658:3 "left"
      on mouseUp
      go to card id 52987
      end mouseUp
    * Part 52658:4 ""
    * Part 52658:5 ""
    * Part 52658:6 ""
  * Card 52987 "" (6 parts)
    * Part 52987:1 "right"
      on mouseUp
      go to card id 52658
      end mouseUp
    * Part 52987:2 "left"
      on mouseUp
      go to card id 52119
      end mouseUp
    * Part 52987:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 53051
      end mouseUp
    * Part 52987:4 ""
    * Part 52987:6 ""
    * Part 52987:7 ""
  * Card 53051 "" (3 parts)
    * Part 53051:1 "left"
      on mouseUp
      go to card id 53323
      end mouseUp
    * Part 53051:2 "right"
      on mouseUp
      go to card id 53323
      end mouseUp
    * Part 53051:3 ""
      on mouseUp
      go to card id 53748
      end mouseUp
  * Card 53748 "" (3 parts)
    * Part 53748:1 "left"
      on mouseUp
      go to card id 53916
      end mouseUp
    * Part 53748:2 "right"
      on mouseUp
      go to card id 53916
      end mouseUp
    * Part 53748:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 54235
      end mouseUp
  * Card 54235 "" (8 parts)
    * Part 54235:1 "left"
      on mouseUp
      go to card id 54277
      end mouseUp
    * Part 54235:2 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 57357
      end mouseUp
    * Part 54235:3 "right"
      on mouseUp
      go to card id 54883
      end mouseUp
    * Part 54235:4 ""
    * Part 54235:6 ""
    * Part 54235:7 ""
    * Part 54235:8 ""
    * Part 54235:9 ""
  * Card 57357 "" (3 parts)
    * Part 57357:1 "left"
      on mouseUp
      go to card id 57628
      end mouseUp
    * Part 57357:2 "right"
      on mouseUp
      go to card id 57628
      end mouseUp
    * Part 57357:3 ""
      on mouseUp
      go to card id 57876
      end mouseUp
  * Card 57876 "" (4 parts)
    * Part 57876:1 "left"
      on mouseUp
      go to card id 58150
      end mouseUp
    * Part 57876:2 "right"
      on mouseUp
      go to card id 58150
      end mouseUp
    * Part 57876:3 ""
      on mouseUp
      go to card id 58558
      end mouseUp
    * Part 57876:4 ""
      on mouseUp
      go to card id 59735
      end mouseUp
  * Card 58558 "" (3 parts)
    * Part 58558:1 "left"
      on mouseUp
      go to card id 58828
      end mouseUp
    * Part 58558:2 ""
      on mouseUp
      go to card id 58973
      end mouseUp
    * Part 58558:3 ""
      on mouseUp
      go to card id 59918
      end mouseUp
  * Card 58973 "" (3 parts)
    * Part 58973:1 "left"
      on mouseUp
      go to card id 59359
      end mouseUp
    * Part 58973:2 ""
      on mouseUp
      go to card id 59607
      end mouseUp
    * Part 58973:3 ""
      on mouseUp
      go to card id 66725
      end mouseUp
  * Card 59607 "" (3 parts)
    * Part 59607:1 "left"
      on mouseUp
      go to card id 59735
      end mouseUp
    * Part 59607:2 ""
      on mouseUp
      go to card id 58558
      end mouseUp
    * Part 59607:3 ""
      on mouseUp
      go to card id 58150
      end mouseUp
  * Card 59735 "" (3 parts)
    * Part 59735:1 "right"
      on mouseUp
      go to card id 59607
      end mouseUp
    * Part 59735:2 ""
      on mouseUp
      go to card id 59359
      end mouseUp
    * Part 59735:3 ""
      on mouseUp
      go to card id 66725
      end mouseUp
  * Card 66725 "" (3 parts)
    * Part 66725:1 "left"
      on mouseUp
      go to card id 66921
      end mouseUp
    * Part 66725:2 "right"
      on mouseUp
      go to card id 66921
      end mouseUp
    * Part 66725:3 ""
      on mouseUp
      go to card id 67173
      end mouseUp
  * Card 67173 "" (3 parts)
    * Part 67173:1 "left"
      on mouseUp
      go to card id 67523
      end mouseUp
    * Part 67173:2 "right"
      on mouseUp
      go to card id 67523
      end mouseUp
    * Part 67173:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 67796
      end mouseUp
  * Card 67796 "" (7 parts)
    * Part 67796:1 "left"
      on mouseUp
      go to card id 68021
      end mouseUp
    * Part 67796:2 "right"
      on mouseUp
      go to card id 68522
      end mouseUp
    * Part 67796:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 68852
      end mouseUp
    * Part 67796:4 ""
    * Part 67796:5 ""
    * Part 67796:6 ""
    * Part 67796:7 ""
  * Card 68852 "" (3 parts)
    * Part 68852:1 "left"
      on mouseUp
      go to card id 68871
      end mouseUp
    * Part 68852:2 "right"
      on mouseUp
      go to card id 68871
      end mouseUp
    * Part 68852:3 ""
      on mouseUp
      go to card id 69143
      end mouseUp
  * Card 69143 "" (3 parts)
    * Part 69143:1 "left"
      on mouseUp
      go to card id 69606
      end mouseUp
    * Part 69143:2 "right"
      on mouseUp
      go to card id 69606
      end mouseUp
    * Part 69143:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 69669
      end mouseUp
  * Card 69669 "" (5 parts)
    * Part 69669:1 "left"
      on mouseUp
      go to card id 69937
      end mouseUp
    * Part 69669:2 "right"
      on mouseUp
      go to card id 70615
      end mouseUp
    * Part 69669:3 ""
    * Part 69669:4 ""
    * Part 69669:5 ""
  * Card 69937 "" (3 parts)
    * Part 69937:1 "left"
      on mouseUp
      go to card id 70222
      end mouseUp
    * Part 69937:2 "right"
      on mouseUp
      go to card id 69669
      end mouseUp
    * Part 69937:3 ""
  * Card 70222 "" (3 parts)
    * Part 70222:1 "left"
      on mouseUp
      go to card id 70615
      end mouseUp
    * Part 70222:2 "right"
      on mouseUp
      go to card id 69937
      end mouseUp
    * Part 70222:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 69606
      end mouseUp
  * Card 70615 "" (6 parts)

    on openCard
    global pictAdd,CH_UpperStairs
    if CH_UpperStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (dooropen)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 70615:4 "marker"
    * Part 70615:1 "left"
      on mouseUp
      go to card id 69669
      end mouseUp
    * Part 70615:2 "right"
      on mouseUp
      go to card id 70222
      end mouseUp
    * Part 70615:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 70784
      end mouseUp
    * Part 70615:5 ""
    * Part 70615:6 "qus"
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 70784
      end mouseUp
  * Card 70784 "" (7 parts)

    on openCard
    global pictAdd,CH_UpperStairs,CH_Elevator1
    global CH_WindMoov
    put "V 43-E Windmill.MooV" into CH_WindMoov
    if CH_UpperStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (dooropen)|" & it & return into pictAdd
    end if
    if CH_Elevator1 is "up" then
    get the rect of card button marker2
    put field "pict name" & " (Elev1Up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 70784:6 "marker2"
    * Part 70784:4 "marker"
    * Part 70784:1 "left"
      on mouseUp
      go to card id 71418
      end mouseUp
    * Part 70784:2 "right"
      on mouseUp
      go to card id 71418
      end mouseUp
    * Part 70784:3 ""
      on mouseUp
      go to card id 71489
      end mouseUp
    * Part 70784:5 "moovmarker"
    * Part 70784:7 "qus"
      on mouseUp
      go to card id 71489
      end mouseUp
  * Card 71489 "" (6 parts)

    on openCard
    global pictAdd,CH_UpperStairs,moov
    global CH_WindMoov
    put "V 44-E Windmill.MooV" into CH_WindMoov
    if CH_UpperStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (dooropen)|" & it & return into pictAdd
    end if
    put false into Moov
    pass openCard
    end openCard

    * Part 71489:4 "marker"
    * Part 71489:1 "left"
      on mouseUp
      go to card id 71823
      end mouseUp
    * Part 71489:2 "right"
      on mouseUp
      go to card id 71823
      end mouseUp
    * Part 71489:3 ""
      on mouseUp
      go to card id 72009
      end mouseUp
    * Part 71489:5 "moovmarker"
    * Part 71489:6 "qus"
      on mouseUp
      go to card id 72009
      end mouseUp
  * Card 72009 "" (5 parts)

    on openCard
    global pictAdd,CH_UpperStairs,CH_WindMoov
    put "Village 45-E Windmill.Moov2" into CH_WindMoov
    
    if CH_UpperStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (dooropen)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 72009:4 "marker"
    * Part 72009:1 "left"
      on mouseUp
      go to card id 72353
      end mouseUp
    * Part 72009:2 "right"
      on mouseUp
      go to card id 72353
      end mouseUp
    * Part 72009:3 ""
      on mouseUp
      go to card id 72506
      end mouseUp
    * Part 72009:5 "moovmarker"
  * Card 72506 "qus" (10 parts)

    on openCard
    global pictAdd,CH_UpperStairs
    if CH_UpperStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (DoorOpen)|" & it & return into pictAdd
    show card button "climbstairs"
    else
    Hide card button "climbStairs"
    end if
    hide card button "EnterElevator"
    show card button "OpenElevator"
    hide card button "CloseElevator"
    playqt "L2 Wind/Ropes MoV","","loop","250"
    pass openCard
    end openCard

    * Part 72506:7 "doormarker"
    * Part 72506:6 "marker"
    * Part 72506:1 "left"
      on mouseUp
      put empty into temp
      if the visible of card button "openElevator" is "false" then
      put "false" into  temp
      end if
      go to card id 72768
      if temp is "false" then
      play "cdoorsqueak2"
      wait 30
      play stop
      play "dr door close"
      end if
      
      end mouseUp
    * Part 72506:2 "right"
      on mouseUp
      put empty into temp
      if the visible of card button "openElevator" is "false" then
      put "false" into  temp
      end if
      go to card id 72768
      if temp is "false" then
      play "cdoorsqueak2"
      wait 30
      play stop
      play "dr door close"
      end if
      
      end mouseUp
    * Part 72506:3 ""
      on mouseUp
      play "DR Gate Not"
      end mouseUp
    * Part 72506:4 "enterElevator"
      on mouseUp
      playqt "L2 wind Mov",,loop,100
      go to card id 97270
      vs left
      go to card id 84244
      end mouseUp
    * Part 72506:8 "OpenElevator"
      on mouseUp
      play "DR wood open"
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,1,16
      put "Village 46-E Elev (doorOpen)" into WhichPict
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      htlock forcefalse
      play stop
      show card button "closeElevator"
      show card button "EnterElevator"
      hide card button "OpenElevator"
      end mouseUp
    * Part 72506:9 "closeElevator"
      on mouseUp
      htlock true
      HTVisual "wipe left",,the rect of card button doormarker,1,32
      play "DR wood shut"
      opencard
      htlock forcefalse
      
      
      end mouseUp
    * Part 72506:12 "climbstairs"
      on mouseUp
      global pictAdd,CH_UpperStairs
      if CH_UpperStairs is "open" then
      put empty into temp
      if the visible of card button "openElevator" is "false" then
      put "false" into  temp
      end if
      go to card id 76263
      if temp is "false" then play "DR wood shut"
      end if
      end mouseUp
    * Part 72506:13 "up"
      on mouseUp
      go to card id 100536
      end mouseUp
  * Card 100536 "" (1 parts)
    * Part 100536:1 "down"
      on mouseUp
      go to card id 72506
      end mouseUp
  * Card 97270 "" (0 parts)
  * Card 84244 "" (3 parts)
    * Part 84244:1 "leave elevator"
      on mouseUp
      playqt "L2 Wind Mov",,loop,200
      put "Elevator2.Moov" into theMovieName
      htlock true
      if there is a window theMovieName then  close window theMovieName
      go to card id 72768
      play "DR wood shut"
      wait 20
      --play stop
      --play "dr door close"
      end mouseUp
    * Part 84244:2 "CloseDoor"
      on mouseUp
      dplay "DR wood shut"
      HTVisual "wipe right",,,1,32
      playQT "L2 Wind Mov",,loop,50
      go to card id 84711
      end mouseUp
    * Part 84244:3 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath
      deCurse "override",2004,"color","nodelay"
      put 228 into theStart
      put "Elevator2Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,52,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it ≥ 9 then
      get 9
      if the sound is "done" then play "SW breakerclose"
      end if
      put it * 52 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      
      end repeat
      play stop
      put "0,0,52,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
  * Card 84711 "" (3 parts)

    on opencard
    setmovie
    pass opencard
    end opencard
    
    on setmovie
    put "Elevator2.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "MooVMarker","invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end setmovie

    * Part 84711:2 "openDoor"
      on mouseUp
      playqt "L2 Wind Mov",,loop,100
      dplay "DR wood open"
      HTVisual "wipe left",,,1,32
      go to card id 84244
      play stop
      end mouseUp
    * Part 84711:4 "moovmarker"
    * Part 84711:5 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath,quick
      deCurse "override",2004,"color","nodelay"
      put 226 into theStart
      put "Elevator2Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,52,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it > 10 then get 10
      put it * 52 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 9 then
      put char 1 to 2 of CH_waterPath into thePath
      if thePath = "11" then
      --if quick is "true" then  -- removed (1.0b8)
      --  skipmoov  -- removed (1.0b8)
      --  exit mousedown  -- removed (1.0b8)
      --else  -- removed (1.0b8)
      hc
      put "Elevator2.Moov" into theMovieName
      if there is a window theMovieName then
      play "MR wood Elev Strt"
      play "MR wood Elev Mid" c c c c c c c c c c
      fadeOut
      set the currTime of window theMovieName to "0"
      set the endTime of window theMovieName to "4,35"
      show window theMovieName
      set the rate of window theMovieName to "1"
      end if
      -- end if  -- removed (1.0b8)
      repeat until the rate of window theMovieName is "0.0"
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "MR wood Elev End"
      playQT "L3 Wind Mov",,loop,50
      set the currTime of window theMovieName to "4,35"
      go to card id 84808
      hide window theMovieName
      exit repeat
      else
      if the sound is "done" then play "SW breakerclose"
      end if
      end if
      end repeat
      put "0,0,52,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
      
      --on skipmoov  -- removed (1.0b8)
      vd
      go to card id 84808
      end skipmoov
  * Card 84808 "" (3 parts)

    on opencard
    setmovie
    pass opencard
    end opencard
    
    on setmovie
    put "Elevator2.MooV" into TheMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button "MooVMarker","invisible","Floating"
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end setmovie

    * Part 84808:2 ""
      on mouseUp
      playqt "L3 Wind Mov",,loop,100
      dplay "DR Wood Open"
      HTVisual "wipe left",,,1,32
      go to card id 85222
      play stop
      
      end mouseUp
    * Part 84808:3 "moovmarker"
    * Part 84808:4 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath,quick
      deCurse "override",2004,"color","nodelay"
      put 228 into theStart
      put "Elevator2Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,52,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it > 11 then get 11
      put it * 52 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 10 then
      put char 1 to 2 of CH_waterPath into thePath
      if thePath = "11" then
      --if quick is "true" then  -- removed (1.0b8)
      --  skipmoov  -- removed (1.0b8)
      --  exit mousedown  -- removed (1.0b8)
      -- else  -- removed (1.0b8)
      hc
      put "Elevator2.Moov" into theMovieName
      if there is a window theMovieName then
      play "MR wood Elev Strt"
      play "MR wood Elev Mid" c c c c c c c c c c
      fadeOut
      set the currTime of window theMovieName to "4,35"
      set the endTime of window theMovieName to "9,15"
      show window theMovieName
      set the rate of window theMovieName to "1"
      end if
      --end if  -- removed (1.0b8)
      repeat until the rate of window theMovieName is "0.0"
      send movieIdle to window theMovieName
      end repeat
      play stop
      play "MR wood Elev End"
      playQT "L2 Wind Mov",,loop,50
      go to card id 84711
      hide window theMovieName
      end if
      exit repeat
      end if
      end repeat
      put "0,0,52,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
      
      --on skipmoov  -- removed (1.0b8)
      vd
      go to card id 84711
      end skipmoov
  * Card 85222 "" (3 parts)
    * Part 85222:1 ""
      on mouseUp
      playqt "L3 Wind Mov",,loop,50
      dplay "DR Wood Shut"
      HTVisual "wipe right",,,1,32
      go to card id 84808
      end mouseUp
    * Part 85222:2 ""
      on mouseUp
      put "Elevator2.Moov" into theMovieName
      htlock true
      if there is a window theMovieName then  close window theMovieName
      go to card id 76503
      play "DR Wood Shut"
      end mouseUp
    * Part 85222:3 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      global CH_Elevator1,CH_waterPath
      deCurse "override",2004,"color","nodelay"
      put 228 into theStart
      put "Elevator2Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,52,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 7
      if it < 0 then get 0
      if it ≥ 9 then
      get 9
      if the sound is "done" then play "SW breakerClose"
      end if
      put it * 52 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      end repeat
      play stop
      put "0,0,52,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
  * Card 76503 "qhi" (4 parts)

    on opencard
    playqt "l3 wind mov","","loop","250"
    pass opencard
    end opencard

    * Part 76503:1 "left"
      on mouseUp
      go to card id 76659
      end mouseUp
    * Part 76503:2 "right"
      on mouseUp
      go to card id 76659
      end mouseUp
    * Part 76503:3 ""
      on mouseUp
      go to card id 78451
      end mouseUp
    * Part 76503:4 "qtmp"
      on mouseUp
      go to card id 78451
      end mouseUp
  * Card 78451 "" (4 parts)
    * Part 78451:2 "left"
      on mouseUp
      go to card id 78770
      end mouseUp
    * Part 78451:3 "right"
      on mouseUp
      go to card id 78770
      end mouseUp
    * Part 78451:4 ""
      on mouseUp
      go to card id 78886
      end mouseUp
    * Part 78451:5 "qtmp left"
      on mouseUp
      go to card id 78770
      end mouseUp
  * Card 78886 "" (5 parts)
    * Part 78886:1 "left"
      on mouseUp
      go to card id 79112
      end mouseUp
    * Part 78886:2 "right"
      on mouseUp
      go to card id 79112
      end mouseUp
    * Part 78886:3 ""
      on mouseUp
      go to card id 79496
      end mouseUp
    * Part 78886:4 "qtmp left"
      on mouseUp
      go to card id 79112
      end mouseUp
    * Part 78886:6 "qach"
      on mouseUp
      go to card id 79496
      end mouseUp
  * Card 79496 "" (5 parts)
    * Part 79496:1 "left"
      on mouseUp
      go to card id 79664
      end mouseUp
    * Part 79496:2 "right"
      on mouseUp
      go to card id 79664
      end mouseUp
    * Part 79496:3 ""
      on mouseUp
      go to card id 80159
      end mouseUp
    * Part 79496:5 "qtmp"
      on mouseUp
      go to card id 80159
      end mouseUp
    * Part 79496:6 "qach right"
      on mouseUp
      go to card id 79664
      end mouseUp
  * Card 80159 "" (5 parts)

    on mouseUp
    
    HTAddPict "Village High 8-w corr.", the rect of card button marker, "Srccopy"
    end mouseUp

    * Part 80159:1 "left"
      on mouseUp
      go to card id 80103
      end mouseUp
    * Part 80159:2 "right"
      on mouseUp
      go to card id 80103
      end mouseUp
    * Part 80159:3 ""
      on mouseUp
      go to card id 80492
      end mouseUp
    * Part 80159:5 "qtmp"
      on mouseUp
      go to card id 80492
      end mouseUp
    * Part 80159:7 "qach right"
      on mouseUp
      go to card id 80103
      end mouseUp
  * Card 80492 "qtmp" (9 parts)

    on opencard
    playqt "l3 wind mov","","loop","250"
    pass opencard
    end opencard

    * Part 80492:9 "gatemarker"
    * Part 80492:5 "marker"
    * Part 80492:1 "left"
      on mouseUp
      go to card id 80720
      end mouseUp
    * Part 80492:2 "right"
      on mouseUp
      go to card id 80720
      end mouseUp
    * Part 80492:4 ""
      on mouseUp
      go to card id 81100
      end mouseUp
    * Part 80492:7 "enterTemple"
      on mouseUp
      go to card id 92144
      end mouseUp
    * Part 80492:8 "closegate"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      play stop
      play "DR Steel close"
      HTVisual "wipe left",,the rect of card button gatemarker,1,16
      put WhichPict & " (GateClsd)" into WhichPict
      HTAddPict WhichPict, the rect of card button gatemarker, "Srccopy"
      htlock forcefalse
      play "DR Steel open"
      wait 10
      HTVisual "wipe right",,the rect of card button gatemarker,1,16
      opencard
      htlock forcefalse
      end mouseUp
    * Part 80492:10 ""
      on mouseUp
      go to card id 46979
      end mouseUp
    * Part 80492:11 "qach"
      on mouseUp
      go to card id 81100
      end mouseUp
  * Card 46979 "" (6 parts)

    on opencard
    show card button "opendoor"
    hide card button "entertemple"
    pass opencard
    end opencard

    * Part 46979:2 "left"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 80720
      play "DR Metal Close"
      else
      go to card id 80720
      end if
      end mouseUp
    * Part 46979:3 "doormarker"
    * Part 46979:4 "enterTemple"
      on mouseUp
      global CH_Monitor
      if CH_Monitor is empty then put 1 into CH_Monitor
      set cursor to none
      go to card id 92144
      set cursor to none
      --close door
      fadeout
      play "DR Metal Close"
      LoadMoov CH_Monitor
      go to card id 101458
      set cursor to none
      put empty into theLoc
      if there is a window "holo" then
      set the rate of window "holo" to "1.0"
      show window "holo"
      set cursor to hand
      repeat until the rate of window "holo" is "0.0"
      send movieidle to window "holo"
      if the mouseclick then
      put the clickLoc into theLoc
      hide window "holo"
      exit repeat
      end if
      end repeat
      close window "holo"
      end if
      go to card id 92144
      if theLoc is not empty then click at theLoc
      playqt "MU ChannelTemple.Mov",fadein,loop,200
      end mouseUp
      
      
      on LoadMoov which
      if which is 1 then
      put "Holo-ALaugh.Moov" into theMovieName
      put "139,65" into MooVLoc
      end if
      if which is 2 then
      put "Holo-AMouth.Moov" into theMovieName
      put "127,74" into MooVLoc
      end if
      if which is 3 then
      put "Holo-ASirrus.Moov" into theMovieName
      put "139,65" into MooVLoc
      end if
      if which is 4 then
      put "Holo-SMessage.Moov" into theMovieName
      put "126,74" into MooVLoc
      end if
      if there is not a window TheMovieName then
      Movie TheMovieName,"borderless",MooVLoc,"invisible","Floating"
      end if
      if there is a window TheMovieName then
      set the dontErase of window TheMovieName to true
      set the movieCursorID of window theMovieName to 128
      set the audioLevel of window TheMovieName to "256"
      set the mute of window TheMovieName to false
      set the badge of window TheMovieName to false
      set the controllerVisible of window TheMovieName to false
      set the useCustomClut of window theMovieName to false
      set the closeOnFinish of window TheMovieName to false
      set the loop of window TheMovieName to false
      set the seeAllFrames of window TheMovieName to false
      set the startTime of window TheMovieName to "0"
      --set the endTime of window TheMovieName to "2,240"
      --set the callBackMsg of window theMovieName to "Done"
      set the passMovieClick of window theMovieName to false
      set the rate of window TheMovieName to "0.0"
      set the windowname of window theMovieName to "holo"
      end if
      end loadMoov
    * Part 46979:5 "none"
      on mouseUp
      htlock true
      htvisual "wipe left",,the rect of card button "doormarker",1,16
      dplay "DR metal close"
      opencard
      end mouseUp
    * Part 46979:1 "opendoor"
      on mouseUp
      global CH_Temple
      put "open" into CH_Temple
      put field "pict name" into whichpict
      htlock true
      htvisual "wipe right",,the rect of card button "doormarker",1,16
      HTAddPict whichpict & " (Open)",the rect of card button "doormarker","srccopy"
      play "DR Metal Open"
      htlock forcefalse
      hide card button "opendoor"
      show card button "enterTemple"
      end mouseUp
    * Part 46979:6 "right"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 81100
      play "DR Metal Close"
      else
      go to card id 81100
      end if
      end mouseUp
  * Card 81100 "" (4 parts)
    * Part 81100:1 "left"
      on mouseUp
      go to card id 81254
      end mouseUp
    * Part 81100:2 "right"
      on mouseUp
      go to card id 81254
      end mouseUp
    * Part 81100:3 ""
      on mouseUp
      go to card id 81740
      end mouseUp
    * Part 81100:4 "qach"
      on mouseUp
      go to card id 81740
      end mouseUp
  * Card 81740 "" (3 parts)
    * Part 81740:1 "left"
      on mouseUp
      go to card id 81586
      end mouseUp
    * Part 81740:2 ""
      on mouseUp
      go to card id 82060
      end mouseUp
    * Part 81740:3 ""
      on mouseUp
      go to card id 82639
      end mouseUp
  * Card 82060 "qtmp2" (3 parts)

    on opencard
    playqt "l3 wind mov","","loop","250"
    pass opencard
    end opencard

    * Part 82060:1 "left"
      on mouseUp
      go to card id 82376
      end mouseUp
    * Part 82060:2 "right"
      on mouseUp
      go to card id 82376
      end mouseUp
    * Part 82060:3 ""
      on mouseUp
      go to card id 88905
      playqt "MU ChannelTemple.Mov",fadein,loop,30
      end mouseUp
  * Card 88905 "" (3 parts)
    * Part 88905:1 ""
      on mouseUp
      go to card id 89220
      end mouseUp
    * Part 88905:2 "right"
      on mouseUp
      go to card id 89220
      end mouseUp
    * Part 88905:3 ""
      on mouseUp
      go to card id 89440
      playqt "MU ChannelTemple.Mov",fadein,loop,50
      end mouseUp
  * Card 89440 "" (4 parts)
    * Part 89440:1 "left"
      on mouseUp
      go to card id 89646
      end mouseUp
    * Part 89440:2 "right"
      on mouseUp
      go to card id 89646
      end mouseUp
    * Part 89440:3 "right"
      on mouseUp
      go to card id 89646
      end mouseUp
    * Part 89440:4 ""
      on mouseUp
      go to card id 100130
      playqt "MU ChannelTemple.Mov",fadein,loop,200
      end mouseUp
  * Card 90018 "" (2 parts)
    * Part 90018:1 "right"
      on mouseUp
      go to card id 90255
      end mouseUp
    * Part 90018:2 "left"
      on mouseUp
      go to card id 100130
      end mouseUp
  * Card 100130 "" (4 parts)
    * Part 100130:1 "right"
      on mouseUp
      go to card id 90018
      end mouseUp
    * Part 100130:2 "left"
      on mouseUp
      go to card id 90543
      end mouseUp
    * Part 100130:3 ""
      on mouseUp
      go to card id 100047
      end mouseUp
    * Part 100130:4 ""
      on mouseUp
      go to card id 99650
      end mouseUp
  * Card 90543 "" (3 parts)
    * Part 90543:1 "left"
      on mouseUp
      go to card id 90255
      end mouseUp
    * Part 90543:2 "right"
      on mouseUp
      go to card id 100130
      end mouseUp
    * Part 90543:3 ""
      on mouseUp
      go to card id 90873
      end mouseUp
  * Card 90873 "" (2 parts)
    * Part 90873:1 "left"
      on mouseUp
      go to card id 91011
      end mouseUp
    * Part 90873:2 "right"
      on mouseUp
      go to card id 100047
      end mouseUp
  * Card 100047 "" (3 parts)
    * Part 100047:1 "left"
      on mouseUp
      go to card id 90873
      end mouseUp
    * Part 100047:2 "right"
      on mouseUp
      go to card id 91011
      end mouseUp
    * Part 100047:3 ""
      on mouseUp
      global ch_temple
      put "closed" into ch_temple
      go to card id 91766
      end mouseUp
  * Card 91261 "" (3 parts)
    * Part 91261:1 "left"
      on mouseUp
      go to card id 99650
      end mouseUp
    * Part 91261:5 "right"
      on mouseUp
      go to card id 101349
      end mouseUp
    * Part 91261:4 "right"
      on mouseUp
      go to card id 101349
      end mouseUp
  * Card 99650 "" (3 parts)
    * Part 99650:1 "right"
      on mouseUp
      go to card id 91261
      end mouseUp
    * Part 99650:2 "left"
      on mouseUp
      go to card id 91455
      end mouseUp
    * Part 99650:3 ""
      on mouseUp
      go to card id 91766
      end mouseUp
  * Card 91455 "" (3 parts)
    * Part 91455:1 "left"
      on mouseUp
      go to card id 101349
      end mouseUp
    * Part 91455:2 ""
      on mouseUp
      go to card id 90873
      end mouseUp
    * Part 91455:3 "right"
      on mouseUp
      go to card id 99650
      end mouseUp
  * Card 91766 "" (4 parts)

    on openCard
    global pictAdd,CH_Temple
    put "Temple 1-E" into fld "pict name"
    if CH_Temple is not "closed" then
    hide card button "opendoor"
    show card button "exittemple"
    else
    put " (Doorclsd)" after fld "pict name"
    hide card button "exitTemple"
    show card button "opendoor"
    end if
    pass openCard
    end openCard

    * Part 91766:1 "right"
      on mouseUp
      global CH_Temple
      go to card id 99487
      if CH_Temple is not "closed" then
      play "DR Metal Close"
      put "closed" into CH_Temple
      end if
      end mouseUp
    * Part 91766:2 "left"
      on mouseUp
      global CH_Temple
      go to card id 99317
      if CH_Temple is not "closed" then
      play "DR Metal Close"
      put "closed" into CH_Temple
      end if
      end mouseUp
    * Part 91766:3 "ExitTemple"
      on mouseUp
      go to card id 80720
      play stop
      play "DR Metal Close"
      playqt "L3 Wind Mov",,loop,250
      end mouseUp
    * Part 91766:5 "opendoor"
      on mouseUp
      global CH_Temple
      put "open" into CH_Temple
      play "DR Metal Open"
      htvisual "wipe left",,,1,32
      opencard
      end mouseUp
  * Card 99487 "" (3 parts)
    * Part 99487:1 "left"
      on mouseUp
      go to card id 91766
      end mouseUp
    * Part 99487:2 "right"
      on mouseUp
      go to card id 92144
      end mouseUp
    * Part 99487:3 ""
      on mouseUp
      go to card id 91261
      end mouseUp
  * Card 92144 "" (6 parts)

    on opencard
    global CH_Temple
    put "closed" into CH_Temple
    
    pass opencard
    end opencard

    * Part 92144:7 "moovmarker"
    * Part 92144:1 "left"
      on mouseUp
      go to card id 99487
      end mouseUp
    * Part 92144:2 "right"
      on mouseUp
      go to card id 99317
      end mouseUp
    * Part 92144:3 ""
      on mouseUp
      go to card id 91261
      end mouseUp
    * Part 92144:4 ""
      on mouseUp
      go to card id 91011
      end mouseUp
    * Part 92144:6 ""
      on mouseUp
      go to card id 101349
      end mouseUp
  * Card 101458 "" (0 parts)
  * Card 101349 "" (5 parts)

    on Opencard
    altar
    pass opencard
    end opencard
    
    on closecard
    htlock true
    put "Temple Alter.Moov" into theMovieName
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closecard
    end closecard
    
    
    on altar
    put "Temple Alter.Moov" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "255"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    end if
    end altar

    * Part 101349:1 "left"
      on mouseUp
      go to card id 91261
      end mouseUp
    * Part 101349:2 "right"
      on mouseUp
      go to card id 91455
      end mouseUp
    * Part 101349:4 "moovmarker"
    * Part 101349:3 ""
      on mouseUp
      set cursor to none
      put "Temple Alter.Moov" into TheMovieName
      soundPause
      set the rate of window theMovieName to "1.0"
      show window TheMovieName
      repeat until the rate of window theMovieName is "0"
      send movieidle to window theMovieName
      end repeat
      soundStart
      play stop
      hide window theMovieName
      end mouseUp
    * Part 101349:5 ""
      on mouseUp
      go to card id 90255
      end mouseUp
  * Card 99317 "" (3 parts)
    * Part 99317:1 ""
      on mouseUp
      go to card id 90873
      end mouseUp
    * Part 99317:2 "left"
      on mouseUp
      go to card id 92144
      end mouseUp
    * Part 99317:3 "right"
      on mouseUp
      go to card id 91766
      end mouseUp
  * Card 91011 "" (5 parts)
    * Part 91011:1 "right"
      on mouseUp
      go to card id 90873
      end mouseUp
    * Part 91011:2 ""
      on mouseUp
      go to card id 90255
      end mouseUp
    * Part 91011:3 "left"
      on mouseUp
      go to card id 100047
      end mouseUp
    * Part 91011:4 ""
      on mouseUp
      go to card id 91261
      end mouseUp
    * Part 91011:5 ""
      on mouseUp
      go to card id 90018
      end mouseUp
  * Card 90255 "" (3 parts)
    * Part 90255:1 ""
      on mouseUp
      go to card id 46695
      set cursor to none
      vs "left"
      go to card id 89646
      set cursor to none
      playqt "MU ChannelTemple.Mov",fadein,loop,50
      end mouseUp
    * Part 90255:2 "left"
      on mouseUp
      go to card id 90018
      end mouseUp
    * Part 90255:3 "right"
      on mouseUp
      go to card id 90543
      end mouseUp
  * Card 46695 "" (0 parts)
  * Card 89646 "" (3 parts)
    * Part 89646:1 "left"
      on mouseUp
      go to card id 89440
      end mouseUp
    * Part 89646:2 "right"
      on mouseUp
      go to card id 89440
      end mouseUp
    * Part 89646:3 ""
      on mouseUp
      go to card id 89220
      playqt "MU ChannelTemple.Mov",fadein,loop,30
      end mouseUp
  * Card 89220 "" (3 parts)
    * Part 89220:1 "left"
      on mouseUp
      go to card id 88905
      end mouseUp
    * Part 89220:2 "right"
      on mouseUp
      go to card id 88905
      end mouseUp
    * Part 89220:3 ""
      on mouseUp
      go to card id 82376
      playqt "l3 wind mov",,loop,250
      end mouseUp
  * Card 82376 "" (4 parts)

    on openCard
    global CH_WindMoov
    put "VH 12-N Windmill.MooV" into CH_WindMoov
    pass openCard
    end openCard
    on mousedowninmovie
    click at the clickloc
    end mousedowninmovie

    * Part 82376:1 "right"
      on mouseUp
      go to card id 82060
      end mouseUp
    * Part 82376:3 ""
      on mouseUp
      go to card id 82639
      end mouseUp
    * Part 82376:6 "moovmarker"
    * Part 82376:2 ""
      on mouseUp
      go to card id 81586
      end mouseUp
  * Card 82639 "" (3 parts)
    * Part 82639:1 "left"
      on mouseUp
      go to card id 82793
      end mouseUp
    * Part 82639:2 "right"
      on mouseUp
      go to card id 82793
      end mouseUp
    * Part 82639:3 ""
      on mouseUp
      go to card id 83143
      end mouseUp
  * Card 83143 "qach" (9 parts)

    on opencard
    show button "openDoor"
    hide card button "closeDoor1"
    hide card button "closeDoor2"
    hide card button "enterHut"
    playqt "l3 wind mov","","loop","250"
    pass opencard
    end opencard

    * Part 83143:9 "doormarker"
    * Part 83143:8 "doorMarker2"
    * Part 83143:4 "doormarker1"
    * Part 83143:1 "left"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 83255
      fadeout
      play "DR wood shut"
      playqt "l3 wind mov",fadein,loop,250
      else
      go to card id 83255
      end if
      end mouseUp
    * Part 83143:2 "right"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 83255
      fadeout
      play "DR wood shut"
      playqt "l3 wind mov",fadein,loop,250
      else
      go to card id 83255
      end if
      end mouseUp
    * Part 83143:3 "opendoor"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      put WhichPict & " (DoorOpen)" into WhichPict
      htvisual "wipe right",,the rect of card button doormarker2,1,16
      htvisual "wipe left",,the rect of card button doormarker1,1,16
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "DR wood open"
      htlock forcefalse
      playqt "MU ChannelAchenar.Mov",fadein,loop,50
      hide card button "opendoor"
      show card button "closedoor1"
      show card button "closedoor2"
      show card button "enterHut"
      end mouseUp
    * Part 83143:5 "closedoor1"
      on mouseUp
      
      htlock true
      htvisual "wipe right",,the rect of card button doormarker1,1,16
      htvisual "wipe left",,the rect of card button doormarker2,1,16
      dplay "DR wood shut"
      opencard
      playqt "l3 wind mov",fadein,loop,250
      end mouseUp
    * Part 83143:6 "closedoor2"
      on mouseUp
      htlock true
      htvisual "wipe left",,the rect of card button doormarker2,1,16
      htvisual "wipe right",,the rect of card button doormarker1,1,16
      opencard
      fadeout
      play "DR wood shut"
      htlock forcefalse
      playqt "l3 wind mov",fadein,loop,250
      end mouseUp
    * Part 83143:7 "enterHut"
      on mouseUp
      go to card id 87805
      playqt "MU ChannelAchenar.Mov",fadein,loop,200
      end mouseUp
  * Card 87805 "" (2 parts)
    * Part 87805:1 "right"
      on mouseUp
      go to card id 87864
      end mouseUp
    * Part 87805:3 "left"
      on mouseUp
      go to card id 88498
      end mouseUp
  * Card 87864 "" (2 parts)
    * Part 87864:1 "right"
      on mouseUp
      go to card id 88272
      end mouseUp
    * Part 87864:2 "left"
      on mouseUp
      go to card id 87805
      end mouseUp
  * Card 88272 "" (4 parts)

    on openCard
    global pictAdd,ALL_Page,MY_BlueBook
    if item 1 to 2 of ALL_Page is "5,A"  or char 5 of MY_BlueBook = 1 then
    put field "pict name" & " (noPage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 88272:4 "marker"
    * Part 88272:1 "right"
      on mouseUp
      go to card id 88498
      end mouseUp
    * Part 88272:2 "left"
      on mouseUp
      go to card id 87864
      end mouseUp
    * Part 88272:3 ""
      on mouseUp
      set cursor to none
      go to card id 83255
      fadeout
      play "DR wood shut"
      playqt "l3 wind mov",,loop,250
      end mouseUp
  * Card 88498 "" (4 parts)

    on openCard
    global pictAdd,ALL_Page,MY_BlueBook
    if item 1 to 2 of ALL_Page is "5,A"  or char 5 of MY_BlueBook = 1 then
    put field "pict name" & " (noPage)|" & the rect ¬
    of card button Marker into pictAdd
    end if
    pass openCard
    end openCard

    * Part 88498:5 "marker"
    * Part 88498:1 "right"
      on mouseUp
      go to card id 87805
      end mouseUp
    * Part 88498:2 "left"
      on mouseUp
      go to card id 88272
      end mouseUp
    * Part 88498:4 "monitor"
      on mouseUp
      global CH_Monitor
      if CH_Monitor is empty then put 3 into CH_Monitor
      go to card id 88814
      playqt "MU ChannelAchenar.Mov",fadein,loop,50
      end mouseUp
  * Card 88814 "" (9 parts)

    on openCard
    global pictAdd,ALL_Page,MY_BlueBook,CH_Monitor
    if item 1 to 2 of ALL_Page is "5,A"  or char 5 of MY_BlueBook = 1 then
    put field "pict name" & " (noPage)|" & the rect ¬
    of card button Marker & return into pictAdd
    end if
    put "Achenar Button" & CH_Monitor &"|" & the rect of ¬
    card button "ButtonMarker" after Pictadd
    if there is not a window "monitor" then LoadMooV CH_Monitor
    pass openCard
    end openCard
    
    on closecard
    htlock true
    put "monitor" into theMovieName
    if there is a window TheMovieName then
    close window TheMovieName
    end if
    pass closecard
    end closecard
    
    on LoadMoov which
    if which is 1 then put "Mon-ALaugh.Moov" into theMovieName
    if which is 2 then put "Mon-AMouth.Moov" into theMovieName
    if which is 3 then put "Mon-ASirrus.Moov" into theMovieName
    if which is 4 then put "Mon-SMessage.Moov" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button mooVMarker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "256"
    set the mute of window TheMovieName to false
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    set the windowname of window theMovieName to "Monitor"
    end if
    end loadMoov

    * Part 88814:1 ""
      on mouseUp
      if there is a window "monitors" then close window "monitors"
      go to card id 88498
      playqt "MU ChannelAchenar.Mov",fadein,loop,200
      end mouseUp
    * Part 88814:2 ""
    * Part 88814:3 "marker"
      on MouseDown
      global MY_BlueBook,ALL_Page
      if char 5 of MY_BlueBook is "0" then
      if char 1 to 3 of ALL_Page is not "5,A" then
      if All_Page is not empty then dropPage
      put "5,A,0" into ALL_Page
      htlock true
      opencard
      else
      put empty into ALL_Page
      UpdateCursor
      htlock true
      opencard
      end if
      end if
      dropState
      end MouseDown
    * Part 88814:4 "moovmarker"
    * Part 88814:10 "buttonmarker"
    * Part 88814:5 ""
      on mouseUp
      global CH_Monitor
      HTAddPict "Achenar Button1", the rect of card button "ButtonMarker", "Srccopy"
      if CH_Monitor is 1 then
      if there is a window "monitor" then
      fadeout
      set the rate of window "monitor" to "1.0"
      show window "monitor"
      end if
      else
      put 1 into CH_Monitor
      if there is a window "monitor" then
      set the rate of window "monitor" to "0.0"
      set the windowRect of window "monitor" to the rect of card button "moovmarker"
      set the movie of window "monitor" to "Mon-ALaugh.Moov"
      set the currTime of window "monitor" to "0"
      fadeout
      set the rate of window "monitor" to 1
      show window "monitor"
      end if
      end if
      
      end mouseUp
    * Part 88814:6 ""
      on mouseUp
      global CH_Monitor
      HTAddPict "Achenar Button2", the rect of card button "ButtonMarker", "Srccopy"
      set cursor to none
      if CH_Monitor is 2 then
      if there is a window "monitor" then
      fadeout
      set the rate of window "monitor" to "1.0"
      show window "monitor"
      end if
      else
      put 2 into CH_Monitor
      if there is a window "monitor" then
      set the rate of window "monitor" to "0.0"
      set the windowRect of window "monitor" to the rect of card button "moovmarker"
      set the movie of window "monitor" to "Mon-AMouth.Moov"
      set the currTime of window "monitor" to "0"
      fadeout
      set the rate of window "monitor" to 1
      show window "monitor"
      end if
      end if
      end mouseUp
    * Part 88814:7 ""
      on mouseUp
      global CH_Monitor
      HTAddPict "Achenar Button3", the rect of card button "ButtonMarker", "Srccopy"
      set cursor to none
      if CH_Monitor is 3 then
      if there is a window "monitor" then
      fadeout
      set the rate of window "monitor" to "1.0"
      show window "monitor"
      end if
      else
      put 3 into CH_Monitor
      if there is a window "monitor" then
      set the rate of window "monitor" to "0.0"
      set the windowRect of window "monitor" to the rect of card button "moovmarker"
      set the movie of window "monitor" to "Mon-ASirrus.Moov"
      set the currTime of window "monitor" to "0"
      fadeout
      set the rate of window "monitor" to 1
      show window "monitor"
      end if
      end if
      end mouseUp
    * Part 88814:8 ""
      on mouseUp
      global CH_Monitor
      HTAddPict "Achenar Button4", the rect of card button "ButtonMarker", "Srccopy"
      set cursor to none
      if CH_Monitor is 4 then
      if there is a window "monitor" then
      fadeout
      set the rate of window "monitor" to "1.0"
      show window "monitor"
      end if
      else
      put 4 into CH_Monitor
      if there is a window "monitor" then
      set the rate of window "monitor" to "0.0"
      set the windowRect of window "monitor" to the rect of card button "moovmarker"
      set the movie of window "monitor" to "Mon-SMessage.Moov"
      set the currTime of window "monitor" to "0"
      fadeout
      set the rate of window "monitor" to 1
      show window "monitor"
      end if
      end if
      end mouseUp
  * Card 83255 "" (8 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_UpperStairs
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (elev1down)|" & it & return into pictAdd
    end if
    if CH_UpperStairs is "closed" then
    get the rect of card button marker2
    put field "pict name" & " (stairsclosed)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 83255:5 "marker2"
    * Part 83255:4 "marker"
    * Part 83255:1 "left"
      on mouseUp
      go to card id 83143
      end mouseUp
    * Part 83255:2 "right"
      on mouseUp
      go to card id 83143
      end mouseUp
    * Part 83255:3 ""
      on mouseUp
      go to card id 82793
      end mouseUp
    * Part 83255:7 "qtmp2"
      on mouseUp
      go to card id 82793
      end mouseUp
    * Part 83255:9 "qtmp3"
      on mouseUp
      go to card id 82793
      end mouseUp
    * Part 83255:10 "qel2"
      on mouseUp
      go to card id 83143
      end mouseUp
  * Card 82793 "" (9 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_UpperStairs
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (elev1down)|" & it & return into pictAdd
    end if
    if CH_UpperStairs is "closed" then
    get the rect of card button marker2
    put field "pict name" & " (stairsclosed)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 82793:6 "marker2"
    * Part 82793:5 "marker"
    * Part 82793:1 "left"
      on mouseUp
      go to card id 82639
      end mouseUp
    * Part 82793:2 "right"
      on mouseUp
      go to card id 82639
      end mouseUp
    * Part 82793:3 ""
      on mouseUp
      go to card id 82060
      end mouseUp
    * Part 82793:4 ""
      on mouseUp
      go to card id 81586
      end mouseUp
    * Part 82793:7 "qtmp2"
      on mouseUp
      go to card id 82060
      end mouseUp
    * Part 82793:8 "qel2 left"
      on mouseUp
      go to card id 82639
      end mouseUp
    * Part 82793:9 "qtmp3"
      on mouseUp
      go to card id 81586
      end mouseUp
  * Card 81586 "" (4 parts)
    * Part 81586:1 "left"
      on mouseUp
      go to card id 81740
      end mouseUp
    * Part 81586:2 "right"
      on mouseUp
      go to card id 81740
      end mouseUp
    * Part 81586:3 ""
      on mouseUp
      go to card id 81254
      end mouseUp
    * Part 81586:5 "qtmp3"
      on mouseUp
      go to card id 81254
      end mouseUp
  * Card 81254 "" (5 parts)
    * Part 81254:4 "marker"
    * Part 81254:1 "left"
      on mouseUp
      go to card id 81100
      end mouseUp
    * Part 81254:2 "right"
      on mouseUp
      go to card id 81100
      end mouseUp
    * Part 81254:3 ""
      on mouseUp
      go to card id 80720
      end mouseUp
    * Part 81254:5 "closedoor"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      play stop
      play "DR Steel Close"
      HTVisual "wipe right",,the rect of card button marker,1,16
      put WhichPict & " (GateClsd)" into WhichPict
      HTAddPict WhichPict, the rect of card button marker, "Srccopy"
      htlock forcefalse
      play "DR Steel open"
      wait 10
      HTVisual "wipe left",,the rect of card button marker,1,16
      opencard
      htlock forcefalse
      end mouseUp
  * Card 80720 "qtmp3" (5 parts)

    on openCard
    global pictAdd,CH_UpperStairs
    if CH_UpperStairs is "closed" then
    get the rect of card button marker
    put field "pict name" & " (Doorclsd)|" & it & return after pictAdd
    end if
    playqt "l3 wind mov","","loop","250"
    pass openCard
    end openCard

    * Part 80720:1 "left"
      on mouseUp
      go to card id 80492
      end mouseUp
    * Part 80720:2 "right"
      on mouseUp
      go to card id 80492
      end mouseUp
    * Part 80720:3 ""
      on mouseUp
      go to card id 80103
      end mouseUp
    * Part 80720:5 "marker"
    * Part 80720:7 "qel2"
      on mouseUp
      go to card id 80103
      end mouseUp
  * Card 80103 "" (7 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_UpperStairs
    global CH_WindMoov
    put "VH 8-E Windmill.MooV" into CH_WindMoov
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    if CH_UpperStairs is "closed" then
    get the rect of card button marker2
    put field "pict name" & " (Doorclsd)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 80103:4 "marker"
    * Part 80103:1 "left"
      on mouseUp
      go to card id 80159
      end mouseUp
    * Part 80103:2 "right"
      on mouseUp
      go to card id 80159
      end mouseUp
    * Part 80103:3 ""
      on mouseUp
      go to card id 79664
      end mouseUp
    * Part 80103:5 "moovmarker"
    * Part 80103:6 "marker2"
    * Part 80103:7 "qel2"
      on mouseUp
      go to card id 79664
      end mouseUp
  * Card 79664 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 79664:4 "marker"
    * Part 79664:1 "left"
      on mouseUp
      go to card id 79496
      end mouseUp
    * Part 79664:2 "right"
      on mouseUp
      go to card id 79496
      end mouseUp
    * Part 79664:3 ""
      on mouseUp
      go to card id 79112
      end mouseUp
  * Card 79112 "" (6 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_UpperStairs
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    if CH_UpperStairs is "closed" then
    get the rect of card button marker2
    put field "pict name" & " (Doorclsd)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 79112:5 "marker2"
    * Part 79112:4 "marker"
    * Part 79112:1 "left"
      on mouseUp
      go to card id 78886
      end mouseUp
    * Part 79112:2 "right"
      on mouseUp
      go to card id 78886
      end mouseUp
    * Part 79112:3 ""
      on mouseUp
      go to card id 78770
      end mouseUp
    * Part 79112:6 "qel2 left"
      on mouseUp
      go to card id 78886
      end mouseUp
  * Card 78770 "" (6 parts)
    * Part 78770:1 "left"
      on mouseUp
      go to card id 78451
      end mouseUp
    * Part 78770:2 "right"
      on mouseUp
      go to card id 78451
      end mouseUp
    * Part 78770:3 ""
      on mouseUp
      go to card id 76659
      end mouseUp
    * Part 78770:4 "qel2 left"
      on mouseUp
      go to card id 78451
      end mouseUp
    * Part 78770:5 "qel2"
      on mouseUp
      go to card id 76659
      end mouseUp
    * Part 78770:6 "qsir"
      on mouseUp
      go to card id 76659
      end mouseUp
  * Card 76659 "qel2" (9 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    hide card button "none"
    show card button "opendoor"
    playqt "l3 wind mov","","loop","250"
    pass openCard
    end openCard

    * Part 76659:5 "marker"
    * Part 76659:7 "doormarker"
    * Part 76659:1 "none"
      on mouseUp
      playqt "L3 Wind Mov",,loop,100
      vd
      go to card id 45661
      vs left
      go to card id 85222
      end mouseUp
    * Part 76659:8 ""
      on mouseUp
      dplay "DR Wood Shut"
      htlock true
      HTVisual "wipe left",,the rect of card button doormarker,1,16
      opencard
      hide card button "None"
      show card button "OpenDoor"
      end mouseUp
    * Part 76659:2 "left"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 76503
      play "DR Wood Shut"
      else
      go to card id 76503
      end if
      end mouseUp
    * Part 76659:3 "right"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 76503
      play "DR Wood Shut"
      else
      go to card id 76503
      end if
      end mouseUp
    * Part 76659:4 ""
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 77034
      play "DR Wood Shut"
      else
      go to card id 77034
      end if
      end mouseUp
    * Part 76659:6 "opendoor"
      on mouseUp
      put field "pict name" into WhichPict
      
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,1,16
      put WhichPict & " (ElevDoorOpen)" into WhichPict
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "DR Wood Open"
      htlock forcefalse
      play stop
      show card button "None"
      hide card button "OpenDoor"
      end mouseUp
    * Part 76659:11 "qsir"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 77034
      play "DR Wood Shut"
      else
      go to card id 77034
      end if
      end mouseUp
  * Card 77034 "" (4 parts)
    * Part 77034:1 "left"
      on mouseUp
      go to card id 77151
      end mouseUp
    * Part 77034:2 "right"
      on mouseUp
      go to card id 77151
      end mouseUp
    * Part 77034:3 ""
      on mouseUp
      go to card id 77454
      end mouseUp
    * Part 77034:4 "qsir"
      on mouseUp
      go to card id 77454
      end mouseUp
  * Card 77454 "" (4 parts)
    * Part 77454:1 "left"
      on mouseUp
      go to card id 77805
      end mouseUp
    * Part 77454:2 "right"
      on mouseUp
      go to card id 77805
      end mouseUp
    * Part 77454:3 ""
      on mouseUp
      go to card id 77985
      end mouseUp
    * Part 77454:4 "qsir"
      on mouseUp
      go to card id 77985
      end mouseUp
  * Card 77985 "" (3 parts)
    * Part 77985:1 "left"
      on mouseUp
      go to card id 78158
      end mouseUp
    * Part 77985:2 "right"
      on mouseUp
      go to card id 78158
      end mouseUp
    * Part 77985:3 ""
      on mouseUp
      go to card id 92317
      end mouseUp
  * Card 92317 "qsir" (6 parts)

    on opencard
    hide card button "enterhut"
    hide card button "closedoor"
    show card button "opendoor"
    playqt "l3 wind mov","","loop","250"
    pass opencard
    end opencard

    * Part 92317:1 "right"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 92512
      play "cdoorsqueak1"
      wait 10
      play stop
      play "DR door close"
      playqt "L3 Wind Mov",,loop,250
      else
      go to card id 92512
      end if
      end mouseUp
    * Part 92317:2 "left"
      on mouseUp
      if the visible of card button openDoor is false then
      go to card id 92512
      play "cdoorsqueak1"
      wait 20
      play stop
      play "DR door close"
      playqt "L3 Wind Mov",,loop,250
      else
      go to card id 92512
      end if
      end mouseUp
    * Part 92317:4 "doormarker"
    * Part 92317:3 "enterHut"
      on mouseUp
      go to card id 92740
      playqt "MU ChannelSirrus.Mov",fadein,loop,200
      end mouseUp
    * Part 92317:5 "OpenDoor"
      on mouseUp
      put field "pict name" into WhichPict
      htlock true
      HTVisual "wipe right",,the rect of card button doormarker,1,16
      put WhichPict & " (DoorOpen)" into WhichPict
      HTAddPict WhichPict, the rect of card button doormarker, "Srccopy"
      play "cDoorSqueak2"
      htlock forcefalse
      hide card button "opendoor"
      show card button "closedoor"
      show card button "enterHut"
      play stop
      playqt "MU ChannelSirrus.Mov",fadein,loop,50
      end mouseUp
    * Part 92317:6 "closeDoor"
      on mouseUp
      dplay "cdoorsqueak1"
      HTVisual "wipe left",,the rect of card button doormarker,1,16
      opencard
      play stop
      play "DR door close"
      playqt "L3 Wind Mov",,loop,250
      end mouseUp
  * Card 92740 "" (3 parts)
    * Part 92740:1 "right"
      on mouseUp
      go to card id 92944
      end mouseUp
    * Part 92740:2 "left"
      on mouseUp
      go to card id 93276
      end mouseUp
    * Part 92740:3 ""
      on mouseUp
      go to card id 93457
      end mouseUp
  * Card 93457 "" (4 parts)
    * Part 93457:1 "right"
      on mouseUp
      go to card id 93725
      end mouseUp
    * Part 93457:2 "left"
      on mouseUp
      go to card id 94270
      end mouseUp
    * Part 93457:3 ""
      on mouseUp
      go to card id 94853
      end mouseUp
    * Part 93457:4 ""
      on mouseUp
      go to card id 95623
      end mouseUp
  * Card 95623 "" (8 parts)
    * Part 95623:1 ""
      on mouseUp
      go to card id 93457
      end mouseUp
    * Part 95623:2 ""
    * Part 95623:3 ""
    * Part 95623:4 ""
    * Part 95623:5 ""
      on mouseUp
      go to card id 71121
      end mouseUp
    * Part 95623:6 ""
      on mouseUp
      global rdrawer,ldrawer
      put "closed" into rdrawer
      put "closed" into ldrawer
      go to card id 98232
      
      end mouseUp
    * Part 95623:7 ""
    * Part 95623:8 ""
  * Card 98232 "" (14 parts)

    on opencard
    global rdrawer,ldrawer,pictAdd
    put field "pict name" into Whichpict
    if ldrawer is "open" then
    put Whichpict & "(l open)|" & the rect of card button leftmarker & return into Pictadd
    end if
    if rdrawer is "open" then
    put Whichpict & "(R open)|" & the rect of card button marker &return after Pictadd
    show card button "closedrawer"
    hide card button "opendrawer"
    else
    show card button "opendrawer"
    hide card button "closedrawer"
    end if
    hide card button "coverall"
    hide card button "coverpage"
    pass opencard
    end opencard

    * Part 98232:15 "marker2"
    * Part 98232:5 "marker"
    * Part 98232:2 "none"
      on mouseUp
      global rdrawer
      if rdrawer is open then
      put closed into rdrawer
      play "DR drawer"
      htlock true
      htvisual "wipe up",,,1,16
      opencard
      htlock forcefalse
      end if
      vd
      go to card id 95623
      end mouseUp
    * Part 98232:3 "closedrawer"
      on mouseUp
      global rdrawer
      put "closed" into rdrawer
      lock screen
      show card button "opendrawer"
      hide card button "closedrawer"
      hide card button "tornpage"
      dplay "DR drawer"
      htlock true
      htvisual "wipe up",,,1,16
      opencard
      play stop
      play "DR drawerClose"
      end mouseUp
    * Part 98232:6 ""
    * Part 98232:8 ""
    * Part 98232:10 ""
    * Part 98232:11 ""
    * Part 98232:12 ""
    * Part 98232:13 ""
    * Part 98232:14 "tornpage"
      on mouseUp
      put field "pict name" into whichpict
      vd
      htlock true
      HTAddPict whichpict & " (tornpage)",the rect of card button "marker2","srccopy"
      show card button "coverall"
      show card button "coverpage"
      htlock forcefalse
      end mouseUp
    * Part 98232:1 "opendrawer"
      on mouseUp
      global rdrawer
      put "open" into rdrawer
      put field "pict name" into whichpict
      htlock true
      htvisual "wipe down",,,1,16
      HTAddPict whichpict & "(R Open)",the rect of card button "marker","srccopy"
      hide card button "opendrawer"
      show card button "closedrawer"
      show card button "tornpage"
      play "DR drawer"
      htlock forcefalse
      end mouseUp
    * Part 98232:16 "coverall"
      on mouseUp
      set cursor to none
      htlock true
      vd
      opencard
      end mouseUp
    * Part 98232:17 "coverpage"
  * Card 71121 "" (12 parts)

    on opencard
    global rdrawer,ldrawer,pictAdd
    put field "pict name" into Whichpict
    if rdrawer is "open" then
    put Whichpict & "(R open)|" & the rect of card button rightmarker &return after Pictadd
    end if
    if ldrawer is "open" then
    put Whichpict & "(l open)|" & the rect of card button marker & return after Pictadd
    
    show card button "closedrawer"
    hide card button "opendrawer"
    else
    show card button "opendrawer"
    hide card button "closedrawer"
    end if
    pass opencard
    end opencard

    * Part 71121:12 "rightmarker"
    * Part 71121:1 "none"
      on mouseUp
      global ldrawer
      if ldrawer is open then
      put closed into ldrawer
      play "DR Drawer"
      htlock true
      htvisual "wipe up",,,1,64
      opencard
      htlock forcefalse
      end if
      
      vd
      
      go to card id 95623
      end mouseUp
    * Part 71121:6 "marker"
    * Part 71121:2 ""
    * Part 71121:3 ""
    * Part 71121:5 "closedrawer"
      on mouseUp
      global ldrawer
      put closed into ldrawer
      show card button "opendrawer"
      hide card button "closedrawer"
      dplay "DR drawer"
      htlock true
      htvisual "wipe up",,,1,64
      opencard
      end mouseUp
    * Part 71121:7 ""
    * Part 71121:8 ""
    * Part 71121:9 ""
    * Part 71121:10 ""
    * Part 71121:4 "opendrawer"
      on mouseUp
      global ldrawer
      put open into ldrawer
      put field "pict name" into whichpict
      htlock true
      htvisual "wipe down",,,1,64
      HTAddPict whichpict & "(L Open)",the rect of card button "marker","srccopy"
      hide card button "opendrawer"
      show card button "closedrawer"
      play "DR Drawer"
      htlock forcefalse
      end mouseUp
    * Part 71121:14 ""
  * Card 94853 "" (2 parts)
    * Part 94853:1 "right"
      on mouseUp
      go to card id 95104
      end mouseUp
    * Part 94853:2 "left"
      on mouseUp
      go to card id 95433
      end mouseUp
  * Card 95104 "" (4 parts)
    * Part 95104:1 "left"
      on mouseUp
      go to card id 94853
      end mouseUp
    * Part 95104:2 ""
      on mouseUp
      go to card id 93983
      end mouseUp
    * Part 95104:3 "right"
      on mouseUp
      go to card id 95433
      end mouseUp
    * Part 95104:4 ""
      on mouseUp
      go to card id 94270
      end mouseUp
  * Card 95433 "" (4 parts)
    * Part 95433:1 "left"
      on mouseUp
      go to card id 95104
      end mouseUp
    * Part 95433:2 "right"
      on mouseUp
      go to card id 94853
      end mouseUp
    * Part 95433:3 ""
    * Part 95433:4 ""
      on mouseUp
      go to card id 94270
      end mouseUp
  * Card 93725 "" (3 parts)
    * Part 93725:1 "right"
      on mouseUp
      go to card id 93983
      end mouseUp
    * Part 93725:2 "left"
      on mouseUp
      go to card id 93457
      end mouseUp
    * Part 93725:3 ""
      on mouseUp
      go to card id 96173
      end mouseUp
  * Card 96173 "" (8 parts)

    on opencard
    show card button "opendrawer"
    hide card button "closedrawer"
    pass opencard
    end opencard

    * Part 96173:1 ""
      on mouseUp
      global drawer
      if drawer is open then
      play "DR drawer"
      htvisual "wipe up",,the rect of card button "marker",1,16
      opencard
      end if
      go to card id 93725
      end mouseUp
    * Part 96173:7 "marker"
    * Part 96173:6 "closedrawer"
      on mouseUp
      global drawer
      put closed into drawer
      htlock true
      htvisual "wipe up",,,1,16
      dplay "dr drawer"
      opencard
      end mouseUp
    * Part 96173:8 ""
    * Part 96173:2 ""
    * Part 96173:3 ""
    * Part 96173:4 ""
    * Part 96173:5 "opendrawer"
      on mouseUp
      global drawer
      put open into drawer
      put field "pict name" into whichpict
      htlock true
      htvisual "wipe down",,,1,16
      HTAddPict whichpict & " (Open)",the rect of card button "marker","srccopy"
      hide card button "opendrawer"
      show card button "closedrawer"
      play "dr drawer"
      htlock forcefalse
      end mouseUp
  * Card 93983 "" (4 parts)
    * Part 93983:1 "right"
      on mouseUp
      go to card id 94270
      end mouseUp
    * Part 93983:2 "left"
      on mouseUp
      go to card id 93725
      end mouseUp
    * Part 93983:3 ""
      on mouseUp
      go to card id 95785
      end mouseUp
    * Part 93983:4 ""
      on mouseUp
      go to card id 92944
      end mouseUp
  * Card 95785 "" (10 parts)
    * Part 95785:1 ""
      on mouseUp
      go to card id 93983
      end mouseUp
    * Part 95785:2 ""
    * Part 95785:3 ""
    * Part 95785:4 ""
    * Part 95785:5 ""
    * Part 95785:8 ""
    * Part 95785:9 ""
    * Part 95785:10 ""
    * Part 95785:11 ""
    * Part 95785:12 ""
  * Card 94270 "" (4 parts)

    on openCard
    global CH_WindMoov
    put "Sirrus Windmill.MooV" into CH_WindMoov
    pass openCard
    end openCard

    * Part 94270:4 "moovMarker"
    * Part 94270:1 "right"
      on mouseUp
      go to card id 93457
      end mouseUp
    * Part 94270:2 "left"
      on mouseUp
      go to card id 93983
      end mouseUp
    * Part 94270:3 ""
      on mouseUp
      global northdesk
      put false into northdesk
      go to card id 94554
      end mouseUp
  * Card 94554 "" (16 parts)

    on opencard
    global drawer,pictAdd,CH_WindMoov,ALL_Page,MY_RedBook,NorthDesk
    if NorthDesk is not "true" then
    put "Sirrus Desk Windmill.MooV" into CH_WindMoov
    end if
    put field "pict name" into Whichpict
    if drawer is "open" then
    put Whichpict & " (open)|" & the rect of card button marker & return into Pictadd
    if item 1 to 2 of ALL_Page is "5,S"  or char 5 of MY_RedBook = 1 then
    put field "pict name" & " (noPage)|" & the rect ¬
    of card button Marker3 & return after pictAdd
    end if
    show card button "closedrawer"
    hide card button "opendrawer"
    else
    show card button "opendrawer"
    hide card button "closedrawer"
    end if
    pass opencard
    end opencard

    * Part 94554:20 "marker3"
    * Part 94554:1 "none"
      on mouseUp
      global northdesk,drawer
      if drawer is open then
      put closed into drawer
      play "dr drawer"
      htvisual "wipe up",,,1,16
      opencard
      end if
      put false into northdesk
      vd
      go to card id 94270
      end mouseUp
    * Part 94554:5 "marker"
    * Part 94554:2 "moovMarker"
    * Part 94554:4 "closedrawer"
      on mouseUp
      global drawer,NorthDesk
      put "true" into NorthDesk
      put "closed" into drawer
      htlock true
      htvisual "wipe up",,,1,16
      dplay "dr drawer"
      opencard
      play stop
      play "DR Drawer Close"
      end mouseUp
    * Part 94554:7 ""
    * Part 94554:8 ""
    * Part 94554:9 ""
    * Part 94554:12 ""
    * Part 94554:14 ""
    * Part 94554:16 ""
    * Part 94554:17 ""
    * Part 94554:18 ""
    * Part 94554:19 ""
    * Part 94554:6 "marker2"
      on MouseDown
      global MY_RedBook,ALL_Page,NorthDesk
      Put "true" into northDesk
      htlock true
      if char 5 of MY_RedBook is "0" then
      if char 1 to 3 of ALL_Page is not "5,S" then
      if All_Page is not empty then dropPage
      put "5,S,0" into ALL_Page
      htlock true
      opencard
      else
      put empty into ALL_Page
      UpdateCursor
      opencard
      end if
      end if
      dropState
      end MouseDown
    * Part 94554:3 "opendrawer"
      on mouseUp
      global drawer,NorthDesk
      put "true" into northDesk
      put "open" into drawer
      htvisual "wipe down",,,1,16
      htlock true
      dplay "dr drawer"
      opencard
      end mouseUp
  * Card 93276 "" (2 parts)
    * Part 93276:1 "right"
      on mouseUp
      go to card id 92740
      end mouseUp
    * Part 93276:2 ""
      on mouseUp
      go to card id 92944
      end mouseUp
  * Card 92944 "" (2 parts)
    * Part 92944:1 "right"
      on mouseUp
      go to card id 93276
      end mouseUp
    * Part 92944:2 ""
      on mouseUp
      go to card id 92512
      fadeout
      play "cdoorsqueak1"
      wait 10
      play stop
      play "DR door close"
      playqt "L3 Wind Mov",fadein,loop,250
      end mouseUp
  * Card 92512 "" (5 parts)

    on openCard
    global pictAdd,CH_UpperStairs
    if CH_UpperStairs is "closed" then
    get the rect of card button marker
    put field "pict name" & " (Doorclsd)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 92512:4 "marker"
    * Part 92512:1 "left"
      on mouseUp
      go to card id 92317
      end mouseUp
    * Part 92512:2 "right"
      on mouseUp
      go to card id 92317
      end mouseUp
    * Part 92512:3 ""
      on mouseUp
      go to card id 78158
      end mouseUp
    * Part 92512:5 "qhi"
      on mouseUp
      go to card id 78158
      end mouseUp
  * Card 78158 "" (4 parts)
    * Part 78158:1 "left"
      on mouseUp
      go to card id 77985
      end mouseUp
    * Part 78158:2 "right"
      on mouseUp
      go to card id 77985
      end mouseUp
    * Part 78158:3 ""
      on mouseUp
      go to card id 77805
      end mouseUp
    * Part 78158:4 "qhi"
      on mouseUp
      go to card id 77805
      end mouseUp
  * Card 77805 "" (4 parts)
    * Part 77805:1 "left"
      on mouseUp
      go to card id 77454
      end mouseUp
    * Part 77805:2 "right"
      on mouseUp
      go to card id 77454
      end mouseUp
    * Part 77805:3 ""
      on mouseUp
      go to card id 77151
      end mouseUp
    * Part 77805:4 "qhi"
      on mouseUp
      go to card id 77151
      end mouseUp
  * Card 77151 "" (3 parts)
    * Part 77151:1 "right"
      on mouseUp
      go to card id 77034
      end mouseUp
    * Part 77151:2 "left"
      on mouseUp
      go to card id 77034
      end mouseUp
    * Part 77151:3 ""
      on mouseUp
      go to card id 76503
      end mouseUp
  * Card 72768 "" (4 parts)
    * Part 72768:1 "left"
      on mouseUp
      go to card id 72506
      end mouseUp
    * Part 72768:2 "right"
      on mouseUp
      go to card id 72506
      end mouseUp
    * Part 72768:3 ""
      on mouseUp
      playQT "L2 Wind/Ropes MoV",,loop,250
      go to card id 72353
      end mouseUp
    * Part 72768:4 "qhut"
      on mouseUp
      playQT "L2 Wind/Ropes MoV",,loop,250
      go to card id 72353
      end mouseUp
  * Card 72353 "" (4 parts)
    * Part 72353:1 "left"
      on mouseUp
      go to card id 72009
      end mouseUp
    * Part 72353:2 "right"
      on mouseUp
      go to card id 72009
      end mouseUp
    * Part 72353:3 ""
      on mouseUp
      go to card id 71823
      end mouseUp
    * Part 72353:4 "qhut"
      on mouseUp
      go to card id 71823
      end mouseUp
  * Card 71823 "" (3 parts)
    * Part 71823:1 "left"
      on mouseUp
      go to card id 71489
      end mouseUp
    * Part 71823:2 "right"
      on mouseUp
      go to card id 71489
      end mouseUp
    * Part 71823:3 ""
      on mouseUp
      go to card id 71418
      end mouseUp
  * Card 71418 "qhut" (3 parts)

    on opencard
    playqt "L2 Wind/Ropes MoV","","loop","250"
    pass opencard
    end opencard

    * Part 71418:1 "left"
      on mouseUp
      go to card id 70784
      end mouseUp
    * Part 71418:2 "right"
      on mouseUp
      go to card id 70784
      end mouseUp
    * Part 71418:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 69937
      end mouseUp
  * Card 69606 "" (3 parts)
    * Part 69606:1 "left"
      on mouseUp
      go to card id 69143
      end mouseUp
    * Part 69606:2 "right"
      on mouseUp
      go to card id 69143
      end mouseUp
    * Part 69606:3 ""
      on mouseUp
      go to card id 68871
      end mouseUp
  * Card 68871 "" (3 parts)
    * Part 68871:1 "left"
      on mouseUp
      go to card id 68852
      end mouseUp
    * Part 68871:2 "right"
      on mouseUp
      go to card id 68852
      end mouseUp
    * Part 68871:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 68131
      end mouseUp
  * Card 68021 "" (9 parts)
    * Part 68021:1 "left"
      on mouseUp
      go to card id 68131
      end mouseUp
    * Part 68021:2 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 66492
      end mouseUp
    * Part 68021:3 "right"
      on mouseUp
      go to card id 67796
      end mouseUp
    * Part 68021:4 ""
    * Part 68021:5 ""
    * Part 68021:6 ""
    * Part 68021:7 ""
    * Part 68021:8 ""
    * Part 68021:9 ""
  * Card 68131 "" (7 parts)
    * Part 68131:1 "left"
      on mouseUp
      go to card id 68522
      end mouseUp
    * Part 68131:2 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 67523
      end mouseUp
    * Part 68131:3 "right"
      on mouseUp
      go to card id 68021
      end mouseUp
    * Part 68131:4 ""
    * Part 68131:5 ""
    * Part 68131:6 ""
    * Part 68131:7 ""
  * Card 68522 "" (7 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "up" then
    get the rect of card button marker
    put field "pict name" & " (Elev1up)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 68522:3 "marker"
    * Part 68522:1 "left"
      on mouseUp
      go to card id 67796
      end mouseUp
    * Part 68522:2 "right"
      on mouseUp
      go to card id 68131
      end mouseUp
    * Part 68522:4 ""
    * Part 68522:5 ""
    * Part 68522:6 ""
    * Part 68522:7 ""
  * Card 67523 "" (3 parts)
    * Part 67523:1 "left"
      on mouseUp
      go to card id 67173
      end mouseUp
    * Part 67523:2 "right"
      on mouseUp
      go to card id 67173
      end mouseUp
    * Part 67523:3 ""
      on mouseUp
      go to card id 66921
      end mouseUp
  * Card 66921 "" (4 parts)
    * Part 66921:1 "left"
      on mouseUp
      go to card id 66725
      end mouseUp
    * Part 66921:2 "right"
      on mouseUp
      go to card id 66725
      end mouseUp
    * Part 66921:3 ""
      on mouseUp
      go to card id 59607
      end mouseUp
    * Part 66921:4 ""
      on mouseUp
      go to card id 59359
      end mouseUp
  * Card 59359 "" (3 parts)
    * Part 59359:1 "right"
      on mouseUp
      go to card id 58973
      end mouseUp
    * Part 59359:2 ""
      on mouseUp
      go to card id 58828
      end mouseUp
    * Part 59359:3 ""
      on mouseUp
      go to card id 59918
      end mouseUp
  * Card 59918 "" (3 parts)
    * Part 59918:1 "left"
      on mouseUp
      go to card id 60345
      end mouseUp
    * Part 59918:2 "right"
      on mouseUp
      go to card id 60345
      end mouseUp
    * Part 59918:3 ""
      on mouseUp
      go to card id 60558
      end mouseUp
  * Card 60558 "" (3 parts)
    * Part 60558:1 "left"
      on mouseUp
      go to card id 60811
      end mouseUp
    * Part 60558:2 "right"
      on mouseUp
      go to card id 60811
      end mouseUp
    * Part 60558:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 61143
      end mouseUp
  * Card 61143 "" (5 parts)
    * Part 61143:1 "left"
      on mouseUp
      go to card id 61362
      end mouseUp
    * Part 61143:2 "right"
      on mouseUp
      go to card id 61856
      end mouseUp
    * Part 61143:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 62019
      end mouseUp
    * Part 61143:4 ""
    * Part 61143:5 ""
  * Card 62019 "" (3 parts)
    * Part 62019:1 "left"
      on mouseUp
      go to card id 62368
      end mouseUp
    * Part 62019:2 "right"
      on mouseUp
      go to card id 62368
      end mouseUp
    * Part 62019:3 ""
      on mouseUp
      go to card id 62538
      end mouseUp
  * Card 62538 "" (8 parts)
    * Part 62538:1 "left"
      on mouseUp
      go to card id 62929
      end mouseUp
    * Part 62538:2 "right"
      on mouseUp
      go to card id 62929
      end mouseUp
    * Part 62538:3 ""
    * Part 62538:4 ""
    * Part 62538:5 ""
    * Part 62538:6 ""
    * Part 62538:8 ""
    * Part 62538:9 ""
  * Card 62929 "" (3 parts)
    * Part 62929:1 "left"
      on mouseUp
      go to card id 62538
      end mouseUp
    * Part 62929:2 "right"
      on mouseUp
      go to card id 62538
      end mouseUp
    * Part 62929:3 ""
      on mouseUp
      go to card id 62368
      end mouseUp
  * Card 62368 "" (3 parts)
    * Part 62368:1 "left"
      on mouseUp
      go to card id 62019
      end mouseUp
    * Part 62368:2 "right"
      on mouseUp
      go to card id 62019
      end mouseUp
    * Part 62368:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 61615
      end mouseUp
  * Card 61362 "" (5 parts)
    * Part 61362:1 "left"
      on mouseUp
      go to card id 61615
      end mouseUp
    * Part 61362:2 "right"
      on mouseUp
      go to card id 61143
      end mouseUp
    * Part 61362:3 ""
    * Part 61362:4 ""
    * Part 61362:5 ""
  * Card 61615 "" (7 parts)
    * Part 61615:1 "left"
      on mouseUp
      go to card id 61856
      end mouseUp
    * Part 61615:2 "right"
      on mouseUp
      go to card id 61362
      end mouseUp
    * Part 61615:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 60811
      end mouseUp
    * Part 61615:4 ""
    * Part 61615:5 ""
    * Part 61615:6 ""
    * Part 61615:7 ""
  * Card 61856 "" (4 parts)
    * Part 61856:1 "left"
      on mouseUp
      go to card id 61143
      end mouseUp
    * Part 61856:2 "right"
      on mouseUp
      go to card id 61615
      end mouseUp
    * Part 61856:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 63091
      end mouseUp
    * Part 61856:4 ""
  * Card 63091 "" (3 parts)
    * Part 63091:1 "left"
      on mouseUp
      go to card id 63414
      end mouseUp
    * Part 63091:3 "right"
      on mouseUp
      go to card id 63414
      end mouseUp
    * Part 63091:4 ""
      on mouseUp
      go to card id 63618
      end mouseUp
  * Card 63618 "" (3 parts)
    * Part 63618:1 "left"
      on mouseUp
      go to card id 63938
      end mouseUp
    * Part 63618:2 "right"
      on mouseUp
      go to card id 63938
      end mouseUp
    * Part 63618:3 ""
      on mouseUp
      go to card id 64200
      end mouseUp
  * Card 64200 "" (2 parts)
    * Part 64200:1 "right"
      on mouseUp
      go to card id 64450
      end mouseUp
    * Part 64200:2 ""
      on mouseUp
      go to card id 64766
      end mouseUp
  * Card 64766 "" (4 parts)
    * Part 64766:1 "left"
      on mouseUp
      go to card id 64977
      end mouseUp
    * Part 64766:2 "right"
      on mouseUp
      go to card id 64977
      end mouseUp
    * Part 64766:3 ""
      on mouseUp
      go to card id 65080
      end mouseUp
    * Part 64766:4 ""
  * Card 65080 "" (2 parts)
    * Part 65080:1 "right"
      on mouseUp
      go to card id 65493
      end mouseUp
    * Part 65080:2 ""
      on mouseUp
      go to card id 65580
      end mouseUp
  * Card 65580 "" (3 parts)
    * Part 65580:1 "left"
      on mouseUp
      go to card id 65832
      end mouseUp
    * Part 65580:2 "right"
      on mouseUp
      go to card id 65832
      end mouseUp
    * Part 65580:3 ""
      on mouseUp
      go to card id 66189
      end mouseUp
  * Card 66189 "" (3 parts)
    * Part 66189:1 "left"
      on mouseUp
      go to card id 66492
      end mouseUp
    * Part 66189:2 "right"
      on mouseUp
      go to card id 66492
      end mouseUp
    * Part 66189:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 68522
      end mouseUp
  * Card 66492 "" (3 parts)
    * Part 66492:1 "left"
      on mouseUp
      go to card id 66189
      end mouseUp
    * Part 66492:3 "right"
      on mouseUp
      go to card id 66189
      end mouseUp
    * Part 66492:4 ""
      on mouseUp
      go to card id 65832
      end mouseUp
  * Card 65832 "" (3 parts)
    * Part 65832:1 "left"
      on mouseUp
      go to card id 65580
      end mouseUp
    * Part 65832:2 "right"
      on mouseUp
      go to card id 65580
      end mouseUp
    * Part 65832:3 ""
      on mouseUp
      go to card id 65493
      end mouseUp
  * Card 65493 "" (2 parts)
    * Part 65493:1 "left"
      on mouseUp
      go to card id 65080
      end mouseUp
    * Part 65493:2 ""
      on mouseUp
      go to card id 64977
      end mouseUp
  * Card 64977 "" (3 parts)
    * Part 64977:1 "left"
      on mouseUp
      go to card id 64766
      end mouseUp
    * Part 64977:2 "right"
      on mouseUp
      go to card id 64766
      end mouseUp
    * Part 64977:3 ""
      on mouseUp
      go to card id 64450
      end mouseUp
  * Card 64450 "" (2 parts)
    * Part 64450:1 "left"
      on mouseUp
      go to card id 64200
      end mouseUp
    * Part 64450:2 ""
      on mouseUp
      go to card id 63938
      end mouseUp
  * Card 63938 "" (3 parts)
    * Part 63938:1 "left"
      on mouseUp
      go to card id 63618
      end mouseUp
    * Part 63938:2 "right"
      on mouseUp
      go to card id 63618
      end mouseUp
    * Part 63938:3 ""
      on mouseUp
      go to card id 63414
      end mouseUp
  * Card 63414 "" (3 parts)
    * Part 63414:1 "left"
      on mouseUp
      go to card id 63091
      end mouseUp
    * Part 63414:2 "right"
      on mouseUp
      go to card id 63091
      end mouseUp
    * Part 63414:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 61362
      end mouseUp
  * Card 60811 "" (3 parts)
    * Part 60811:1 "left"
      on mouseUp
      go to card id 60558
      end mouseUp
    * Part 60811:2 "right"
      on mouseUp
      go to card id 60558
      end mouseUp
    * Part 60811:3 ""
      on mouseUp
      go to card id 60345
      end mouseUp
  * Card 60345 "" (4 parts)
    * Part 60345:1 "left"
      on mouseUp
      go to card id 59918
      end mouseUp
    * Part 60345:2 "right"
      on mouseUp
      go to card id 59918
      end mouseUp
    * Part 60345:3 ""
      on mouseUp
      go to card id 58973
      end mouseUp
    * Part 60345:4 ""
      on mouseUp
      go to card id 58828
      end mouseUp
  * Card 58828 "" (3 parts)
    * Part 58828:1 "right"
      on mouseUp
      go to card id 58558
      end mouseUp
    * Part 58828:2 ""
      on mouseUp
      go to card id 58150
      end mouseUp
    * Part 58828:3 ""
      on mouseUp
      go to card id 59735
      end mouseUp
  * Card 58150 "" (3 parts)
    * Part 58150:1 "left"
      on mouseUp
      go to card id 57876
      end mouseUp
    * Part 58150:2 "right"
      on mouseUp
      go to card id 57876
      end mouseUp
    * Part 58150:3 ""
      on mouseUp
      go to card id 57628
      end mouseUp
  * Card 57628 "" (3 parts)
    * Part 57628:1 "left"
      on mouseUp
      go to card id 57357
      end mouseUp
    * Part 57628:2 "right"
      on mouseUp
      go to card id 57357
      end mouseUp
    * Part 57628:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 54701
      end mouseUp
  * Card 54277 "" (12 parts)
    * Part 54277:2 "Left"
      on mouseUp
      go to card id 54701
      end mouseUp
    * Part 54277:3 "right"
      on mouseUp
      go to card id 54235
      end mouseUp
    * Part 54277:4 ""
    * Part 54277:5 ""
    * Part 54277:6 ""
    * Part 54277:7 ""
    * Part 54277:8 ""
    * Part 54277:9 ""
    * Part 54277:10 ""
    * Part 54277:11 ""
    * Part 54277:12 ""
    * Part 54277:13 ""
  * Card 54701 "" (15 parts)
    * Part 54701:1 "left"
      on mouseUp
      go to card id 54883
      end mouseUp
    * Part 54701:2 "right"
      on mouseUp
      go to card id 54277
      end mouseUp
    * Part 54701:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 53916
      end mouseUp
    * Part 54701:4 ""
    * Part 54701:6 ""
    * Part 54701:7 ""
    * Part 54701:8 ""
    * Part 54701:9 ""
    * Part 54701:10 ""
    * Part 54701:11 ""
    * Part 54701:12 ""
    * Part 54701:13 ""
    * Part 54701:14 ""
    * Part 54701:15 ""
    * Part 54701:16 ""
  * Card 54883 "" (7 parts)
    * Part 54883:1 "left"
      on mouseUp
      go to card id 54235
      end mouseUp
    * Part 54883:2 "right"
      on mouseUp
      go to card id 54701
      end mouseUp
    * Part 54883:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,200
      go to card id 55164
      end mouseUp
    * Part 54883:4 ""
    * Part 54883:5 ""
    * Part 54883:6 ""
    * Part 54883:7 ""
  * Card 55164 "" (3 parts)
    * Part 55164:1 "left"
      on mouseUp
      go to card id 55361
      end mouseUp
    * Part 55164:2 "right"
      on mouseUp
      go to card id 55361
      end mouseUp
    * Part 55164:4 ""
      on mouseUp
      go to card id 55677
      end mouseUp
  * Card 55677 "" (2 parts)
    * Part 55677:1 "left"
      on mouseUp
      go to card id 55975
      end mouseUp
    * Part 55677:2 ""
      on mouseUp
      go to card id 56127
      end mouseUp
  * Card 56127 "" (3 parts)
    * Part 56127:1 "left"
      on mouseUp
      go to card id 56544
      end mouseUp
    * Part 56127:2 "right"
      on mouseUp
      go to card id 56544
      end mouseUp
    * Part 56127:3 ""
      on mouseUp
      go to card id 56830
      end mouseUp
  * Card 56830 "" (2 parts)
    * Part 56830:1 "right"
      on mouseUp
      go to card id 57070
      end mouseUp
    * Part 56830:2 ""
      on mouseUp
      go to card id 57119
      end mouseUp
  * Card 57119 "" (3 parts)

    on openCard
    door
    pass openCard
    end openCard
    
    on idle
    if there is a window "V 19-N StairsDoor.MooV" then
    send movieidle to window "V 19-N StairsDoor.MooV"
    end if
    pass idle
    end idle
    
    on door
    put "V 19-N StairsDoor.MooV" into theMovieName
    if there is not a window TheMovieName then
    Movie TheMovieName,"borderless",the topleft of card button moovmarker,"invisible","Floating"
    end if
    if there is a window TheMovieName then
    set the dontErase of window TheMovieName to true
    set the movieCursorID of window theMovieName to 128
    set the audioLevel of window TheMovieName to "0"
    set the mute of window TheMovieName to true
    set the badge of window TheMovieName to false
    set the controllerVisible of window TheMovieName to false
    set the useCustomClut of window theMovieName to false
    set the closeOnFinish of window TheMovieName to false
    set the loop of window TheMovieName to false
    set the seeAllFrames of window TheMovieName to false
    set the startTime of window TheMovieName to "0"
    --set the endTime of window TheMovieName to "2,240"
    --set the callBackMsg of window theMovieName to "Done"
    set the passMovieClick of window theMovieName to false
    set the rate of window TheMovieName to "0.0"
    --show window TheMovieName
    end if
    end door
    
    on closecard
    htlock true
    put "V 19-N StairsDoor.MooV" into theMovieName
    if there is a window theMovieName then  close window theMovieName
    pass closecard
    end closecard

    * Part 57119:4 "none"
      on mousewithin
      deCurse "override",2003,"color","nodelay"
      end mousewithin
      
      on mouseDown
      soundidle
      global CH_UpperStairs
      deCurse "override",2004,"color","nodelay"
      put 230 into theStart
      put "Village 19-N Switch" into thePict
      put the rect of card button none into theLoc
      put "0,0,53,53" into theClip
      repeat until the mouse is up
      soundidle
      if the mouseloc is not within the rect of card button none then exit repeat
      get (the mouseV - theStart) div 5
      if it < 0 then get 0
      if it > 11 then get 11
      put it * 53 into item 1 of theClip
      --put it * 87 + 87 into item 3 of theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      if it ≥ 11 then
      put "V 19-N StairsDoor.MooV" into theMovieName
      if CH_UpperStairs is not "open" then
      if there is a window theMovieName then
      set the currTime of window theMovieName to "0"
      set the rate of window theMovieName to "1.0"
      show window theMovieName
      end if
      put "open" into CH_UpperStairs
      else
      if there is a window theMovieName then
      set the currTime of window theMovieName to the duration of window theMovieName
      set the rate of window theMovieName to "-1.0"
      show window theMovieName
      end if
      put "closed" into CH_UpperStairs
      end if
      exit repeat
      end if
      end repeat
      if there is a window theMovieName then
      repeat until the rate of window theMovieName is "0"
      soundidle
      send idle to window theMovieName
      end repeat
      end if
      put "0,0,53,83" into theClip
      HTAddPict thePict,theLoc,"srccopy","srcRect",theClip
      deCurse "override",2003,"color","nodelay"
      end mouseDown
    * Part 57119:1 "right"
      on mouseUp
      go to card id 57070
      end mouseUp
    * Part 57119:2 "moovmarker"
  * Card 57070 "" (2 parts)
    * Part 57070:1 "left"
      on mouseUp
      go to card id 56830
      end mouseUp
    * Part 57070:2 ""
      on mouseUp
      go to card id 56544
      end mouseUp
  * Card 56544 "" (3 parts)
    * Part 56544:1 "left"
      on mouseUp
      go to card id 56127
      end mouseUp
    * Part 56544:2 "right"
      on mouseUp
      go to card id 56127
      end mouseUp
    * Part 56544:3 ""
      on mouseUp
      go to card id 55975
      end mouseUp
  * Card 55975 "" (2 parts)
    * Part 55975:1 "right"
      on mouseUp
      go to card id 55677
      end mouseUp
    * Part 55975:2 ""
      on mouseUp
      go to card id 55361
      end mouseUp
  * Card 55361 "" (3 parts)
    * Part 55361:1 "left"
      on mouseUp
      go to card id 55164
      end mouseUp
    * Part 55361:2 "right"
      on mouseUp
      go to card id 55164
      end mouseUp
    * Part 55361:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 54277
      end mouseUp
  * Card 53916 "" (3 parts)
    * Part 53916:1 "left"
      on mouseUp
      go to card id 53748
      end mouseUp
    * Part 53916:2 "right"
      on mouseUp
      go to card id 53748
      end mouseUp
    * Part 53916:3 ""
      on mouseUp
      go to card id 53323
      end mouseUp
  * Card 53323 "" (3 parts)
    * Part 53323:1 "right"
      on mouseUp
      go to card id 53051
      end mouseUp
    * Part 53323:2 "left"
      on mouseUp
      go to card id 53051
      end mouseUp
    * Part 53323:3 ""
      on mouseUp
      playQT "L2 Wind Mov",,loop,100
      go to card id 52457
      end mouseUp
  * Card 51770 "" (5 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_LowerStairs
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    if CH_LowerStairs is "open" then
    get the rect of card button marker2
    put field "pict name" & " (dooropen)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 51770:5 "marker2"
    * Part 51770:4 "marker"
    * Part 51770:1 ""
      on mouseUp
      go to card id 51416
      end mouseUp
    * Part 51770:2 "right"
      on mouseUp
      go to card id 51667
      end mouseUp
    * Part 51770:3 "left"
      on mouseUp
      go to card id 51667
      end mouseUp
  * Card 51416 "" (4 parts)
    * Part 51416:1 "left"
      on mouseUp
      go to card id 51081
      end mouseUp
    * Part 51416:2 "right"
      on mouseUp
      go to card id 51081
      end mouseUp
    * Part 51416:3 ""
      on mouseUp
      go to card id 50043
      end mouseUp
    * Part 51416:4 ""
      on mouseUp
      go to card id 50514
      end mouseUp
  * Card 50043 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & "  (elev1down)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 50043:4 "marker"
    * Part 50043:1 "left"
      on mouseUp
      go to card id 50393
      end mouseUp
    * Part 50043:2 ""
      on mouseUp
      go to card id 47869
      end mouseUp
    * Part 50043:3 ""
      on mouseUp
      go to card id 50725
      end mouseUp
  * Card 50725 "" (6 parts)

    on openCard
    global pictAdd,CH_Elevator1,CH_LowerStairs
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    if CH_LowerStairs is "open" then
    get the rect of card button marker2
    put field "pict name" & " Stairs (DoorOpen)|" & it & return after pictAdd
    end if
    pass openCard
    end openCard

    * Part 50725:6 "marker2"
    * Part 50725:4 "marker"
    * Part 50725:1 ""
      on mouseUp
      go to card id 96441
      end mouseUp
    * Part 50725:2 "left"
      on mouseUp
      go to card id 47569
      end mouseUp
    * Part 50725:3 "right"
      on mouseUp
      go to card id 47569
      end mouseUp
    * Part 50725:7 "qel4"
      on mouseUp
      go to card id 96441
      end mouseUp
  * Card 96441 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 96441:5 "marker"
    * Part 96441:1 "right"
      on mouseUp
      go to card id 96569
      end mouseUp
    * Part 96441:3 "left"
      on mouseUp
      go to card id 96569
      end mouseUp
    * Part 96441:4 ""
      on mouseUp
      global CH_Elevator1
      if CH_elevator1 is "down" then
      go to card id 98756
      else
      go to card id 46136
      end if
      
      end mouseUp
  * Card 98756 "" (3 parts)

    on openCard
    global pictAdd,CH_LowerStairs
    if CH_LowerStairs is "open" then
    get the rect of card button marker
    put field "pict name" & " (open)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 98756:1 ""
      on mouseUp
      go to card id 96441
      end mouseUp
    * Part 98756:2 ""
    * Part 98756:3 "marker"
  * Card 96569 "" (3 parts)
    * Part 96569:1 ""
      on mouseUp
      go to card id 96441
      end mouseUp
    * Part 96569:2 "right"
      on mouseUp
      go to card id 96441
      end mouseUp
    * Part 96569:3 ""
      on mouseUp
      go to card id 47569
      end mouseUp
  * Card 50393 "" (3 parts)
    * Part 50393:1 ""
      on mouseUp
      go to card id 50514
      end mouseUp
    * Part 50393:2 "right"
      on mouseUp
      go to card id 50043
      end mouseUp
    * Part 50393:3 ""
      on mouseUp
      go to card id 51081
      end mouseUp
  * Card 50514 "" (4 parts)

    on Opencard
    global CH_WindMoov
    put "V 8-N Windmill.MooV" into CH_WindMoov
    pass opencard
    end opencard

    * Part 50514:1 "right"
      on mouseUp
      go to card id 49884
      end mouseUp
    * Part 50514:2 ""
      on mouseUp
      go to card id 47918
      end mouseUp
    * Part 50514:3 ""
      on mouseUp
      go to card id 49611
      end mouseUp
    * Part 50514:4 "moovmarker"
  * Card 49611 "" (4 parts)

    on openCard
    global pictAdd,CH_Elevator1
    if CH_Elevator1 is "down" then
    get the rect of card button marker
    put field "pict name" & " (Elev1down)|" & it & return into pictAdd
    end if
    pass openCard
    end openCard

    * Part 49611:4 "marker"
    * Part 49611:1 "right"
      on mouseUp
      go to card id 47869
      end mouseUp
    * Part 49611:2 ""
      on mouseUp
      go to card id 50393
      end mouseUp
    * Part 49611:3 ""
      on mouseUp
      go to card id 50725
      end mouseUp
  * Card 44614 "" (0 parts)
  * Background 2647 "" (3 parts)
    * Part 2647:7 ""
    * Part 2647:1 "pict name"
    * Part 2647:8 "truepath"
